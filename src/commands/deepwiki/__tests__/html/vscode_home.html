<!DOCTYPE html>
<html lang="en">

<head>
    <meta charSet="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="preload" href="/_next/static/media/569ce4b8f30dc480-s.p.woff2" as="font" crossorigin=""
        type="font/woff2" />
    <link rel="preload" href="/_next/static/media/93f479601ee12b01-s.p.woff2" as="font" crossorigin=""
        type="font/woff2" />
    <link rel="stylesheet" href="/_next/static/css/f30152c0704fba31.css?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp"
        data-precedence="next" />
    <link rel="stylesheet" href="/_next/static/css/fedbfc2ae0aae6b7.css?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp"
        data-precedence="next" />
    <link rel="preload" as="script" fetchPriority="low"
        href="/_next/static/chunks/webpack-acbbbb548492d4a6.js?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp" />
    <script src="/_next/static/chunks/4bd1b696-cebf68b71ed1e85d.js?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp"
        async=""></script>
    <script src="/_next/static/chunks/1684-ea67d49f9b80c8e3.js?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp" async=""></script>
    <script src="/_next/static/chunks/main-app-8ab5af3d6b81086e.js?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp"
        async=""></script>
    <script src="/_next/static/chunks/b1298b8d-549c141f97a3b262.js?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp"
        async=""></script>
    <script src="/_next/static/chunks/378e5a93-3b0f971d3611a8a5.js?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp"
        async=""></script>
    <script src="/_next/static/chunks/f7f68e2d-40290491c524df5c.js?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp"
        async=""></script>
    <script src="/_next/static/chunks/5009-cf1c1739f4eccbfa.js?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp" async=""></script>
    <script src="/_next/static/chunks/3377-d302682beb4206f6.js?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp" async=""></script>
    <script src="/_next/static/chunks/6671-b0da8a89e8d16b02.js?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp" async=""></script>
    <script src="/_next/static/chunks/6967-c4b815e71e97ed18.js?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp" async=""></script>
    <script src="/_next/static/chunks/app/layout-06063843479c8654.js?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp"
        async=""></script>
    <script src="/_next/static/chunks/7bf36345-06f80506190927ed.js?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp"
        async=""></script>
    <script src="/_next/static/chunks/c16f53c3-c80d3b6d0c4af7a0.js?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp"
        async=""></script>
    <script src="/_next/static/chunks/537-d9d5e9261de3e69c.js?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp" async=""></script>
    <script src="/_next/static/chunks/8039-e53433e94d896525.js?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp" async=""></script>
    <script src="/_next/static/chunks/2136-947db7298d61ada7.js?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp" async=""></script>
    <script src="/_next/static/chunks/8674-a5b7b13d963b8a5d.js?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp" async=""></script>
    <script src="/_next/static/chunks/3977-e03adae34a519f5e.js?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp" async=""></script>
    <script src="/_next/static/chunks/9783-f88757c029ed31d1.js?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp" async=""></script>
    <script src="/_next/static/chunks/420-e2b3ea79d67e5a73.js?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp" async=""></script>
    <script src="/_next/static/chunks/6032-be6c666fb5ecb598.js?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp" async=""></script>
    <script src="/_next/static/chunks/6483-c0b9dd8c2baf74dc.js?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp" async=""></script>
    <script
        src="/_next/static/chunks/app/%5Borg%5D/%5Brepo%5D/%5B%5B...wikiRoutes%5D%5D/page-b309f29bff911a92.js?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp"
        async=""></script>
    <script src="/_next/static/chunks/3449-c92dfc3f699b631b.js?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp" async=""></script>
    <script src="/_next/static/chunks/7202-534888446eb5d98d.js?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp" async=""></script>
    <script src="/_next/static/chunks/736-7a62e7c2ead36425.js?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp" async=""></script>
    <script
        src="/_next/static/chunks/app/%5Borg%5D/%5Brepo%5D/layout-06632fe3cb1ac889.js?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp"
        async=""></script>
    <meta name="next-size-adjust" content="" />
    <title>microsoft/vscode | DeepWiki</title>
    <meta name="description"
        content="This document provides a high-level overview of Visual Studio Code&#x27;s architecture, covering the main application structure, process model, and key design principles. It focuses on the core systems tha" />
    <meta property="og:title" content="microsoft/vscode | DeepWiki" />
    <meta property="og:description"
        content="This document provides a high-level overview of Visual Studio Code&#x27;s architecture, covering the main application structure, process model, and key design principles. It focuses on the core systems tha" />
    <meta property="og:url" content="https://deepwiki.com/microsoft/vscode" />
    <meta property="og:site_name" content="DeepWiki" />
    <meta property="og:type" content="website" />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="microsoft/vscode | DeepWiki" />
    <meta name="twitter:description"
        content="This document provides a high-level overview of Visual Studio Code&#x27;s architecture, covering the main application structure, process model, and key design principles. It focuses on the core systems tha" />
    <link rel="icon" href="/favicon.ico" type="image/x-icon" sizes="48x48" />
    <link rel="icon" href="/icon.png?66aaf51e0e68c818" type="image/png" sizes="16x16" />
    <link rel="apple-touch-icon" href="/apple-icon.png?a4f658907db0ab87" type="image/png" sizes="180x180" />
    <script src="/_next/static/chunks/polyfills-42372ed130431b0a.js?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp"
        noModule=""></script>
</head>

<body class="__variable_5cfdac font-geist-sans relative min-h-screen __variable_9a8899 bg-background antialiased">
    <section aria-label="Notifications alt+T" tabindex="-1" aria-live="polite" aria-relevant="additions text"
        aria-atomic="false"></section>
    <script>((e, t, r, n, a, o, i, s) => { let u = document.documentElement, l = ["light", "dark"]; function c(t) { var r; (Array.isArray(e) ? e : [e]).forEach(e => { let r = "class" === e, n = r && o ? a.map(e => o[e] || e) : a; r ? (u.classList.remove(...n), u.classList.add(o && o[t] ? o[t] : t)) : u.setAttribute(e, t) }), r = t, s && l.includes(r) && (u.style.colorScheme = r) } if (n) c(n); else try { let e = localStorage.getItem(t) || r, n = i && "system" === e ? window.matchMedia("(prefers-color-scheme: dark)").matches ? "dark" : "light" : e; c(n) } catch (e) { } })("class", "theme", "light", null, ["light", "dark"], null, true, true)</script>
    <!--$!--><template data-dgst="BAILOUT_TO_CLIENT_SIDE_RENDERING"></template>
    <div class="flex min-h-screen w-full flex-col text-white">
        <div class="container-wrapper flex flex-1 items-center justify-center px-4">
            <div class="inline-block bg-clip-text text-[#b5b5b5a4] animate-shine text-center text-lg"
                style="background-image:linear-gradient(120deg, rgba(255, 255, 255, 0) 40%, rgba(255, 255, 255, 0.8) 50%, rgba(255, 255, 255, 0) 60%);background-size:200% 100%;-webkit-background-clip:text;animation-duration:1s">
                Loading...</div>
        </div>
    </div><!--/$-->
    <script src="/_next/static/chunks/webpack-acbbbb548492d4a6.js?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp"
        async=""></script>
    <script>(self.__next_f = self.__next_f || []).push([0])</script>
    <script>self.__next_f.push([1, "1:\"$Sreact.fragment\"\n2:I[51709,[\"9453\",\"static/chunks/b1298b8d-549c141f97a3b262.js?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp\",\"8970\",\"static/chunks/378e5a93-3b0f971d3611a8a5.js?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp\",\"1585\",\"static/chunks/f7f68e2d-40290491c524df5c.js?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp\",\"5009\",\"static/chunks/5009-cf1c1739f4eccbfa.js?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp\",\"3377\",\"static/chunks/3377-d302682beb4206f6.js?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp\",\"6671\",\"static/chunks/6671-b0da8a89e8d16b02.js?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp\",\"6967\",\"static/chunks/6967-c4b815e71e97ed18.js?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp\",\"7177\",\"static/chunks/app/layout-06063843479c8654.js?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp\"],\"RootProvider\"]\n3:I[87555,[],\"\"]\n4:I[31295,[],\"\"]\n6:I[90894,[],\"ClientPageRoot\"]\n7:I[87667,[\"9453\",\"static/chunks/b1298b8d-549c141f97a3b262.js?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp\",\"8970\",\"static/chunks/378e5a93-3b0f971d3611a8a5.js?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp\",\"1585\",\"static/chunks/f7f68e2d-40290491c524df5c.js?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp\",\"4129\",\"static/chunks/7bf36345-06f80506190927ed.js?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp\",\"2545\",\"static/chunks/c16f53c3-c80d3b6d0c4af7a0.js?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp\",\"537\",\"static/chunks/537-d9d5e9261de3e69c.js?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp\",\"5009\",\"static/chunks/5009-cf1c1739f4eccbfa.js?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp\",\"3377\",\"static/chunks/3377-d302682beb4206f6.js?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp\",\"6671\",\"static/chunks/6671-b0da8a89e8d16b02.js?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp\",\"8039\",\"static/chunks/8039-e53433e94d896525.js?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp\",\"2136\",\"static/chunks/2136-947db7298d61ada7.js?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp\",\"6967\",\"static/chunks/6967-c4b815e71e97ed18.js?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp\",\"8674\",\"static/chunks/8674-a5b7b13d963b8a5d.js?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp\",\"3977\",\"static/chunks/3977-e03adae34a519f5e.js?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp\",\"9783\",\"static/ch"])</script>
    <script>self.__next_f.push([1, "unks/9783-f88757c029ed31d1.js?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp\",\"420\",\"static/chunks/420-e2b3ea79d67e5a73.js?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp\",\"6032\",\"static/chunks/6032-be6c666fb5ecb598.js?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp\",\"6483\",\"static/chunks/6483-c0b9dd8c2baf74dc.js?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp\",\"3285\",\"static/chunks/app/%5Borg%5D/%5Brepo%5D/%5B%5B...wikiRoutes%5D%5D/page-b309f29bff911a92.js?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp\"],\"default\"]\na:I[59665,[],\"OutletBoundary\"]\nd:I[59665,[],\"ViewportBoundary\"]\nf:I[59665,[],\"MetadataBoundary\"]\n11:I[26614,[],\"\"]\n:HL[\"/_next/static/media/569ce4b8f30dc480-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/media/93f479601ee12b01-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/css/f30152c0704fba31.css?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp\",\"style\"]\n:HL[\"/_next/static/css/fedbfc2ae0aae6b7.css?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp\",\"style\"]\n"])</script>
    <script>self.__next_f.push([1, "0:{\"P\":null,\"b\":\"RYqqB-vnBi5KYmJvCZBca\",\"p\":\"\",\"c\":[\"\",\"microsoft\",\"vscode\",\"\"],\"i\":false,\"f\":[[[\"\",{\"children\":[[\"org\",\"microsoft\",\"d\"],{\"children\":[[\"repo\",\"vscode\",\"d\"],{\"children\":[[\"wikiRoutes\",\"\",\"oc\"],{\"children\":[\"__PAGE__\",{}]}]}]}]},\"$undefined\",\"$undefined\",true],[\"\",[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/f30152c0704fba31.css?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}],[\"$\",\"link\",\"1\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/fedbfc2ae0aae6b7.css?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"suppressHydrationWarning\":true,\"children\":[[\"$\",\"head\",null,{}],[\"$\",\"body\",null,{\"className\":\"__variable_5cfdac font-geist-sans relative min-h-screen __variable_9a8899 bg-background antialiased\",\"children\":[\"$\",\"$L2\",null,{\"children\":[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":404}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]}]]}]]}],{\"children\":[[\"org\",\"microsoft\",\"d\"],[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"repo\",\"vscode\",\"d\"],[\"$\",\"$1\",\"c\",{\"children\":[null,\"$L5\"]}],{\"children\":[[\"wikiRoutes\",\"\",\"oc\"],[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[\"__PAGE__\",[\"$\",\"$1\",\"c\",{\"children\":[[\"$\",\"$L6\",null,{\"Component\":\"$7\",\"searchParams\":{},\"params\":{\"org\":\"microsoft\",\"repo\":\"vscode\"},\"promises\":[\"$@8\",\"$@9\"]}],\"$undefined\",null,[\"$\",\"$La\",null,{\"children\":[\"$Lb\",\"$Lc\",null]}]]}],{},null,false]},null,false]},null,false]},null,false]},null,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[\"$\",\"$1\",\"umBvpVMRoJEFH7DuLEbru\",{\"children\":[[\"$\",\"$Ld\",null,{\"children\":\"$Le\"}],[\"$\",\"meta\",null,{\"name\":\"next-size-adjust\",\"content\":\"\"}]]}],[\"$\",\"$Lf\",null,{\"children\":\"$L10\"}]]}],false]],\"m\":\"$undefined\",\"G\":[\"$11\",\"$undefined\"],\"s\":false,\"S\":true}\n"])</script>
    <script>self.__next_f.push([1, "8:{}\n9:{\"org\":\"microsoft\",\"repo\":\"vscode\"}\n"])</script>
    <script>self.__next_f.push([1, "e:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\nb:null\n"])</script>
    <script>self.__next_f.push([1, "12:I[27393,[\"9453\",\"static/chunks/b1298b8d-549c141f97a3b262.js?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp\",\"8970\",\"static/chunks/378e5a93-3b0f971d3611a8a5.js?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp\",\"1585\",\"static/chunks/f7f68e2d-40290491c524df5c.js?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp\",\"537\",\"static/chunks/537-d9d5e9261de3e69c.js?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp\",\"5009\",\"static/chunks/5009-cf1c1739f4eccbfa.js?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp\",\"3377\",\"static/chunks/3377-d302682beb4206f6.js?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp\",\"8039\",\"static/chunks/8039-e53433e94d896525.js?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp\",\"2136\",\"static/chunks/2136-947db7298d61ada7.js?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp\",\"3449\",\"static/chunks/3449-c92dfc3f699b631b.js?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp\",\"3977\",\"static/chunks/3977-e03adae34a519f5e.js?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp\",\"9783\",\"static/chunks/9783-f88757c029ed31d1.js?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp\",\"7202\",\"static/chunks/7202-534888446eb5d98d.js?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp\",\"736\",\"static/chunks/736-7a62e7c2ead36425.js?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp\",\"2933\",\"static/chunks/app/%5Borg%5D/%5Brepo%5D/layout-06632fe3cb1ac889.js?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp\"],\"HeaderWrapperWithSuspense\"]\n13:I[93403,[\"9453\",\"static/chunks/b1298b8d-549c141f97a3b262.js?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp\",\"8970\",\"static/chunks/378e5a93-3b0f971d3611a8a5.js?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp\",\"1585\",\"static/chunks/f7f68e2d-40290491c524df5c.js?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp\",\"537\",\"static/chunks/537-d9d5e9261de3e69c.js?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp\",\"5009\",\"static/chunks/5009-cf1c1739f4eccbfa.js?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp\",\"3377\",\"static/chunks/3377-d302682beb4206f6.js?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp\",\"8039\",\"static/chunks/8039-e53433e94d896525.js?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp\",\"2136\",\"static/chunks/2136-947db7298d61ada7.js?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp\",\"3449\",\"static/chunks/3449-c92dfc3f699b631b.js?dpl=dpl_Anbo7sxeDA69MkH68QwGR1Cf"])</script>
    <script>self.__next_f.push([1, "gYyp\",\"3977\",\"static/chunks/3977-e03adae34a519f5e.js?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp\",\"9783\",\"static/chunks/9783-f88757c029ed31d1.js?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp\",\"7202\",\"static/chunks/7202-534888446eb5d98d.js?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp\",\"736\",\"static/chunks/736-7a62e7c2ead36425.js?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp\",\"2933\",\"static/chunks/app/%5Borg%5D/%5Brepo%5D/layout-06632fe3cb1ac889.js?dpl=dpl_Anbo7sxeDA69MkH68QwGR1CfgYyp\"],\"WikiContextProvider\"]\n14:T50a1,"])</script>
    <script>self.__next_f.push([1, "# VS Code Architecture Overview\n\n\u003cdetails\u003e\n\u003csummary\u003eRelevant source files\u003c/summary\u003e\n\nThe following files were used as context for generating this wiki page:\n\n- [.npmrc](.npmrc)\n- [.nvmrc](.nvmrc)\n- [build/.moduleignore](build/.moduleignore)\n- [build/.webignore](build/.webignore)\n- [build/checksums/electron.txt](build/checksums/electron.txt)\n- [build/checksums/nodejs.txt](build/checksums/nodejs.txt)\n- [build/lib/i18n.resources.json](build/lib/i18n.resources.json)\n- [build/package-lock.json](build/package-lock.json)\n- [build/package.json](build/package.json)\n- [cgmanifest.json](cgmanifest.json)\n- [extensions/vscode-colorize-tests/src/colorizer.test.ts](extensions/vscode-colorize-tests/src/colorizer.test.ts)\n- [package-lock.json](package-lock.json)\n- [package.json](package.json)\n- [remote/.npmrc](remote/.npmrc)\n- [remote/package-lock.json](remote/package-lock.json)\n- [remote/package.json](remote/package.json)\n- [remote/web/package-lock.json](remote/web/package-lock.json)\n- [remote/web/package.json](remote/web/package.json)\n- [src/vs/base/node/terminalEncoding.ts](src/vs/base/node/terminalEncoding.ts)\n- [src/vs/code/browser/workbench/workbench-dev.html](src/vs/code/browser/workbench/workbench-dev.html)\n- [src/vs/code/browser/workbench/workbench.html](src/vs/code/browser/workbench/workbench.html)\n- [src/vs/code/browser/workbench/workbench.ts](src/vs/code/browser/workbench/workbench.ts)\n- [src/vs/code/electron-main/app.ts](src/vs/code/electron-main/app.ts)\n- [src/vs/code/electron-main/main.ts](src/vs/code/electron-main/main.ts)\n- [src/vs/code/node/cli.ts](src/vs/code/node/cli.ts)\n- [src/vs/code/node/cliProcessMain.ts](src/vs/code/node/cliProcessMain.ts)\n- [src/vs/editor/common/config/editorConfigurationSchema.ts](src/vs/editor/common/config/editorConfigurationSchema.ts)\n- [src/vs/platform/editor/common/editor.ts](src/vs/platform/editor/common/editor.ts)\n- [src/vs/platform/environment/common/argv.ts](src/vs/platform/environment/common/argv.ts)\n- [src/vs/platform/environment/common/environment.ts](src/vs/platform/environment/common/environment.ts)\n- [src/vs/platform/environment/common/environmentService.ts](src/vs/platform/environment/common/environmentService.ts)\n- [src/vs/platform/environment/electron-main/environmentMainService.ts](src/vs/platform/environment/electron-main/environmentMainService.ts)\n- [src/vs/platform/environment/node/argv.ts](src/vs/platform/environment/node/argv.ts)\n- [src/vs/platform/environment/node/argvHelper.ts](src/vs/platform/environment/node/argvHelper.ts)\n- [src/vs/platform/environment/node/environmentService.ts](src/vs/platform/environment/node/environmentService.ts)\n- [src/vs/platform/environment/node/stdin.ts](src/vs/platform/environment/node/stdin.ts)\n- [src/vs/platform/environment/test/node/nativeModules.integrationTest.ts](src/vs/platform/environment/test/node/nativeModules.integrationTest.ts)\n- [src/vs/server/node/server.cli.ts](src/vs/server/node/server.cli.ts)\n- [src/vs/workbench/browser/actions/layoutActions.ts](src/vs/workbench/browser/actions/layoutActions.ts)\n- [src/vs/workbench/browser/contextkeys.ts](src/vs/workbench/browser/contextkeys.ts)\n- [src/vs/workbench/browser/dnd.ts](src/vs/workbench/browser/dnd.ts)\n- [src/vs/workbench/browser/layout.ts](src/vs/workbench/browser/layout.ts)\n- [src/vs/workbench/browser/parts/auxiliarybar/auxiliaryBarActions.ts](src/vs/workbench/browser/parts/auxiliarybar/auxiliaryBarActions.ts)\n- [src/vs/workbench/browser/parts/editor/editor.contribution.ts](src/vs/workbench/browser/parts/editor/editor.contribution.ts)\n- [src/vs/workbench/browser/parts/editor/editor.ts](src/vs/workbench/browser/parts/editor/editor.ts)\n- [src/vs/workbench/browser/parts/editor/editorActions.ts](src/vs/workbench/browser/parts/editor/editorActions.ts)\n- [src/vs/workbench/browser/parts/editor/editorCommands.ts](src/vs/workbench/browser/parts/editor/editorCommands.ts)\n- [src/vs/workbench/browser/parts/editor/editorDropTarget.ts](src/vs/workbench/browser/parts/editor/editorDropTarget.ts)\n- [src/vs/workbench/browser/parts/editor/editorGroupView.ts](src/vs/workbench/browser/parts/editor/editorGroupView.ts)\n- [src/vs/workbench/browser/parts/editor/editorGroupWatermark.ts](src/vs/workbench/browser/parts/editor/editorGroupWatermark.ts)\n- [src/vs/workbench/browser/parts/editor/editorPart.ts](src/vs/workbench/browser/parts/editor/editorPart.ts)\n- [src/vs/workbench/browser/parts/editor/media/editorgroupview.css](src/vs/workbench/browser/parts/editor/media/editorgroupview.css)\n- [src/vs/workbench/browser/parts/panel/panelActions.ts](src/vs/workbench/browser/parts/panel/panelActions.ts)\n- [src/vs/workbench/browser/parts/titlebar/titlebarActions.ts](src/vs/workbench/browser/parts/titlebar/titlebarActions.ts)\n- [src/vs/workbench/browser/web.api.ts](src/vs/workbench/browser/web.api.ts)\n- [src/vs/workbench/browser/web.factory.ts](src/vs/workbench/browser/web.factory.ts)\n- [src/vs/workbench/browser/web.main.ts](src/vs/workbench/browser/web.main.ts)\n- [src/vs/workbench/browser/workbench.contribution.ts](src/vs/workbench/browser/workbench.contribution.ts)\n- [src/vs/workbench/browser/workbench.ts](src/vs/workbench/browser/workbench.ts)\n- [src/vs/workbench/common/contextkeys.ts](src/vs/workbench/common/contextkeys.ts)\n- [src/vs/workbench/common/editor.ts](src/vs/workbench/common/editor.ts)\n- [src/vs/workbench/electron-browser/desktop.main.ts](src/vs/workbench/electron-browser/desktop.main.ts)\n- [src/vs/workbench/services/editor/browser/editorService.ts](src/vs/workbench/services/editor/browser/editorService.ts)\n- [src/vs/workbench/services/editor/common/editorGroupsService.ts](src/vs/workbench/services/editor/common/editorGroupsService.ts)\n- [src/vs/workbench/services/editor/common/editorService.ts](src/vs/workbench/services/editor/common/editorService.ts)\n- [src/vs/workbench/services/editor/test/browser/editorGroupsService.test.ts](src/vs/workbench/services/editor/test/browser/editorGroupsService.test.ts)\n- [src/vs/workbench/services/editor/test/browser/editorService.test.ts](src/vs/workbench/services/editor/test/browser/editorService.test.ts)\n- [src/vs/workbench/services/environment/browser/environmentService.ts](src/vs/workbench/services/environment/browser/environmentService.ts)\n- [src/vs/workbench/services/environment/common/environmentService.ts](src/vs/workbench/services/environment/common/environmentService.ts)\n- [src/vs/workbench/services/environment/electron-browser/environmentService.ts](src/vs/workbench/services/environment/electron-browser/environmentService.ts)\n- [src/vs/workbench/services/extensionManagement/browser/builtinExtensionsScannerService.ts](src/vs/workbench/services/extensionManagement/browser/builtinExtensionsScannerService.ts)\n- [src/vs/workbench/services/extensionManagement/browser/webExtensionsScannerService.ts](src/vs/workbench/services/extensionManagement/browser/webExtensionsScannerService.ts)\n- [src/vs/workbench/services/extensions/electron-browser/nativeExtensionService.ts](src/vs/workbench/services/extensions/electron-browser/nativeExtensionService.ts)\n- [src/vs/workbench/services/layout/browser/layoutService.ts](src/vs/workbench/services/layout/browser/layoutService.ts)\n- [src/vs/workbench/services/remote/browser/browserRemoteResourceHandler.ts](src/vs/workbench/services/remote/browser/browserRemoteResourceHandler.ts)\n- [src/vs/workbench/test/browser/workbenchTestServices.ts](src/vs/workbench/test/browser/workbenchTestServices.ts)\n- [src/vs/workbench/workbench.common.main.ts](src/vs/workbench/workbench.common.main.ts)\n- [src/vs/workbench/workbench.desktop.main.ts](src/vs/workbench/workbench.desktop.main.ts)\n- [src/vs/workbench/workbench.web.main.ts](src/vs/workbench/workbench.web.main.ts)\n- [test/automation/package.json](test/automation/package.json)\n- [test/integration/browser/package.json](test/integration/browser/package.json)\n- [test/smoke/package.json](test/smoke/package.json)\n\n\u003c/details\u003e\n\n\n\n## Purpose and Scope\n\nThis document provides a high-level overview of Visual Studio Code's architecture, covering the main application structure, process model, and key design principles. It focuses on the core systems that enable VS Code to function as both a desktop application (via Electron) and a web application, while supporting a rich extension ecosystem.\n\nFor detailed information about specific subsystems, refer to the relevant pages in this wiki.\n\n## Multi-Process Architecture\n\nVS Code employs a multi-process architecture designed for performance, security, and extensibility. The architecture differs between desktop (Electron) and web environments.\n\n### Process Architecture \u0026 Communication\n```mermaid\ngraph TB\n    subgraph \"Main Process (Electron)\"\n        MainApp[\"CodeApplication\u003cbr/\u003eapp.ts\"]\n        WindowMgmt[\"WindowsMainService\"]\n        FileSystem[\"DiskFileSystemProvider\"]\n        ExtScanner[\"ExtensionsScannerService\"]\n    end\n    \n    subgraph \"Renderer Process (Workbench)\"\n        Workbench[\"Workbench\u003cbr/\u003eworkbench.ts\"]\n        EditorCore[\"EditorService\"]\n        UIComponents[\"Layout\u003cbr/\u003elayout.ts\"]\n        Services[\"Core Services\u003cbr/\u003eServiceCollection\"]\n    end\n    \n    subgraph \"Extension Host Process\"\n        ExtHostServices[\"ExtensionHostStarter\"]\n        ExtensionCode[\"Extension Code\"]\n        LanguageServers[\"Language Server Protocol\"]\n    end\n    \n    subgraph \"Additional Processes\"\n        Terminal[\"PtyHostService\u003cbr/\u003eptyHostService.ts\"]\n        DebugAdapter[\"Debug Adapters\"]\n        TaskRunner[\"Terminal Task System\"]\n    end\n    \n    MainApp -.-\u003e|IPC| Workbench\n    Workbench -.-\u003e|RPC| ExtHostServices\n    ExtHostServices --\u003e ExtensionCode\n    ExtensionCode --\u003e LanguageServers\n    \n    Services --\u003e Terminal\n    Services --\u003e DebugAdapter\n    Services --\u003e TaskRunner\n    \n    MainApp --\u003e FileSystem\n    MainApp --\u003e ExtScanner\n```\n\nThe main process (`CodeApplication`) manages application lifecycle, window creation, and native system integration. The renderer process hosts the `Workbench` which contains the editor UI and core services. Extension hosts run in separate processes for isolation and stability.\n\n**Sources:** [src/vs/code/electron-main/app.ts:130-624](), [src/vs/workbench/browser/workbench.ts:14-125](), [src/vs/workbench/browser/layout.ts:138-304](), [src/vs/platform/terminal/node/ptyHostService.ts:111-114]()\n\n## Application Entry Points\n\nVS Code has multiple entry points depending on the execution context. Each entry point initializes the appropriate services and components for its environment.\n\n### Application Startup Flow\n```mermaid\ngraph LR\n    subgraph \"Entry Points\"\n        ElectronMain[\"main.ts\u003cbr/\u003eCodeMain\"]\n        WebMain[\"web.main.ts\u003cbr/\u003eBrowserMain\"]\n        CLI[\"cli.ts\u003cbr/\u003emain()\"]\n        CliProcess[\"cliProcessMain.ts\u003cbr/\u003eCliMain\"]\n    end\n    \n    subgraph \"Core Application Classes\"\n        CodeApplication[\"CodeApplication\u003cbr/\u003eapp.ts\"]\n        Workbench[\"Workbench\u003cbr/\u003eworkbench.ts\"]\n        BrowserWindow[\"BrowserWindow\u003cbr/\u003ewindow.ts\"]\n    end\n    \n    ElectronMain --\u003e CodeApplication\n    WebMain --\u003e BrowserMain\n    BrowserMain --\u003e Workbench\n    CodeApplication --\u003e Workbench\n    WebMain --\u003e BrowserWindow\n    CLI --\u003e CliProcess\n    CliProcess --\u003e CodeApplication\n```\n\n| Entry Point | Purpose | Key Classes |\n|-------------|---------|-------------|\n| **main.ts** | Electron main process | `CodeMain`, `CodeApplication` |\n| **web.main.ts** | Web browser startup | `BrowserMain`, `Workbench` |\n| **cli.ts** | Command-line interface | `main()`, `CliMain` |\n| **cliProcessMain.ts** | CLI process handling | `CliMain`, extension management |\n\n**Sources:** [src/vs/code/electron-main/main.ts:84-335](), [src/vs/workbench/browser/web.main.ts:99-137](), [src/vs/code/node/cli.ts:32-138](), [src/vs/code/node/cliProcessMain.ts:72-327]()\n\n## Core Workbench Architecture\n\nThe `Workbench` class serves as the main UI container and orchestrates the initialization of all core services. The `Layout` class manages the visual arrangement of workbench parts.\n\n### Workbench Layout System\n```mermaid\ngraph TB\n    subgraph \"Workbench Container\"\n        WorkbenchClass[\"Workbench\u003cbr/\u003eworkbench.ts\"]\n        LayoutClass[\"Layout\u003cbr/\u003elayout.ts\"]\n        ServiceCollection[\"ServiceCollection\"]\n        InstantiationService[\"InstantiationService\"]\n    end\n    \n    subgraph \"UI Parts (Parts enum)\"\n        TitlebarPart[\"TITLEBAR_PART\u003cbr/\u003eTitleService\"]\n        BannerPart[\"BANNER_PART\u003cbr/\u003eBannerService\"]\n        ActivitybarPart[\"ACTIVITYBAR_PART\"]\n        SidebarPart[\"SIDEBAR_PART\u003cbr/\u003eSidebarPart\"]\n        EditorPart[\"EDITOR_PART\u003cbr/\u003eEditorService\"]\n        PanelPart[\"PANEL_PART\u003cbr/\u003ePanelPart\"]\n        AuxiliarybarPart[\"AUXILIARYBAR_PART\u003cbr/\u003eAuxiliaryBarPart\"]\n        StatusbarPart[\"STATUSBAR_PART\u003cbr/\u003eStatusbarPart\"]\n    end\n    \n    subgraph \"Editor System\"\n        EditorGroupsService[\"EditorGroupsService\"]\n        EditorGroupView[\"EditorGroupView\"]\n        EditorPanes[\"EditorPanes\"]\n        MonacoEditor[\"Monaco Editor\"]\n    end\n    \n    WorkbenchClass --\u003e LayoutClass\n    WorkbenchClass --\u003e ServiceCollection\n    ServiceCollection --\u003e InstantiationService\n    \n    LayoutClass --\u003e TitlebarPart\n    LayoutClass --\u003e BannerPart\n    LayoutClass --\u003e ActivitybarPart\n    LayoutClass --\u003e SidebarPart\n    LayoutClass --\u003e EditorPart\n    LayoutClass --\u003e PanelPart\n    LayoutClass --\u003e AuxiliarybarPart\n    LayoutClass --\u003e StatusbarPart\n    \n    EditorPart --\u003e EditorGroupsService\n    EditorGroupsService --\u003e EditorGroupView\n    EditorGroupView --\u003e EditorPanes\n    EditorPanes --\u003e MonacoEditor\n```\n\nThe workbench uses a `SerializableGrid` layout system where each part can be resized and repositioned. The `EditorGroupsService` manages multiple editor groups within the editor part.\n\n**Sources:** [src/vs/workbench/browser/workbench.ts:14-125](), [src/vs/workbench/browser/layout.ts:138-304](), [src/vs/workbench/browser/parts/editor/editorGroupView.ts:62-247](), [src/vs/workbench/services/editor/browser/editorService.ts:39-95]()\n\n## Service Layer Architecture\n\nVS Code uses a comprehensive dependency injection system built around `IInstantiationService`. Services are registered as singletons and provide core functionality across the application.\n\n### Core Service Dependencies\n```mermaid\ngraph TB\n    subgraph \"Service Registration System\"\n        registerSingleton[\"registerSingleton()\"]\n        ServiceCollection[\"ServiceCollection\"]\n        SyncDescriptor[\"SyncDescriptor\"]\n        TestInstantiationService[\"TestInstantiationService\u003cbr/\u003e(for testing)\"]\n    end\n    \n    subgraph \"Foundation Services\"\n        IEnvironmentService[\"IEnvironmentService\u003cbr/\u003eBrowserWorkbenchEnvironmentService\"]\n        IFileService[\"IFileService\u003cbr/\u003eFileService\"]\n        IConfigurationService[\"IConfigurationService\u003cbr/\u003eWorkspaceService\"]\n        ILogService[\"ILogService\u003cbr/\u003eLogService\"]\n        IStorageService[\"IStorageService\u003cbr/\u003eBrowserStorageService\"]\n    end\n    \n    subgraph \"Workbench Core Services\"\n        IEditorService[\"IEditorService\u003cbr/\u003eEditorService\"]\n        IWorkbenchLayoutService[\"IWorkbenchLayoutService\u003cbr/\u003eLayout\"]\n        IEditorGroupsService[\"IEditorGroupsService\u003cbr/\u003eEditorGroupsService\"]\n        IThemeService[\"IThemeService\u003cbr/\u003eWorkbenchThemeService\"]\n        IKeybindingService[\"IKeybindingService\u003cbr/\u003eWorkbenchKeybindingService\"]\n    end\n    \n    subgraph \"Feature Services\"\n        IExtensionService[\"IExtensionService\u003cbr/\u003eExtensionService\"]\n        ITerminalService[\"ITerminalService\u003cbr/\u003eTerminalService\"]\n        INotificationService[\"INotificationService\u003cbr/\u003eNotificationService\"]\n        IDialogService[\"IDialogService\u003cbr/\u003eDialogService\"]\n    end\n    \n    registerSingleton --\u003e ServiceCollection\n    ServiceCollection --\u003e SyncDescriptor\n    \n    ServiceCollection --\u003e IEnvironmentService\n    ServiceCollection --\u003e IFileService\n    ServiceCollection --\u003e IConfigurationService\n    ServiceCollection --\u003e ILogService\n    ServiceCollection --\u003e IStorageService\n    \n    IFileService --\u003e IEditorService\n    IConfigurationService --\u003e IWorkbenchLayoutService\n    IEditorService --\u003e IEditorGroupsService\n    \n    IEnvironmentService --\u003e IExtensionService\n    IThemeService --\u003e IWorkbenchLayoutService\n    IKeybindingService --\u003e IEditorService\n```\n\n| Service Category | Purpose | Key Implementations |\n|------------------|---------|-------------------|\n| **Foundation** | Core platform capabilities | `FileService`, `ConfigurationService`, `LogService` |\n| **Layout** | UI structure and management | `Layout`, `EditorGroupsService`, `WorkbenchLayoutService` |\n| **Extensions** | Extension lifecycle and API | `ExtensionService`, `ExtensionHostStarter` |\n| **Features** | Specialized functionality | `TerminalService`, `NotificationService`, `ThemeService` |\n\n**Sources:** [src/vs/workbench/workbench.common.main.ts:131-176](), [src/vs/workbench/test/browser/workbenchTestServices.ts:250-336](), [src/vs/workbench/services/environment/browser/environmentService.ts:42-402](), [src/vs/workbench/browser/layout.ts:305-336]()\n\n## Extension System Architecture\n\nThe extension system runs in isolated processes and communicates with the main workbench via RPC (Remote Procedure Call) mechanisms. Extensions access VS Code functionality through a well-defined API surface.\n\n### Extension Host Communication\n```mermaid\ngraph LR\n    subgraph \"Main Thread (Renderer)\"\n        ExtensionService[\"ExtensionService\"]\n        ExtensionHostStarter[\"ExtensionHostStarter\"]\n        MainThreadAPI[\"MainThread APIs\u003cbr/\u003emainThreadLanguageFeatures.ts\u003cbr/\u003emainThreadCommands.ts\u003cbr/\u003emainThreadEditor.ts\"]\n    end\n    \n    subgraph \"Extension Host Process\"\n        ExtHostMain[\"Extension Host Main\"]\n        ExtHostAPI[\"ExtHost APIs\u003cbr/\u003eextHostLanguageFeatures.ts\u003cbr/\u003eextHostCommands.ts\u003cbr/\u003eextHostEditors.ts\"]\n        VSCodeAPI[\"vscode.d.ts\u003cbr/\u003eExtension API\"]\n        ExtensionCode[\"Extension Code\"]\n    end\n    \n    subgraph \"RPC Communication\"\n        ElectronIPCServer[\"ElectronIPCServer\"]\n        MessagePortClient[\"MessagePortClient\"]\n        ProxyChannel[\"ProxyChannel\"]\n    end\n    \n    ExtensionService --\u003e ExtensionHostStarter\n    ExtensionHostStarter --\u003e ElectronIPCServer\n    ElectronIPCServer --\u003e MessagePortClient\n    MessagePortClient --\u003e ProxyChannel\n    ProxyChannel --\u003e ExtHostMain\n    \n    ExtHostMain --\u003e ExtHostAPI\n    ExtHostAPI --\u003e VSCodeAPI\n    VSCodeAPI --\u003e ExtensionCode\n    \n    MainThreadAPI \u003c-.-\u003e|RPC| ExtHostAPI\n```\n\nThe extension host provides a sandboxed environment where extensions run. The `vscode.d.ts` API defines the contract between VS Code and extensions, with main thread services handling the actual implementation.\n\n**Sources:** [src/vs/code/electron-main/app.ts:24-26](), [src/vs/platform/extensions/common/extensionHostStarter.ts:43-44](), [src/vs/workbench/workbench.common.main.ts:10-40](), [src/vs/workbench/browser/parts/editor/editor.contribution.ts:8-15]()\n\n## Build System Integration\n\nVS Code's build system handles TypeScript compilation, module bundling, and platform-specific packaging through a complex webpack-based pipeline.\n\n| Component | Purpose | Key Files |\n|-----------|---------|-----------|\n| **TypeScript Compiler** | Source transformation and type checking | `tsconfig.json`, `build/gulpfile.js` |\n| **Webpack Bundler** | Module bundling and optimization | `webpack.config.js` files |\n| **Package Management** | Dependency resolution | `package.json`, `yarn.lock` |\n| **Platform Packaging** | Desktop and web distribution | Build scripts, Electron packaging |\n| **Extension Packaging** | VSIX creation for extensions | Extension manifest processing |\n\n```mermaid\ngraph TB\n    subgraph \"Source Processing\"\n        TypeScript[\"TypeScript Sources\u003cbr/\u003e(.ts files)\"]\n        PackageJSON[\"package.json\u003cbr/\u003e(dependencies)\"]\n        YarnLock[\"yarn.lock\u003cbr/\u003e(locked versions)\"]\n    end\n    \n    subgraph \"Build Pipeline\"\n        TSCompiler[\"TypeScript Compiler\u003cbr/\u003e(tsc)\"]\n        WebpackBundle[\"Webpack\u003cbr/\u003e(module bundling)\"]\n        ESLint[\"ESLint\u003cbr/\u003e(code quality)\"]\n    end\n    \n    subgraph \"Output Targets\"\n        DesktopApp[\"Desktop App\u003cbr/\u003e(Electron)\"]\n        WebApp[\"Web App\u003cbr/\u003e(Browser)\"]\n        VSIXExtensions[\"VSIX Extensions\u003cbr/\u003e(Extension packages)\"]\n        CLITools[\"CLI Tools\u003cbr/\u003e(Native binaries)\"]\n    end\n    \n    TypeScript --\u003e TSCompiler\n    PackageJSON --\u003e WebpackBundle\n    YarnLock --\u003e WebpackBundle\n    \n    TSCompiler --\u003e WebpackBundle\n    WebpackBundle --\u003e ESLint\n    \n    ESLint --\u003e DesktopApp\n    ESLint --\u003e WebApp\n    ESLint --\u003e VSIXExtensions\n    ESLint --\u003e CLITools\n```\n\n**Sources:** [build/lib/i18n.resources.json:1-20](), [src/vs/platform/environment/node/argv.ts:47-222](), [src/vs/workbench/workbench.desktop.main.ts:1-186](), [src/vs/workbench/workbench.web.main.ts:1-103]()"])</script>
    <script>self.__next_f.push([1, "15:T94fb,"])</script>
    <script>self.__next_f.push([1, "# Application Startup and Process Architecture\n\n\u003cdetails\u003e\n\u003csummary\u003eRelevant source files\u003c/summary\u003e\n\nThe following files were used as context for generating this wiki page:\n\n- [build/lib/i18n.resources.json](build/lib/i18n.resources.json)\n- [src/vs/base/node/terminalEncoding.ts](src/vs/base/node/terminalEncoding.ts)\n- [src/vs/code/browser/workbench/workbench-dev.html](src/vs/code/browser/workbench/workbench-dev.html)\n- [src/vs/code/browser/workbench/workbench.html](src/vs/code/browser/workbench/workbench.html)\n- [src/vs/code/browser/workbench/workbench.ts](src/vs/code/browser/workbench/workbench.ts)\n- [src/vs/code/electron-main/app.ts](src/vs/code/electron-main/app.ts)\n- [src/vs/code/electron-main/main.ts](src/vs/code/electron-main/main.ts)\n- [src/vs/code/node/cli.ts](src/vs/code/node/cli.ts)\n- [src/vs/code/node/cliProcessMain.ts](src/vs/code/node/cliProcessMain.ts)\n- [src/vs/platform/environment/common/argv.ts](src/vs/platform/environment/common/argv.ts)\n- [src/vs/platform/environment/common/environment.ts](src/vs/platform/environment/common/environment.ts)\n- [src/vs/platform/environment/common/environmentService.ts](src/vs/platform/environment/common/environmentService.ts)\n- [src/vs/platform/environment/electron-main/environmentMainService.ts](src/vs/platform/environment/electron-main/environmentMainService.ts)\n- [src/vs/platform/environment/node/argv.ts](src/vs/platform/environment/node/argv.ts)\n- [src/vs/platform/environment/node/argvHelper.ts](src/vs/platform/environment/node/argvHelper.ts)\n- [src/vs/platform/environment/node/environmentService.ts](src/vs/platform/environment/node/environmentService.ts)\n- [src/vs/platform/environment/node/stdin.ts](src/vs/platform/environment/node/stdin.ts)\n- [src/vs/server/node/server.cli.ts](src/vs/server/node/server.cli.ts)\n- [src/vs/workbench/browser/web.api.ts](src/vs/workbench/browser/web.api.ts)\n- [src/vs/workbench/browser/web.factory.ts](src/vs/workbench/browser/web.factory.ts)\n- [src/vs/workbench/browser/web.main.ts](src/vs/workbench/browser/web.main.ts)\n- [src/vs/workbench/electron-browser/desktop.main.ts](src/vs/workbench/electron-browser/desktop.main.ts)\n- [src/vs/workbench/services/environment/browser/environmentService.ts](src/vs/workbench/services/environment/browser/environmentService.ts)\n- [src/vs/workbench/services/environment/common/environmentService.ts](src/vs/workbench/services/environment/common/environmentService.ts)\n- [src/vs/workbench/services/environment/electron-browser/environmentService.ts](src/vs/workbench/services/environment/electron-browser/environmentService.ts)\n- [src/vs/workbench/services/extensionManagement/browser/builtinExtensionsScannerService.ts](src/vs/workbench/services/extensionManagement/browser/builtinExtensionsScannerService.ts)\n- [src/vs/workbench/services/extensionManagement/browser/webExtensionsScannerService.ts](src/vs/workbench/services/extensionManagement/browser/webExtensionsScannerService.ts)\n- [src/vs/workbench/services/extensions/electron-browser/nativeExtensionService.ts](src/vs/workbench/services/extensions/electron-browser/nativeExtensionService.ts)\n- [src/vs/workbench/services/remote/browser/browserRemoteResourceHandler.ts](src/vs/workbench/services/remote/browser/browserRemoteResourceHandler.ts)\n- [src/vs/workbench/workbench.common.main.ts](src/vs/workbench/workbench.common.main.ts)\n- [src/vs/workbench/workbench.desktop.main.ts](src/vs/workbench/workbench.desktop.main.ts)\n- [src/vs/workbench/workbench.web.main.ts](src/vs/workbench/workbench.web.main.ts)\n\n\u003c/details\u003e\n\n\n\nThis document explains how VS Code initializes and its multi-process architecture, including the main process, renderer processes, extension host process, and shared process. It covers the startup sequence, environment setup, service initialization, and how processes communicate.\n\nFor information about dependency management and build system, see [Build System and Package Management](#1.2).\n\n## Overview\n\nVS Code uses a multi-process architecture built on Electron, which combines Chromium for rendering and Node.js for native capabilities. The application startup involves careful orchestration of multiple processes, each with specific responsibilities:\n\n1. **Main Process**: Entry point that coordinates application lifecycle and manages windows\n2. **Renderer Process**: Handles UI rendering and workbench components  \n3. **Extension Host Process**: Runs extensions in isolation from the main UI\n4. **Shared Process**: Handles resource-intensive operations shared across windows\n\nThe startup sequence involves command line parsing, environment setup, service initialization, and process coordination to ensure proper application initialization.\n\nSources:\n- [src/vs/code/electron-main/main.ts:84-93]()\n- [src/vs/code/electron-main/app.ts:526-530]()\n- [src/vs/workbench/browser/web.main.ts:119-131]()\n\n## Application Startup Flow\n\n### Entry Points by Platform\n\n**Application Entry Points and Process Creation**\n\nVS Code has different entry points depending on the platform and deployment target:\n\n```mermaid\nflowchart TD\n    CLI[\"Command Line\u003cbr/\u003ecode CLI\"] \n    DesktopApp[\"Desktop App\u003cbr/\u003eElectron\"]\n    WebBrowser[\"Web Browser\u003cbr/\u003evscode.dev\"]\n    \n    CLI --\u003e CliMain[\"main()\u003cbr/\u003e(src/vs/code/node/cli.ts)\"]\n    DesktopApp --\u003e ElectronMain[\"CodeMain.main()\u003cbr/\u003e(src/vs/code/electron-main/main.ts)\"]\n    WebBrowser --\u003e BrowserMainOpen[\"BrowserMain.open()\u003cbr/\u003e(src/vs/workbench/browser/web.main.ts)\"]\n    \n    CliMain --\u003e CliProcessMain[\"CliMain.run()\u003cbr/\u003e(src/vs/code/node/cliProcessMain.ts)\"]\n    CliMain --\u003e ElectronSpawn[\"Spawn Electron Process\"]\n    \n    ElectronMain --\u003e CodeAppStartup[\"CodeApplication.startup()\u003cbr/\u003e(src/vs/code/electron-main/app.ts)\"]\n    ElectronSpawn --\u003e CodeAppStartup\n    \n    BrowserMainOpen --\u003e WorkbenchCreate[\"new Workbench()\u003cbr/\u003e(src/vs/workbench/browser/workbench.ts)\"]\n    \n    CodeAppStartup --\u003e DesktopMain[\"DesktopMain.main()\u003cbr/\u003e(src/vs/workbench/electron-browser/desktop.main.ts)\"]\n    DesktopMain --\u003e WorkbenchDesktop[\"new Workbench()\u003cbr/\u003e(src/vs/workbench/browser/workbench.ts)\"]\n```\n\nSources:\n- [src/vs/code/node/cli.ts:43-139]()\n- [src/vs/code/electron-main/main.ts:85-94]()\n- [src/vs/workbench/browser/web.main.ts:119-131]()\n- [src/vs/code/electron-main/app.ts:526-530]()\n- [src/vs/workbench/electron-browser/desktop.main.ts:1-185]()\n\n### Main Process Startup Sequence\n\n**CodeMain and CodeApplication Initialization**\n\nThe main process startup follows a specific sequence managed by the `CodeMain` and `CodeApplication` classes:\n\n```mermaid\nsequenceDiagram\n    participant Entry as \"main()\"\n    participant CodeMain as \"CodeMain\"\n    participant CodeApp as \"CodeApplication\" \n    participant Services as \"ServiceCollection\"\n    participant SharedProcess as \"SharedProcess\"\n    participant WindowsMainService as \"WindowsMainService\"\n    \n    Entry-\u003e\u003eCodeMain: \"startup()\"\n    CodeMain-\u003e\u003eCodeMain: \"createServices()\"\n    CodeMain-\u003e\u003eServices: \"ProductService, EnvironmentMainService, LoggerMainService\"\n    CodeMain-\u003e\u003eCodeMain: \"claimInstance()\"\n    CodeMain-\u003e\u003eCodeMain: \"new NodeIPCServer()\"\n    CodeMain-\u003e\u003eCodeApp: \"new CodeApplication(mainProcessNodeIpcServer, userEnv)\"\n    CodeApp-\u003e\u003eCodeApp: \"startup()\"\n    CodeApp-\u003e\u003eSharedProcess: \"setupSharedProcess(machineId, sqmId, devDeviceId)\"\n    CodeApp-\u003e\u003eCodeApp: \"initServices(appInstantiationService)\"\n    CodeApp-\u003e\u003eCodeApp: \"setupProtocolUrlHandlers()\"\n    CodeApp-\u003e\u003eCodeApp: \"setupManagedRemoteResourceUrlHandler()\"\n    CodeApp-\u003e\u003eWindowsMainService: \"openFirstWindow(accessor, initialProtocolUrls)\"\n    WindowsMainService-\u003e\u003eWindowsMainService: \"Create CodeWindow renderer process\"\n```\n\nSources:\n- [src/vs/code/electron-main/main.ts:85-151]()\n- [src/vs/code/electron-main/app.ts:526-624]()\n- [src/vs/code/electron-main/main.ts:152-236]()\n\n## Environment Setup and Configuration\n\nEnvironment setup is a critical part of the startup process, handled by various environment services depending on the platform.\n\n### Environment Service Hierarchy\n\n**Environment Service Class Structure and Implementations**\n\n```mermaid\nclassDiagram\n    class IEnvironmentService {\n        +stateResource: URI\n        +userRoamingDataHome: URI\n        +logsHome: URI\n        +isBuilt: boolean\n        +verbose: boolean\n        +disableTelemetry: boolean\n    }\n    \n    class INativeEnvironmentService {\n        +args: NativeParsedArgs\n        +appRoot: string\n        +userHome: URI\n        +extensionsPath: string\n        +userDataPath: string\n        +machineSettingsResource: URI\n    }\n    \n    class IWorkbenchEnvironmentService {\n        +remoteAuthority?: string\n        +filesToOpenOrCreate?: IPath[]\n        +isExtensionDevelopment: boolean\n        +extensionDevelopmentLocationURI?: URI[]\n        +logExtensionHostCommunication: boolean\n    }\n    \n    class IBrowserWorkbenchEnvironmentService {\n        +options?: IWorkbenchConstructionOptions\n        +expectsResolverExtension: boolean\n    }\n    \n    class NativeEnvironmentService {\n        +constructor(args: NativeParsedArgs, productService: IProductService)\n        +getUserDataPath(): string\n    }\n    \n    class BrowserWorkbenchEnvironmentService {\n        +constructor(workspaceId: string, logsHome: URI, options: IWorkbenchConstructionOptions, productService: IProductService)\n        +resolveExtensionHostDebugEnvironment(): IExtensionHostDebugEnvironment\n        +get webviewExternalEndpoint(): string\n    }\n    \n    IEnvironmentService \u003c|-- INativeEnvironmentService\n    IEnvironmentService \u003c|-- IWorkbenchEnvironmentService\n    IWorkbenchEnvironmentService \u003c|-- IBrowserWorkbenchEnvironmentService\n    INativeEnvironmentService \u003c|-- NativeEnvironmentService\n    IBrowserWorkbenchEnvironmentService \u003c|-- BrowserWorkbenchEnvironmentService\n```\n\nSources:\n- [src/vs/platform/environment/common/environment.ts:35-159]()\n- [src/vs/workbench/services/environment/common/environmentService.ts:11-50]()\n- [src/vs/workbench/services/environment/browser/environmentService.ts:23-412]()\n- [src/vs/platform/environment/node/environmentService.ts:13-31]()\n\n### Command Line Argument Processing\n\n**Argument Parsing Pipeline with Specific Functions**\n\nCommand line arguments are processed through a structured system using the `parseArgs` function and `OPTIONS` definitions:\n\n```mermaid\nflowchart TD\n    RawArgs[\"string[] argv\"]\n    ParseHelper[\"parseMainProcessArgv()\u003cbr/\u003e(src/vs/platform/environment/node/argvHelper.ts)\"]\n    ParseArgs[\"parseArgs\u003cT\u003e()\u003cbr/\u003e(src/vs/platform/environment/node/argv.ts:240)\"]\n    OptionsConfig[\"OPTIONS: OptionDescriptions\u003cNativeParsedArgs\u003e\u003cbr/\u003e(src/vs/platform/environment/node/argv.ts:49)\"]\n    \n    NativeParsedArgs[\"NativeParsedArgs\u003cbr/\u003e(src/vs/platform/environment/common/argv.ts:15)\"]\n    ErrorReporter[\"ErrorReporter\u003cbr/\u003eonUnknownOption, onMultipleValues\"]\n    \n    EnvironmentMainService[\"new EnvironmentMainService(args, productService)\u003cbr/\u003e(src/vs/platform/environment/electron-main/environmentMainService.ts)\"]\n    \n    RawArgs --\u003e ParseHelper\n    ParseHelper --\u003e ParseArgs\n    OptionsConfig --\u003e ParseArgs\n    ParseArgs --\u003e NativeParsedArgs\n    ParseArgs --\u003e ErrorReporter\n    NativeParsedArgs --\u003e EnvironmentMainService\n    \n    subgraph \"Key Options\"\n        ExtensionDev[\"extensionDevelopmentPath: string[]\"]\n        UserDataDir[\"user-data-dir: string\"]\n        LogLevel[\"log: string[]\"]\n        InspectExt[\"inspect-extensions: string\"]\n        DisableExt[\"disable-extensions: boolean\"]\n    end\n    \n    OptionsConfig --\u003e ExtensionDev\n    OptionsConfig --\u003e UserDataDir\n    OptionsConfig --\u003e LogLevel\n    OptionsConfig --\u003e InspectExt\n    OptionsConfig --\u003e DisableExt\n```\n\nSources:\n- [src/vs/platform/environment/node/argv.ts:240-362]()\n- [src/vs/platform/environment/common/argv.ts:15-158]()\n- [src/vs/platform/environment/node/argvHelper.ts:12-70]()\n- [src/vs/platform/environment/electron-main/environmentMainService.ts:43-87]()\n\n## Process Architecture Components\n\n### Core Process Structure\n\n**Multi-Process Architecture with Specific Service Classes**\n\n```mermaid\ngraph TD\n    subgraph MainProcess[\"Main Process (Node.js + Electron)\"]\n        CodeApplication[\"CodeApplication\u003cbr/\u003e(src/vs/code/electron-main/app.ts)\"]\n        WindowsMainService[\"WindowsMainService\u003cbr/\u003e(IWindowsMainService)\"]\n        SharedProcessService[\"SharedProcessService\u003cbr/\u003e(ISharedProcessService)\"] \n        LifecycleMainService[\"LifecycleMainService\u003cbr/\u003e(ILifecycleMainService)\"]\n        NativeHostMainService[\"NativeHostMainService\u003cbr/\u003e(INativeHostMainService)\"]\n        ProtocolMainService[\"ProtocolMainService\u003cbr/\u003e(IProtocolMainService)\"]\n    end\n    \n    subgraph RendererProcess[\"Renderer Process (Chromium)\"]\n        Workbench[\"Workbench\u003cbr/\u003e(src/vs/workbench/browser/workbench.ts)\"]\n        EditorService[\"EditorService\u003cbr/\u003e(IEditorService)\"]\n        TerminalService[\"TerminalService\u003cbr/\u003e(ITerminalService)\"]\n        ViewsService[\"ViewsService\u003cbr/\u003e(IViewsService)\"]\n        ActivityService[\"ActivityService\u003cbr/\u003e(IActivityService)\"]\n        StatusbarService[\"StatusbarService\u003cbr/\u003e(IStatusbarService)\"]\n    end\n    \n    subgraph ExtensionHost[\"Extension Host (Node.js)\"]\n        ExtensionHostStarter[\"ExtensionHostStarter\u003cbr/\u003e(IExtensionHostStarter)\"]\n        ExtHostLanguageFeatures[\"ExtHostLanguageFeatures\u003cbr/\u003e(extHostLanguageFeatures.ts)\"]\n        ExtHostCommands[\"ExtHostCommands\u003cbr/\u003e(extHostCommands.ts)\"]\n    end\n    \n    subgraph SharedProcess[\"Shared Process (Node.js Utility)\"]\n        ExtensionManagementService[\"ExtensionManagementService\u003cbr/\u003e(IExtensionManagementService)\"]\n        ExtensionGalleryService[\"ExtensionGalleryService\u003cbr/\u003e(IExtensionGalleryService)\"]\n        SearchService[\"SearchService\u003cbr/\u003e(ISearchService)\"]\n    end\n    \n    CodeApplication --\u003e WindowsMainService\n    CodeApplication --\u003e SharedProcessService\n    CodeApplication --\u003e LifecycleMainService\n    CodeApplication --\u003e NativeHostMainService\n    \n    WindowsMainService --\u003e Workbench\n    Workbench --\u003e EditorService\n    Workbench --\u003e TerminalService\n    Workbench --\u003e ViewsService\n    \n    SharedProcessService --\u003e ExtensionManagementService\n    SharedProcessService --\u003e SearchService\n    \n    Workbench \u003c--\u003e|\"ElectronIPCServer\"| ExtensionHostStarter\n    ExtensionHostStarter --\u003e ExtHostLanguageFeatures\n    ExtensionHostStarter --\u003e ExtHostCommands\n```\n\nSources:\n- [src/vs/code/electron-main/app.ts:130-159]()\n- [src/vs/workbench/workbench.common.main.ts:131-176]()\n- [src/vs/workbench/browser/web.main.ts:254-434]()\n\n## Main Process\n\nThe main process serves as the entry point and coordinator for the entire VS Code application. It's implemented primarily in the `CodeApplication` class and manages the application lifecycle.\n\n### Service Initialization\n\n**Main Process Service Creation Order**\n\nThe main process initializes services in a specific order during startup in `CodeMain.createServices()`:\n\n```mermaid\nflowchart TD\n    ProductService[\"IProductService\u003cbr/\u003e{ ...product }\"]\n    EnvironmentMainService[\"IEnvironmentMainService\u003cbr/\u003enew EnvironmentMainService()\"]\n    LoggerMainService[\"ILoggerMainService\u003cbr/\u003enew LoggerMainService()\"]\n    FileService[\"IFileService\u003cbr/\u003enew FileService()\"]\n    DiskFileSystemProvider[\"DiskFileSystemProvider\u003cbr/\u003eregisterProvider(Schemas.file)\"]\n    UriIdentityService[\"IUriIdentityService\u003cbr/\u003enew UriIdentityService()\"]\n    StateService[\"IStateService\u003cbr/\u003enew StateService()\"]\n    UserDataProfilesMainService[\"IUserDataProfilesMainService\u003cbr/\u003enew UserDataProfilesMainService()\"]\n    PolicyService[\"IPolicyService\u003cbr/\u003eNativePolicyService/FilePolicyService\"]\n    ConfigurationService[\"IConfigurationService\u003cbr/\u003enew ConfigurationService()\"]\n    \n    ProductService --\u003e EnvironmentMainService\n    EnvironmentMainService --\u003e LoggerMainService\n    LoggerMainService --\u003e FileService\n    FileService --\u003e DiskFileSystemProvider\n    FileService --\u003e UriIdentityService\n    UriIdentityService --\u003e StateService\n    StateService --\u003e UserDataProfilesMainService\n    PolicyService --\u003e ConfigurationService\n    UserDataProfilesMainService --\u003e ConfigurationService\n```\n\nSources:\n- [src/vs/code/electron-main/main.ts:153-236]()\n\n### Core Responsibilities\n\n| Component | Class | Key Methods | Purpose |\n|-----------|-------|-------------|---------|\n| Application Coordinator | `CodeApplication` | `startup()`, `initServices()` | Overall application lifecycle |\n| Window Management | `IWindowsMainService` | `open()`, `openEmptyWindow()` | Window creation and management |\n| Lifecycle Management | `ILifecycleMainService` | `phase`, `onWillShutdown` | Application state transitions |\n| Menu Management | `IMenubarMainService` | `updateMenubar()` | Native menu handling |\n| Native Integration | `INativeHostMainService` | `openExternal()`, `showMessageBox()` | OS-specific functionality |\n| Process Management | `SharedProcessService` | `whenReady()` | Shared process coordination |\n\n### Detailed Startup Implementation\n\n**CodeApplication.startup() Method Execution Flow**\n\nThe `CodeApplication.startup()` method follows this sequence:\n\n```mermaid\nsequenceDiagram\n    participant App as \"CodeApplication\"\n    participant SharedProcess as \"SharedProcess\" \n    participant InstantiationService as \"appInstantiationService\"\n    participant ElectronIPCServer as \"mainProcessElectronServer\"\n    participant WindowsMainService as \"IWindowsMainService\"\n    participant LifecycleMainService as \"ILifecycleMainService\"\n    \n    App-\u003e\u003eApp: \"configureSession()\"\n    App-\u003e\u003eApp: \"registerListeners()\"\n    Note over App: \"Resolve machineId, sqmId, devDeviceId\"\n    App-\u003e\u003eSharedProcess: \"setupSharedProcess(machineId, sqmId, devDeviceId)\"\n    App-\u003e\u003eInstantiationService: \"initServices(machineId, sqmId, devDeviceId, sharedProcessReady)\"\n    App-\u003e\u003eInstantiationService: \"new ErrorTelemetry()\"\n    App-\u003e\u003eInstantiationService: \"UserDataProfilesHandler\"\n    App-\u003e\u003eElectronIPCServer: \"initChannels(accessor, mainProcessElectronServer, sharedProcessClient)\"\n    App-\u003e\u003eApp: \"setupProtocolUrlHandlers(accessor, mainProcessElectronServer)\"\n    App-\u003e\u003eApp: \"setupManagedRemoteResourceUrlHandler(mainProcessElectronServer)\"\n    App-\u003e\u003eLifecycleMainService: \"phase = LifecycleMainPhase.Ready\"\n    App-\u003e\u003eWindowsMainService: \"openFirstWindow(accessor, initialProtocolUrls)\"\n    App-\u003e\u003eLifecycleMainService: \"phase = LifecycleMainPhase.AfterWindowOpen\"\n    App-\u003e\u003eApp: \"afterWindowOpen()\"\n    App-\u003e\u003eLifecycleMainService: \"phase = LifecycleMainPhase.Eventually\"\n```\n\nSources:\n- [src/vs/code/electron-main/app.ts:526-624]()\n\n## Renderer Process\n\nEach VS Code window runs in its own renderer process, hosting the workbench UI and handling user interactions. The initialization differs between desktop and web environments.\n\n### Desktop Renderer Initialization\n\n**DesktopMain Service Creation and Workbench Startup**\n\nDesktop renderer processes start through the `DesktopMain` class:\n\n```mermaid\nsequenceDiagram\n    participant CodeWindow as \"CodeWindow\"\n    participant DesktopMain as \"DesktopMain\" \n    participant ServiceCollection as \"ServiceCollection\"\n    participant Workbench as \"Workbench\"\n    participant InstantiationService as \"InstantiationService\"\n    \n    CodeWindow-\u003e\u003eDesktopMain: \"main(configuration: INativeWindowConfiguration)\"\n    DesktopMain-\u003e\u003eDesktopMain: \"init()\"\n    DesktopMain-\u003e\u003eDesktopMain: \"reviveUris(configuration)\"\n    DesktopMain-\u003e\u003eServiceCollection: \"createServices()\"\n    Note over ServiceCollection: \"NativeWorkbenchEnvironmentService, FileService, RemoteAgentService, ConfigurationService, StorageService\"\n    DesktopMain-\u003e\u003eWorkbench: \"new Workbench(domElement, services.serviceCollection, logService)\"\n    DesktopMain-\u003e\u003eWorkbench: \"startup()\"\n    Workbench-\u003e\u003eInstantiationService: \"createInstance()\"\n    InstantiationService-\u003e\u003eInstantiationService: \"Initialize workbench parts\"\n    Note over InstantiationService: \"Creates NativeWindow, registers listeners\"\n```\n\nSources:\n- [src/vs/workbench/electron-browser/desktop.main.ts:67-164]()\n\n### Web Renderer Initialization\n\n**BrowserMain Service Initialization and Web Workbench Creation**\n\nWeb renderer processes start through the `BrowserMain` class:\n\n```mermaid\nsequenceDiagram\n    participant Browser as \"Browser\"\n    participant BrowserMain as \"BrowserMain\"\n    participant ServiceCollection as \"ServiceCollection\" \n    participant Workbench as \"Workbench\"\n    participant DOMContentLoaded as \"domContentLoaded()\"\n    \n    Browser-\u003e\u003eBrowserMain: \"open(): Promise\u003cIWorkbench\u003e\"\n    BrowserMain-\u003e\u003eServiceCollection: \"initServices()\"\n    Note over ServiceCollection: \"BrowserWorkbenchEnvironmentService, FileService, RemoteAuthorityResolverService, WorkspaceService, BrowserStorageService\"\n    BrowserMain-\u003e\u003eDOMContentLoaded: \"Promise.all([initServices(), domContentLoaded()])\"\n    BrowserMain-\u003e\u003eWorkbench: \"new Workbench(domElement, undefined, services.serviceCollection, logService)\"\n    BrowserMain-\u003e\u003eWorkbench: \"startup()\"\n    Workbench-\u003e\u003eWorkbench: \"instantiationService.createInstance(BrowserWindow)\"\n    Note over Workbench: \"Returns IWorkbench API facade with commands, env, logger, window, workspace, shutdown\"\n```\n\nSources:\n- [src/vs/workbench/browser/web.main.ts:119-245]()\n\n### Workbench Service Architecture\n\n**Service Registration via registerSingleton() Pattern**\n\nThe workbench uses a dependency injection system with service registration in `workbench.common.main.ts`:\n\n| Service Interface | Implementation | Registration Call | InstantiationType |\n|------------------|----------------|------------------|------------------|\n| `IContextViewService` | `ContextViewService` | `registerSingleton(IContextViewService, ContextViewService, InstantiationType.Delayed)` | Delayed |\n| `IListService` | `ListService` | `registerSingleton(IListService, ListService, InstantiationType.Delayed)` | Delayed |\n| `IEditorWorkerService` | `WorkbenchEditorWorkerService` | `registerSingleton(IEditorWorkerService, WorkbenchEditorWorkerService, InstantiationType.Eager)` | Eager |\n| `IMarkerDecorationsService` | `MarkerDecorationsService` | `registerSingleton(IMarkerDecorationsService, MarkerDecorationsService, InstantiationType.Delayed)` | Delayed |\n| `IMarkerService` | `MarkerService` | `registerSingleton(IMarkerService, MarkerService, InstantiationType.Delayed)` | Delayed |\n| `IContextKeyService` | `ContextKeyService` | `registerSingleton(IContextKeyService, ContextKeyService, InstantiationType.Delayed)` | Delayed |\n| `IOpenerService` | `OpenerService` | `registerSingleton(IOpenerService, OpenerService, InstantiationType.Delayed)` | Delayed |\n\nSources:\n- [src/vs/workbench/workbench.common.main.ts:131-176]()\n\n### Window Configuration Structure\n\n```mermaid\nclassDiagram\n    class INativeWindowConfiguration {\n        +windowId: number\n        +sessionId: string\n        +logLevel?: LogLevel\n        +workspace?: IWorkspaceIdentifier\n        +userEnv: IProcessEnvironment\n    }\n    \n    class IWorkbenchConstructionOptions {\n        +remoteAuthority?: string\n        +workspaceProvider?: IWorkspaceProvider\n        +productConfiguration?: IProductConfiguration\n        +enableWorkspaceTrust?: boolean\n    }\n    \n    class BrowserWorkbenchEnvironmentService {\n        +constructor(workspaceId, logsHome, options, productService)\n        +remoteAuthority?: string\n        +expectsResolverExtension: boolean\n    }\n    \n    INativeWindowConfiguration --\u003e IWorkbenchConstructionOptions\n    IWorkbenchConstructionOptions --\u003e BrowserWorkbenchEnvironmentService\n```\n\nSources:\n- [src/vs/workbench/electron-sandbox/desktop.main.ts:68-164]()\n- [src/vs/workbench/browser/web.main.ts:119-245]()\n- [src/vs/workbench/workbench.common.main.ts:131-176]()\n- [src/vs/workbench/services/environment/browser/environmentService.ts:42-275]()\n\n## Extension Host Process\n\nThe extension host process provides an isolated runtime environment for extensions, preventing them from affecting the main UI stability. Extension startup is coordinated through the `ExtensionHostStarter` service.\n\n### Extension Host Startup Process\n\n```mermaid\nsequenceDiagram\n    participant Workbench as \"Workbench\"\n    participant ExtHostStarter as \"ExtensionHostStarter\"\n    participant ExtHostProcess as \"Extension Host Process\"\n    participant ExtHostMain as \"ExtHost Main Thread\"\n    participant Extensions as \"Extension Code\"\n    \n    Workbench-\u003e\u003eExtHostStarter: \"createExtensionHost()\"\n    ExtHostStarter-\u003e\u003eExtHostProcess: \"spawn Node.js process\"\n    ExtHostProcess-\u003e\u003eExtHostMain: \"initialize extension host\"\n    ExtHostMain-\u003e\u003eExtHostMain: \"setup Extension API\"\n    ExtHostMain-\u003e\u003eWorkbench: \"ready for extensions\"\n    Workbench-\u003e\u003eExtHostMain: \"activate extensions\"\n    ExtHostMain-\u003e\u003eExtensions: \"activate(context)\"\n    Extensions-\u003e\u003eExtHostMain: \"register API providers\"\n```\n\n### Extension Host Communication Architecture\n\nThe extension host uses a bidirectional RPC protocol for communication:\n\n```mermaid\nflowchart TD\n    MainThread[\"Main Thread\u003cbr/\u003e(Renderer Process)\"]\n    ExtHostThread[\"Extension Host Thread\u003cbr/\u003e(Node.js Process)\"]\n    \n    subgraph \"Main Thread APIs\"\n        MainThreadCommands[\"MainThreadCommands\"]\n        MainThreadEditors[\"MainThreadEditors\"] \n        MainThreadTerminal[\"MainThreadTerminal\"]\n        MainThreadLanguages[\"MainThreadLanguages\"]\n    end\n    \n    subgraph \"Extension Host APIs\"\n        ExtHostCommands[\"ExtHostCommands\"]\n        ExtHostEditors[\"ExtHostEditors\"]\n        ExtHostTerminal[\"ExtHostTerminal\"] \n        ExtHostLanguages[\"ExtHostLanguages\"]\n    end\n    \n    subgraph \"Extensions\"\n        Extension1[\"Extension A\"]\n        Extension2[\"Extension B\"]\n        Extension3[\"Extension C\"]\n    end\n    \n    MainThread \u003c--\u003e|\"MessagePort IPC\"| ExtHostThread\n    \n    MainThreadCommands \u003c--\u003e ExtHostCommands\n    MainThreadEditors \u003c--\u003e ExtHostEditors\n    MainThreadTerminal \u003c--\u003e ExtHostTerminal\n    MainThreadLanguages \u003c--\u003e ExtHostLanguages\n    \n    Extension1 --\u003e ExtHostCommands\n    Extension2 --\u003e ExtHostEditors\n    Extension3 --\u003e ExtHostLanguages\n```\n\n### Extension Host Debug Configuration\n\nExtension debugging is configured through environment parameters:\n\n| Parameter | Purpose | Service |\n|-----------|---------|---------|\n| `debugExtensionHost` | Debug configuration object | `IExtensionHostDebugParams` |\n| `isExtensionDevelopment` | Development mode flag | `IEnvironmentService` |\n| `extensionDevelopmentLocationURI` | Extension source paths | Environment configuration |\n| `extensionTestsLocationURI` | Test runner location | Environment configuration |\n\nSources:\n- [src/vs/platform/extensions/electron-main/extensionHostStarter.ts:43-44]()\n- [src/vs/workbench/services/environment/browser/environmentService.ts:147-200]()\n- [src/vs/platform/environment/common/environment.ts:70-77]()\n\n## Shared Process\n\nThe shared process handles resource-intensive operations that are shared across multiple windows. It's implemented as a utility process spawned by the main process.\n\n### Shared Process Service Implementation\n\n```mermaid\nclassDiagram\n    class ISharedProcessService {\n        +whenReady(): Promise\n        +getChannel(channelName): IChannel\n        +registerChannel(channelName, channel): void\n    }\n    \n    class SharedProcessService {\n        -sharedProcess: SharedProcess\n        +constructor(windowId, logService, lifecycleService)\n        +whenReady(): Promise\n        +getChannel(channelName): IChannel\n    }\n    \n    class SharedProcess {\n        -utilityProcess: UtilityProcess\n        +spawn(): Promise\n        +whenReady(): Promise\n        +dispose(): void\n    }\n    \n    ISharedProcessService \u003c|-- SharedProcessService\n    SharedProcessService --\u003e SharedProcess\n```\n\n### Shared Process Services Architecture\n\nThe shared process hosts several key services that are expensive to duplicate per window:\n\n| Service | Interface | Purpose |\n|---------|-----------|---------|\n| Extension Management | `IExtensionManagementService` | Extension installation, updates, and metadata |\n| Extension Gallery | `IExtensionGalleryService` | Marketplace API communication |\n| Search Service | `ISearchService` | File and text search indexing |\n| Telemetry Service | `ITelemetryService` | Usage analytics and crash reporting |\n| Storage Service | `IStorageService` | Persistent application data |\n| Request Service | `IRequestService` | HTTP request handling |\n\n### Shared Process Initialization Flow\n\n```mermaid\nsequenceDiagram\n    participant Main as \"Main Process\"\n    participant SharedProcessService as \"SharedProcessService\"\n    participant SharedProcess as \"SharedProcess\"\n    participant UtilityProcess as \"UtilityProcess\"\n    participant Services as \"Shared Services\"\n    \n    Main-\u003e\u003eSharedProcessService: \"setupSharedProcess()\"\n    SharedProcessService-\u003e\u003eSharedProcess: \"new SharedProcess()\"\n    SharedProcess-\u003e\u003eUtilityProcess: \"spawn utility process\"\n    UtilityProcess-\u003e\u003eServices: \"initialize services\"\n    Services-\u003e\u003eSharedProcess: \"services ready\"\n    SharedProcess-\u003e\u003eSharedProcessService: \"ready promise resolves\"\n    SharedProcessService-\u003e\u003eMain: \"shared process available\"\n```\n\n### Channel-Based Communication\n\nThe shared process exposes services through named IPC channels:\n\n```mermaid\nflowchart LR\n    subgraph \"Renderer Process\"\n        RendererService[\"Service Consumer\"]\n        ChannelClient[\"Channel Client\"]\n    end\n    \n    subgraph \"Shared Process\"\n        ChannelServer[\"Channel Server\"]\n        SharedService[\"Actual Service Implementation\"]\n    end\n    \n    RendererService --\u003e ChannelClient\n    ChannelClient \u003c--\u003e|\"IPC Channel\u003cbr/\u003e(e.g., 'extensions')\"| ChannelServer\n    ChannelServer --\u003e SharedService\n```\n\nSources:\n- [src/vs/platform/sharedProcess/electron-main/sharedProcess.ts:24-193]()\n- [src/vs/code/electron-main/app.ts:576-578]()\n- [src/vs/workbench/electron-sandbox/desktop.main.ts:24-26]()\n\n## Inter-Process Communication\n\nVS Code uses several IPC mechanisms to enable communication between its different processes.\n\n### IPC Channels\n\n1. **Electron IPC**: Used for communication between the main process and renderer processes\n2. **Node.js IPC**: Used for communication with the extension host and shared process\n3. **Message Ports**: Used for high-performance communication between processes\n\n### Main Process as Coordinator\n\nThe main process acts as a coordinator for IPC, setting up channels and routing messages between processes.\n\n```mermaid\ngraph TD\n    Main[\"Main Process\u003cbr\u003e(IPC Server)\"]\n    Renderer[\"Renderer Process\u003cbr\u003e(IPC Client)\"]\n    ExtHost[\"Extension Host\u003cbr\u003e(IPC Client)\"]\n    Shared[\"Shared Process\u003cbr\u003e(IPC Client)\"]\n    \n    Main \u003c--\u003e|\"Electron IPC\"| Renderer\n    Main \u003c--\u003e|\"Node.js IPC\"| ExtHost\n    Main \u003c--\u003e|\"Node.js IPC\"| Shared\n    Renderer \u003c-.-\u003e|\"Message Ports\"| ExtHost\n    Renderer \u003c-.-\u003e|\"Message Ports\"| Shared\n```\n\n### Service Architecture\n\nVS Code uses a service-oriented architecture where services are exposed through IPC channels. This allows services to be consumed across process boundaries.\n\nSources:\n- [src/vs/code/electron-main/app.ts:551-561]()\n- [src/vs/code/electron-main/app.ts:588-594]()\n- [src/vs/platform/sharedProcess/electron-main/sharedProcess.ts:51-92]()\n\n## Window Management\n\nWindow management is a core responsibility of the main process, handled primarily by the `WindowsMainService`.\n\n### Window Creation\n\nWindows are created through the `WindowsMainService`, which manages the lifecycle of all windows in the application.\n\n```mermaid\nsequenceDiagram\n    participant App as CodeApplication\n    participant WindowsService as WindowsMainService\n    participant Window as CodeWindow\n    \n    App-\u003e\u003eWindowsService: openFirstWindow()\n    WindowsService-\u003e\u003eWindowsService: open()\n    WindowsService-\u003e\u003eWindowsService: doOpen()\n    WindowsService-\u003e\u003eWindow: openInBrowserWindow()\n    Window-\u003e\u003eWindow: load()\n    Window--\u003e\u003eWindowsService: window ready\n    WindowsService--\u003e\u003eApp: windows opened\n```\n\n### Window States\n\nWindows go through several states during their lifecycle:\n\n1. **Creation**: Window is created but not yet loaded\n2. **Loading**: Window is loading the workbench\n3. **Ready**: Window is fully loaded and ready for user interaction\n4. **Closing**: Window is in the process of closing\n\n### Multi-Window Support\n\nVS Code supports multiple windows, each with its own renderer process. The `WindowsMainService` keeps track of all open windows and manages focus, z-order, and window state.\n\nSources:\n- [src/vs/platform/windows/electron-main/windowsMainService.ts:183-657]()\n- [src/vs/platform/windows/electron-main/windows.ts:58-237]()\n- [src/vs/platform/window/electron-main/window.ts:45-83]()\n\n## Process Lifecycle Management\n\nVS Code carefully manages the lifecycle of all its processes to ensure proper startup, shutdown, and resource management.\n\n### Application Lifecycle\n\nThe `LifecycleMainService` manages the overall application lifecycle, including:\n\n1. **Startup**: Initializing services and opening windows\n2. **Running**: Managing the running application\n3. **Shutdown**: Gracefully shutting down all processes\n\n### Lifecycle Phases\n\nThe application goes through several phases during its lifecycle:\n\n```mermaid\nstateDiagram-v2\n    [*] --\u003e Starting\n    Starting --\u003e Ready: Services initialized\n    Ready --\u003e AfterWindowOpen: First window opened\n    AfterWindowOpen --\u003e Eventually: After delay\n    Eventually --\u003e [*]: Shutdown\n```\n\n1. **Starting**: Application is initializing\n2. **Ready**: Core services are initialized\n3. **AfterWindowOpen**: First window is opened\n4. **Eventually**: Application is fully initialized\n5. **Shutdown**: Application is shutting down\n\n### Process Coordination\n\nDuring shutdown, processes are terminated in a coordinated manner:\n\n1. Renderer processes are closed first\n2. Extension host processes are terminated\n3. Shared process is terminated\n4. Main process exits\n\nSources:\n- [src/vs/code/electron-main/app.ts:596-620]()\n- [src/vs/code/electron-main/app.ts:374-386]()\n- [src/vs/platform/windows/electron-main/windowImpl.ts:1000-1100]()\n\n## Security Considerations\n\nVS Code's multi-process architecture provides security benefits by isolating different components.\n\n### Process Isolation\n\nBy running extensions in a separate process, VS Code prevents extensions from directly accessing the UI or other sensitive parts of the application.\n\n### Content Security\n\nThe main process implements several security measures:\n\n1. **Permission handling**: Controls what permissions are granted to web content\n2. **Content filtering**: Blocks potentially dangerous content\n3. **Protocol handling**: Securely handles custom protocols\n\n### Sandbox\n\nVS Code uses Electron's sandbox feature to restrict what renderer processes can do, providing an additional layer of security.\n\nSources:\n- [src/vs/code/electron-main/app.ts:161-205]()\n- [src/vs/code/electron-main/app.ts:267-320]()\n- [src/vs/code/electron-main/app.ts:397-442]()\n\n## Command Line Integration\n\nVS Code supports being launched from the command line with various arguments. This is handled through a special CLI process.\n\n### CLI Process\n\nWhen VS Code is launched from the command line, a CLI process is created that communicates with the main process to handle the command.\n\n```mermaid\nsequenceDiagram\n    participant CLI as CLI Process\n    participant Main as Main Process\n    participant Windows as WindowsMainService\n    \n    CLI-\u003e\u003eCLI: parse arguments\n    CLI-\u003e\u003eMain: connect to running instance\n    Main-\u003e\u003eWindows: open(args)\n    Windows-\u003e\u003eWindows: handle command\n    Windows--\u003e\u003eMain: windows opened\n    Main--\u003e\u003eCLI: command handled\n    CLI-\u003e\u003eCLI: exit\n```\n\n### Single Instance\n\nVS Code ensures that only one instance of the application is running at a time. When a new instance is launched, it communicates with the existing instance and then exits.\n\nSources:\n- [src/vs/code/node/cliProcessMain.ts:72-342]()\n- [src/vs/code/electron-main/main.ts:291-419]()\n- [src/vs/platform/launch/electron-main/launchMainService.ts:39-93]()\n\n## Auxiliary Windows\n\nVS Code supports auxiliary windows (like dialog windows) that are managed separately from the main application windows.\n\n### Auxiliary Window Management\n\nAuxiliary windows are managed by the `AuxiliaryWindowsMainService`, which handles their creation, focus, and lifecycle.\n\n```mermaid\nclassDiagram\n    class IAuxiliaryWindowsMainService {\n        +createWindow()\n        +registerWindow()\n        +getWindowByWebContents()\n        +getWindows()\n    }\n    \n    class AuxiliaryWindowsMainService {\n        -windows: Map\n        +createWindow()\n        +registerWindow()\n    }\n    \n    class IAuxiliaryWindow {\n        +readonly parentId: number\n        +readonly id: number\n    }\n    \n    class AuxiliaryWindow {\n        +readonly id: number\n        +parentId: number\n    }\n    \n    IAuxiliaryWindowsMainService \u003c|-- AuxiliaryWindowsMainService\n    IAuxiliaryWindow \u003c|-- AuxiliaryWindow\n    AuxiliaryWindowsMainService --\u003e AuxiliaryWindow\n```\n\nSources:\n- [src/vs/platform/auxiliaryWindow/electron-main/auxiliaryWindow.ts:17-67]()\n- [src/vs/platform/auxiliaryWindow/electron-main/auxiliaryWindowsMainService.ts:18-36]()\n- [src/vs/platform/auxiliaryWindow/electron-main/auxiliaryWindows.ts:13-32]()\n\n## Summary\n\nVS Code's multi-process architecture provides a robust foundation for the application, with clear separation of concerns between processes:\n\n1. **Main Process**: Coordinates the application and manages windows\n2. **Renderer Process**: Handles the UI and user interactions\n3. **Extension Host Process**: Runs extensions in isolation\n4. **Shared Process**: Handles shared operations across windows\n\nThis architecture enables VS Code to be stable, secure, and performant, while providing a rich platform for extensions.\n\n| Process | Main Responsibilities | Key Components |\n|---------|----------------------|----------------|\n| Main Process | Application lifecycle, Window management | CodeApplication, WindowsMainService, LifecycleMainService |\n| Renderer Process | UI rendering, User interaction | Workbench, EditorPart, SidebarPart |\n| Extension Host | Running extensions, API provision | Extension Host, Extension Runtime |\n| Shared Process | Shared operations, Resource management | Extension Management, File Search |\n\nSources:\n- [src/vs/code/electron-main/app.ts:126-130]()\n- [src/vs/platform/windows/electron-main/windowsMainService.ts:183-237]()\n- [src/vs/platform/sharedProcess/electron-main/sharedProcess.ts:24-34]()"])</script>
    <script>self.__next_f.push([1, "16:T3102,"])</script>
    <script>self.__next_f.push([1, "# Build System and Package Management\n\n\u003cdetails\u003e\n\u003csummary\u003eRelevant source files\u003c/summary\u003e\n\nThe following files were used as context for generating this wiki page:\n\n- [.npmrc](.npmrc)\n- [.nvmrc](.nvmrc)\n- [build/.moduleignore](build/.moduleignore)\n- [build/.webignore](build/.webignore)\n- [build/checksums/electron.txt](build/checksums/electron.txt)\n- [build/checksums/nodejs.txt](build/checksums/nodejs.txt)\n- [build/package-lock.json](build/package-lock.json)\n- [build/package.json](build/package.json)\n- [cgmanifest.json](cgmanifest.json)\n- [extensions/vscode-colorize-tests/src/colorizer.test.ts](extensions/vscode-colorize-tests/src/colorizer.test.ts)\n- [package-lock.json](package-lock.json)\n- [package.json](package.json)\n- [remote/.npmrc](remote/.npmrc)\n- [remote/package-lock.json](remote/package-lock.json)\n- [remote/package.json](remote/package.json)\n- [remote/web/package-lock.json](remote/web/package-lock.json)\n- [remote/web/package.json](remote/web/package.json)\n- [src/vs/editor/common/config/editorConfigurationSchema.ts](src/vs/editor/common/config/editorConfigurationSchema.ts)\n- [src/vs/platform/environment/test/node/nativeModules.integrationTest.ts](src/vs/platform/environment/test/node/nativeModules.integrationTest.ts)\n- [test/automation/package.json](test/automation/package.json)\n- [test/integration/browser/package.json](test/integration/browser/package.json)\n- [test/smoke/package.json](test/smoke/package.json)\n\n\u003c/details\u003e\n\n\n\nThis document covers VS Code's build system architecture, package management configuration, and dependency handling across the multi-platform, multi-process application. It explains how the build scripts, NPM packages, and tooling work together to produce the final VS Code distributions.\n\nFor information about application startup and the runtime architecture that the build system produces, see [Application Startup and Process Architecture](#1.1).\n\n## Package Structure Overview\n\nVS Code uses a multi-package architecture with separate `package.json` files for different build targets and runtime environments. The build system coordinates compilation, bundling, and distribution across these packages.\n\n```mermaid\ngraph TB\n    subgraph \"Root Package\"\n        MainPkg[\"package.json\u003cbr/\u003e(Main Application)\"]\n    end\n    \n    subgraph \"Platform Packages\"\n        RemotePkg[\"remote/package.json\u003cbr/\u003e(Remote Server)\"]\n        WebPkg[\"remote/web/package.json\u003cbr/\u003e(Web Client)\"]\n    end\n    \n    subgraph \"Build Packages\"\n        BuildPkg[\"build/package.json\u003cbr/\u003e(Build Tools)\"]\n    end\n    \n    subgraph \"Test Packages\"\n        SmokePkg[\"test/smoke/package.json\"]\n        AutoPkg[\"test/automation/package.json\"]\n        IntegPkg[\"test/integration/browser/package.json\"]\n    end\n    \n    MainPkg --\u003e RemotePkg\n    MainPkg --\u003e WebPkg\n    MainPkg --\u003e BuildPkg\n    MainPkg --\u003e SmokePkg\n    MainPkg --\u003e AutoPkg\n    MainPkg --\u003e IntegPkg\n```\n\n**Sources:** [package.json:1-237](), [remote/package.json:1-49](), [remote/web/package.json:1-25](), [build/package.json:1-70]()\n\n## Main Package Configuration\n\nThe root [`package.json`]() defines the core application metadata and build pipeline. It specifies VS Code as an ES module with Electron as the runtime.\n\n### Application Metadata\n\n| Property | Value | Purpose |\n|----------|--------|---------|\n| `name` | `\"code-oss-dev\"` | Package identifier |\n| `version` | `\"1.102.0\"` | Current version |\n| `main` | `\"./out/main.js\"` | Entry point |\n| `type` | `\"module\"` | ES module format |\n| `private` | `true` | Not published to npm |\n\n### Build Scripts\n\nThe package defines key build scripts that orchestrate the compilation and development workflow:\n\n```mermaid\ngraph LR\n    subgraph \"Development Scripts\"\n        Watch[\"npm run watch\"]\n        WatchClient[\"npm run watch-client\"]\n        WatchExt[\"npm run watch-extensions\"]\n    end\n    \n    subgraph \"Compilation Scripts\"\n        Compile[\"npm run compile\"]\n        CompileWeb[\"npm run compile-web\"]\n        CompileCli[\"npm run compile-cli\"]\n    end\n    \n    subgraph \"Build Scripts\"\n        CompileBuild[\"npm run compile-build\"]\n        MinifyVscode[\"npm run minify-vscode\"]\n        MinifyWeb[\"npm run minify-vscode-reh-web\"]\n    end\n    \n    subgraph \"Gulp Tasks\"\n        GulpCmd[\"node ./node_modules/gulp/bin/gulp.js\"]\n    end\n    \n    Watch --\u003e WatchClient\n    Watch --\u003e WatchExt\n    Compile --\u003e GulpCmd\n    CompileWeb --\u003e GulpCmd\n    CompileBuild --\u003e GulpCmd\n    MinifyVscode --\u003e GulpCmd\n```\n\n**Sources:** [package.json:12-69]()\n\n### Key Build Commands\n\n- `compile`: Runs Gulp-based TypeScript compilation\n- `watch`: Parallel compilation watching for client and extensions\n- `compile-build`: Production build with mangling\n- `minify-vscode`: Creates minified application bundles\n- `valid-layers-check`: Validates architectural layer dependencies\n\n**Sources:** [package.json:20-47]()\n\n## Dependency Management\n\nVS Code manages dependencies across multiple categories with precise version control and platform-specific requirements.\n\n### Production Dependencies\n\nThe application includes both runtime dependencies and native modules:\n\n```mermaid\ngraph TB\n    subgraph \"Core Runtime\"\n        Electron[\"electron@35.5.1\"]\n        NodePty[\"node-pty@1.1.0-beta33\"]\n        Parcel[\"@parcel/watcher@2.5.1\"]\n    end\n    \n    subgraph \"VS Code Packages\"\n        VscodeRipgrep[\"@vscode/ripgrep@1.15.13\"]\n        VscodeSpdlog[\"@vscode/spdlog@0.15.2\"]\n        VscodeDeviceId[\"@vscode/deviceid@0.1.1\"]\n        VscodeProxyAgent[\"@vscode/proxy-agent@0.32.0\"]\n    end\n    \n    subgraph \"Terminal \u0026 XTerm\"\n        XtermCore[\"@xterm/xterm@5.6.0-beta.110\"]\n        XtermClipboard[\"@xterm/addon-clipboard\"]\n        XtermSearch[\"@xterm/addon-search\"]\n        XtermWebgl[\"@xterm/addon-webgl\"]\n    end\n    \n    subgraph \"Language Processing\"\n        VscodeTextmate[\"vscode-textmate@9.2.0\"]\n        VscodeOniguruma[\"vscode-oniguruma@1.7.0\"]\n        TreeSitter[\"@vscode/tree-sitter-wasm@0.1.4\"]\n    end\n```\n\n**Sources:** [package.json:71-115]()\n\n### Development Dependencies\n\nBuild and development tooling includes TypeScript, testing frameworks, and bundling tools:\n\n| Category | Key Dependencies |\n|----------|------------------|\n| **TypeScript** | `typescript@5.9.0-dev`, `ts-loader@9.5.1` |\n| **Build Tools** | `gulp@4.0.0`, `webpack@5.94.0`, `esbuild` (in build package) |\n| **Testing** | `mocha@10.8.2`, `@playwright/test@1.52.0`, `sinon@12.0.1` |\n| **Linting** | `eslint@9.11.1`, `typescript-eslint@8.8.0` |\n\n**Sources:** [package.json:117-219]()\n\n## Build Tools and Compilation\n\nThe build system uses Gulp as the primary task runner with TypeScript compilation and bundling workflows.\n\n### Gulp-Based Build Pipeline\n\n```mermaid\ngraph TB\n    subgraph \"TypeScript Compilation\"\n        TscMain[\"TSC Main Sources\"]\n        TscBuild[\"TSC Build Scripts\"]\n        TscExtensions[\"TSC Extensions\"]\n    end\n    \n    subgraph \"Bundling \u0026 Minification\"\n        Webpack[\"Webpack Bundling\"]\n        Minify[\"Code Minification\"]\n        Sourcemaps[\"Source Map Generation\"]\n    end\n    \n    subgraph \"Asset Processing\"\n        CopyAssets[\"Copy Static Assets\"]\n        ProcessSvg[\"SVG Optimization\"]\n        CompressGzip[\"Gzip Compression\"]\n    end\n    \n    subgraph \"Platform Builds\"\n        ElectronBuild[\"Electron App Build\"]\n        WebBuild[\"Web Client Build\"]\n        RemoteBuild[\"Remote Server Build\"]\n    end\n    \n    TscMain --\u003e Webpack\n    TscBuild --\u003e Minify\n    TscExtensions --\u003e Webpack\n    Webpack --\u003e Sourcemaps\n    Minify --\u003e ElectronBuild\n    CopyAssets --\u003e ElectronBuild\n    ProcessSvg --\u003e WebBuild\n    CompressGzip --\u003e RemoteBuild\n```\n\n**Sources:** [package.json:35](), [build/package.json:61-64]()\n\n### Multi-Platform Configuration\n\nThe build system handles platform-specific requirements through NPM configuration and native module compilation:\n\n#### NPM Configuration\n\nThe `.npmrc` files configure native module compilation for different environments:\n\n| Environment | Target | Runtime |\n|-------------|--------|---------|\n| **Electron** | `35.5.1` | `electron` |\n| **Node.js** | `22.15.1` | `node` |\n| **Build** | Uses `node-gyp` for native compilation |\n\n**Sources:** [.npmrc:1-8](), [remote/.npmrc:1-7]()\n\n#### Native Module Handling\n\nThe build system manages native dependencies through selective inclusion rules:\n\n```mermaid\ngraph LR\n    subgraph \"Native Modules\"\n        NodePty[\"node-pty\"]\n        Spdlog[\"@vscode/spdlog\"]\n        DeviceId[\"@vscode/deviceid\"]\n        WindowsRegistry[\"@vscode/windows-registry\"]\n        ParcelWatcher[\"@parcel/watcher\"]\n    end\n    \n    subgraph \"Module Filtering\"\n        ModuleIgnore[\"build/.moduleignore\"]\n        WebIgnore[\"build/.webignore\"]\n    end\n    \n    subgraph \"Build Outputs\"\n        ElectronOut[\"Electron Native Binaries\"]\n        WebOut[\"Web-Compatible Modules\"]\n    end\n    \n    NodePty --\u003e ModuleIgnore\n    Spdlog --\u003e ModuleIgnore\n    DeviceId --\u003e ModuleIgnore\n    ModuleIgnore --\u003e ElectronOut\n    WebIgnore --\u003e WebOut\n```\n\n**Sources:** [build/.moduleignore:1-189](), [build/.webignore:1-60]()\n\n## Package Variants\n\nVS Code builds multiple package variants from the same codebase to support different deployment scenarios.\n\n### Remote Development Packages\n\n#### Remote Server Package\nThe `remote/package.json` defines dependencies for the VS Code server running in remote environments:\n\n- Excludes Electron-specific dependencies\n- Includes core VS Code functionality\n- Supports terminal and language features\n\n**Sources:** [remote/package.json:5-41]()\n\n#### Web Client Package\nThe `remote/web/package.json` provides the minimal dependency set for browser-based VS Code:\n\n- Web-compatible dependencies only\n- Reduced bundle size\n- No native module dependencies\n\n**Sources:** [remote/web/package.json:5-24]()\n\n### Build Tools Package\n\nThe `build/package.json` contains development and build-time dependencies:\n\n```mermaid\ngraph TB\n    subgraph \"Azure Integration\"\n        AzureAuth[\"@azure/core-auth\"]\n        AzureStorage[\"@azure/storage-blob\"]\n        AzureIdentity[\"@azure/identity\"]\n    end\n    \n    subgraph \"Build Tools\"\n        ElectronGet[\"@electron/get\"]\n        Esbuild[\"esbuild@0.25.0\"]\n        TreeSitter[\"tree-sitter@0.22.4\"]\n    end\n    \n    subgraph \"Packaging Tools\"\n        VscePackage[\"@vscode/vsce\"]\n        ElectronSign[\"electron-osx-sign\"]\n        UniversalBundler[\"vscode-universal-bundler\"]\n    end\n    \n    subgraph \"Development Support\"\n        TypeScript[\"TypeScript Types\"]\n        Workerpool[\"workerpool@6.4.0\"]\n        SourceMap[\"source-map@0.6.1\"]\n    end\n```\n\n**Sources:** [build/package.json:5-69]()\n\n## Dependency Lock and Security\n\n### Lock File Management\n\nVS Code uses `package-lock.json` files to ensure reproducible builds across environments:\n\n- Root package lock manages main application dependencies\n- Separate locks for remote and build packages\n- Version 3 lockfile format for npm 7+ compatibility\n\n**Sources:** [package-lock.json:1-5](), [remote/package-lock.json:1-5]()\n\n### Component Governance\n\nThe `cgmanifest.json` file tracks third-party components and their licenses:\n\n```mermaid\ngraph TB\n    subgraph \"Browser Components\"\n        Chromium[\"Chromium@134.0.6998.205\"]\n        FFmpeg[\"FFmpeg@5.1.git\"]\n    end\n    \n    subgraph \"Runtime Components\"\n        NodeJS[\"Node.js@22.15.1\"]\n        ElectronComp[\"Electron@35.5.1\"]\n    end\n    \n    subgraph \"Build Components\"\n        InnoSetup[\"Inno Setup@6.4.1\"]\n        H264[\"H.264/AVC Video Standard\"]\n    end\n    \n    subgraph \"License Tracking\"\n        CGManifest[\"cgmanifest.json\"]\n    end\n    \n    Chromium --\u003e CGManifest\n    FFmpeg --\u003e CGManifest\n    NodeJS --\u003e CGManifest\n    ElectronComp --\u003e CGManifest\n    InnoSetup --\u003e CGManifest\n    H264 --\u003e CGManifest\n```\n\n**Sources:** [cgmanifest.json:2-537]()\n\n## Development Workflow Integration\n\n### Watch Mode Development\n\nThe build system supports incremental development through watch mode scripts:\n\n- `watch-client`: Monitors main application source changes\n- `watch-extensions`: Monitors built-in extension changes\n- `deemon`: Daemon management for watch processes\n\n### Testing Integration\n\nTest packages maintain their own dependency trees:\n\n| Test Package | Purpose | Key Dependencies |\n|--------------|---------|------------------|\n| `test/smoke` | End-to-end testing | `ncp`, `node-fetch`, `rimraf` |\n| `test/automation` | UI automation driver | `tmp`, `tree-kill`, `vscode-uri` |\n| `test/integration/browser` | Browser integration tests | `rimraf`, `tmp`, `tree-kill` |\n\n**Sources:** [test/smoke/package.json:13-16](), [test/automation/package.json:20-24](), [test/integration/browser/package.json:13-16]()"])</script>
    <script>self.__next_f.push([1, "17:T4eae,"])</script>
    <script>self.__next_f.push([1, "# Core Platform Services\n\n\u003cdetails\u003e\n\u003csummary\u003eRelevant source files\u003c/summary\u003e\n\nThe following files were used as context for generating this wiki page:\n\n- [src/vs/base/browser/ui/list/list.ts](src/vs/base/browser/ui/list/list.ts)\n- [src/vs/base/browser/ui/list/listPaging.ts](src/vs/base/browser/ui/list/listPaging.ts)\n- [src/vs/base/browser/ui/list/listView.ts](src/vs/base/browser/ui/list/listView.ts)\n- [src/vs/base/browser/ui/list/listWidget.ts](src/vs/base/browser/ui/list/listWidget.ts)\n- [src/vs/base/browser/ui/list/splice.ts](src/vs/base/browser/ui/list/splice.ts)\n- [src/vs/base/browser/ui/tree/abstractTree.ts](src/vs/base/browser/ui/tree/abstractTree.ts)\n- [src/vs/base/browser/ui/tree/asyncDataTree.ts](src/vs/base/browser/ui/tree/asyncDataTree.ts)\n- [src/vs/base/browser/ui/tree/compressedObjectTreeModel.ts](src/vs/base/browser/ui/tree/compressedObjectTreeModel.ts)\n- [src/vs/base/browser/ui/tree/dataTree.ts](src/vs/base/browser/ui/tree/dataTree.ts)\n- [src/vs/base/browser/ui/tree/indexTree.ts](src/vs/base/browser/ui/tree/indexTree.ts)\n- [src/vs/base/browser/ui/tree/indexTreeModel.ts](src/vs/base/browser/ui/tree/indexTreeModel.ts)\n- [src/vs/base/browser/ui/tree/objectTree.ts](src/vs/base/browser/ui/tree/objectTree.ts)\n- [src/vs/base/browser/ui/tree/objectTreeModel.ts](src/vs/base/browser/ui/tree/objectTreeModel.ts)\n- [src/vs/base/browser/ui/tree/tree.ts](src/vs/base/browser/ui/tree/tree.ts)\n- [src/vs/base/common/resources.ts](src/vs/base/common/resources.ts)\n- [src/vs/base/test/browser/ui/tree/asyncDataTree.test.ts](src/vs/base/test/browser/ui/tree/asyncDataTree.test.ts)\n- [src/vs/base/test/browser/ui/tree/compressedObjectTreeModel.test.ts](src/vs/base/test/browser/ui/tree/compressedObjectTreeModel.test.ts)\n- [src/vs/base/test/browser/ui/tree/indexTreeModel.test.ts](src/vs/base/test/browser/ui/tree/indexTreeModel.test.ts)\n- [src/vs/base/test/browser/ui/tree/objectTree.test.ts](src/vs/base/test/browser/ui/tree/objectTree.test.ts)\n- [src/vs/base/test/browser/ui/tree/objectTreeModel.test.ts](src/vs/base/test/browser/ui/tree/objectTreeModel.test.ts)\n- [src/vs/base/test/common/resources.test.ts](src/vs/base/test/common/resources.test.ts)\n- [src/vs/platform/configuration/common/configuration.ts](src/vs/platform/configuration/common/configuration.ts)\n- [src/vs/platform/configuration/common/configurationModels.ts](src/vs/platform/configuration/common/configurationModels.ts)\n- [src/vs/platform/configuration/common/configurationService.ts](src/vs/platform/configuration/common/configurationService.ts)\n- [src/vs/platform/configuration/test/common/configurationModels.test.ts](src/vs/platform/configuration/test/common/configurationModels.test.ts)\n- [src/vs/platform/configuration/test/common/configurationRegistry.test.ts](src/vs/platform/configuration/test/common/configurationRegistry.test.ts)\n- [src/vs/platform/configuration/test/common/configurationService.test.ts](src/vs/platform/configuration/test/common/configurationService.test.ts)\n- [src/vs/platform/configuration/test/common/configurations.test.ts](src/vs/platform/configuration/test/common/configurations.test.ts)\n- [src/vs/platform/editor/common/editor.ts](src/vs/platform/editor/common/editor.ts)\n- [src/vs/platform/list/browser/listService.ts](src/vs/platform/list/browser/listService.ts)\n- [src/vs/platform/userData/common/fileUserDataProvider.ts](src/vs/platform/userData/common/fileUserDataProvider.ts)\n- [src/vs/platform/userData/test/browser/fileUserDataProvider.test.ts](src/vs/platform/userData/test/browser/fileUserDataProvider.test.ts)\n- [src/vs/workbench/api/browser/mainThreadConfiguration.ts](src/vs/workbench/api/browser/mainThreadConfiguration.ts)\n- [src/vs/workbench/api/common/extHostConfiguration.ts](src/vs/workbench/api/common/extHostConfiguration.ts)\n- [src/vs/workbench/browser/actions/layoutActions.ts](src/vs/workbench/browser/actions/layoutActions.ts)\n- [src/vs/workbench/browser/actions/listCommands.ts](src/vs/workbench/browser/actions/listCommands.ts)\n- [src/vs/workbench/browser/contextkeys.ts](src/vs/workbench/browser/contextkeys.ts)\n- [src/vs/workbench/browser/dnd.ts](src/vs/workbench/browser/dnd.ts)\n- [src/vs/workbench/browser/layout.ts](src/vs/workbench/browser/layout.ts)\n- [src/vs/workbench/browser/parts/auxiliarybar/auxiliaryBarActions.ts](src/vs/workbench/browser/parts/auxiliarybar/auxiliaryBarActions.ts)\n- [src/vs/workbench/browser/parts/editor/editor.contribution.ts](src/vs/workbench/browser/parts/editor/editor.contribution.ts)\n- [src/vs/workbench/browser/parts/editor/editor.ts](src/vs/workbench/browser/parts/editor/editor.ts)\n- [src/vs/workbench/browser/parts/editor/editorActions.ts](src/vs/workbench/browser/parts/editor/editorActions.ts)\n- [src/vs/workbench/browser/parts/editor/editorCommands.ts](src/vs/workbench/browser/parts/editor/editorCommands.ts)\n- [src/vs/workbench/browser/parts/editor/editorDropTarget.ts](src/vs/workbench/browser/parts/editor/editorDropTarget.ts)\n- [src/vs/workbench/browser/parts/editor/editorGroupView.ts](src/vs/workbench/browser/parts/editor/editorGroupView.ts)\n- [src/vs/workbench/browser/parts/editor/editorGroupWatermark.ts](src/vs/workbench/browser/parts/editor/editorGroupWatermark.ts)\n- [src/vs/workbench/browser/parts/editor/editorPart.ts](src/vs/workbench/browser/parts/editor/editorPart.ts)\n- [src/vs/workbench/browser/parts/editor/media/editorgroupview.css](src/vs/workbench/browser/parts/editor/media/editorgroupview.css)\n- [src/vs/workbench/browser/parts/panel/panelActions.ts](src/vs/workbench/browser/parts/panel/panelActions.ts)\n- [src/vs/workbench/browser/parts/titlebar/titlebarActions.ts](src/vs/workbench/browser/parts/titlebar/titlebarActions.ts)\n- [src/vs/workbench/browser/workbench.contribution.ts](src/vs/workbench/browser/workbench.contribution.ts)\n- [src/vs/workbench/browser/workbench.ts](src/vs/workbench/browser/workbench.ts)\n- [src/vs/workbench/common/contextkeys.ts](src/vs/workbench/common/contextkeys.ts)\n- [src/vs/workbench/common/editor.ts](src/vs/workbench/common/editor.ts)\n- [src/vs/workbench/contrib/telemetry/browser/telemetry.contribution.ts](src/vs/workbench/contrib/telemetry/browser/telemetry.contribution.ts)\n- [src/vs/workbench/services/configuration/browser/configuration.ts](src/vs/workbench/services/configuration/browser/configuration.ts)\n- [src/vs/workbench/services/configuration/browser/configurationService.ts](src/vs/workbench/services/configuration/browser/configurationService.ts)\n- [src/vs/workbench/services/configuration/common/configuration.ts](src/vs/workbench/services/configuration/common/configuration.ts)\n- [src/vs/workbench/services/configuration/common/configurationEditing.ts](src/vs/workbench/services/configuration/common/configurationEditing.ts)\n- [src/vs/workbench/services/configuration/common/configurationModels.ts](src/vs/workbench/services/configuration/common/configurationModels.ts)\n- [src/vs/workbench/services/configuration/common/jsonEditing.ts](src/vs/workbench/services/configuration/common/jsonEditing.ts)\n- [src/vs/workbench/services/configuration/common/jsonEditingService.ts](src/vs/workbench/services/configuration/common/jsonEditingService.ts)\n- [src/vs/workbench/services/configuration/test/browser/configuration.test.ts](src/vs/workbench/services/configuration/test/browser/configuration.test.ts)\n- [src/vs/workbench/services/configuration/test/browser/configurationService.test.ts](src/vs/workbench/services/configuration/test/browser/configurationService.test.ts)\n- [src/vs/workbench/services/configuration/test/common/configurationModels.test.ts](src/vs/workbench/services/configuration/test/common/configurationModels.test.ts)\n- [src/vs/workbench/services/editor/browser/editorService.ts](src/vs/workbench/services/editor/browser/editorService.ts)\n- [src/vs/workbench/services/editor/common/editorGroupsService.ts](src/vs/workbench/services/editor/common/editorGroupsService.ts)\n- [src/vs/workbench/services/editor/common/editorService.ts](src/vs/workbench/services/editor/common/editorService.ts)\n- [src/vs/workbench/services/editor/test/browser/editorGroupsService.test.ts](src/vs/workbench/services/editor/test/browser/editorGroupsService.test.ts)\n- [src/vs/workbench/services/editor/test/browser/editorService.test.ts](src/vs/workbench/services/editor/test/browser/editorService.test.ts)\n- [src/vs/workbench/services/keybinding/test/browser/keybindingEditing.test.ts](src/vs/workbench/services/keybinding/test/browser/keybindingEditing.test.ts)\n- [src/vs/workbench/services/layout/browser/layoutService.ts](src/vs/workbench/services/layout/browser/layoutService.ts)\n- [src/vs/workbench/test/browser/workbenchTestServices.ts](src/vs/workbench/test/browser/workbenchTestServices.ts)\n\n\u003c/details\u003e\n\n\n\nThis document covers the foundational platform services that power the VS Code workbench. These services provide essential infrastructure for configuration management, layout coordination, UI component systems, and service lifecycle management. For information about specific editor functionality, see [Editor System](#4). For details about extension integration, see [Extension System](#4).\n\n## Service Architecture Overview\n\nVS Code's core platform services form a layered architecture where foundational services support higher-level workbench functionality. The service system uses dependency injection to manage service lifecycles and provide clean separation of concerns.\n\n```mermaid\ngraph TB\n    subgraph \"Service Layer\"\n        ConfigSvc[\"IConfigurationService\u003cbr/\u003eConfigurationService\"]\n        LayoutSvc[\"IWorkbenchLayoutService\u003cbr/\u003eLayout\"]\n        ListSvc[\"IListService\u003cbr/\u003eListService\"]\n        InstSvc[\"IInstantiationService\u003cbr/\u003eInstantiationService\"]\n    end\n    \n    subgraph \"UI Infrastructure\"\n        AbstractTree[\"AbstractTree\u003cbr/\u003eTreeRenderer\"]\n        ListWidget[\"List\u003cbr/\u003eListWidget\"] \n        EditorGroups[\"EditorGroupView\u003cbr/\u003eEditorPart\"]\n    end\n    \n    subgraph \"Workbench Parts\"\n        TitleBar[\"TitleBar\"]\n        SideBar[\"SideBar\"]\n        Panel[\"Panel\"]\n        StatusBar[\"StatusBar\"]\n    end\n    \n    ConfigSvc --\u003e LayoutSvc\n    ConfigSvc --\u003e ListSvc\n    InstSvc --\u003e ConfigSvc\n    InstSvc --\u003e LayoutSvc\n    \n    LayoutSvc --\u003e TitleBar\n    LayoutSvc --\u003e SideBar\n    LayoutSvc --\u003e Panel\n    LayoutSvc --\u003e StatusBar\n    \n    ListSvc --\u003e AbstractTree\n    ListSvc --\u003e ListWidget\n    AbstractTree --\u003e EditorGroups\n    ListWidget --\u003e EditorGroups\n```\n\n**Sources:** [src/vs/workbench/browser/layout.ts:305-336](), [src/vs/platform/list/browser/listService.ts:53-106](), [src/vs/workbench/services/configuration/browser/configurationService.ts:1-100]()\n\n## Configuration System\n\nThe configuration system manages all settings, preferences, and workspace-specific configurations in VS Code. It provides a hierarchical configuration model with support for user, workspace, and folder-level settings.\n\n```mermaid\ngraph TB\n    subgraph \"Configuration Architecture\"\n        IConfigSvc[\"IConfigurationService\"]\n        ConfigSvc[\"ConfigurationService\"]\n        ConfigModel[\"ConfigurationModel\"]\n        ConfigCache[\"IConfigurationCache\"]\n    end\n    \n    subgraph \"Configuration Sources\"\n        UserSettings[\"User Settings\u003cbr/\u003esettings.json\"]\n        WorkspaceSettings[\"Workspace Settings\u003cbr/\u003e.vscode/settings.json\"]\n        FolderSettings[\"Folder Settings\u003cbr/\u003eper folder config\"]\n        DefaultSettings[\"Default Settings\u003cbr/\u003ebuilt-in defaults\"]\n    end\n    \n    subgraph \"Configuration Targets\"\n        LayoutService[\"Layout Service\"]\n        EditorService[\"Editor Service\"]\n        UIComponents[\"UI Components\"]\n    end\n    \n    IConfigSvc --\u003e ConfigSvc\n    ConfigSvc --\u003e ConfigModel\n    ConfigSvc --\u003e ConfigCache\n    \n    DefaultSettings --\u003e ConfigModel\n    UserSettings --\u003e ConfigModel\n    WorkspaceSettings --\u003e ConfigModel\n    FolderSettings --\u003e ConfigModel\n    \n    ConfigSvc --\u003e LayoutService\n    ConfigSvc --\u003e EditorService\n    ConfigSvc --\u003e UIComponents\n```\n\nThe `ConfigurationService` implements the `IConfigurationService` interface and manages configuration resolution across multiple scopes:\n\n| Configuration Scope | Priority | File Location | Purpose |\n|---------------------|----------|---------------|---------|\n| Application | Lowest | Built-in | Default values |\n| User | Low | `%APPDATA%/Code/User/settings.json` | User preferences |\n| Workspace | High | `.vscode/settings.json` | Project settings |\n| Folder | Highest | Per workspace folder | Folder-specific overrides |\n\n**Sources:** [src/vs/workbench/services/configuration/browser/configurationService.ts:15-50](), [src/vs/workbench/services/configuration/browser/configuration.ts:12-30](), [src/vs/platform/configuration/common/configurationModels.ts:1-100]()\n\n## Layout Management\n\nThe layout service orchestrates the positioning and sizing of workbench parts including the title bar, sidebar, panel, editor area, and status bar. It manages responsive layout changes and user customizations.\n\n```mermaid\ngraph TB\n    subgraph \"Layout Service Core\"\n        ILayoutSvc[\"IWorkbenchLayoutService\"]\n        Layout[\"Layout\u003cbr/\u003eabstract class\"]\n        LayoutState[\"ILayoutState\"]\n        LayoutGrid[\"SerializableGrid\"]\n    end\n    \n    subgraph \"Workbench Parts\"\n        TitleBarPart[\"titleBarPartView\u003cbr/\u003eISerializableView\"]\n        SideBarPart[\"sideBarPartView\u003cbr/\u003eISerializableView\"]\n        EditorPart[\"editorPartView\u003cbr/\u003eISerializableView\"]\n        PanelPart[\"panelPartView\u003cbr/\u003eISerializableView\"]\n        StatusBarPart[\"statusBarPartView\u003cbr/\u003eISerializableView\"]\n    end\n    \n    subgraph \"Layout Events\"\n        OnDidChange[\"onDidChangePartVisibility\"]\n        OnDidLayout[\"onDidLayoutContainer\"]\n        OnDidResize[\"onDidLayoutMainContainer\"]\n    end\n    \n    ILayoutSvc --\u003e Layout\n    Layout --\u003e LayoutState\n    Layout --\u003e LayoutGrid\n    \n    LayoutGrid --\u003e TitleBarPart\n    LayoutGrid --\u003e SideBarPart\n    LayoutGrid --\u003e EditorPart\n    LayoutGrid --\u003e PanelPart\n    LayoutGrid --\u003e StatusBarPart\n    \n    Layout --\u003e OnDidChange\n    Layout --\u003e OnDidLayout\n    Layout --\u003e OnDidResize\n```\n\nThe layout system uses a `SerializableGrid` to manage part positioning and supports operations like:\n\n- **Part Visibility**: `isVisible(Parts.SIDEBAR_PART)`, `toggleSidebar()`\n- **Part Positioning**: `setSideBarPosition(Position.LEFT)`\n- **Layout Persistence**: State serialization for workspace restoration\n- **Responsive Behavior**: Automatic adjustments based on window size\n\n**Sources:** [src/vs/workbench/browser/layout.ts:260-300](), [src/vs/workbench/browser/layout.ts:540-580](), [src/vs/workbench/services/layout/browser/layoutService.ts:1-50]()\n\n## UI Component Infrastructure\n\nThe UI component system provides foundational widgets like trees and lists that are used throughout the workbench. These components handle complex interaction patterns, virtualization, and accessibility.\n\n```mermaid\ngraph TB\n    subgraph \"List Service Architecture\"\n        IListSvc[\"IListService\"]\n        ListSvc[\"ListService\"] \n        ListWidget[\"WorkbenchListWidget\"]\n        RegisteredList[\"IRegisteredList\"]\n    end\n    \n    subgraph \"Tree Components\"\n        AbstractTree[\"AbstractTree\u003cbr/\u003eComposedTreeDelegate\"]\n        TreeRenderer[\"TreeRenderer\u003cbr/\u003eITreeListTemplateData\"]\n        TreeFilter[\"FindFilter\u003cbr/\u003eIFindFilter\"]\n        TreeModel[\"IndexTreeModel\"]\n    end\n    \n    subgraph \"List Components\"  \n        List[\"List\u003cbr/\u003eIListRenderer\"]\n        ListController[\"KeyboardController\"]\n        ListTrait[\"Trait\u003cbr/\u003eSelectionTrait\"]\n        ListView[\"ListView\u003cbr/\u003eIListView\"]\n    end\n    \n    IListSvc --\u003e ListSvc\n    ListSvc --\u003e RegisteredList\n    RegisteredList --\u003e ListWidget\n    \n    ListWidget --\u003e AbstractTree\n    ListWidget --\u003e List\n    \n    AbstractTree --\u003e TreeRenderer\n    AbstractTree --\u003e TreeFilter\n    AbstractTree --\u003e TreeModel\n    \n    List --\u003e ListView\n    List --\u003e ListController\n    List --\u003e ListTrait\n```\n\nKey component features include:\n\n| Component | Purpose | Key Classes |\n|-----------|---------|-------------|\n| AbstractTree | Hierarchical data display | `AbstractTree`, `TreeRenderer`, `FindFilter` |\n| List | Flat data virtualization | `List`, `ListView`, `KeyboardController` |\n| Traits | Selection/focus management | `SelectionTrait`, `FocusTrait` |\n| Renderers | Element visualization | `IListRenderer`, `ITreeRenderer` |\n\n**Sources:** [src/vs/base/browser/ui/tree/abstractTree.ts:335-580](), [src/vs/base/browser/ui/list/listWidget.ts:308-430](), [src/vs/platform/list/browser/listService.ts:77-106]()\n\n## Service Lifecycle and Dependencies\n\nThe platform services use dependency injection through the `IInstantiationService` to manage service creation, lifecycle, and dependencies. Services are registered as singletons and injected based on interface contracts.\n\n```mermaid\ngraph LR\n    subgraph \"Service Registration\"\n        ServiceDescriptor[\"SyncDescriptor\u003cbr/\u003eService Definition\"]\n        ServiceCollection[\"ServiceCollection\u003cbr/\u003eDI Container\"] \n        ServiceIdentifier[\"ServiceIdentifier\u003cbr/\u003eToken\"]\n    end\n    \n    subgraph \"Service Creation\"\n        InstantiationSvc[\"IInstantiationService\u003cbr/\u003eInstantiationService\"]\n        CreateInstance[\"createInstance()\u003cbr/\u003eService Factory\"]\n        ScopedServices[\"Scoped Services\u003cbr/\u003ePer-context instances\"]\n    end\n    \n    subgraph \"Service Dependencies\"\n        ConfigService[\"ConfigurationService\u003cbr/\u003e@IConfigurationService\"]\n        LayoutService[\"Layout\u003cbr/\u003e@IWorkbenchLayoutService\"]\n        ListService[\"ListService\u003cbr/\u003e@IListService\"]\n    end\n    \n    ServiceDescriptor --\u003e ServiceCollection\n    ServiceIdentifier --\u003e ServiceCollection\n    ServiceCollection --\u003e InstantiationSvc\n    \n    InstantiationSvc --\u003e CreateInstance\n    CreateInstance --\u003e ScopedServices\n    \n    CreateInstance --\u003e ConfigService\n    CreateInstance --\u003e LayoutService  \n    CreateInstance --\u003e ListService\n    \n    ConfigService --\u003e LayoutService\n    ConfigService --\u003e ListService\n```\n\nService lifecycle phases:\n\n1. **Registration**: Services register descriptors with `ServiceCollection`\n2. **Instantiation**: `IInstantiationService.createInstance()` creates instances\n3. **Injection**: Constructor parameters are automatically resolved\n4. **Scoping**: Services can be scoped to specific contexts (e.g., editor groups)\n5. **Disposal**: Services implement `IDisposable` for cleanup\n\n**Sources:** [src/vs/workbench/test/browser/workbenchTestServices.ts:250-350](), [src/vs/platform/instantiation/common/instantiation.ts:1-50](), [src/vs/workbench/browser/parts/editor/editorGroupView.ts:200-230]()\n\n## Configuration Integration Points\n\nThe platform services integrate deeply with the configuration system to provide customizable behavior. Key integration points include:\n\n```mermaid\ngraph TB\n    subgraph \"Configuration Flow\"\n        UserAction[\"User Configuration Change\"]\n        ConfigEvent[\"IConfigurationChangeEvent\"]\n        ServiceUpdate[\"Service Update\"]\n        UIRefresh[\"UI Refresh\"]\n    end\n    \n    subgraph \"Layout Configuration\"\n        LayoutSettings[\"LayoutSettings\u003cbr/\u003eACTIVITY_BAR_LOCATION\u003cbr/\u003ePANEL_POSITION\u003cbr/\u003eSIDEBAR_POSITION\"]\n        LayoutService[\"Layout Service\"]\n        PartVisibility[\"Part Visibility Updates\"]\n    end\n    \n    subgraph \"List Configuration\"\n        ListSettings[\"List Settings\u003cbr/\u003emultiSelectModifier\u003cbr/\u003eopenMode\u003cbr/\u003ehorizontalScrolling\"]\n        ListService[\"List Service\"]\n        ListBehavior[\"List Behavior Updates\"]\n    end\n    \n    UserAction --\u003e ConfigEvent\n    ConfigEvent --\u003e ServiceUpdate\n    ServiceUpdate --\u003e UIRefresh\n    \n    ConfigEvent --\u003e LayoutSettings\n    LayoutSettings --\u003e LayoutService\n    LayoutService --\u003e PartVisibility\n    \n    ConfigEvent --\u003e ListSettings\n    ListSettings --\u003e ListService\n    ListService --\u003e ListBehavior\n```\n\nConfiguration-driven features:\n- **Layout Customization**: Panel position, sidebar location, activity bar placement\n- **Component Behavior**: List interaction modes, tree rendering options\n- **Accessibility**: High contrast themes, keyboard navigation preferences\n- **Performance**: Virtualization settings, smooth scrolling options\n\n**Sources:** [src/vs/workbench/browser/layout.ts:360-400](), [src/vs/platform/list/browser/listService.ts:170-250](), [src/vs/workbench/browser/workbench.contribution.ts:20-100]()"])</script>
    <script>self.__next_f.push([1, "18:T5333,"])</script>
    <script>self.__next_f.push([1, "# Configuration System\n\n\u003cdetails\u003e\n\u003csummary\u003eRelevant source files\u003c/summary\u003e\n\nThe following files were used as context for generating this wiki page:\n\n- [src/vs/base/common/resources.ts](src/vs/base/common/resources.ts)\n- [src/vs/base/test/common/resources.test.ts](src/vs/base/test/common/resources.test.ts)\n- [src/vs/platform/configuration/common/configuration.ts](src/vs/platform/configuration/common/configuration.ts)\n- [src/vs/platform/configuration/common/configurationModels.ts](src/vs/platform/configuration/common/configurationModels.ts)\n- [src/vs/platform/configuration/common/configurationService.ts](src/vs/platform/configuration/common/configurationService.ts)\n- [src/vs/platform/configuration/test/common/configurationModels.test.ts](src/vs/platform/configuration/test/common/configurationModels.test.ts)\n- [src/vs/platform/configuration/test/common/configurationRegistry.test.ts](src/vs/platform/configuration/test/common/configurationRegistry.test.ts)\n- [src/vs/platform/configuration/test/common/configurationService.test.ts](src/vs/platform/configuration/test/common/configurationService.test.ts)\n- [src/vs/platform/configuration/test/common/configurations.test.ts](src/vs/platform/configuration/test/common/configurations.test.ts)\n- [src/vs/platform/userData/common/fileUserDataProvider.ts](src/vs/platform/userData/common/fileUserDataProvider.ts)\n- [src/vs/platform/userData/test/browser/fileUserDataProvider.test.ts](src/vs/platform/userData/test/browser/fileUserDataProvider.test.ts)\n- [src/vs/workbench/api/browser/mainThreadConfiguration.ts](src/vs/workbench/api/browser/mainThreadConfiguration.ts)\n- [src/vs/workbench/api/common/extHostConfiguration.ts](src/vs/workbench/api/common/extHostConfiguration.ts)\n- [src/vs/workbench/contrib/telemetry/browser/telemetry.contribution.ts](src/vs/workbench/contrib/telemetry/browser/telemetry.contribution.ts)\n- [src/vs/workbench/services/configuration/browser/configuration.ts](src/vs/workbench/services/configuration/browser/configuration.ts)\n- [src/vs/workbench/services/configuration/browser/configurationService.ts](src/vs/workbench/services/configuration/browser/configurationService.ts)\n- [src/vs/workbench/services/configuration/common/configuration.ts](src/vs/workbench/services/configuration/common/configuration.ts)\n- [src/vs/workbench/services/configuration/common/configurationEditing.ts](src/vs/workbench/services/configuration/common/configurationEditing.ts)\n- [src/vs/workbench/services/configuration/common/configurationModels.ts](src/vs/workbench/services/configuration/common/configurationModels.ts)\n- [src/vs/workbench/services/configuration/common/jsonEditing.ts](src/vs/workbench/services/configuration/common/jsonEditing.ts)\n- [src/vs/workbench/services/configuration/common/jsonEditingService.ts](src/vs/workbench/services/configuration/common/jsonEditingService.ts)\n- [src/vs/workbench/services/configuration/test/browser/configuration.test.ts](src/vs/workbench/services/configuration/test/browser/configuration.test.ts)\n- [src/vs/workbench/services/configuration/test/browser/configurationService.test.ts](src/vs/workbench/services/configuration/test/browser/configurationService.test.ts)\n- [src/vs/workbench/services/configuration/test/common/configurationModels.test.ts](src/vs/workbench/services/configuration/test/common/configurationModels.test.ts)\n- [src/vs/workbench/services/keybinding/test/browser/keybindingEditing.test.ts](src/vs/workbench/services/keybinding/test/browser/keybindingEditing.test.ts)\n\n\u003c/details\u003e\n\n\n\nVS Code's Configuration System provides a hierarchical, multi-target configuration management framework that supports user settings, workspace settings, folder-level settings, and extension-contributed configuration. The system handles configuration merging, validation, caching, and real-time updates across different scopes and override contexts.\n\nThis document covers the core configuration service architecture, configuration models, parsing system, and integration with the extension API. For information about workspace management, see [Workbench Layout and Services](#2.2). For extension-specific configuration handling, see [Extension Host and API Protocol](#4.1).\n\n## Architecture Overview\n\nThe Configuration System is built around the `WorkspaceService` class, which implements both `IWorkbenchConfigurationService` and `IWorkspaceContextService`. This service orchestrates multiple configuration sources and provides a unified interface for reading and writing configuration values.\n\n### Core Configuration Service Architecture\n\n```mermaid\ngraph TB\n    WorkspaceService[\"WorkspaceService\u003cbr/\u003e(Main Service)\"]\n    \n    subgraph \"Configuration Models\"\n        DefaultConfig[\"DefaultConfiguration\u003cbr/\u003e(Registry + Overrides)\"]\n        PolicyConfig[\"PolicyConfiguration\u003cbr/\u003e(Enterprise Policies)\"]\n        ApplicationConfig[\"ApplicationConfiguration\u003cbr/\u003e(Application Scope)\"]\n        UserConfig[\"UserConfiguration\u003cbr/\u003e(Local + Remote)\"]\n        WorkspaceConfig[\"WorkspaceConfiguration\u003cbr/\u003e(Workspace Files)\"]\n        FolderConfigs[\"FolderConfiguration\u003cbr/\u003e(Per-folder Settings)\"]\n    end\n    \n    subgraph \"Configuration Targets\"\n        DefaultTarget[\"DEFAULT\"]\n        ApplicationTarget[\"APPLICATION\"]\n        UserLocalTarget[\"USER_LOCAL\"]\n        UserRemoteTarget[\"USER_REMOTE\"] \n        WorkspaceTarget[\"WORKSPACE\"]\n        WorkspaceFolderTarget[\"WORKSPACE_FOLDER\"]\n        MemoryTarget[\"MEMORY\"]\n    end\n    \n    subgraph \"Configuration Infrastructure\"\n        ConfigParser[\"ConfigurationModelParser\u003cbr/\u003e(JSON Parsing)\"]\n        ConfigCache[\"IConfigurationCache\u003cbr/\u003e(Caching Layer)\"]\n        ConfigRegistry[\"IConfigurationRegistry\u003cbr/\u003e(Settings Schema)\"]\n    end\n    \n    WorkspaceService --\u003e DefaultConfig\n    WorkspaceService --\u003e PolicyConfig\n    WorkspaceService --\u003e ApplicationConfig\n    WorkspaceService --\u003e UserConfig\n    WorkspaceService --\u003e WorkspaceConfig\n    WorkspaceService --\u003e FolderConfigs\n    \n    WorkspaceService --\u003e ConfigCache\n    DefaultConfig --\u003e ConfigRegistry\n    \n    ConfigParser --\u003e DefaultConfig\n    ConfigParser --\u003e UserConfig\n    ConfigParser --\u003e WorkspaceConfig\n    ConfigParser --\u003e FolderConfigs\n```\n\nSources: [src/vs/workbench/services/configuration/browser/configurationService.ts:63-160](), [src/vs/workbench/services/configuration/browser/configuration.ts:123-153](), [src/vs/platform/configuration/common/configurationModels.ts:306-488]()\n\n### Configuration Hierarchy and Merging\n\nThe configuration system uses a layered approach where settings from different sources are merged according to precedence rules. Each layer can override settings from lower-precedence layers.\n\n```mermaid\ngraph TB\n    subgraph \"Configuration Precedence (High to Low)\"\n        Memory[\"Memory Configuration\u003cbr/\u003e(Runtime Overrides)\"]\n        Policy[\"Policy Configuration\u003cbr/\u003e(Enterprise/Admin)\"]\n        WorkspaceFolder[\"Workspace Folder\u003cbr/\u003e(.vscode/settings.json)\"]\n        Workspace[\"Workspace Settings\u003cbr/\u003e(workspace.json)\"]\n        UserRemote[\"User Remote\u003cbr/\u003e(Remote Settings)\"]\n        UserLocal[\"User Local\u003cbr/\u003e(Local Settings)\"]\n        Application[\"Application\u003cbr/\u003e(Profile Settings)\"]\n        Defaults[\"Default Configuration\u003cbr/\u003e(Built-in + Extensions)\"]\n    end\n    \n    subgraph \"Override Context\"\n        LanguageOverrides[\"Language Overrides\u003cbr/\u003e([javascript], [python])\"]\n        ResourceOverrides[\"Resource Overrides\u003cbr/\u003e(File/Folder Specific)\"]\n    end\n    \n    Memory --\u003e Policy\n    Policy --\u003e WorkspaceFolder\n    WorkspaceFolder --\u003e Workspace\n    Workspace --\u003e UserRemote\n    UserRemote --\u003e UserLocal\n    UserLocal --\u003e Application\n    Application --\u003e Defaults\n    \n    LanguageOverrides -.-\u003e Memory\n    LanguageOverrides -.-\u003e WorkspaceFolder\n    LanguageOverrides -.-\u003e Workspace\n    LanguageOverrides -.-\u003e UserLocal\n    \n    ResourceOverrides -.-\u003e Memory\n    ResourceOverrides -.-\u003e WorkspaceFolder\n```\n\nSources: [src/vs/platform/configuration/common/configurationModels.ts:710-788](), [src/vs/workbench/services/configuration/common/configurationModels.ts:98-171](), [src/vs/workbench/services/configuration/browser/configurationService.ts:686-708]()\n\n## Configuration Models\n\nThe system uses several specialized configuration model classes to handle different configuration sources and their specific requirements.\n\n### Configuration Model Classes\n\n| Class | Purpose | Configuration Source | File Locations |\n|-------|---------|---------------------|----------------|\n| `DefaultConfiguration` | Default settings from registry and overrides | Built-in settings + extension contributions | Registry + cached overrides |\n| `PolicyConfiguration` | Enterprise/admin enforced settings | Policy files | System policy locations |\n| `ApplicationConfiguration` | Application-level profile settings | Profile-specific application settings | `{profile}/settings.json` (application scope only) |\n| `UserConfiguration` | User preferences (local and remote) | User settings.json files | Local: `{userDataHome}/User/settings.json`\u003cbr/\u003eRemote: `{userDataHome}/User/settings.json` |\n| `WorkspaceConfiguration` | Workspace-specific settings | .code-workspace files | `{workspace}.code-workspace` |\n| `FolderConfiguration` | Folder-level settings | .vscode/settings.json files | `{workspaceFolder}/.vscode/settings.json` |\n\nThe `UserConfiguration` class supports both standalone settings files and combined settings+tasks files through `FileServiceBasedConfiguration`. It automatically switches between `UserSettings` (settings-only) and the full file-based configuration when tasks configuration is needed.\n\nSources: [src/vs/workbench/services/configuration/browser/configuration.ts:32-121](), [src/vs/workbench/services/configuration/browser/configuration.ts:155-221](), [src/vs/workbench/services/configuration/browser/configuration.ts:627-733]()\n\n### Configuration Parsing and Validation\n\nThe `ConfigurationModelParser` handles parsing JSON configuration files with support for validation, scope filtering, and override processing.\n\n```mermaid\ngraph LR\n    subgraph \"Configuration File Processing\"\n        JSONFile[\"JSON Configuration File\"]\n        Parser[\"ConfigurationModelParser\u003cbr/\u003e.parse()\"]\n        Validation[\"Schema Validation\u003cbr/\u003e(IConfigurationRegistry)\"]\n        Filtering[\"Scope Filtering\u003cbr/\u003e(ConfigurationParseOptions)\"]\n        Model[\"ConfigurationModel\u003cbr/\u003e(Parsed Result)\"]\n    end\n    \n    subgraph \"Parse Options\"\n        Scopes[\"scopes[]\u003cbr/\u003e(APPLICATION, WINDOW, etc)\"]\n        SkipRestricted[\"skipRestricted\u003cbr/\u003e(Security Filtering)\"]\n        Include[\"include[]\u003cbr/\u003e(Explicit Inclusion)\"]\n        Exclude[\"exclude[]\u003cbr/\u003e(Explicit Exclusion)\"]\n    end\n    \n    JSONFile --\u003e Parser\n    Parser --\u003e Validation\n    Validation --\u003e Filtering\n    Filtering --\u003e Model\n    \n    Scopes --\u003e Filtering\n    SkipRestricted --\u003e Filtering\n    Include --\u003e Filtering\n    Exclude --\u003e Filtering\n```\n\nSources: [src/vs/platform/configuration/common/configurationModels.ts:306-488](), [src/vs/platform/configuration/common/configurationModels.ts:417-468]()\n\n## Configuration Targets and Scopes\n\n### Configuration Targets\n\nThe system defines specific targets where configuration values can be stored and retrieved:\n\n```typescript\nenum ConfigurationTarget {\n    APPLICATION = 1,    // Application-level settings\n    USER,              // User settings (local + remote)\n    USER_LOCAL,        // Local user settings only\n    USER_REMOTE,       // Remote user settings only\n    WORKSPACE,         // Workspace settings\n    WORKSPACE_FOLDER,  // Folder-specific settings\n    DEFAULT,           // Default values\n    MEMORY            // Runtime overrides\n}\n```\n\nSources: [src/vs/platform/configuration/common/configuration.ts:38-47]()\n\n### Configuration Scopes\n\nConfiguration properties are classified by scope to determine where they can be applied:\n\n| Scope | Description | Valid Targets |\n|-------|-------------|---------------|\n| `APPLICATION` | Application-wide settings | APPLICATION, MEMORY |\n| `MACHINE` | Machine-specific settings | USER_LOCAL, USER_REMOTE |\n| `WINDOW` | Window-level settings | USER, WORKSPACE, MEMORY |\n| `RESOURCE` | Resource/file-specific | WORKSPACE, WORKSPACE_FOLDER, MEMORY |\n| `LANGUAGE_OVERRIDABLE` | Language-specific overrides | All targets with language context |\n\nSources: [src/vs/workbench/services/configuration/common/configuration.ts:28-34](), [src/vs/platform/configuration/common/configurationRegistry.ts:164-169]()\n\n## Configuration Service Implementation\n\n### WorkspaceService Core Functionality\n\nThe `WorkspaceService` class serves as the central configuration service, implementing both workspace context and configuration management:\n\n```mermaid\ngraph TB\n    subgraph \"WorkspaceService Methods\"\n        GetValue[\"getValue()\u003cbr/\u003e(Read Configuration)\"]\n        UpdateValue[\"updateValue()\u003cbr/\u003e(Write Configuration)\"]\n        Inspect[\"inspect()\u003cbr/\u003e(Detailed Inspection)\"]\n        Reload[\"reloadConfiguration()\u003cbr/\u003e(Refresh from Files)\"]\n        Keys[\"keys()\u003cbr/\u003e(Available Settings)\"]\n    end\n    \n    subgraph \"Configuration State\"\n        ConfigurationInstance[\"_configuration: Configuration\u003cbr/\u003e(Merged Model)\"]\n        DefaultModel[\"defaultConfiguration: DefaultConfiguration\"]\n        UserModel[\"localUserConfiguration: UserConfiguration\"]\n        WorkspaceModel[\"workspaceConfiguration: WorkspaceConfiguration\"]\n        FolderModels[\"cachedFolderConfigs: ResourceMap\u003cFolderConfiguration\u003e\"]\n    end\n    \n    subgraph \"Event System\"\n        OnDidChange[\"onDidChangeConfiguration\u003cbr/\u003e(Configuration Changes)\"]\n        ConfigEvents[\"IConfigurationChangeEvent\u003cbr/\u003e(Change Details)\"]\n    end\n    \n    GetValue --\u003e ConfigurationInstance\n    UpdateValue --\u003e ConfigurationInstance\n    Inspect --\u003e ConfigurationInstance\n    \n    ConfigurationInstance --\u003e DefaultModel\n    ConfigurationInstance --\u003e UserModel\n    ConfigurationInstance --\u003e WorkspaceModel\n    ConfigurationInstance --\u003e FolderModels\n    \n    OnDidChange --\u003e ConfigEvents\n```\n\nSources: [src/vs/workbench/services/configuration/browser/configurationService.ts:320-421](), [src/vs/workbench/services/configuration/browser/configurationService.ts:63-109]()\n\n### Configuration Reading and Writing\n\nThe service provides multiple overloaded methods for reading and writing configuration values:\n\n**getValue Method Overloads:**\n```typescript\ngetValue\u003cT\u003e(): T;\ngetValue\u003cT\u003e(section: string): T;\ngetValue\u003cT\u003e(overrides: IConfigurationOverrides): T;\ngetValue\u003cT\u003e(section: string, overrides: IConfigurationOverrides): T;\n```\n\n**updateValue Method Overloads:**\n```typescript\nupdateValue(key: string, value: any): Promise\u003cvoid\u003e;\nupdateValue(key: string, value: unknown, overrides: IConfigurationOverrides | IConfigurationUpdateOverrides): Promise\u003cvoid\u003e;\nupdateValue(key: string, value: unknown, target: ConfigurationTarget): Promise\u003cvoid\u003e;\nupdateValue(key: string, value: unknown, overrides: IConfigurationOverrides | IConfigurationUpdateOverrides, target: ConfigurationTarget, options?: IConfigurationUpdateOptions): Promise\u003cvoid\u003e;\n```\n\n**Other Core Methods:**\n- `inspect\u003cT\u003e(key: string, overrides?: IConfigurationOverrides): IConfigurationValue\u003cT\u003e` - Get detailed value breakdown by source\n- `reloadConfiguration(target?: ConfigurationTarget | IWorkspaceFolder): Promise\u003cvoid\u003e` - Refresh configuration from files\n- `keys(): { default: string[]; user: string[]; workspace: string[]; workspaceFolder: string[]; }` - Get available configuration keys\n\nSources: [src/vs/workbench/services/configuration/browser/configurationService.ts:324-421](), [src/vs/workbench/services/configuration/browser/configurationService.ts:334-403]()\n\n## Extension API Integration\n\n### ExtHostConfiguration Architecture\n\nExtensions access configuration through the `ExtHostConfiguration` service, which provides the VS Code extension API for configuration management:\n\n```mermaid\ngraph LR\n    subgraph \"Extension Process\"\n        Extension[\"Extension Code\u003cbr/\u003e(vscode.workspace.getConfiguration)\"]\n        ExtHostConfig[\"ExtHostConfiguration\u003cbr/\u003e(Extension Host Service)\"]\n        ExtHostProvider[\"ExtHostConfigProvider\u003cbr/\u003e(Implementation)\"]\n    end\n    \n    subgraph \"Main Process\"\n        MainThreadConfig[\"MainThreadConfiguration\u003cbr/\u003e(Main Thread Proxy)\"]\n        WorkspaceService[\"WorkspaceService\u003cbr/\u003e(Core Service)\"]\n    end\n    \n    subgraph \"RPC Communication\"\n        Protocol[\"RPC Protocol\u003cbr/\u003e(Cross-process)\"]\n        ConfigData[\"IConfigurationInitData\u003cbr/\u003e(Serialized Config)\"]\n        ConfigChanges[\"IConfigurationChange\u003cbr/\u003e(Change Events)\"]\n    end\n    \n    Extension --\u003e ExtHostConfig\n    ExtHostConfig --\u003e ExtHostProvider\n    ExtHostProvider --\u003e Protocol\n    Protocol --\u003e MainThreadConfig\n    MainThreadConfig --\u003e WorkspaceService\n    \n    ConfigData --\u003e Protocol\n    ConfigChanges --\u003e Protocol\n```\n\nSources: [src/vs/workbench/api/common/extHostConfiguration.ts:97-131](), [src/vs/workbench/api/common/extHostConfiguration.ts:133-292](), [src/vs/workbench/api/browser/mainThreadConfiguration.ts:16-92]()\n\n### Extension Configuration API\n\nThe extension API provides a workspace configuration object with methods for reading, updating, and inspecting configuration through the `ExtHostConfigProvider` class:\n\n```typescript\ninterface WorkspaceConfiguration {\n    get\u003cT\u003e(section: string, defaultValue?: T): T;\n    has(section: string): boolean;\n    inspect\u003cT\u003e(section: string): ConfigurationInspect\u003cT\u003e;\n    update(section: string, value: any, target?: ConfigurationTarget): Thenable\u003cvoid\u003e;\n}\n```\n\n**Key Implementation Classes:**\n- `ExtHostConfiguration` - Main service implementing `ExtHostConfigurationShape`\n- `ExtHostConfigProvider` - Core implementation handling configuration operations\n- `MainThreadConfiguration` - Main thread proxy implementing `MainThreadConfigurationShape`\n\nThe `ExtHostConfigProvider` manages the configuration state in the extension host process and synchronizes with the main thread through RPC calls. It maintains a local `Configuration` instance and emits `ConfigurationChangeEvent` objects when settings change.\n\nSources: [src/vs/workbench/api/common/extHostConfiguration.ts:184-285](), [src/vs/workbench/api/common/extHostConfiguration.ts:97-131](), [src/vs/workbench/api/common/extHostConfiguration.ts:133-292]()\n\n## Configuration Caching and Performance\n\n### Configuration Cache Interface\n\nThe system includes a caching layer to improve performance, especially for remote configurations:\n\n```mermaid\ngraph TB\n    subgraph \"Configuration Caching\"\n        CacheInterface[\"IConfigurationCache\u003cbr/\u003e(Cache Interface)\"]\n        CacheKey[\"ConfigurationKey\u003cbr/\u003e(type + key identifier)\"]\n        \n        subgraph \"Cache Operations\"\n            NeedsCaching[\"needsCaching(resource)\u003cbr/\u003e(Check if caching required)\"]\n            Read[\"read(key)\u003cbr/\u003e(Retrieve cached data)\"]\n            Write[\"write(key, content)\u003cbr/\u003e(Store configuration)\"]\n            Remove[\"remove(key)\u003cbr/\u003e(Clear cache entry)\"]\n        end\n        \n        subgraph \"Cache Types\"\n            DefaultsCache[\"defaults\u003cbr/\u003e(Default overrides)\"]\n            UserCache[\"user\u003cbr/\u003e(Remote user config)\"]\n            WorkspacesCache[\"workspaces\u003cbr/\u003e(Workspace configs)\"]\n            FolderCache[\"folder\u003cbr/\u003e(Folder configs)\"]\n        end\n    end\n    \n    CacheInterface --\u003e CacheKey\n    CacheInterface --\u003e NeedsCaching\n    CacheInterface --\u003e Read\n    CacheInterface --\u003e Write\n    CacheInterface --\u003e Remove\n    \n    CacheKey --\u003e DefaultsCache\n    CacheKey --\u003e UserCache\n    CacheKey --\u003e WorkspacesCache\n    CacheKey --\u003e FolderCache\n```\n\nSources: [src/vs/workbench/services/configuration/common/configuration.ts:48-57](), [src/vs/workbench/services/configuration/browser/configuration.ts:564-625]()\n\n## Configuration Overrides and Language Support\n\nThe configuration system supports sophisticated override mechanisms for language-specific and resource-specific settings:\n\n### Override Processing\n\n```mermaid\ngraph LR\n    subgraph \"Override Types\"\n        LanguageOverrides[\"Language Overrides\u003cbr/\u003e([typescript], [json])\"]\n        ResourceOverrides[\"Resource Overrides\u003cbr/\u003e(File path based)\"]\n        IdentifierOverrides[\"Override Identifiers\u003cbr/\u003e(Multiple contexts)\"]\n    end\n    \n    subgraph \"Override Resolution\"\n        OverrideKey[\"Override Key\u003cbr/\u003e(e.g., '[typescript]')\"]\n        OverrideContents[\"Override Contents\u003cbr/\u003e(Scoped settings)\"]\n        MergedResult[\"Merged Configuration\u003cbr/\u003e(Final values)\"]\n    end\n    \n    subgraph \"Override Context\"\n        ConfigOverrides[\"IConfigurationOverrides\u003cbr/\u003e(resource + overrideIdentifier)\"]\n        ScopeValidation[\"Scope Validation\u003cbr/\u003e(Resource vs Window scope)\"]\n    end\n    \n    LanguageOverrides --\u003e OverrideKey\n    ResourceOverrides --\u003e OverrideKey\n    IdentifierOverrides --\u003e OverrideKey\n    \n    OverrideKey --\u003e OverrideContents\n    OverrideContents --\u003e MergedResult\n    \n    ConfigOverrides --\u003e ScopeValidation\n    ScopeValidation --\u003e MergedResult\n```\n\nSources: [src/vs/platform/configuration/common/configurationModels.ts:112-144](), [src/vs/workbench/api/common/extHostConfiguration.ts:78-95](), [src/vs/workbench/api/common/extHostConfiguration.ts:310-325]()\n\nThe Configuration System provides a robust, scalable foundation for managing settings across VS Code's complex multi-process architecture, supporting everything from simple user preferences to sophisticated enterprise policy enforcement and language-specific overrides."])</script>
    <script>self.__next_f.push([1, "19:T3956,"])</script>
    <script>self.__next_f.push([1, "# Workbench Layout and Editor Management\n\n\u003cdetails\u003e\n\u003csummary\u003eRelevant source files\u003c/summary\u003e\n\nThe following files were used as context for generating this wiki page:\n\n- [src/vs/platform/editor/common/editor.ts](src/vs/platform/editor/common/editor.ts)\n- [src/vs/workbench/browser/actions/layoutActions.ts](src/vs/workbench/browser/actions/layoutActions.ts)\n- [src/vs/workbench/browser/contextkeys.ts](src/vs/workbench/browser/contextkeys.ts)\n- [src/vs/workbench/browser/dnd.ts](src/vs/workbench/browser/dnd.ts)\n- [src/vs/workbench/browser/layout.ts](src/vs/workbench/browser/layout.ts)\n- [src/vs/workbench/browser/parts/auxiliarybar/auxiliaryBarActions.ts](src/vs/workbench/browser/parts/auxiliarybar/auxiliaryBarActions.ts)\n- [src/vs/workbench/browser/parts/editor/editor.contribution.ts](src/vs/workbench/browser/parts/editor/editor.contribution.ts)\n- [src/vs/workbench/browser/parts/editor/editor.ts](src/vs/workbench/browser/parts/editor/editor.ts)\n- [src/vs/workbench/browser/parts/editor/editorActions.ts](src/vs/workbench/browser/parts/editor/editorActions.ts)\n- [src/vs/workbench/browser/parts/editor/editorCommands.ts](src/vs/workbench/browser/parts/editor/editorCommands.ts)\n- [src/vs/workbench/browser/parts/editor/editorDropTarget.ts](src/vs/workbench/browser/parts/editor/editorDropTarget.ts)\n- [src/vs/workbench/browser/parts/editor/editorGroupView.ts](src/vs/workbench/browser/parts/editor/editorGroupView.ts)\n- [src/vs/workbench/browser/parts/editor/editorGroupWatermark.ts](src/vs/workbench/browser/parts/editor/editorGroupWatermark.ts)\n- [src/vs/workbench/browser/parts/editor/editorPart.ts](src/vs/workbench/browser/parts/editor/editorPart.ts)\n- [src/vs/workbench/browser/parts/editor/media/editorgroupview.css](src/vs/workbench/browser/parts/editor/media/editorgroupview.css)\n- [src/vs/workbench/browser/parts/panel/panelActions.ts](src/vs/workbench/browser/parts/panel/panelActions.ts)\n- [src/vs/workbench/browser/parts/titlebar/titlebarActions.ts](src/vs/workbench/browser/parts/titlebar/titlebarActions.ts)\n- [src/vs/workbench/browser/workbench.contribution.ts](src/vs/workbench/browser/workbench.contribution.ts)\n- [src/vs/workbench/browser/workbench.ts](src/vs/workbench/browser/workbench.ts)\n- [src/vs/workbench/common/contextkeys.ts](src/vs/workbench/common/contextkeys.ts)\n- [src/vs/workbench/common/editor.ts](src/vs/workbench/common/editor.ts)\n- [src/vs/workbench/services/editor/browser/editorService.ts](src/vs/workbench/services/editor/browser/editorService.ts)\n- [src/vs/workbench/services/editor/common/editorGroupsService.ts](src/vs/workbench/services/editor/common/editorGroupsService.ts)\n- [src/vs/workbench/services/editor/common/editorService.ts](src/vs/workbench/services/editor/common/editorService.ts)\n- [src/vs/workbench/services/editor/test/browser/editorGroupsService.test.ts](src/vs/workbench/services/editor/test/browser/editorGroupsService.test.ts)\n- [src/vs/workbench/services/editor/test/browser/editorService.test.ts](src/vs/workbench/services/editor/test/browser/editorService.test.ts)\n- [src/vs/workbench/services/layout/browser/layoutService.ts](src/vs/workbench/services/layout/browser/layoutService.ts)\n- [src/vs/workbench/test/browser/workbenchTestServices.ts](src/vs/workbench/test/browser/workbenchTestServices.ts)\n\n\u003c/details\u003e\n\n\n\nThis document covers VS Code's workbench layout system and editor management architecture. The workbench layout defines how the main UI parts (sidebar, panel, editor area, etc.) are arranged and sized, while editor management handles the lifecycle and organization of editors within the editor area.\n\nFor information about Monaco Editor's text editing capabilities, see [3](#3). For UI component fundamentals like lists and trees, see [2.3](#2.3).\n\n## Overview\n\nThe workbench layout system consists of two main layers:\n\n1. **Layout Management**: Controls the arrangement and sizing of major workbench parts (sidebar, panel, editor area, auxiliary bar, etc.)\n2. **Editor Management**: Manages editors within the editor area, including grouping, splitting, and lifecycle operations\n\nThe system uses a grid-based layout with serializable state that persists across sessions.\n\n## Layout Architecture\n\n### Core Layout Components\n\n```mermaid\ngraph TB\n    subgraph \"Workbench Container\"\n        Layout[\"Layout\u003cbr/\u003e(layout.ts)\"]\n        \n        subgraph \"Workbench Parts\"\n            TitleBar[\"TitleBar Part\"]\n            Banner[\"Banner Part\"]\n            ActivityBar[\"ActivityBar Part\"]\n            SideBar[\"SideBar Part\"]\n            EditorPart[\"EditorPart\u003cbr/\u003e(editorPart.ts)\"]\n            Panel[\"Panel Part\"]\n            AuxiliaryBar[\"AuxiliaryBar Part\"]\n            StatusBar[\"StatusBar Part\"]\n        end\n        \n        subgraph \"Layout Grid\"\n            SerializableGrid[\"SerializableGrid\u003cbr/\u003e(grid.ts)\"]\n            GridViews[\"ISerializableView[]\"]\n        end\n    end\n    \n    Layout --\u003e SerializableGrid\n    SerializableGrid --\u003e GridViews\n    GridViews --\u003e TitleBar\n    GridViews --\u003e Banner\n    GridViews --\u003e ActivityBar\n    GridViews --\u003e SideBar\n    GridViews --\u003e EditorPart\n    GridViews --\u003e Panel\n    GridViews --\u003e AuxiliaryBar\n    GridViews --\u003e StatusBar\n```\n\nThe `Layout` class orchestrates the overall workbench structure, managing eight distinct parts arranged in a serializable grid system.\n\nSources: [src/vs/workbench/browser/layout.ts:138-304](), [src/vs/workbench/browser/parts/editor/editorPart.ts:86-172]()\n\n### Layout State Management\n\n```mermaid\ngraph LR\n    subgraph \"State Management\"\n        LayoutStateModel[\"LayoutStateModel\"]\n        RuntimeState[\"ILayoutRuntimeState\"]\n        InitState[\"ILayoutInitializationState\"]\n        Storage[\"StorageService\"]\n    end\n    \n    subgraph \"Layout Properties\"\n        SidebarPos[\"Sidebar Position\"]\n        PanelPos[\"Panel Position\"]\n        PartVisibility[\"Part Visibility\"]\n        WindowState[\"Window State\"]\n        ZenMode[\"Zen Mode\"]\n    end\n    \n    LayoutStateModel --\u003e RuntimeState\n    LayoutStateModel --\u003e InitState\n    LayoutStateModel --\u003e Storage\n    \n    RuntimeState --\u003e SidebarPos\n    RuntimeState --\u003e PanelPos\n    RuntimeState --\u003e PartVisibility\n    RuntimeState --\u003e WindowState\n    RuntimeState --\u003e ZenMode\n```\n\nThe layout system maintains persistent state through `LayoutStateModel`, tracking part positions, visibility, and special modes like Zen Mode.\n\nSources: [src/vs/workbench/browser/layout.ts:54-95](), [src/vs/workbench/browser/layout.ts:625-744]()\n\n## Editor Management System\n\n### Editor Service Architecture\n\n```mermaid\ngraph TB\n    subgraph \"Editor Services\"\n        EditorService[\"EditorService\u003cbr/\u003e(editorService.ts)\"]\n        EditorGroupsService[\"IEditorGroupsService\"]\n        EditorResolverService[\"IEditorResolverService\"]\n    end\n    \n    subgraph \"Editor Parts\"\n        MainEditorPart[\"MainEditorPart\u003cbr/\u003e(editorPart.ts)\"]\n        AuxEditorPart[\"AuxiliaryEditorPart\"]\n    end\n    \n    subgraph \"Editor Groups\"\n        EditorGroupView1[\"EditorGroupView\u003cbr/\u003e(editorGroupView.ts)\"]\n        EditorGroupView2[\"EditorGroupView\"]\n        EditorGroupViewN[\"EditorGroupView...\"]\n    end\n    \n    subgraph \"Editors\"\n        EditorInput1[\"EditorInput\"]\n        EditorInput2[\"EditorInput\"]\n        EditorInputN[\"EditorInput...\"]\n        EditorPane1[\"EditorPane\"]\n        EditorPane2[\"EditorPane\"]\n    end\n    \n    EditorService --\u003e EditorGroupsService\n    EditorService --\u003e EditorResolverService\n    EditorGroupsService --\u003e MainEditorPart\n    EditorGroupsService --\u003e AuxEditorPart\n    MainEditorPart --\u003e EditorGroupView1\n    MainEditorPart --\u003e EditorGroupView2\n    MainEditorPart --\u003e EditorGroupViewN\n    EditorGroupView1 --\u003e EditorInput1\n    EditorGroupView1 --\u003e EditorInput2\n    EditorGroupView2 --\u003e EditorInputN\n    EditorInput1 --\u003e EditorPane1\n    EditorInput2 --\u003e EditorPane2\n```\n\nThe editor system uses a hierarchical structure where `EditorService` coordinates with `EditorGroupsService` to manage multiple editor parts, each containing multiple editor groups.\n\nSources: [src/vs/workbench/services/editor/browser/editorService.ts:39-96](), [src/vs/workbench/browser/parts/editor/editorPart.ts:86-236]()\n\n### Editor Group Layout\n\n```mermaid\ngraph LR\n    subgraph \"Editor Groups Arrangement\"\n        GridWidget[\"Grid\u003cEditorGroupView\u003e\"]\n        \n        subgraph \"Group 1\"\n            EG1[\"EditorGroupView\"]\n            E1[\"Editor A\"]\n            E2[\"Editor B\"]\n            E3[\"Editor C\"]\n        end\n        \n        subgraph \"Group 2\"\n            EG2[\"EditorGroupView\"]\n            E4[\"Editor D\"]\n            E5[\"Editor E\"]\n        end\n        \n        subgraph \"Group 3\"\n            EG3[\"EditorGroupView\"]\n            E6[\"Editor F\"]\n        end\n    end\n    \n    GridWidget --\u003e EG1\n    GridWidget --\u003e EG2\n    GridWidget --\u003e EG3\n    EG1 --\u003e E1\n    EG1 --\u003e E2\n    EG1 --\u003e E3\n    EG2 --\u003e E4\n    EG2 --\u003e E5\n    EG3 --\u003e E6\n```\n\nEditor groups are arranged using the same grid system as the overall layout, allowing flexible splitting and resizing of editor areas.\n\nSources: [src/vs/workbench/browser/parts/editor/editorPart.ts:154-157](), [src/vs/workbench/browser/parts/editor/editorGroupView.ts:116-175]()\n\n## Key Interfaces and Services\n\n### IWorkbenchLayoutService\n\nThe main interface for layout operations:\n\n| Method | Purpose |\n|--------|---------|\n| `isVisible(part: Parts)` | Check part visibility |\n| `setPartHidden(hidden: boolean, part: Parts)` | Toggle part visibility |\n| `toggleZenMode()` | Enter/exit zen mode |\n| `centerMainEditorLayout(active: boolean)` | Toggle centered editor layout |\n| `setPanelAlignment(alignment: PanelAlignment)` | Set panel alignment |\n\nSources: [src/vs/workbench/services/layout/browser/layoutService.ts:225-398]()\n\n### IEditorGroupsService\n\nManages editor group operations:\n\n| Method | Purpose |\n|--------|---------|\n| `addGroup(location: GroupLocation, direction: GroupDirection)` | Create new editor group |\n| `removeGroup(group: IEditorGroup)` | Remove editor group |\n| `moveGroup(group: IEditorGroup, location: GroupLocation)` | Move group position |\n| `arrangeGroups(arrangement: GroupsArrangement)` | Arrange group layout |\n\nSources: [src/vs/workbench/services/editor/common/editorGroupsService.ts:188-445]()\n\n### EditorGroupView Lifecycle\n\n```mermaid\nsequenceDiagram\n    participant Client\n    participant EditorService\n    participant EditorGroupsService\n    participant EditorGroupView\n    participant EditorInput\n    participant EditorPane\n\n    Client-\u003e\u003eEditorService: openEditor(input, options)\n    EditorService-\u003e\u003eEditorGroupsService: getActiveGroup()\n    EditorGroupsService-\u003e\u003eEditorGroupView: openEditor(input, options)\n    EditorGroupView-\u003e\u003eEditorInput: create/resolve\n    EditorGroupView-\u003e\u003eEditorPane: setInput(input)\n    EditorPane--\u003e\u003eEditorGroupView: onDidFocus\n    EditorGroupView--\u003e\u003eEditorService: onDidActiveEditorChange\n    EditorService--\u003e\u003eClient: editor opened\n```\n\nThe editor opening process involves coordination between multiple services to resolve inputs and create appropriate editor panes.\n\nSources: [src/vs/workbench/browser/parts/editor/editorGroupView.ts:785-950](), [src/vs/workbench/services/editor/browser/editorService.ts:478-629]()\n\n## Layout Persistence and Restoration\n\n### State Serialization\n\nThe layout system persists its state through several mechanisms:\n\n```mermaid\ngraph TD\n    subgraph \"Persistence Layer\"\n        WorkspaceMemento[\"Workspace Memento\u003cbr/\u003e(per workspace)\"]\n        ProfileMemento[\"Profile Memento\u003cbr/\u003e(per user profile)\"]\n        StorageService[\"StorageService\"]\n    end\n    \n    subgraph \"Serialized State\"\n        UIState[\"IEditorPartUIState\"]\n        GridSerialized[\"ISerializedGrid\"]\n        GroupState[\"ISerializedEditorGroupModel\"]\n        LayoutState[\"Layout Configuration\"]\n    end\n    \n    StorageService --\u003e WorkspaceMemento\n    StorageService --\u003e ProfileMemento\n    WorkspaceMemento --\u003e UIState\n    UIState --\u003e GridSerialized\n    UIState --\u003e GroupState\n    ProfileMemento --\u003e LayoutState\n```\n\nDifferent aspects of layout state are persisted at different scopes - workspace-specific state (like open editors) versus user preferences (like part positions).\n\nSources: [src/vs/workbench/browser/parts/editor/editorPart.ts:142-143](), [src/vs/workbench/browser/layout.ts:625-744]()\n\n## Editor Group Management\n\n### Group Operations\n\n```mermaid\ngraph LR\n    subgraph \"Group Operations\"\n        Split[\"splitEditor()\"]\n        Merge[\"mergeGroup()\"]\n        Move[\"moveGroup()\"]\n        Close[\"closeGroup()\"]\n    end\n    \n    subgraph \"Group Directions\"\n        Up[\"GroupDirection.UP\"]\n        Down[\"GroupDirection.DOWN\"]\n        Left[\"GroupDirection.LEFT\"]\n        Right[\"GroupDirection.RIGHT\"]\n    end\n    \n    subgraph \"Group Arrangements\"\n        Maximize[\"MAXIMIZE\"]\n        Expand[\"EXPAND\"]\n        Even[\"EVEN\"]\n    end\n    \n    Split --\u003e Up\n    Split --\u003e Down\n    Split --\u003e Left\n    Split --\u003e Right\n    \n    Merge --\u003e Move\n    Move --\u003e Maximize\n    Move --\u003e Expand\n    Move --\u003e Even\n```\n\nEditor groups support various operations for splitting, merging, and arranging editors in the workspace.\n\nSources: [src/vs/workbench/services/editor/common/editorGroupsService.ts:23-40](), [src/vs/workbench/services/editor/common/editorGroupsService.ts:47-64]()\n\n### Editor Input Management\n\nEach `EditorGroupView` manages a collection of `EditorInput` instances:\n\n| Component | Responsibility |\n|-----------|----------------|\n| `EditorGroupModel` | Tracks editor state and order |\n| `EditorTitleControl` | Renders tabs and title area |\n| `EditorPanes` | Manages editor pane instances |\n| `EditorDropTarget` | Handles drag \u0026 drop operations |\n\nSources: [src/vs/workbench/browser/parts/editor/editorGroupView.ts:116-247]()\n\n## Configuration and Customization\n\nThe layout system exposes numerous configuration options through VS Code's settings:\n\n### Layout Settings\n\n```typescript\ninterface IEditorPartOptions {\n  showTabs: 'multiple' | 'single' | 'none';\n  tabSizing: 'fit' | 'shrink' | 'fixed';\n  splitOnDragAndDrop: boolean;\n  centeredLayoutFixedWidth: boolean;\n  // ... many more options\n}\n```\n\n### Key Configuration Properties\n\n| Setting | Purpose | Default |\n|---------|---------|---------|\n| `workbench.editor.showTabs` | Tab display mode | `'multiple'` |\n| `workbench.sideBar.location` | Sidebar position | `'left'` |\n| `workbench.panel.defaultLocation` | Panel position | `'bottom'` |\n| `workbench.editor.splitSizing` | Split editor sizing | `'auto'` |\n\nSources: [src/vs/workbench/browser/parts/editor/editor.ts:31-149](), [src/vs/workbench/browser/workbench.contribution.ts:49-383]()\n\nThis architecture provides a flexible, extensible system for managing VS Code's complex UI layout while maintaining performance and user experience across different workflows and window configurations."])</script>
    <script>self.__next_f.push([1, "1a:T3991,"])</script>
    <script>self.__next_f.push([1, "# UI Components: Lists and Trees\n\n\u003cdetails\u003e\n\u003csummary\u003eRelevant source files\u003c/summary\u003e\n\nThe following files were used as context for generating this wiki page:\n\n- [src/vs/base/browser/ui/list/list.ts](src/vs/base/browser/ui/list/list.ts)\n- [src/vs/base/browser/ui/list/listPaging.ts](src/vs/base/browser/ui/list/listPaging.ts)\n- [src/vs/base/browser/ui/list/listView.ts](src/vs/base/browser/ui/list/listView.ts)\n- [src/vs/base/browser/ui/list/listWidget.ts](src/vs/base/browser/ui/list/listWidget.ts)\n- [src/vs/base/browser/ui/list/splice.ts](src/vs/base/browser/ui/list/splice.ts)\n- [src/vs/base/browser/ui/tree/abstractTree.ts](src/vs/base/browser/ui/tree/abstractTree.ts)\n- [src/vs/base/browser/ui/tree/asyncDataTree.ts](src/vs/base/browser/ui/tree/asyncDataTree.ts)\n- [src/vs/base/browser/ui/tree/compressedObjectTreeModel.ts](src/vs/base/browser/ui/tree/compressedObjectTreeModel.ts)\n- [src/vs/base/browser/ui/tree/dataTree.ts](src/vs/base/browser/ui/tree/dataTree.ts)\n- [src/vs/base/browser/ui/tree/indexTree.ts](src/vs/base/browser/ui/tree/indexTree.ts)\n- [src/vs/base/browser/ui/tree/indexTreeModel.ts](src/vs/base/browser/ui/tree/indexTreeModel.ts)\n- [src/vs/base/browser/ui/tree/objectTree.ts](src/vs/base/browser/ui/tree/objectTree.ts)\n- [src/vs/base/browser/ui/tree/objectTreeModel.ts](src/vs/base/browser/ui/tree/objectTreeModel.ts)\n- [src/vs/base/browser/ui/tree/tree.ts](src/vs/base/browser/ui/tree/tree.ts)\n- [src/vs/base/test/browser/ui/tree/asyncDataTree.test.ts](src/vs/base/test/browser/ui/tree/asyncDataTree.test.ts)\n- [src/vs/base/test/browser/ui/tree/compressedObjectTreeModel.test.ts](src/vs/base/test/browser/ui/tree/compressedObjectTreeModel.test.ts)\n- [src/vs/base/test/browser/ui/tree/indexTreeModel.test.ts](src/vs/base/test/browser/ui/tree/indexTreeModel.test.ts)\n- [src/vs/base/test/browser/ui/tree/objectTree.test.ts](src/vs/base/test/browser/ui/tree/objectTree.test.ts)\n- [src/vs/base/test/browser/ui/tree/objectTreeModel.test.ts](src/vs/base/test/browser/ui/tree/objectTreeModel.test.ts)\n- [src/vs/platform/list/browser/listService.ts](src/vs/platform/list/browser/listService.ts)\n- [src/vs/workbench/browser/actions/listCommands.ts](src/vs/workbench/browser/actions/listCommands.ts)\n\n\u003c/details\u003e\n\n\n\nThis document covers the foundational list and tree UI components that provide the scrollable, interactive data display widgets used throughout VS Code. These components handle virtualized rendering, keyboard navigation, drag-and-drop, filtering, and selection management for hierarchical and flat data structures.\n\nFor workbench-specific list usage patterns, see [Workbench Layout and Editor Management](#2.2). For the Monaco editor's internal tree structures, see [Monaco Editor](#3).\n\n## Architecture Overview\n\nThe list and tree system is built on a layered architecture where base components provide core functionality, specialized implementations add specific behaviors, and platform services manage integration with the broader workbench.\n\n### Component Hierarchy\n\n```mermaid\ngraph TB\n    subgraph \"Core Abstractions\"\n        ListView[\"ListView\u003cT\u003e\"]\n        AbstractTree[\"AbstractTree\u003cT, TFilterData, TRef\u003e\"]\n        IListRenderer[\"IListRenderer\u003cT, TTemplateData\u003e\"]\n        ITreeRenderer[\"ITreeRenderer\u003cT, TFilterData, TTemplateData\u003e\"]\n    end\n    \n    subgraph \"List Implementations\"\n        List[\"List\u003cT\u003e\"]\n        PagedList[\"PagedList\u003cT\u003e\"]\n        Table[\"Table\u003cTRow\u003e\"]\n    end\n    \n    subgraph \"Tree Implementations\"\n        ObjectTree[\"ObjectTree\u003cT, TFilterData\u003e\"]\n        DataTree[\"DataTree\u003cTInput, T, TFilterData\u003e\"]\n        AsyncDataTree[\"AsyncDataTree\u003cTInput, T, TFilterData\u003e\"]\n        IndexTree[\"IndexTree\u003cT, TFilterData\u003e\"]\n        CompressibleObjectTree[\"CompressibleObjectTree\u003cT, TFilterData\u003e\"]\n    end\n    \n    subgraph \"Workbench Integration\"\n        WorkbenchList[\"WorkbenchList\u003cT\u003e\"]\n        WorkbenchTree[\"WorkbenchObjectTree\u003cT, TFilterData\u003e\"]\n        ListService[\"ListService\"]\n    end\n    \n    ListView --\u003e List\n    ListView --\u003e PagedList\n    ListView --\u003e Table\n    \n    AbstractTree --\u003e ObjectTree\n    AbstractTree --\u003e DataTree\n    AbstractTree --\u003e AsyncDataTree\n    AbstractTree --\u003e IndexTree\n    AbstractTree --\u003e CompressibleObjectTree\n    \n    List --\u003e WorkbenchList\n    ObjectTree --\u003e WorkbenchTree\n    \n    ListService --\u003e WorkbenchList\n    ListService --\u003e WorkbenchTree\n    \n    IListRenderer -.-\u003e ListView\n    ITreeRenderer -.-\u003e AbstractTree\n```\n\nSources: [src/vs/base/browser/ui/list/listWidget.ts:254-383](), [src/vs/base/browser/ui/tree/abstractTree.ts:1087-1228](), [src/vs/platform/list/browser/listService.ts:254-383]()\n\n### Data Flow Architecture\n\n```mermaid\ngraph LR\n    subgraph \"Data Sources\"\n        DS[\"IDataSource\u003cTInput, T\u003e\"]\n        ADS[\"IAsyncDataSource\u003cTInput, T\u003e\"]\n        Elements[\"Raw Elements\"]\n    end\n    \n    subgraph \"Models\"\n        ITM[\"IndexTreeModel\u003cT, TFilterData\u003e\"]\n        OTM[\"ObjectTreeModel\u003cT, TFilterData\u003e\"]\n        COTM[\"CompressedObjectTreeModel\u003cT, TFilterData\u003e\"]\n    end\n    \n    subgraph \"Views\"\n        LV[\"ListView\u003cT\u003e\"]\n        AT[\"AbstractTree\u003cT, TFilterData, TRef\u003e\"]\n    end\n    \n    subgraph \"Renderers\"\n        LR[\"IListRenderer\u003cT, TTemplateData\u003e\"]\n        TR[\"ITreeRenderer\u003cT, TFilterData, TTemplateData\u003e\"]\n    end\n    \n    subgraph \"Virtual Scroll\"\n        RangeMap[\"RangeMap\"]\n        RowCache[\"RowCache\u003cT\u003e\"]\n    end\n    \n    DS --\u003e OTM\n    ADS --\u003e OTM\n    Elements --\u003e ITM\n    \n    ITM --\u003e AT\n    OTM --\u003e AT\n    COTM --\u003e AT\n    \n    Elements --\u003e LV\n    \n    AT --\u003e TR\n    LV --\u003e LR\n    \n    LV --\u003e RangeMap\n    LV --\u003e RowCache\n    AT --\u003e RangeMap\n    AT --\u003e RowCache\n```\n\nSources: [src/vs/base/browser/ui/tree/tree.ts:206-216](), [src/vs/base/browser/ui/tree/indexTreeModel.ts:92-142](), [src/vs/base/browser/ui/list/listView.ts:288-472]()\n\n## Core List Components\n\n### ListView\n\n`ListView` is the foundational virtual scrolling component that efficiently renders large datasets by only creating DOM elements for visible items.\n\n**Key Responsibilities:**\n- Virtual scrolling with `RangeMap` for position calculations\n- Drag and drop operations via `IListViewDragAndDrop`\n- Template-based rendering through `IListRenderer`\n- Keyboard and mouse event handling\n\n```mermaid\ngraph LR\n    subgraph \"ListView Internals\"\n        LV[ListView]\n        RM[RangeMap]\n        RC[RowCache]\n        SE[SmoothScrollableElement]\n    end\n    \n    subgraph \"External Contracts\"\n        VD[IListVirtualDelegate]\n        LR[IListRenderer]\n        DND[IListViewDragAndDrop]\n    end\n    \n    LV --\u003e RM\n    LV --\u003e RC\n    LV --\u003e SE\n    \n    VD --\u003e LV\n    LR --\u003e LV\n    DND --\u003e LV\n```\n\nSources: [src/vs/base/browser/ui/list/listView.ts:288-472](), [src/vs/base/browser/ui/list/listWidget.ts:254-383]()\n\n### List Widget\n\nThe `List` class extends `ListView` with higher-level features like selection management, focus handling, and keyboard navigation.\n\n**Key Features:**\n- Selection and focus management via `Trait\u003cT\u003e` classes\n- Type-ahead navigation through `TypeNavigationController`\n- Multiple selection support with configurable modifiers\n- Integration with accessibility providers\n\nSources: [src/vs/base/browser/ui/list/listWidget.ts:117-200](), [src/vs/base/browser/ui/list/listWidget.ts:450-596]()\n\n### PagedList\n\n`PagedList` provides on-demand loading for large datasets through the `IPagedModel` interface.\n\n**Implementation Pattern:**\n- Wraps renderers with `PagedRenderer` to handle placeholder rendering\n- Uses `CancellationTokenSource` for request management\n- Resolves data asynchronously while maintaining UI responsiveness\n\nSources: [src/vs/base/browser/ui/list/listPaging.ts:26-71]()\n\n## Tree Components\n\n### AbstractTree\n\n`AbstractTree` provides the foundation for all tree implementations, handling common tree operations like expansion, collapse, and hierarchical navigation.\n\n**Core Features:**\n- Tree model abstraction via `ITreeModel\u003cT, TFilterData, TRef\u003e`\n- Find functionality with `FindController` and `IFindFilter`\n- Sticky scroll support for keeping parent nodes visible\n- Indent guides and twistie rendering\n\n```mermaid\ngraph TB\n    subgraph \"AbstractTree Structure\"\n        AT[\"AbstractTree\u003cT, TFilterData, TRef\u003e\"]\n        TM[\"ITreeModel\u003cT, TFilterData, TRef\u003e\"]\n        FC[\"FindController\u003cT, TFilterData\u003e\"]\n        TR[\"TreeRenderer\u003cT, TFilterData, TRef, TTemplateData\u003e\"]\n    end\n    \n    subgraph \"Navigation\"\n        TN[\"TreeNavigator\u003cT\u003e\"]\n        SS[\"StickyScrollDelegate\"]\n    end\n    \n    subgraph \"Filtering\"\n        FF[\"IFindFilter\u003cT\u003e\"]\n        TF[\"ITreeFilter\u003cT, TFilterData\u003e\"]\n    end\n    \n    AT --\u003e TM\n    AT --\u003e FC\n    AT --\u003e TR\n    AT --\u003e TN\n    AT --\u003e SS\n    \n    FC --\u003e FF\n    FC --\u003e TF\n```\n\nSources: [src/vs/base/browser/ui/tree/abstractTree.ts:1087-1228](), [src/vs/base/browser/ui/tree/abstractTree.ts:335-577]()\n\n### ObjectTree\n\n`ObjectTree` manages tree structures where each node is a distinct object, using `ObjectTreeModel` for data management.\n\n**Key Operations:**\n- `setChildren(element, children, options)` for tree updates\n- `rerender(element)` for visual refresh without data changes\n- `resort(element, recursive)` for sorting operations\n- Element-based navigation and selection\n\nSources: [src/vs/base/browser/ui/tree/objectTree.ts:38-87]()\n\n### AsyncDataTree\n\n`AsyncDataTree` handles asynchronous data loading with loading states and error handling.\n\n**Async Features:**\n- `IAsyncDataSource` for promise-based data fetching\n- Loading indicators via twistie state management\n- Cancellation support for in-flight requests\n- Stale node detection and refresh logic\n\n```mermaid\ngraph LR\n    subgraph \"AsyncDataTree Flow\"\n        ADT[AsyncDataTree]\n        ADS[IAsyncDataSource]\n        Node[IAsyncDataTreeNode]\n        Promise[refreshPromise]\n    end\n    \n    subgraph \"State Management\"\n        Stale[stale: boolean]\n        Slow[slow: boolean]\n        Loading[Loading Twistie]\n    end\n    \n    ADT --\u003e ADS\n    ADS --\u003e Promise\n    Promise --\u003e Node\n    \n    Node --\u003e Stale\n    Node --\u003e Slow\n    Slow --\u003e Loading\n```\n\nSources: [src/vs/base/browser/ui/tree/asyncDataTree.ts:522-600](), [src/vs/base/browser/ui/tree/asyncDataTree.ts:30-59]()\n\n### CompressibleObjectTree\n\n`CompressibleObjectTree` automatically compresses single-child chains into compact representations, useful for file system trees.\n\n**Compression Logic:**\n- `compress()` function collapses single-child chains\n- `decompress()` expands compressed nodes for rendering\n- `ICompressedTreeNode\u003cT\u003e` contains element arrays\n- `ITreeCompressionDelegate` controls compression behavior\n\nSources: [src/vs/base/browser/ui/tree/compressedObjectTreeModel.ts:38-99](), [src/vs/base/browser/ui/tree/objectTree.ts:88-200]()\n\n## Tree Models and Data Management\n\n### Model Hierarchy\n\n```mermaid\ngraph TB\n    subgraph \"Model Interfaces\"\n        ITM_I[\"ITreeModel\u003cT, TFilterData, TRef\u003e\"]\n        IOTM_I[\"IObjectTreeModel\u003cT, TFilterData\u003e\"]\n    end\n    \n    subgraph \"Model Implementations\"\n        ITM[\"IndexTreeModel\u003cT, TFilterData\u003e\"]\n        OTM[\"ObjectTreeModel\u003cT, TFilterData\u003e\"]\n        COTM[\"CompressedObjectTreeModel\u003cT, TFilterData\u003e\"]\n    end\n    \n    subgraph \"Tree Operations\"\n        Splice[\"splice(location, deleteCount, toInsert)\"]\n        SetChildren[\"setChildren(element, children)\"]\n        Collapse[\"setCollapsed(location, collapsed)\"]\n    end\n    \n    ITM_I --\u003e ITM\n    IOTM_I --\u003e OTM\n    IOTM_I --\u003e COTM\n    \n    ITM --\u003e Splice\n    OTM --\u003e SetChildren\n    OTM --\u003e Collapse\n```\n\nSources: [src/vs/base/browser/ui/tree/tree.ts:133-160](), [src/vs/base/browser/ui/tree/objectTreeModel.ts:14-26]()\n\n### IndexTreeModel\n\n`IndexTreeModel` manages tree structure using array-based indexing for fast lookups and modifications.\n\n**Key Features:**\n- Location-based addressing via `number[]` paths\n- Efficient splicing operations with diff algorithms\n- Filter support with `TreeVisibility` states\n- Event-driven updates for view synchronization\n\nSources: [src/vs/base/browser/ui/tree/indexTreeModel.ts:92-160]()\n\n### ObjectTreeModel\n\n`ObjectTreeModel` provides object-centric tree management with identity-based operations.\n\n**Identity Management:**\n- `IIdentityProvider\u003cT\u003e` for stable node identification\n- Preserve collapse state across updates\n- Sorting support via `ITreeSorter\u003cT\u003e`\n- Optimized diffing for large tree updates\n\nSources: [src/vs/base/browser/ui/tree/objectTreeModel.ts:27-128]()\n\n## Platform Integration\n\n### ListService\n\n`ListService` manages all list and tree instances within the workbench, providing centralized access and context key management.\n\n**Service Responsibilities:**\n- Track `lastFocusedList` for command targeting\n- Manage context keys for keybindings\n- Coordinate focus between multiple list instances\n- Integrate with accessibility and theming systems\n\n```mermaid\ngraph LR\n    subgraph \"ListService Management\"\n        LS[ListService]\n        Registry[IRegisteredList[]]\n        LastFocused[lastFocusedWidget]\n    end\n    \n    subgraph \"Context Keys\"\n        Focus[WorkbenchListFocusContextKey]\n        Selection[WorkbenchListHasSelectionOrFocus]\n        MultiSelect[WorkbenchListSupportsMultiSelectContextKey]\n    end\n    \n    subgraph \"Workbench Lists\"\n        WL[WorkbenchList]\n        WOT[WorkbenchObjectTree]\n        WAD[WorkbenchAsyncDataTree]\n    end\n    \n    LS --\u003e Registry\n    LS --\u003e LastFocused\n    LS --\u003e Focus\n    LS --\u003e Selection\n    LS --\u003e MultiSelect\n    \n    WL --\u003e LS\n    WOT --\u003e LS\n    WAD --\u003e LS\n```\n\nSources: [src/vs/platform/list/browser/listService.ts:53-106](), [src/vs/platform/list/browser/listService.ts:108-130]()\n\n### Workbench Integration\n\nWorkbench-specific list classes add configuration management, styling, and command integration.\n\n**Integration Features:**\n- Configuration service binding for user preferences\n- Theme integration via `getListStyles()`\n- Keybinding service integration for navigation\n- Resource navigator for file operations\n\nSources: [src/vs/platform/list/browser/listService.ts:254-383](), [src/vs/platform/list/browser/listService.ts:512-600]()\n\n## Rendering and Performance\n\n### Virtual Scrolling\n\nThe virtual scrolling system optimizes performance for large datasets by only rendering visible elements.\n\n**Performance Components:**\n- `RangeMap` calculates item positions and visible ranges\n- `RowCache` manages template reuse and disposal\n- Dynamic height support for variable-sized items\n- Smooth scrolling with `SmoothScrollableElement`\n\n### Template System\n\nThe renderer system uses a template-based approach for efficient DOM management.\n\n**Renderer Pattern:**\n- `renderTemplate()` creates reusable DOM structure\n- `renderElement()` populates template with data\n- `disposeTemplate()` cleans up resources\n- Template pooling reduces allocation overhead\n\nSources: [src/vs/base/browser/ui/list/list.ts:25-31](), [src/vs/base/browser/ui/tree/tree.ts:166-171]()"])</script>
    <script>self.__next_f.push([1, "1b:T630c,"])</script>
    <script>self.__next_f.push([1, "# Monaco Editor\n\n\u003cdetails\u003e\n\u003csummary\u003eRelevant source files\u003c/summary\u003e\n\nThe following files were used as context for generating this wiki page:\n\n- [build/monaco/monaco.d.ts.recipe](build/monaco/monaco.d.ts.recipe)\n- [extensions/vscode-colorize-perf-tests/test/colorize-fixtures/test-treeView.ts](extensions/vscode-colorize-perf-tests/test/colorize-fixtures/test-treeView.ts)\n- [src/vs/editor/browser/config/charWidthReader.ts](src/vs/editor/browser/config/charWidthReader.ts)\n- [src/vs/editor/browser/editorBrowser.ts](src/vs/editor/browser/editorBrowser.ts)\n- [src/vs/editor/browser/view/domLineBreaksComputer.ts](src/vs/editor/browser/view/domLineBreaksComputer.ts)\n- [src/vs/editor/browser/view/renderingContext.ts](src/vs/editor/browser/view/renderingContext.ts)\n- [src/vs/editor/browser/viewParts/contentWidgets/contentWidgets.ts](src/vs/editor/browser/viewParts/contentWidgets/contentWidgets.ts)\n- [src/vs/editor/browser/viewParts/margin/margin.ts](src/vs/editor/browser/viewParts/margin/margin.ts)\n- [src/vs/editor/browser/viewParts/minimap/minimap.ts](src/vs/editor/browser/viewParts/minimap/minimap.ts)\n- [src/vs/editor/browser/viewParts/minimap/minimapCharRenderer.ts](src/vs/editor/browser/viewParts/minimap/minimapCharRenderer.ts)\n- [src/vs/editor/browser/viewParts/minimap/minimapCharRendererFactory.ts](src/vs/editor/browser/viewParts/minimap/minimapCharRendererFactory.ts)\n- [src/vs/editor/browser/viewParts/minimap/minimapCharSheet.ts](src/vs/editor/browser/viewParts/minimap/minimapCharSheet.ts)\n- [src/vs/editor/browser/viewParts/minimap/minimapPreBaked.ts](src/vs/editor/browser/viewParts/minimap/minimapPreBaked.ts)\n- [src/vs/editor/browser/viewParts/overlayWidgets/overlayWidgets.ts](src/vs/editor/browser/viewParts/overlayWidgets/overlayWidgets.ts)\n- [src/vs/editor/browser/viewParts/overviewRuler/decorationsOverviewRuler.ts](src/vs/editor/browser/viewParts/overviewRuler/decorationsOverviewRuler.ts)\n- [src/vs/editor/browser/viewParts/scrollDecoration/scrollDecoration.ts](src/vs/editor/browser/viewParts/scrollDecoration/scrollDecoration.ts)\n- [src/vs/editor/browser/viewParts/viewCursors/viewCursor.ts](src/vs/editor/browser/viewParts/viewCursors/viewCursor.ts)\n- [src/vs/editor/browser/viewParts/viewCursors/viewCursors.ts](src/vs/editor/browser/viewParts/viewCursors/viewCursors.ts)\n- [src/vs/editor/browser/viewParts/viewZones/viewZones.ts](src/vs/editor/browser/viewParts/viewZones/viewZones.ts)\n- [src/vs/editor/browser/widget/codeEditor/codeEditorWidget.ts](src/vs/editor/browser/widget/codeEditor/codeEditorWidget.ts)\n- [src/vs/editor/common/config/editorOptions.ts](src/vs/editor/common/config/editorOptions.ts)\n- [src/vs/editor/common/config/fontInfo.ts](src/vs/editor/common/config/fontInfo.ts)\n- [src/vs/editor/common/editorCommon.ts](src/vs/editor/common/editorCommon.ts)\n- [src/vs/editor/common/model.ts](src/vs/editor/common/model.ts)\n- [src/vs/editor/common/model/guidesTextModelPart.ts](src/vs/editor/common/model/guidesTextModelPart.ts)\n- [src/vs/editor/common/model/textModel.ts](src/vs/editor/common/model/textModel.ts)\n- [src/vs/editor/common/standalone/standaloneEnums.ts](src/vs/editor/common/standalone/standaloneEnums.ts)\n- [src/vs/editor/common/textModelGuides.ts](src/vs/editor/common/textModelGuides.ts)\n- [src/vs/editor/common/viewLayout/linesLayout.ts](src/vs/editor/common/viewLayout/linesLayout.ts)\n- [src/vs/editor/common/viewLayout/viewLayout.ts](src/vs/editor/common/viewLayout/viewLayout.ts)\n- [src/vs/editor/common/viewLayout/viewLinesViewportData.ts](src/vs/editor/common/viewLayout/viewLinesViewportData.ts)\n- [src/vs/editor/common/viewModel.ts](src/vs/editor/common/viewModel.ts)\n- [src/vs/editor/common/viewModel/minimapTokensColorTracker.ts](src/vs/editor/common/viewModel/minimapTokensColorTracker.ts)\n- [src/vs/editor/common/viewModel/modelLineProjection.ts](src/vs/editor/common/viewModel/modelLineProjection.ts)\n- [src/vs/editor/common/viewModel/monospaceLineBreaksComputer.ts](src/vs/editor/common/viewModel/monospaceLineBreaksComputer.ts)\n- [src/vs/editor/common/viewModel/viewModelDecorations.ts](src/vs/editor/common/viewModel/viewModelDecorations.ts)\n- [src/vs/editor/common/viewModel/viewModelImpl.ts](src/vs/editor/common/viewModel/viewModelImpl.ts)\n- [src/vs/editor/common/viewModel/viewModelLines.ts](src/vs/editor/common/viewModel/viewModelLines.ts)\n- [src/vs/editor/standalone/browser/standaloneCodeEditor.ts](src/vs/editor/standalone/browser/standaloneCodeEditor.ts)\n- [src/vs/editor/standalone/browser/standaloneEditor.ts](src/vs/editor/standalone/browser/standaloneEditor.ts)\n- [src/vs/editor/test/browser/view/minimapCharRenderer.test.ts](src/vs/editor/test/browser/view/minimapCharRenderer.test.ts)\n- [src/vs/editor/test/browser/viewModel/modelLineProjection.test.ts](src/vs/editor/test/browser/viewModel/modelLineProjection.test.ts)\n- [src/vs/editor/test/common/model/modelInjectedText.test.ts](src/vs/editor/test/common/model/modelInjectedText.test.ts)\n- [src/vs/editor/test/common/viewLayout/linesLayout.test.ts](src/vs/editor/test/common/viewLayout/linesLayout.test.ts)\n- [src/vs/editor/test/common/viewModel/lineBreakData.test.ts](src/vs/editor/test/common/viewModel/lineBreakData.test.ts)\n- [src/vs/editor/test/common/viewModel/monospaceLineBreaksComputer.test.ts](src/vs/editor/test/common/viewModel/monospaceLineBreaksComputer.test.ts)\n- [src/vs/monaco.d.ts](src/vs/monaco.d.ts)\n\n\u003c/details\u003e\n\n\n\nThis document covers the Monaco Editor system, which serves as the core text editor engine that powers VS Code's editing experience. Monaco Editor provides a rich, feature-complete code editor that can be embedded in web applications or used as a standalone component.\n\nFor information about the overall VS Code architecture, see [VS Code Architecture Overview](#1). For details about the extension system that builds upon Monaco Editor, see [Extension System](#4).\n\n## Overview and Architecture\n\nMonaco Editor implements a Model-View-ViewModel (MVVM) architecture that separates document representation, visual presentation, and user interaction concerns. The system is designed to handle large files efficiently while providing rich editing features like syntax highlighting, IntelliSense, and advanced text manipulation.\n\n```mermaid\ngraph TB\n    subgraph \"Public API Layer\"\n        MonacoAPI[\"monaco namespace\u003cbr/\u003emonaco.d.ts\"]\n        StandaloneEditor[\"StandaloneEditor\u003cbr/\u003estandaloneEditor.ts\"]\n        EditorAPI[\"monaco.editor.create()\"]\n    end\n    \n    subgraph \"Editor Core\"\n        CodeEditorWidget[\"CodeEditorWidget\u003cbr/\u003ecodeEditorWidget.ts\"]\n        EditorConfiguration[\"EditorConfiguration\u003cbr/\u003eeditorConfiguration.ts\"]\n        EditorOptions[\"EditorOptions\u003cbr/\u003eeditorOptions.ts\"]\n    end\n    \n    subgraph \"Model Layer\"\n        TextModel[\"TextModel\u003cbr/\u003etextModel.ts\"]\n        TextBuffer[\"PieceTreeTextBuffer\u003cbr/\u003epieceTreeTextBuffer.ts\"]\n        ModelServices[\"IModelService\"]\n    end\n    \n    subgraph \"View Model Layer\"\n        ViewModel[\"ViewModel\u003cbr/\u003eviewModelImpl.ts\"]\n        ViewModelLines[\"ViewModelLines\u003cbr/\u003eviewModelLines.ts\"]\n        LineProjection[\"ModelLineProjection\u003cbr/\u003emodelLineProjection.ts\"]\n        LineBreaksComputer[\"LineBreaksComputer\u003cbr/\u003edomLineBreaksComputer.ts\"]\n    end\n    \n    subgraph \"View Layer\"\n        ViewParts[\"View Parts\"]\n        Minimap[\"Minimap\u003cbr/\u003eminimap.ts\"]\n        ContentWidgets[\"ContentWidgets\u003cbr/\u003econtentWidgets.ts\"]\n        ViewCursors[\"ViewCursors\u003cbr/\u003eviewCursors.ts\"]\n        OverviewRuler[\"OverviewRuler\u003cbr/\u003edecorationsOverviewRuler.ts\"]\n    end\n    \n    MonacoAPI --\u003e StandaloneEditor\n    StandaloneEditor --\u003e CodeEditorWidget\n    EditorAPI --\u003e CodeEditorWidget\n    CodeEditorWidget --\u003e EditorConfiguration\n    CodeEditorWidget --\u003e ViewModel\n    CodeEditorWidget --\u003e ViewParts\n    \n    ViewModel --\u003e TextModel\n    ViewModel --\u003e ViewModelLines\n    ViewModelLines --\u003e LineProjection\n    ViewModelLines --\u003e LineBreaksComputer\n    \n    TextModel --\u003e TextBuffer\n    TextModel --\u003e ModelServices\n    \n    ViewParts --\u003e Minimap\n    ViewParts --\u003e ContentWidgets\n    ViewParts --\u003e ViewCursors\n    ViewParts --\u003e OverviewRuler\n```\n\nSources: [src/vs/monaco.d.ts:1-50](), [src/vs/editor/standalone/browser/standaloneEditor.ts:1-100](), [src/vs/editor/browser/widget/codeEditor/codeEditorWidget.ts:1-100](), [src/vs/editor/common/viewModel/viewModelImpl.ts:1-100]()\n\n## Text Model System\n\nThe text model system represents the underlying document content and provides efficient text manipulation capabilities. The `TextModel` class serves as the primary interface for document operations, while the `PieceTreeTextBuffer` handles the actual text storage using a piece table data structure for efficient insertions and deletions.\n\n```mermaid\ngraph TB\n    subgraph \"Text Model Core\"\n        ITextModel[\"ITextModel\u003cbr/\u003eInterface\"]\n        TextModel[\"TextModel\u003cbr/\u003etextModel.ts\"]\n        TextBuffer[\"ITextBuffer\u003cbr/\u003eInterface\"]\n        PieceTreeBuffer[\"PieceTreeTextBuffer\u003cbr/\u003epieceTreeTextBuffer.ts\"]\n    end\n    \n    subgraph \"Model Services\"\n        ModelService[\"IModelService\u003cbr/\u003emodel.ts\"]\n        LanguageService[\"ILanguageService\u003cbr/\u003elanguage.ts\"]\n        UndoRedoService[\"IUndoRedoService\"]\n    end\n    \n    subgraph \"Model Features\"\n        TokenizationPart[\"TokenizationTextModelPart\u003cbr/\u003etokenizationTextModelPart.ts\"]\n        BracketPairs[\"BracketPairsTextModelPart\u003cbr/\u003ebracketPairsImpl.ts\"]\n        GuidesTextModel[\"GuidesTextModelPart\u003cbr/\u003eguidesTextModelPart.ts\"]\n        Decorations[\"ModelDecorations\"]\n    end\n    \n    subgraph \"Edit Operations\"\n        EditStack[\"EditStack\u003cbr/\u003eeditStack.ts\"]\n        EditOperations[\"ISingleEditOperation\"]\n        Commands[\"ICommand\"]\n    end\n    \n    ITextModel --\u003e TextModel\n    TextModel --\u003e TextBuffer\n    TextBuffer --\u003e PieceTreeBuffer\n    \n    TextModel --\u003e ModelService\n    TextModel --\u003e LanguageService\n    TextModel --\u003e UndoRedoService\n    \n    TextModel --\u003e TokenizationPart\n    TextModel --\u003e BracketPairs\n    TextModel --\u003e GuidesTextModel\n    TextModel --\u003e Decorations\n    \n    TextModel --\u003e EditStack\n    EditStack --\u003e EditOperations\n    EditOperations --\u003e Commands\n```\n\nThe `TextModel` class [src/vs/editor/common/model/textModel.ts:180-700]() provides comprehensive document management including:\n\n- **Content Management**: Text insertion, deletion, and replacement operations\n- **Decoration System**: Visual annotations and markers attached to text ranges  \n- **Event System**: Change notifications for content, decorations, and language modifications\n- **Undo/Redo**: Integration with VS Code's undo/redo infrastructure\n- **Language Features**: Tokenization, bracket matching, and indent guides\n\nKey text model interfaces and classes:\n\n| Component | Purpose | Key Methods |\n|-----------|---------|-------------|\n| `ITextModel` | Core document interface | `getValue()`, `setValue()`, `applyEdits()` |\n| `TextModel` | Main implementation | `onDidChangeContent`, `deltaDecorations()` |\n| `PieceTreeTextBuffer` | Efficient text storage | `insert()`, `delete()`, `getValueInRange()` |\n| `EditStack` | Undo/redo management | `pushEditOperation()`, `undo()`, `redo()` |\n\nSources: [src/vs/editor/common/model/textModel.ts:180-500](), [src/vs/editor/common/model.ts:400-800](), [src/vs/editor/common/model/editStack.ts:1-50]()\n\n## View Model and Line Projection\n\nThe view model system transforms the logical text model into a visual representation that handles line wrapping, hidden areas, and injected text. The `ViewModel` class coordinates between the text model and the rendering system, while specialized line projection components handle the complex logic of converting model lines to view lines.\n\n```mermaid\ngraph TB\n    subgraph \"View Model Core\"\n        IViewModel[\"IViewModel\u003cbr/\u003eInterface\"]\n        ViewModel[\"ViewModel\u003cbr/\u003eviewModelImpl.ts\"]\n        ViewModelLines[\"IViewModelLines\u003cbr/\u003eInterface\"]\n    end\n    \n    subgraph \"Line Projection Implementations\"\n        ViewModelLinesFromModel[\"ViewModelLinesFromModelAsIs\u003cbr/\u003eviewModelLines.ts\"]\n        ViewModelLinesFromProjected[\"ViewModelLinesFromProjectedModel\u003cbr/\u003eviewModelLines.ts\"]\n        ModelLineProjection[\"ModelLineProjection\u003cbr/\u003emodelLineProjection.ts\"]\n    end\n    \n    subgraph \"Line Breaking\"\n        ILineBreaksComputer[\"ILineBreaksComputer\u003cbr/\u003eInterface\"]\n        DOMLineBreaksComputer[\"DOMLineBreaksComputer\u003cbr/\u003edomLineBreaksComputer.ts\"]\n        MonospaceLineBreaksComputer[\"MonospaceLineBreaksComputer\u003cbr/\u003emonospaceLineBreaksComputer.ts\"]\n        LineBreaksComputerFactory[\"ILineBreaksComputerFactory\"]\n    end\n    \n    subgraph \"Coordinates and Layout\"\n        CoordinatesConverter[\"ICoordinatesConverter\u003cbr/\u003eInterface\"]\n        ViewLayout[\"ViewLayout\u003cbr/\u003eviewLayout.ts\"]\n        LinesLayout[\"LinesLayout\u003cbr/\u003elinesLayout.ts\"]\n    end\n    \n    IViewModel --\u003e ViewModel\n    ViewModel --\u003e ViewModelLines\n    ViewModel --\u003e CoordinatesConverter\n    ViewModel --\u003e ViewLayout\n    \n    ViewModelLines --\u003e ViewModelLinesFromModel\n    ViewModelLines --\u003e ViewModelLinesFromProjected\n    ViewModelLinesFromProjected --\u003e ModelLineProjection\n    \n    ModelLineProjection --\u003e ILineBreaksComputer\n    ILineBreaksComputer --\u003e DOMLineBreaksComputer\n    ILineBreaksComputer --\u003e MonospaceLineBreaksComputer\n    LineBreaksComputerFactory --\u003e DOMLineBreaksComputer\n    LineBreaksComputerFactory --\u003e MonospaceLineBreaksComputer\n    \n    ViewLayout --\u003e LinesLayout\n```\n\nThe view model handles several critical transformations:\n\n**Line Wrapping**: The `ILineBreaksComputer` implementations [src/vs/editor/browser/view/domLineBreaksComputer.ts:20-50]() and [src/vs/editor/common/viewModel/monospaceLineBreaksComputer.ts:15-30]() calculate where lines should wrap based on:\n- Available width and font metrics\n- Word breaking rules and character classification\n- Wrapping indentation preferences\n- Injected text and decorations\n\n**Coordinate Conversion**: The `ICoordinatesConverter` interface provides bidirectional mapping between:\n- Model positions (line/column in source text)\n- View positions (line/column in wrapped/visual representation)  \n- Screen coordinates (pixel positions)\n\n**Performance Optimization**: For large files, the system uses `ViewModelLinesFromModelAsIs` [src/vs/editor/common/viewModel/viewModelLines.ts:800-900]() which bypasses line wrapping for better performance.\n\nSources: [src/vs/editor/common/viewModel/viewModelImpl.ts:47-200](), [src/vs/editor/common/viewModel/viewModelLines.ts:22-100](), [src/vs/editor/browser/view/domLineBreaksComputer.ts:1-50](), [src/vs/editor/common/viewModel/monospaceLineBreaksComputer.ts:1-30]()\n\n## Editor Configuration System\n\nMonaco Editor provides an extensive configuration system that controls every aspect of editor behavior and appearance. The configuration system uses a type-safe, enumerated approach where each option has a unique identifier and validation logic.\n\n```mermaid\ngraph TB\n    subgraph \"Configuration Types\"\n        IEditorOptions[\"IEditorOptions\u003cbr/\u003eeditorOptions.ts\"]\n        EditorOption[\"EditorOption Enum\u003cbr/\u003e~160 options\"]\n        ConfigurationChangedEvent[\"ConfigurationChangedEvent\u003cbr/\u003echange tracking\"]\n    end\n    \n    subgraph \"Configuration Processing\"\n        EditorConfiguration[\"EditorConfiguration\u003cbr/\u003eeditorConfiguration.ts\"]\n        EditorOptionsComputer[\"Options validation\u003cbr/\u003eand computation\"]\n        EnvironmentalOptions[\"IEnvironmentalOptions\u003cbr/\u003efont, layout info\"]\n    end\n    \n    subgraph \"Font and Layout\"\n        FontInfo[\"FontInfo\u003cbr/\u003efontInfo.ts\"]\n        FontMeasurements[\"FontMeasurements\u003cbr/\u003efontMeasurements.ts\"]\n        EditorLayoutInfo[\"EditorLayoutInfo\u003cbr/\u003ecomputed layout\"]\n    end\n    \n    subgraph \"Specialized Options\"\n        MinimapOptions[\"IEditorMinimapOptions\"]\n        ScrollbarOptions[\"IEditorScrollbarOptions\"]\n        SuggestOptions[\"ISuggestOptions\"]\n        FindOptions[\"IEditorFindOptions\"]\n    end\n    \n    IEditorOptions --\u003e EditorConfiguration\n    EditorOption --\u003e EditorConfiguration\n    EditorConfiguration --\u003e EditorOptionsComputer\n    EditorOptionsComputer --\u003e EnvironmentalOptions\n    \n    EnvironmentalOptions --\u003e FontInfo\n    FontInfo --\u003e FontMeasurements\n    EditorConfiguration --\u003e EditorLayoutInfo\n    \n    IEditorOptions --\u003e MinimapOptions\n    IEditorOptions --\u003e ScrollbarOptions\n    IEditorOptions --\u003e SuggestOptions\n    IEditorOptions --\u003e FindOptions\n    \n    EditorConfiguration --\u003e ConfigurationChangedEvent\n```\n\nThe configuration system operates on several key principles:\n\n**Type Safety**: Each option is defined with specific types and validation. The `EditorOption` enum [src/vs/editor/common/config/editorOptions.ts:176-337]() contains approximately 160 different configuration options, from basic settings like `fontSize` to complex objects like `minimap` configuration.\n\n**Reactive Updates**: When configuration changes, the `ConfigurationChangedEvent` [src/vs/editor/common/config/editorOptions.ts:960-971]() tracks exactly which options changed, allowing components to update efficiently.\n\n**Environment Dependency**: Some options depend on environmental factors like screen density, available space, and font measurements. The `IEnvironmentalOptions` interface [src/vs/editor/common/config/editorOptions.ts:985-1001]() captures these dependencies.\n\nKey configuration categories:\n\n| Category | Key Options | Purpose |\n|----------|-------------|---------|\n| **Font \u0026 Rendering** | `fontFamily`, `fontSize`, `lineHeight` | Text appearance and metrics |\n| **Layout** | `minimap`, `scrollbar`, `rulers` | Editor layout and auxiliary UI |\n| **Behavior** | `wordWrap`, `tabSize`, `autoIndent` | Editing behavior and formatting |\n| **Features** | `suggest`, `hover`, `lightbulb` | IntelliSense and coding assistance |\n| **Accessibility** | `accessibilitySupport`, `screenReaderAnnounceInlineSuggestion` | Screen reader support |\n\nSources: [src/vs/editor/common/config/editorOptions.ts:51-797](), [src/vs/editor/browser/config/editorConfiguration.ts:1-100](), [src/vs/editor/common/config/fontInfo.ts:1-50]()\n\n## Rendering System and View Parts\n\nThe Monaco Editor rendering system is composed of modular view parts that each handle specific visual aspects of the editor. This design allows for efficient updates and customization of different editor regions.\n\n```mermaid\ngraph TB\n    subgraph \"Core Rendering\"\n        ViewPart[\"ViewPart\u003cbr/\u003eBase class\"]\n        RenderingContext[\"RenderingContext\u003cbr/\u003erenderingContext.ts\"]\n        ViewContext[\"ViewContext\u003cbr/\u003eshared state\"]\n    end\n    \n    subgraph \"Content Rendering\"\n        ViewLines[\"ViewLines\u003cbr/\u003emain text content\"]\n        ViewCursors[\"ViewCursors\u003cbr/\u003eviewCursors.ts\"]\n        ViewZones[\"ViewZones\u003cbr/\u003eviewZones.ts\"]\n        ContentWidgets[\"ContentWidgets\u003cbr/\u003econtentWidgets.ts\"]\n    end\n    \n    subgraph \"Margin and Gutter\"\n        LineNumbers[\"LineNumbers\"]\n        GlyphMargin[\"GlyphMargin\"]\n        LinesDecorations[\"LinesDecorations\"]\n        Margin[\"Margin\"]\n    end\n    \n    subgraph \"Auxiliary Views\"\n        Minimap[\"Minimap\u003cbr/\u003eminimap.ts\"]\n        OverviewRuler[\"OverviewRuler\u003cbr/\u003edecorationsOverviewRuler.ts\"]\n        OverlayWidgets[\"OverlayWidgets\u003cbr/\u003eoverlayWidgets.ts\"]\n        Scrollbars[\"Scrollbars\"]\n    end\n    \n    ViewPart --\u003e RenderingContext\n    ViewPart --\u003e ViewContext\n    \n    ViewPart --\u003e ViewLines\n    ViewPart --\u003e ViewCursors\n    ViewPart --\u003e ViewZones\n    ViewPart --\u003e ContentWidgets\n    \n    ViewPart --\u003e LineNumbers\n    ViewPart --\u003e GlyphMargin\n    ViewPart --\u003e LinesDecorations\n    ViewPart --\u003e Margin\n    \n    ViewPart --\u003e Minimap\n    ViewPart --\u003e OverviewRuler\n    ViewPart --\u003e OverlayWidgets\n    ViewPart --\u003e Scrollbars\n```\n\n**View Parts Architecture**: Each view part extends the base `ViewPart` class and implements specific event handlers for configuration changes, model updates, and scroll events. The rendering system uses a two-phase approach:\n\n1. **Event Processing**: View parts receive events and update their internal state\n2. **Rendering**: The `RenderingContext` provides the current viewport and metrics for efficient rendering\n\n**Content Widgets**: The `ContentWidgets` system [src/vs/editor/browser/viewParts/contentWidgets/contentWidgets.ts:25-200]() manages floating UI elements that are positioned relative to text content, such as:\n- IntelliSense suggestion boxes\n- Parameter hints\n- Hover tooltips\n- Error lightbulbs\n\n**Minimap Implementation**: The `Minimap` [src/vs/editor/browser/viewParts/minimap/minimap.ts:100-500]() provides a bird's-eye view of the entire document with several rendering modes:\n- **Text mode**: Renders actual character shapes at small scale\n- **Blocks mode**: Uses colored blocks to represent content\n- **Proportional/Fill/Fit sizing**: Different strategies for minimap dimensions\n\n**Cursor Rendering**: The `ViewCursors` system [src/vs/editor/browser/viewParts/viewCursors/viewCursors.ts:1-100]() handles multiple cursors with various visual styles and animations including blink patterns, smooth movement, and different cursor shapes.\n\nSources: [src/vs/editor/browser/view/viewPart.ts:1-50](), [src/vs/editor/browser/viewParts/contentWidgets/contentWidgets.ts:1-100](), [src/vs/editor/browser/viewParts/minimap/minimap.ts:1-200](), [src/vs/editor/browser/viewParts/viewCursors/viewCursors.ts:1-50]()\n\n## Standalone API and Integration\n\nMonaco Editor provides a comprehensive standalone API that allows embedding the editor in web applications independent of VS Code. The API is exposed through the global `monaco` namespace and provides both high-level convenience methods and low-level customization options.\n\n```mermaid\ngraph TB\n    subgraph \"Public API Surface\"\n        MonacoNamespace[\"monaco namespace\u003cbr/\u003emonaco.d.ts\"]\n        EditorNamespace[\"monaco.editor.*\u003cbr/\u003eeditor API\"]\n        LanguagesNamespace[\"monaco.languages.*\u003cbr/\u003elanguage API\"]\n        MarkerNamespace[\"monaco.markers.*\u003cbr/\u003ediagnostics API\"]\n    end\n    \n    subgraph \"Editor Creation\"\n        CreateEditor[\"monaco.editor.create()\u003cbr/\u003estandaloneEditor.ts\"]\n        CreateDiffEditor[\"monaco.editor.createDiffEditor()\"]\n        StandaloneCodeEditor[\"StandaloneCodeEditor\u003cbr/\u003estandaloneCodeEditor.ts\"]\n        StandaloneDiffEditor[\"StandaloneDiffEditor\"]\n    end\n    \n    subgraph \"Model Management\"\n        CreateModel[\"monaco.editor.createModel()\"]\n        ModelService[\"IModelService\u003cbr/\u003emodel management\"]\n        LanguageSelection[\"ILanguageSelection\u003cbr/\u003elanguage binding\"]\n    end\n    \n    subgraph \"Services and Infrastructure\"\n        StandaloneServices[\"StandaloneServices\u003cbr/\u003estandaloneServices.ts\"]\n        ServiceCollection[\"Service injection\"]\n        ThemeService[\"StandaloneThemeService\u003cbr/\u003estandaloneThemeService.ts\"]\n        KeybindingService[\"StandaloneKeybindingService\"]\n    end\n    \n    MonacoNamespace --\u003e EditorNamespace\n    MonacoNamespace --\u003e LanguagesNamespace\n    MonacoNamespace --\u003e MarkerNamespace\n    \n    EditorNamespace --\u003e CreateEditor\n    EditorNamespace --\u003e CreateDiffEditor\n    CreateEditor --\u003e StandaloneCodeEditor\n    CreateDiffEditor --\u003e StandaloneDiffEditor\n    \n    EditorNamespace --\u003e CreateModel\n    CreateModel --\u003e ModelService\n    CreateModel --\u003e LanguageSelection\n    \n    CreateEditor --\u003e StandaloneServices\n    StandaloneServices --\u003e ServiceCollection\n    StandaloneServices --\u003e ThemeService\n    StandaloneServices --\u003e KeybindingService\n```\n\n**Editor Creation and Lifecycle**: The main entry points are `monaco.editor.create()` and `monaco.editor.createDiffEditor()` [src/vs/editor/standalone/browser/standaloneEditor.ts:48-100](). These functions:\n\n1. Initialize the standalone service container\n2. Create editor instances with specified configuration\n3. Set up event listeners and lifecycle management\n4. Return strongly-typed editor interfaces\n\n**Service Architecture**: The standalone environment uses a dependency injection system through `StandaloneServices` [src/vs/editor/standalone/browser/standaloneServices.ts:1-100](). Key services include:\n\n| Service | Purpose | Implementation |\n|---------|---------|----------------|\n| `IModelService` | Model creation and management | Tracks all text models |\n| `ILanguageService` | Language registration and features | Syntax highlighting, IntelliSense |\n| `IThemeService` | Color themes and styling | `StandaloneThemeService` |\n| `IKeybindingService` | Keyboard shortcuts | `StandaloneKeybindingService` |\n| `IMarkerService` | Error/warning markers | Diagnostic management |\n\n**API Capabilities**: The standalone API provides extensive customization options:\n\n- **Custom Languages**: Register new programming languages with syntax highlighting\n- **Custom Themes**: Define color themes with `monaco.editor.defineTheme()`\n- **Actions and Commands**: Add custom editor actions and keybindings\n- **Web Workers**: Offload language processing to background threads\n- **Markers and Decorations**: Add custom visual annotations\n\n**Integration Examples**:\n```typescript\n// Basic editor creation\nconst editor = monaco.editor.create(document.getElementById('container'), {\n    value: 'console.log(\"Hello Monaco\");',\n    language: 'javascript',\n    theme: 'vs-dark'\n});\n\n// Model management\nconst model = monaco.editor.createModel(content, 'typescript', monaco.Uri.parse('file:///example.ts'));\neditor.setModel(model);\n```\n\nSources: [src/vs/monaco.d.ts:1-100](), [src/vs/editor/standalone/browser/standaloneEditor.ts:1-200](), [src/vs/editor/standalone/browser/standaloneCodeEditor.ts:1-100](), [src/vs/editor/standalone/browser/standaloneServices.ts:1-50]()"])</script>
    <script>self.__next_f.push([1, "1c:T3ede,"])</script>
    <script>self.__next_f.push([1, "# Text Model and View Model\n\n\u003cdetails\u003e\n\u003csummary\u003eRelevant source files\u003c/summary\u003e\n\nThe following files were used as context for generating this wiki page:\n\n- [build/monaco/monaco.d.ts.recipe](build/monaco/monaco.d.ts.recipe)\n- [extensions/vscode-colorize-perf-tests/test/colorize-fixtures/test-treeView.ts](extensions/vscode-colorize-perf-tests/test/colorize-fixtures/test-treeView.ts)\n- [src/vs/editor/browser/config/charWidthReader.ts](src/vs/editor/browser/config/charWidthReader.ts)\n- [src/vs/editor/browser/editorBrowser.ts](src/vs/editor/browser/editorBrowser.ts)\n- [src/vs/editor/browser/view/domLineBreaksComputer.ts](src/vs/editor/browser/view/domLineBreaksComputer.ts)\n- [src/vs/editor/browser/view/renderingContext.ts](src/vs/editor/browser/view/renderingContext.ts)\n- [src/vs/editor/browser/viewParts/contentWidgets/contentWidgets.ts](src/vs/editor/browser/viewParts/contentWidgets/contentWidgets.ts)\n- [src/vs/editor/browser/viewParts/margin/margin.ts](src/vs/editor/browser/viewParts/margin/margin.ts)\n- [src/vs/editor/browser/viewParts/minimap/minimap.ts](src/vs/editor/browser/viewParts/minimap/minimap.ts)\n- [src/vs/editor/browser/viewParts/minimap/minimapCharRenderer.ts](src/vs/editor/browser/viewParts/minimap/minimapCharRenderer.ts)\n- [src/vs/editor/browser/viewParts/minimap/minimapCharRendererFactory.ts](src/vs/editor/browser/viewParts/minimap/minimapCharRendererFactory.ts)\n- [src/vs/editor/browser/viewParts/minimap/minimapCharSheet.ts](src/vs/editor/browser/viewParts/minimap/minimapCharSheet.ts)\n- [src/vs/editor/browser/viewParts/minimap/minimapPreBaked.ts](src/vs/editor/browser/viewParts/minimap/minimapPreBaked.ts)\n- [src/vs/editor/browser/viewParts/overlayWidgets/overlayWidgets.ts](src/vs/editor/browser/viewParts/overlayWidgets/overlayWidgets.ts)\n- [src/vs/editor/browser/viewParts/overviewRuler/decorationsOverviewRuler.ts](src/vs/editor/browser/viewParts/overviewRuler/decorationsOverviewRuler.ts)\n- [src/vs/editor/browser/viewParts/scrollDecoration/scrollDecoration.ts](src/vs/editor/browser/viewParts/scrollDecoration/scrollDecoration.ts)\n- [src/vs/editor/browser/viewParts/viewCursors/viewCursor.ts](src/vs/editor/browser/viewParts/viewCursors/viewCursor.ts)\n- [src/vs/editor/browser/viewParts/viewCursors/viewCursors.ts](src/vs/editor/browser/viewParts/viewCursors/viewCursors.ts)\n- [src/vs/editor/browser/viewParts/viewZones/viewZones.ts](src/vs/editor/browser/viewParts/viewZones/viewZones.ts)\n- [src/vs/editor/browser/widget/codeEditor/codeEditorWidget.ts](src/vs/editor/browser/widget/codeEditor/codeEditorWidget.ts)\n- [src/vs/editor/common/config/editorOptions.ts](src/vs/editor/common/config/editorOptions.ts)\n- [src/vs/editor/common/config/fontInfo.ts](src/vs/editor/common/config/fontInfo.ts)\n- [src/vs/editor/common/editorCommon.ts](src/vs/editor/common/editorCommon.ts)\n- [src/vs/editor/common/model.ts](src/vs/editor/common/model.ts)\n- [src/vs/editor/common/model/guidesTextModelPart.ts](src/vs/editor/common/model/guidesTextModelPart.ts)\n- [src/vs/editor/common/model/textModel.ts](src/vs/editor/common/model/textModel.ts)\n- [src/vs/editor/common/standalone/standaloneEnums.ts](src/vs/editor/common/standalone/standaloneEnums.ts)\n- [src/vs/editor/common/textModelGuides.ts](src/vs/editor/common/textModelGuides.ts)\n- [src/vs/editor/common/viewLayout/linesLayout.ts](src/vs/editor/common/viewLayout/linesLayout.ts)\n- [src/vs/editor/common/viewLayout/viewLayout.ts](src/vs/editor/common/viewLayout/viewLayout.ts)\n- [src/vs/editor/common/viewLayout/viewLinesViewportData.ts](src/vs/editor/common/viewLayout/viewLinesViewportData.ts)\n- [src/vs/editor/common/viewModel.ts](src/vs/editor/common/viewModel.ts)\n- [src/vs/editor/common/viewModel/minimapTokensColorTracker.ts](src/vs/editor/common/viewModel/minimapTokensColorTracker.ts)\n- [src/vs/editor/common/viewModel/modelLineProjection.ts](src/vs/editor/common/viewModel/modelLineProjection.ts)\n- [src/vs/editor/common/viewModel/monospaceLineBreaksComputer.ts](src/vs/editor/common/viewModel/monospaceLineBreaksComputer.ts)\n- [src/vs/editor/common/viewModel/viewModelDecorations.ts](src/vs/editor/common/viewModel/viewModelDecorations.ts)\n- [src/vs/editor/common/viewModel/viewModelImpl.ts](src/vs/editor/common/viewModel/viewModelImpl.ts)\n- [src/vs/editor/common/viewModel/viewModelLines.ts](src/vs/editor/common/viewModel/viewModelLines.ts)\n- [src/vs/editor/standalone/browser/standaloneCodeEditor.ts](src/vs/editor/standalone/browser/standaloneCodeEditor.ts)\n- [src/vs/editor/standalone/browser/standaloneEditor.ts](src/vs/editor/standalone/browser/standaloneEditor.ts)\n- [src/vs/editor/test/browser/view/minimapCharRenderer.test.ts](src/vs/editor/test/browser/view/minimapCharRenderer.test.ts)\n- [src/vs/editor/test/browser/viewModel/modelLineProjection.test.ts](src/vs/editor/test/browser/viewModel/modelLineProjection.test.ts)\n- [src/vs/editor/test/common/model/modelInjectedText.test.ts](src/vs/editor/test/common/model/modelInjectedText.test.ts)\n- [src/vs/editor/test/common/viewLayout/linesLayout.test.ts](src/vs/editor/test/common/viewLayout/linesLayout.test.ts)\n- [src/vs/editor/test/common/viewModel/lineBreakData.test.ts](src/vs/editor/test/common/viewModel/lineBreakData.test.ts)\n- [src/vs/editor/test/common/viewModel/monospaceLineBreaksComputer.test.ts](src/vs/editor/test/common/viewModel/monospaceLineBreaksComputer.test.ts)\n- [src/vs/monaco.d.ts](src/vs/monaco.d.ts)\n\n\u003c/details\u003e\n\n\n\n## Purpose and Scope\n\nThis document covers the core text representation and view abstraction layers in VS Code's Monaco editor. The Text Model manages the actual document content and operations, while the View Model provides a view-specific abstraction that handles concerns like line wrapping, folding, and coordinate transformations. \n\nFor information about the editor configuration system that controls these models, see [Editor Configuration and Features](#3.2). For details about the overall Monaco editor architecture, see [Monaco Editor](#3).\n\n## Architecture Overview\n\nThe text editing system follows a layered architecture where the Text Model stores raw document content and the View Model provides view-specific transformations and abstractions.\n\n```mermaid\ngraph TB\n    subgraph \"Editor Layer\"\n        CE[\"CodeEditorWidget\"]\n        ED[\"EditorView\"]\n    end\n    \n    subgraph \"View Model Layer\"\n        VM[\"ViewModel\"]\n        VML[\"IViewModelLines\"]\n        CC[\"CoordinatesConverter\"]\n        VD[\"ViewModelDecorations\"]\n    end\n    \n    subgraph \"Text Model Layer\"\n        TM[\"TextModel\"]\n        TB[\"TextBuffer\"]\n        PTB[\"PieceTreeTextBuffer\"]\n    end\n    \n    subgraph \"Line Projection\"\n        VMLFM[\"ViewModelLinesFromModelAsIs\"]\n        VMLPM[\"ViewModelLinesFromProjectedModel\"]\n        LP[\"ModelLineProjection\"]\n    end\n    \n    CE --\u003e VM\n    ED --\u003e VM\n    VM --\u003e TM\n    VM --\u003e VML\n    VM --\u003e CC\n    VM --\u003e VD\n    \n    VML --\u003e VMLFM\n    VML --\u003e VMLPM\n    VMLPM --\u003e LP\n    \n    TM --\u003e TB\n    TB --\u003e PTB\n    \n    VMLFM -.-\u003e|\"large files\"| TM\n    VMLPM -.-\u003e|\"normal files\"| TM\n```\n\n**Sources:** [src/vs/editor/common/viewModel/viewModelImpl.ts:47-164](), [src/vs/editor/common/model/textModel.ts:180-396](), [src/vs/editor/common/viewModel/viewModelLines.ts:22-25]()\n\n## Text Model\n\nThe `TextModel` class serves as the core document representation, managing text content, edit operations, and model-level decorations.\n\n### Core Structure\n\n```mermaid\nclassDiagram\n    class TextModel {\n        -_buffer: ITextBuffer\n        -_options: TextModelResolvedOptions\n        -_decorations: object\n        -_decorationsTree: DecorationsTrees\n        -_commandManager: EditStack\n        +setValue(value)\n        +pushEditOperations(selections, operations)\n        +getLineContent(lineNumber)\n        +getValueInRange(range)\n        +deltaDecorations(oldDecorations, newDecorations)\n    }\n    \n    class ITextBuffer {\n        +getLineCount()\n        +getLineContent(lineNumber)\n        +getValueInRange(range)\n        +applyEdits(operations)\n    }\n    \n    class PieceTreeTextBuffer {\n        +_chunks: string[]\n        +_cr: number\n        +_lf: number\n        +_crlf: number\n    }\n    \n    class EditStack {\n        +pushEditOperation(editOperation)\n        +undo()\n        +redo()\n    }\n    \n    TextModel --\u003e ITextBuffer\n    ITextBuffer \u003c|-- PieceTreeTextBuffer\n    TextModel --\u003e EditStack\n```\n\nThe `TextModel` delegates actual text storage to an `ITextBuffer` implementation, typically `PieceTreeTextBuffer` which uses a piece table data structure for efficient text editing.\n\n**Sources:** [src/vs/editor/common/model/textModel.ts:180-396](), [src/vs/editor/common/model/pieceTreeTextBuffer/pieceTreeTextBuffer.ts]()\n\n### Text Operations\n\nThe TextModel provides methods for text manipulation while maintaining undo/redo state:\n\n| Method | Purpose |\n|--------|---------|\n| `setValue()` | Replace entire document content |\n| `pushEditOperations()` | Apply multiple edit operations atomically |\n| `getLineContent()` | Retrieve content of a specific line |\n| `getValueInRange()` | Extract text from a range |\n| `deltaDecorations()` | Add/remove/modify decorations |\n\n**Sources:** [src/vs/editor/common/model/textModel.ts:453-462](), [src/vs/editor/common/model/textModel.ts:464-512]()\n\n## View Model\n\nThe `ViewModel` class wraps a `TextModel` and provides view-specific abstractions, handling concerns like line wrapping, coordinate conversion, and view decorations.\n\n### View Model Architecture\n\n```mermaid\ngraph TB\n    subgraph \"ViewModel Components\"\n        VM[\"ViewModel\"]\n        VML[\"_lines: IViewModelLines\"]\n        CC[\"coordinatesConverter\"]\n        VD[\"_decorations: ViewModelDecorations\"]\n        C[\"_cursor: CursorsController\"]\n    end\n    \n    subgraph \"Line Management\"\n        VMLFM[\"ViewModelLinesFromModelAsIs\"]\n        VMLPM[\"ViewModelLinesFromProjectedModel\"]\n    end\n    \n    subgraph \"Supporting Systems\"\n        LBC[\"ILineBreaksComputer\"]\n        LP[\"ModelLineProjection\"]\n        DLC[\"DOMLineBreaksComputer\"]\n        MLC[\"MonospaceLineBreaksComputer\"]\n    end\n    \n    VM --\u003e VML\n    VM --\u003e CC\n    VM --\u003e VD\n    VM --\u003e C\n    \n    VML --\u003e VMLFM\n    VML --\u003e VMLPM\n    \n    VMLPM --\u003e LP\n    VMLPM --\u003e LBC\n    \n    LBC --\u003e DLC\n    LBC --\u003e MLC\n```\n\n**Sources:** [src/vs/editor/common/viewModel/viewModelImpl.ts:47-164](), [src/vs/editor/common/viewModel/viewModelLines.ts:22-46]()\n\n### Line Management Strategy\n\nThe ViewModel selects between two line management strategies based on file characteristics:\n\n```mermaid\nflowchart TD\n    Start[\"ViewModel Constructor\"]\n    Check{\"model.isTooLargeForTokenization()\"}\n    AsIs[\"ViewModelLinesFromModelAsIs\u003cbr/\u003eDirect pass-through\"]\n    Projected[\"ViewModelLinesFromProjectedModel\u003cbr/\u003eLine wrapping \u0026 projections\"]\n    \n    Start --\u003e Check\n    Check --\u003e|true| AsIs\n    Check --\u003e|false| Projected\n    \n    AsIs --\u003e Simple[\"Simple 1:1 mapping\u003cbr/\u003elineNumber → viewLineNumber\"]\n    Projected --\u003e Complex[\"Complex mapping\u003cbr/\u003eHandles wrapping, folding\"]\n```\n\n**Sources:** [src/vs/editor/common/viewModel/viewModelImpl.ts:90-114]()\n\n### Coordinates Conversion\n\nThe `ICoordinatesConverter` interface handles transformations between model coordinates (based on the actual text) and view coordinates (based on what the user sees with wrapping/folding applied).\n\n| Conversion Method | Purpose |\n|------------------|---------|\n| `convertViewPositionToModelPosition()` | View cursor position → model position |\n| `convertModelPositionToViewPosition()` | Model position → view position |\n| `convertViewRangeToModelRange()` | View selection → model range |\n| `convertModelRangeToViewRange()` | Model range → view selection |\n\n**Sources:** [src/vs/editor/common/viewModel.ts:115-151]()\n\n## Line Projection System\n\nLine projection handles the transformation between model lines and view lines, supporting features like word wrapping and code folding.\n\n### Projection Components\n\n```mermaid\nclassDiagram\n    class IModelLineProjection {\n        +getViewLineCount(): number\n        +getViewLineContent(viewLineNumber): string\n        +getViewLineMinColumn(viewLineNumber): number\n        +getViewLineMaxColumn(viewLineNumber): number\n        +getModelColumnOfViewPosition(viewLineNumber, viewColumn): number\n    }\n    \n    class ModelLineProjectionData {\n        +injectedText: InjectedText[]\n        +lineBreakData: LineBreakData\n        +breakOffsets: number[]\n        +breakOffsetsVisibleColumn: number[]\n    }\n    \n    class ILineBreaksComputer {\n        +addRequest(lineText, injectedText, previousLineBreakData)\n        +finalize(): ModelLineProjectionData[]\n    }\n    \n    class DOMLineBreaksComputer {\n        +_targetWindow: WeakRef~Window~\n        +_requests: string[]\n        +_injectedTexts: LineInjectedText[][]\n    }\n    \n    class MonospaceLineBreaksComputer {\n        +_classifier: WrappingCharacterClassifier\n        +_wrappingIndent: WrappingIndent\n    }\n    \n    ILineBreaksComputer \u003c|-- DOMLineBreaksComputer\n    ILineBreaksComputer \u003c|-- MonospaceLineBreaksComputer\n    IModelLineProjection --\u003e ModelLineProjectionData\n    ModelLineProjectionData --\u003e ILineBreaksComputer\n```\n\n**Sources:** [src/vs/editor/common/viewModel/modelLineProjection.ts:1-20](), [src/vs/editor/browser/view/domLineBreaksComputer.ts:20-29](), [src/vs/editor/common/viewModel/monospaceLineBreaksComputer.ts:15-27]()\n\n### Line Break Computation\n\nThe system supports two line break computation strategies:\n\n1. **DOM-based computation** (`DOMLineBreaksComputer`) - Uses actual DOM measurement for accurate wrapping\n2. **Monospace computation** (`MonospaceLineBreaksComputer`) - Fast computation for monospace fonts\n\n```mermaid\nflowchart LR\n    subgraph \"Input\"\n        LT[\"Line Text\"]\n        IT[\"Injected Text\"]\n        WS[\"Wrapping Settings\"]\n    end\n    \n    subgraph \"Computation\"\n        LBC[\"ILineBreaksComputer\"]\n        DOM[\"DOM Measurement\"]\n        MONO[\"Monospace Calculation\"]\n    end\n    \n    subgraph \"Output\"\n        MLPD[\"ModelLineProjectionData\"]\n        BO[\"Break Offsets\"]\n        VLC[\"View Line Count\"]\n    end\n    \n    LT --\u003e LBC\n    IT --\u003e LBC\n    WS --\u003e LBC\n    \n    LBC --\u003e DOM\n    LBC --\u003e MONO\n    \n    DOM --\u003e MLPD\n    MONO --\u003e MLPD\n    \n    MLPD --\u003e BO\n    MLPD --\u003e VLC\n```\n\n**Sources:** [src/vs/editor/browser/view/domLineBreaksComputer.ts:29-44](), [src/vs/editor/common/viewModel/monospaceLineBreaksComputer.ts:28-35]()\n\n## View Model Integration\n\nThe View Model integrates with the broader editor system through event handling and view updates.\n\n### Event Flow\n\n```mermaid\nsequenceDiagram\n    participant TM as TextModel\n    participant VM as ViewModel\n    participant VML as IViewModelLines\n    participant ED as EditorView\n    \n    TM-\u003e\u003eVM: onDidChangeContentOrInjectedText\n    VM-\u003e\u003eVML: onModelLinesChanged\n    VML-\u003e\u003eVM: ViewLinesChangedEvent\n    VM-\u003e\u003eED: ViewEvent\n    ED-\u003e\u003eED: Re-render affected lines\n```\n\n### Configuration Updates\n\nThe ViewModel responds to configuration changes by updating its line management strategy:\n\n```mermaid\nflowchart TD\n    Config[\"Configuration Change\"]\n    Check{\"Font/Wrapping Changed?\"}\n    Update[\"setWrappingSettings()\"]\n    Flush[\"ViewFlushedEvent\"]\n    Remap[\"ViewLineMappingChangedEvent\"]\n    Render[\"Re-render Editor\"]\n    \n    Config --\u003e Check\n    Check --\u003e|Yes| Update\n    Check --\u003e|No| Render\n    Update --\u003e Flush\n    Flush --\u003e Remap\n    Remap --\u003e Render\n```\n\n**Sources:** [src/vs/editor/common/viewModel/viewModelImpl.ts:261-301](), [src/vs/editor/common/viewModel/viewModelLines.ts:25-35]()\n\n## Performance Considerations\n\nThe Text Model and View Model system includes several optimizations for large files:\n\n| Optimization | Condition | Effect |\n|-------------|-----------|---------|\n| Large file detection | File \u003e 20MB or \u003e 300K lines | Disable tokenization, use simple line mapping |\n| Identity lines collection | `isTooLargeForTokenization()` | Use `ViewModelLinesFromModelAsIs` |\n| Piece table buffer | All files | Efficient text editing operations |\n| Viewport-based rendering | All files | Only compute view data for visible lines |\n\n**Sources:** [src/vs/editor/common/model/textModel.ts:182-186](), [src/vs/editor/common/viewModel/viewModelImpl.ts:90-92]()"])</script>
    <script>self.__next_f.push([1, "1d:T3e11,"])</script>
    <script>self.__next_f.push([1, "# Editor Configuration and Features\n\n\u003cdetails\u003e\n\u003csummary\u003eRelevant source files\u003c/summary\u003e\n\nThe following files were used as context for generating this wiki page:\n\n- [build/monaco/monaco.d.ts.recipe](build/monaco/monaco.d.ts.recipe)\n- [extensions/vscode-colorize-perf-tests/test/colorize-fixtures/test-treeView.ts](extensions/vscode-colorize-perf-tests/test/colorize-fixtures/test-treeView.ts)\n- [src/vs/editor/browser/config/charWidthReader.ts](src/vs/editor/browser/config/charWidthReader.ts)\n- [src/vs/editor/browser/editorBrowser.ts](src/vs/editor/browser/editorBrowser.ts)\n- [src/vs/editor/browser/view/domLineBreaksComputer.ts](src/vs/editor/browser/view/domLineBreaksComputer.ts)\n- [src/vs/editor/browser/view/renderingContext.ts](src/vs/editor/browser/view/renderingContext.ts)\n- [src/vs/editor/browser/viewParts/contentWidgets/contentWidgets.ts](src/vs/editor/browser/viewParts/contentWidgets/contentWidgets.ts)\n- [src/vs/editor/browser/viewParts/margin/margin.ts](src/vs/editor/browser/viewParts/margin/margin.ts)\n- [src/vs/editor/browser/viewParts/minimap/minimap.ts](src/vs/editor/browser/viewParts/minimap/minimap.ts)\n- [src/vs/editor/browser/viewParts/minimap/minimapCharRenderer.ts](src/vs/editor/browser/viewParts/minimap/minimapCharRenderer.ts)\n- [src/vs/editor/browser/viewParts/minimap/minimapCharRendererFactory.ts](src/vs/editor/browser/viewParts/minimap/minimapCharRendererFactory.ts)\n- [src/vs/editor/browser/viewParts/minimap/minimapCharSheet.ts](src/vs/editor/browser/viewParts/minimap/minimapCharSheet.ts)\n- [src/vs/editor/browser/viewParts/minimap/minimapPreBaked.ts](src/vs/editor/browser/viewParts/minimap/minimapPreBaked.ts)\n- [src/vs/editor/browser/viewParts/overlayWidgets/overlayWidgets.ts](src/vs/editor/browser/viewParts/overlayWidgets/overlayWidgets.ts)\n- [src/vs/editor/browser/viewParts/overviewRuler/decorationsOverviewRuler.ts](src/vs/editor/browser/viewParts/overviewRuler/decorationsOverviewRuler.ts)\n- [src/vs/editor/browser/viewParts/scrollDecoration/scrollDecoration.ts](src/vs/editor/browser/viewParts/scrollDecoration/scrollDecoration.ts)\n- [src/vs/editor/browser/viewParts/viewCursors/viewCursor.ts](src/vs/editor/browser/viewParts/viewCursors/viewCursor.ts)\n- [src/vs/editor/browser/viewParts/viewCursors/viewCursors.ts](src/vs/editor/browser/viewParts/viewCursors/viewCursors.ts)\n- [src/vs/editor/browser/viewParts/viewZones/viewZones.ts](src/vs/editor/browser/viewParts/viewZones/viewZones.ts)\n- [src/vs/editor/browser/widget/codeEditor/codeEditorWidget.ts](src/vs/editor/browser/widget/codeEditor/codeEditorWidget.ts)\n- [src/vs/editor/common/config/editorOptions.ts](src/vs/editor/common/config/editorOptions.ts)\n- [src/vs/editor/common/config/fontInfo.ts](src/vs/editor/common/config/fontInfo.ts)\n- [src/vs/editor/common/editorCommon.ts](src/vs/editor/common/editorCommon.ts)\n- [src/vs/editor/common/model.ts](src/vs/editor/common/model.ts)\n- [src/vs/editor/common/model/guidesTextModelPart.ts](src/vs/editor/common/model/guidesTextModelPart.ts)\n- [src/vs/editor/common/model/textModel.ts](src/vs/editor/common/model/textModel.ts)\n- [src/vs/editor/common/standalone/standaloneEnums.ts](src/vs/editor/common/standalone/standaloneEnums.ts)\n- [src/vs/editor/common/textModelGuides.ts](src/vs/editor/common/textModelGuides.ts)\n- [src/vs/editor/common/viewLayout/linesLayout.ts](src/vs/editor/common/viewLayout/linesLayout.ts)\n- [src/vs/editor/common/viewLayout/viewLayout.ts](src/vs/editor/common/viewLayout/viewLayout.ts)\n- [src/vs/editor/common/viewLayout/viewLinesViewportData.ts](src/vs/editor/common/viewLayout/viewLinesViewportData.ts)\n- [src/vs/editor/common/viewModel.ts](src/vs/editor/common/viewModel.ts)\n- [src/vs/editor/common/viewModel/minimapTokensColorTracker.ts](src/vs/editor/common/viewModel/minimapTokensColorTracker.ts)\n- [src/vs/editor/common/viewModel/modelLineProjection.ts](src/vs/editor/common/viewModel/modelLineProjection.ts)\n- [src/vs/editor/common/viewModel/monospaceLineBreaksComputer.ts](src/vs/editor/common/viewModel/monospaceLineBreaksComputer.ts)\n- [src/vs/editor/common/viewModel/viewModelDecorations.ts](src/vs/editor/common/viewModel/viewModelDecorations.ts)\n- [src/vs/editor/common/viewModel/viewModelImpl.ts](src/vs/editor/common/viewModel/viewModelImpl.ts)\n- [src/vs/editor/common/viewModel/viewModelLines.ts](src/vs/editor/common/viewModel/viewModelLines.ts)\n- [src/vs/editor/standalone/browser/standaloneCodeEditor.ts](src/vs/editor/standalone/browser/standaloneCodeEditor.ts)\n- [src/vs/editor/standalone/browser/standaloneEditor.ts](src/vs/editor/standalone/browser/standaloneEditor.ts)\n- [src/vs/editor/test/browser/view/minimapCharRenderer.test.ts](src/vs/editor/test/browser/view/minimapCharRenderer.test.ts)\n- [src/vs/editor/test/browser/viewModel/modelLineProjection.test.ts](src/vs/editor/test/browser/viewModel/modelLineProjection.test.ts)\n- [src/vs/editor/test/common/model/modelInjectedText.test.ts](src/vs/editor/test/common/model/modelInjectedText.test.ts)\n- [src/vs/editor/test/common/viewLayout/linesLayout.test.ts](src/vs/editor/test/common/viewLayout/linesLayout.test.ts)\n- [src/vs/editor/test/common/viewModel/lineBreakData.test.ts](src/vs/editor/test/common/viewModel/lineBreakData.test.ts)\n- [src/vs/editor/test/common/viewModel/monospaceLineBreaksComputer.test.ts](src/vs/editor/test/common/viewModel/monospaceLineBreaksComputer.test.ts)\n- [src/vs/monaco.d.ts](src/vs/monaco.d.ts)\n\n\u003c/details\u003e\n\n\n\nThis document covers how VS Code's Monaco editor is configured and the various features it provides. It explains the configuration system, available editor features, and how these features are implemented within the editor architecture.\n\nFor information about the underlying text model and view model architecture, see [Text Model and View Model](#3.1). For extension system and language features provided through extensions, see [Extension Host and Language Features](#4.1).\n\n## Configuration System Overview\n\nThe editor configuration system is built around a comprehensive options framework that validates, computes, and manages all editor behavior settings.\n\n### EditorOptions Architecture\n\nThe configuration system centers on the `IEditorOptions` interface and `EditorOption` enum defined in [src/vs/editor/common/config/editorOptions.ts:51-797](). The system supports over 150 different configuration options covering everything from basic text editing to advanced UI features.\n\n```mermaid\ngraph TB\n    UserConfig[\"User Configuration\u003cbr/\u003e(IEditorOptions)\"] --\u003e ConfigSystem[\"Configuration System\u003cbr/\u003eEditorConfiguration\"]\n    ConfigSystem --\u003e Validation[\"Option Validation\u003cbr/\u003eIEditorOption.validate()\"]\n    Validation --\u003e Computation[\"Option Computation\u003cbr/\u003eIEditorOption.compute()\"]\n    Computation --\u003e ComputedOpts[\"Computed Options\u003cbr/\u003eIComputedEditorOptions\"]\n    ComputedOpts --\u003e ChangeEvent[\"ConfigurationChangedEvent\"]\n    ChangeEvent --\u003e ViewParts[\"View Parts\u003cbr/\u003e(Minimap, Cursors, etc.)\"]\n    ChangeEvent --\u003e ViewModel[\"ViewModel\"]\n    ChangeEvent --\u003e TextModel[\"TextModel\"]\n```\n\nSources: [src/vs/editor/common/config/editorOptions.ts:51-797](), [src/vs/editor/common/config/editorOptions.ts:960-971]()\n\n### Core Configuration Options\n\nThe `EditorOption` enum defines all configurable aspects of the editor:\n\n| Category | Key Options | Purpose |\n|----------|-------------|---------|\n| **Text Rendering** | `fontFamily`, `fontSize`, `lineHeight`, `letterSpacing` | Font and text display |\n| **Cursor Behavior** | `cursorStyle`, `cursorBlinking`, `cursorSmoothCaretAnimation` | Cursor appearance and animation |\n| **Language Features** | `suggest`, `quickSuggestions`, `parameterHints`, `codeLens` | IntelliSense and language support |\n| **Visual Elements** | `minimap`, `rulers`, `lineNumbers`, `glyphMargin` | UI components visibility |\n| **Editing Behavior** | `autoIndent`, `autoClosingBrackets`, `wordWrap`, `tabSize` | Text editing features |\n\nSources: [src/vs/editor/common/config/editorOptions.ts:176-337](), [src/vs/editor/common/standalone/standaloneEnums.ts:176-337]()\n\n### Configuration Change Handling\n\nWhen options change, the system generates a `ConfigurationChangedEvent` that components can subscribe to:\n\n```mermaid\ngraph LR\n    OptionChange[\"Option Change\"] --\u003e ConfigEvent[\"ConfigurationChangedEvent\"]\n    ConfigEvent --\u003e ViewModelUpdate[\"ViewModel.onConfigurationChanged()\"]\n    ConfigEvent --\u003e ViewPartUpdate[\"ViewPart.onConfigurationChanged()\"]\n    ConfigEvent --\u003e LayoutUpdate[\"ViewLayout.onConfigurationChanged()\"]\n    ViewModelUpdate --\u003e Recompute[\"Recompute Line Breaks\"]\n    ViewPartUpdate --\u003e UIUpdate[\"Update UI Components\"]\n    LayoutUpdate --\u003e Relayout[\"Trigger Layout\"]\n```\n\nSources: [src/vs/editor/common/viewModel/viewModelImpl.ts:261-301](), [src/vs/editor/common/config/editorOptions.ts:960-971]()\n\n## Core Text Editing Features\n\n### Text Model Configuration\n\nThe text model supports several fundamental editing features configured through options:\n\n- **Auto Indentation**: Controlled by `autoIndent` option with strategies `none`, `keep`, `brackets`, `advanced`, `full` [src/vs/editor/common/config/editorOptions.ts:509]()\n- **Auto Closing**: Brackets, quotes, and comments with strategies `always`, `languageDefined`, `beforeWhitespace`, `never` [src/vs/editor/common/config/editorOptions.ts:25-35]()\n- **Word Wrapping**: Various wrapping modes including `off`, `on`, `wordWrapColumn`, `bounded` [src/vs/editor/common/config/editorOptions.ts:320]()\n\n### Selection and Multi-Cursor Features\n\nThe editor supports advanced selection capabilities:\n\n- **Multi-cursor**: Controlled by `multiCursorModifier`, `multiCursorMergeOverlapping`, `multiCursorLimit` [src/vs/editor/common/config/editorOptions.ts:422-436]()\n- **Column Selection**: Enabled via `columnSelection` option [src/vs/editor/common/config/editorOptions.ts:417]()\n- **Selection Clipboard**: Linux-style selection clipboard via `selectionClipboard` [src/vs/editor/common/config/editorOptions.ts:98]()\n\nSources: [src/vs/editor/common/config/editorOptions.ts:509](), [src/vs/editor/common/config/editorOptions.ts:422-436]()\n\n## Visual Features and UI Components\n\n### Minimap Implementation\n\nThe minimap is a comprehensive feature with its own rendering system:\n\n```mermaid\ngraph TB\n    MinimapOptions[\"MinimapOptions\u003cbr/\u003e(size, showSlider, autohide)\"] --\u003e MinimapWidget[\"Minimap ViewPart\"]\n    MinimapWidget --\u003e CharRenderer[\"MinimapCharRenderer\"]\n    MinimapWidget --\u003e TokenRenderer[\"Token Rendering\"]\n    MinimapWidget --\u003e DecorationRenderer[\"Decoration Rendering\"]\n    CharRenderer --\u003e FontScale[\"Font Scaling\"]\n    TokenRenderer --\u003e ColorTracker[\"MinimapTokensColorTracker\"]\n    DecorationRenderer --\u003e MinimapDecorations[\"Minimap Decorations\"]\n```\n\nThe minimap supports three rendering modes defined in `RenderMinimap` enum:\n- `None`: Disabled\n- `Text`: Character-based rendering\n- `Blocks`: Block-based rendering\n\nSources: [src/vs/editor/browser/viewParts/minimap/minimap.ts:48-153](), [src/vs/editor/common/config/editorOptions.ts:77]()\n\n### Cursor System\n\nThe cursor system handles multiple cursor rendering and animations:\n\n- **Cursor Styles**: `line`, `block`, `underline`, `line-thin`, `block-outline`, `underline-thin` [src/vs/editor/common/config/editorOptions.ts:248]()\n- **Blinking Modes**: `blink`, `smooth`, `phase`, `expand`, `solid` [src/vs/editor/common/config/editorOptions.ts:228]()\n- **Multi-cursor Support**: Primary and secondary cursor rendering [src/vs/editor/browser/viewParts/viewCursors/viewCursors.ts:11-15]()\n\n### Line Number and Gutter Features\n\nThe editor provides various gutter configurations:\n\n- **Line Numbers**: Types include `off`, `on`, `relative`, `interval`, `custom` [src/vs/editor/common/config/editorOptions.ts:106]()\n- **Glyph Margin**: Support for decorations in left margin [src/vs/editor/common/config/editorOptions.ts:142]()\n- **Rulers**: Vertical guide lines at specified columns [src/vs/editor/common/config/editorOptions.ts:81]()\n\nSources: [src/vs/editor/common/config/editorOptions.ts:106-149](), [src/vs/editor/browser/viewParts/viewCursors/viewCursors.ts:11-15]()\n\n## Widget and Content Architecture\n\n### Content Widget System\n\nContent widgets are positioned relative to text and used for suggestions, parameter hints, and other contextual UI:\n\n```mermaid\ngraph TB\n    IContentWidget[\"IContentWidget Interface\"] --\u003e WidgetId[\"getId()\"]\n    IContentWidget --\u003e DomNode[\"getDomNode()\"]\n    IContentWidget --\u003e Position[\"getPosition()\"]\n    Position --\u003e ContentWidgetPositionPreference[\"EXACT, ABOVE, BELOW\"]\n    Position --\u003e PositionAffinity[\"Left, Right, None\"]\n    ViewContentWidgets[\"ViewContentWidgets ViewPart\"] --\u003e WidgetManager[\"Widget Management\"]\n    WidgetManager --\u003e PositionCalculation[\"Position Calculation\"]\n    PositionCalculation --\u003e Rendering[\"Widget Rendering\"]\n```\n\n### Overlay Widget System\n\nOverlay widgets are positioned absolutely and used for find widgets, floating elements:\n\n- **Position Preferences**: `TOP_RIGHT_CORNER`, `BOTTOM_RIGHT_CORNER`, `TOP_CENTER` [src/vs/editor/browser/editorBrowser.ts:228-243]()\n- **Overflow Handling**: Support for widgets that can overflow editor bounds [src/vs/editor/browser/editorBrowser.ts:285]()\n\n### View Zones\n\nView zones create spaces between lines for additional content:\n\n- **Positioning**: After specific line numbers with column affinity [src/vs/editor/browser/editorBrowser.ts:33-97]()\n- **Height Options**: Support for both pixel-based and line-based heights [src/vs/editor/browser/editorBrowser.ts:69-75]()\n- **Margin Content**: Optional margin DOM nodes [src/vs/editor/browser/editorBrowser.ts:88]()\n\nSources: [src/vs/editor/browser/editorBrowser.ts:174-208](), [src/vs/editor/browser/editorBrowser.ts:33-97](), [src/vs/editor/browser/viewParts/contentWidgets/contentWidgets.ts:25-48]()\n\n## Feature Implementation Architecture\n\n### ViewPart System\n\nMost visual features are implemented as `ViewPart` subclasses that respond to configuration and model changes:\n\n```mermaid\ngraph TB\n    ViewPart[\"ViewPart Base Class\"] --\u003e ConfigChanged[\"onConfigurationChanged()\"]\n    ViewPart --\u003e ModelChanged[\"onModelChanged()\"]\n    ViewPart --\u003e Render[\"render()\"]\n    \n    ViewPart --\u003e Minimap[\"MinimapViewPart\"]\n    ViewPart --\u003e Cursors[\"ViewCursors\"]\n    ViewPart --\u003e ContentWidgets[\"ViewContentWidgets\"]\n    ViewPart --\u003e OverlayWidgets[\"ViewOverlayWidgets\"]\n    ViewPart --\u003e LineNumbers[\"LineNumbersOverlay\"]\n    ViewPart --\u003e Decorations[\"DecorationsOverlay\"]\n    \n    Minimap --\u003e MinimapRender[\"Character/Block Rendering\"]\n    Cursors --\u003e CursorAnimation[\"Cursor Animation\"]\n    ContentWidgets --\u003e WidgetPositioning[\"Widget Positioning\"]\n```\n\n### Feature Lifecycle\n\nEditor features follow a consistent lifecycle pattern:\n\n1. **Initialization**: Created with initial configuration\n2. **Configuration Updates**: Respond to `ConfigurationChangedEvent`\n3. **Model Changes**: React to text model modifications\n4. **Rendering**: Update visual representation\n5. **Disposal**: Clean up resources\n\nSources: [src/vs/editor/browser/view/viewPart.ts](), [src/vs/editor/browser/viewParts/minimap/minimap.ts:111-153](), [src/vs/editor/browser/viewParts/viewCursors/viewCursors.ts:89-156]()\n\n### Standalone vs Workbench Features\n\nThe editor supports both standalone usage and integration within VS Code workbench:\n\n- **Standalone Features**: Core editing, syntax highlighting, basic IntelliSense [src/vs/editor/standalone/browser/standaloneEditor.ts:48-51]()\n- **Workbench Integration**: Advanced language features, debugging, source control [src/vs/editor/browser/widget/codeEditor/codeEditorWidget.ts]()\n\nThe `EditorOptions` system provides the foundation for all these features through its comprehensive configuration framework, allowing fine-grained control over editor behavior while maintaining consistency across different usage contexts.\n\nSources: [src/vs/editor/standalone/browser/standaloneEditor.ts:48-51](), [src/vs/editor/common/config/editorOptions.ts:1-50]()"])</script>
    <script>self.__next_f.push([1, "1e:T543e,"])</script>
    <script>self.__next_f.push([1, "# Extension System\n\n\u003cdetails\u003e\n\u003csummary\u003eRelevant source files\u003c/summary\u003e\n\nThe following files were used as context for generating this wiki page:\n\n- [extensions/vscode-api-tests/package.json](extensions/vscode-api-tests/package.json)\n- [src/vs/editor/common/languages.ts](src/vs/editor/common/languages.ts)\n- [src/vs/editor/common/services/languageFeatures.ts](src/vs/editor/common/services/languageFeatures.ts)\n- [src/vs/editor/common/services/languageFeaturesService.ts](src/vs/editor/common/services/languageFeaturesService.ts)\n- [src/vs/editor/contrib/gotoSymbol/browser/goToCommands.ts](src/vs/editor/contrib/gotoSymbol/browser/goToCommands.ts)\n- [src/vs/editor/contrib/gotoSymbol/browser/goToSymbol.ts](src/vs/editor/contrib/gotoSymbol/browser/goToSymbol.ts)\n- [src/vs/editor/contrib/gotoSymbol/browser/link/clickLinkGesture.ts](src/vs/editor/contrib/gotoSymbol/browser/link/clickLinkGesture.ts)\n- [src/vs/editor/contrib/gotoSymbol/browser/link/goToDefinitionAtPosition.css](src/vs/editor/contrib/gotoSymbol/browser/link/goToDefinitionAtPosition.css)\n- [src/vs/editor/contrib/gotoSymbol/browser/link/goToDefinitionAtPosition.ts](src/vs/editor/contrib/gotoSymbol/browser/link/goToDefinitionAtPosition.ts)\n- [src/vs/editor/contrib/inPlaceReplace/browser/inPlaceReplace.css](src/vs/editor/contrib/inPlaceReplace/browser/inPlaceReplace.css)\n- [src/vs/editor/contrib/inPlaceReplace/browser/inPlaceReplace.ts](src/vs/editor/contrib/inPlaceReplace/browser/inPlaceReplace.ts)\n- [src/vs/editor/contrib/inlayHints/browser/inlayHintsLocations.ts](src/vs/editor/contrib/inlayHints/browser/inlayHintsLocations.ts)\n- [src/vs/editor/contrib/links/browser/links.css](src/vs/editor/contrib/links/browser/links.css)\n- [src/vs/editor/contrib/links/browser/links.ts](src/vs/editor/contrib/links/browser/links.ts)\n- [src/vs/editor/standalone/browser/standaloneLanguages.ts](src/vs/editor/standalone/browser/standaloneLanguages.ts)\n- [src/vs/platform/extensionManagement/common/abstractExtensionManagementService.ts](src/vs/platform/extensionManagement/common/abstractExtensionManagementService.ts)\n- [src/vs/platform/extensionManagement/common/extensionGalleryService.ts](src/vs/platform/extensionManagement/common/extensionGalleryService.ts)\n- [src/vs/platform/extensionManagement/common/extensionManagement.ts](src/vs/platform/extensionManagement/common/extensionManagement.ts)\n- [src/vs/platform/extensionManagement/common/extensionManagementIpc.ts](src/vs/platform/extensionManagement/common/extensionManagementIpc.ts)\n- [src/vs/platform/extensionManagement/common/extensionManagementUtil.ts](src/vs/platform/extensionManagement/common/extensionManagementUtil.ts)\n- [src/vs/platform/extensionManagement/node/extensionManagementService.ts](src/vs/platform/extensionManagement/node/extensionManagementService.ts)\n- [src/vs/workbench/api/browser/extensionHost.contribution.ts](src/vs/workbench/api/browser/extensionHost.contribution.ts)\n- [src/vs/workbench/api/browser/mainThreadLanguageFeatures.ts](src/vs/workbench/api/browser/mainThreadLanguageFeatures.ts)\n- [src/vs/workbench/api/common/extHost.api.impl.ts](src/vs/workbench/api/common/extHost.api.impl.ts)\n- [src/vs/workbench/api/common/extHost.protocol.ts](src/vs/workbench/api/common/extHost.protocol.ts)\n- [src/vs/workbench/api/common/extHostLanguageFeatures.ts](src/vs/workbench/api/common/extHostLanguageFeatures.ts)\n- [src/vs/workbench/api/common/extHostTypeConverters.ts](src/vs/workbench/api/common/extHostTypeConverters.ts)\n- [src/vs/workbench/api/common/extHostTypes.ts](src/vs/workbench/api/common/extHostTypes.ts)\n- [src/vs/workbench/api/node/extHostExtensionService.ts](src/vs/workbench/api/node/extHostExtensionService.ts)\n- [src/vs/workbench/api/test/browser/extHostLanguageFeatures.test.ts](src/vs/workbench/api/test/browser/extHostLanguageFeatures.test.ts)\n- [src/vs/workbench/contrib/extensions/browser/extensionEditor.ts](src/vs/workbench/contrib/extensions/browser/extensionEditor.ts)\n- [src/vs/workbench/contrib/extensions/browser/extensions.contribution.ts](src/vs/workbench/contrib/extensions/browser/extensions.contribution.ts)\n- [src/vs/workbench/contrib/extensions/browser/extensionsActions.ts](src/vs/workbench/contrib/extensions/browser/extensionsActions.ts)\n- [src/vs/workbench/contrib/extensions/browser/extensionsList.ts](src/vs/workbench/contrib/extensions/browser/extensionsList.ts)\n- [src/vs/workbench/contrib/extensions/browser/extensionsViewer.ts](src/vs/workbench/contrib/extensions/browser/extensionsViewer.ts)\n- [src/vs/workbench/contrib/extensions/browser/extensionsViewlet.ts](src/vs/workbench/contrib/extensions/browser/extensionsViewlet.ts)\n- [src/vs/workbench/contrib/extensions/browser/extensionsViews.ts](src/vs/workbench/contrib/extensions/browser/extensionsViews.ts)\n- [src/vs/workbench/contrib/extensions/browser/extensionsWidgets.ts](src/vs/workbench/contrib/extensions/browser/extensionsWidgets.ts)\n- [src/vs/workbench/contrib/extensions/browser/extensionsWorkbenchService.ts](src/vs/workbench/contrib/extensions/browser/extensionsWorkbenchService.ts)\n- [src/vs/workbench/contrib/extensions/browser/media/extension.css](src/vs/workbench/contrib/extensions/browser/media/extension.css)\n- [src/vs/workbench/contrib/extensions/browser/media/extensionActions.css](src/vs/workbench/contrib/extensions/browser/media/extensionActions.css)\n- [src/vs/workbench/contrib/extensions/browser/media/extensionEditor.css](src/vs/workbench/contrib/extensions/browser/media/extensionEditor.css)\n- [src/vs/workbench/contrib/extensions/browser/media/extensionsViewlet.css](src/vs/workbench/contrib/extensions/browser/media/extensionsViewlet.css)\n- [src/vs/workbench/contrib/extensions/browser/media/extensionsWidgets.css](src/vs/workbench/contrib/extensions/browser/media/extensionsWidgets.css)\n- [src/vs/workbench/contrib/extensions/common/extensions.ts](src/vs/workbench/contrib/extensions/common/extensions.ts)\n- [src/vs/workbench/contrib/extensions/test/electron-browser/extensionRecommendationsService.test.ts](src/vs/workbench/contrib/extensions/test/electron-browser/extensionRecommendationsService.test.ts)\n- [src/vs/workbench/contrib/extensions/test/electron-browser/extensionsActions.test.ts](src/vs/workbench/contrib/extensions/test/electron-browser/extensionsActions.test.ts)\n- [src/vs/workbench/contrib/extensions/test/electron-browser/extensionsViews.test.ts](src/vs/workbench/contrib/extensions/test/electron-browser/extensionsViews.test.ts)\n- [src/vs/workbench/contrib/extensions/test/electron-browser/extensionsWorkbenchService.test.ts](src/vs/workbench/contrib/extensions/test/electron-browser/extensionsWorkbenchService.test.ts)\n- [src/vs/workbench/services/extensionManagement/browser/extensionEnablementService.ts](src/vs/workbench/services/extensionManagement/browser/extensionEnablementService.ts)\n- [src/vs/workbench/services/extensionManagement/common/extensionManagement.ts](src/vs/workbench/services/extensionManagement/common/extensionManagement.ts)\n- [src/vs/workbench/services/extensionManagement/common/extensionManagementChannelClient.ts](src/vs/workbench/services/extensionManagement/common/extensionManagementChannelClient.ts)\n- [src/vs/workbench/services/extensionManagement/common/extensionManagementServerService.ts](src/vs/workbench/services/extensionManagement/common/extensionManagementServerService.ts)\n- [src/vs/workbench/services/extensionManagement/common/extensionManagementService.ts](src/vs/workbench/services/extensionManagement/common/extensionManagementService.ts)\n- [src/vs/workbench/services/extensionManagement/common/webExtensionManagementService.ts](src/vs/workbench/services/extensionManagement/common/webExtensionManagementService.ts)\n- [src/vs/workbench/services/extensionManagement/electron-browser/extensionManagementServerService.ts](src/vs/workbench/services/extensionManagement/electron-browser/extensionManagementServerService.ts)\n- [src/vs/workbench/services/extensionManagement/electron-browser/remoteExtensionManagementService.ts](src/vs/workbench/services/extensionManagement/electron-browser/remoteExtensionManagementService.ts)\n- [src/vs/workbench/services/extensionManagement/test/browser/extensionEnablementService.test.ts](src/vs/workbench/services/extensionManagement/test/browser/extensionEnablementService.test.ts)\n- [src/vscode-dts/vscode.d.ts](src/vscode-dts/vscode.d.ts)\n\n\u003c/details\u003e\n\n\n\nThis document covers VS Code's extension system, which enables third-party functionality through a secure, performant architecture. The extension system includes the extension host process, API surface, extension management services, and integration points for language features.\n\nFor information about the build system and package management, see [Build System and Package Management](#1.2). For details about Monaco Editor integration, see [Monaco Editor](#3).\n\n## Architecture Overview\n\nVS Code's extension system uses a multi-process architecture to isolate extension code from the main application while providing rich integration capabilities.\n\n### Process Architecture\n\n```mermaid\ngraph TB\n    subgraph \"Main Process\"\n        MainApp[\"Application\"]\n        ExtMgmt[\"ExtensionManagementService\"]\n        ExtWorkbench[\"ExtensionsWorkbenchService\"]\n    end\n    \n    subgraph \"Renderer Process\"\n        MainThread[\"MainThreadLanguageFeatures\"]\n        ExtViewlet[\"ExtensionsViewPaneContainer\"]\n        ExtActions[\"ExtensionActions\"]\n    end\n    \n    subgraph \"Extension Host Process\"\n        ExtHostSvc[\"ExtHostExtensionService\"]\n        ExtHostAPI[\"extHost.api.impl\"]\n        ExtHostLang[\"ExtHostLanguageFeatures\"]\n        ExtHostCmd[\"ExtHostCommands\"]\n    end\n    \n    subgraph \"Extension Code\"\n        UserExt[\"User Extensions\"]\n        APIUsage[\"vscode API Usage\"]\n    end\n    \n    MainApp --\u003e|\"IPC\"| MainThread\n    MainThread \u003c--\u003e|\"RPC Protocol\"| ExtHostSvc\n    ExtHostSvc --\u003e ExtHostAPI\n    ExtHostAPI --\u003e UserExt\n    ExtHostLang \u003c--\u003e MainThread\n    ExtMgmt --\u003e ExtViewlet\n    ExtViewlet --\u003e ExtActions\n```\n\n**Sources:** [src/vs/workbench/api/common/extHost.protocol.ts:105-106](), [src/vs/workbench/api/common/extHost.api.impl.ts:127-244](), [src/vs/workbench/contrib/extensions/browser/extensionsWorkbenchService.ts:1-100]()\n\nThe extension system separates concerns across processes:\n\n- **Main Process**: Handles extension installation, management, and lifecycle\n- **Renderer Process**: Provides UI for extension management and main thread API implementations  \n- **Extension Host Process**: Runs extension code in isolation with access to the VS Code API\n\n### Extension Host Communication\n\n```mermaid\ngraph LR\n    subgraph \"Main Thread\"\n        MainThreadCmd[\"MainThreadCommands\"]\n        MainThreadLang[\"MainThreadLanguageFeatures\"]\n        MainThreadDoc[\"MainThreadDocuments\"]\n    end\n    \n    subgraph \"Extension Host\"\n        ExtHostCmd[\"ExtHostCommands\"]\n        ExtHostLang[\"ExtHostLanguageFeatures\"] \n        ExtHostDoc[\"ExtHostDocuments\"]\n    end\n    \n    subgraph \"RPC Protocol\"\n        RPCProxy[\"Proxy Objects\"]\n        RPCShape[\"Protocol Shapes\"]\n    end\n    \n    MainThreadCmd \u003c--\u003e|\"$executeCommand\"| RPCProxy\n    MainThreadLang \u003c--\u003e|\"$registerProvider\"| RPCProxy\n    MainThreadDoc \u003c--\u003e|\"$tryOpenDocument\"| RPCProxy\n    \n    RPCProxy \u003c--\u003e ExtHostCmd\n    RPCProxy \u003c--\u003e ExtHostLang\n    RPCProxy \u003c--\u003e ExtHostDoc\n```\n\n**Sources:** [src/vs/workbench/api/common/extHost.protocol.ts:115-121](), [src/vs/workbench/api/browser/mainThreadLanguageFeatures.ts:38-53](), [src/vs/workbench/api/common/extHostLanguageFeatures.ts:1-50]()\n\n## Extension Host Process\n\nThe extension host runs extension code in a separate Node.js process, providing security isolation and preventing extensions from blocking the main UI.\n\n### Extension Host Service\n\nThe `ExtHostExtensionService` manages extension activation and lifecycle within the extension host process:\n\n```mermaid\ngraph TB\n    subgraph \"ExtHostExtensionService\"\n        ExtActivator[\"ExtensionActivator\"]\n        ExtRegistry[\"ExtensionDescriptionRegistry\"]\n        ExtRuntime[\"ExtensionRuntime\"]\n    end\n    \n    subgraph \"Extension Activation\"\n        ActivationEvents[\"Activation Events\"]\n        ExtensionMain[\"extension.main()\"]\n        APIFactory[\"createApiFactoryAndRegisterActors\"]\n    end\n    \n    subgraph \"API Surface\"\n        VSCodeAPI[\"vscode namespace\"]\n        ExtHostCmd[\"ExtHostCommands\"]\n        ExtHostLang[\"ExtHostLanguageFeatures\"]\n        ExtHostWorkspace[\"ExtHostWorkspace\"]\n    end\n    \n    ExtActivator --\u003e ActivationEvents\n    ActivationEvents --\u003e ExtensionMain\n    ExtensionMain --\u003e APIFactory\n    APIFactory --\u003e VSCodeAPI\n    VSCodeAPI --\u003e ExtHostCmd\n    VSCodeAPI --\u003e ExtHostLang\n    VSCodeAPI --\u003e ExtHostWorkspace\n```\n\n**Sources:** [src/vs/workbench/api/node/extHostExtensionService.ts:1-50](), [src/vs/workbench/api/common/extHost.api.impl.ts:127-155]()\n\n### Extension API Implementation\n\nThe extension API is implemented through a factory pattern that creates the `vscode` namespace for each extension:\n\nKey API namespaces include:\n- `commands`: Command registration and execution via `ExtHostCommands`\n- `languages`: Language feature providers via `ExtHostLanguageFeatures`  \n- `workspace`: Workspace operations via `ExtHostWorkspace`\n- `window`: UI interactions via `ExtHostWindow`\n- `extensions`: Extension management via `ExtHostExtensionService`\n\n**Sources:** [src/vs/workbench/api/common/extHost.api.impl.ts:244-533](), [src/vscode-dts/vscode.d.ts:1-50]()\n\n## Extension Management\n\nExtension management encompasses discovery, installation, enablement, and lifecycle operations.\n\n### Extension Management Services\n\n```mermaid\ngraph TB\n    subgraph \"Core Management\"\n        ExtMgmtSvc[\"IExtensionManagementService\"]\n        ExtEnablementSvc[\"IWorkbenchExtensionEnablementService\"]\n        ExtWorkbenchSvc[\"IExtensionsWorkbenchService\"]\n    end\n    \n    subgraph \"Extension Representation\"\n        IExtension[\"IExtension Interface\"]\n        Extension[\"Extension Class\"]\n        ExtState[\"ExtensionState\"]\n    end\n    \n    subgraph \"Gallery Integration\"\n        GallerySvc[\"IExtensionGalleryService\"]\n        GalleryExt[\"IGalleryExtension\"]\n        InstallOps[\"InstallOptions\"]\n    end\n    \n    subgraph \"UI Layer\"\n        ExtViewlet[\"ExtensionsViewPaneContainer\"]\n        ExtActions[\"ExtensionActions\"]\n        ExtEditor[\"ExtensionEditor\"]\n    end\n    \n    ExtMgmtSvc --\u003e Extension\n    ExtEnablementSvc --\u003e ExtState\n    ExtWorkbenchSvc --\u003e IExtension\n    GallerySvc --\u003e GalleryExt\n    GalleryExt --\u003e InstallOps\n    ExtViewlet --\u003e ExtActions\n    ExtActions --\u003e ExtEditor\n```\n\n**Sources:** [src/vs/platform/extensionManagement/common/extensionManagement.ts:1-50](), [src/vs/workbench/contrib/extensions/browser/extensionsWorkbenchService.ts:77-114](), [src/vs/workbench/contrib/extensions/browser/extensionsActions.ts:285-320]()\n\n### Extension States and Lifecycle\n\nExtensions progress through various states managed by the `ExtensionsWorkbenchService`:\n\n| State | Description | Code Location |\n|-------|-------------|---------------|\n| `Uninstalled` | Extension not installed | [ExtensionState enum]() |\n| `Installing` | Installation in progress | [ExtensionState enum]() |\n| `Installed` | Installed but not enabled | [ExtensionState enum]() |\n| `Enabling` | Enablement in progress | [ExtensionState enum]() |\n| `Enabled` | Active and functional | [ExtensionState enum]() |\n\n**Sources:** [src/vs/workbench/contrib/extensions/common/extensions.ts:1-50](), [src/vs/workbench/contrib/extensions/browser/extensionsWorkbenchService.ts:92-165]()\n\n## Language Features Integration\n\nExtensions integrate with VS Code's language features through provider-based APIs that register capabilities like completion, diagnostics, and hover information.\n\n### Language Feature Providers\n\n```mermaid\ngraph TB\n    subgraph \"Extension Host\"\n        ExtLangFeatures[\"ExtHostLanguageFeatures\"]\n        Providers[\"Provider Adapters\"]\n        ProviderCache[\"Provider Cache\"]\n    end\n    \n    subgraph \"Main Thread\"\n        MainLangFeatures[\"MainThreadLanguageFeatures\"]\n        LangFeaturesService[\"ILanguageFeaturesService\"]\n        LanguageService[\"ILanguageService\"]\n    end\n    \n    subgraph \"Provider Types\"\n        CompletionProvider[\"CompletionItemProvider\"]\n        HoverProvider[\"HoverProvider\"]\n        DiagnosticProvider[\"DiagnosticProvider\"]\n        DefinitionProvider[\"DefinitionProvider\"]\n    end\n    \n    ExtLangFeatures --\u003e Providers\n    Providers --\u003e ProviderCache\n    Providers \u003c--\u003e|\"RPC\"| MainLangFeatures\n    MainLangFeatures --\u003e LangFeaturesService\n    LangFeaturesService --\u003e LanguageService\n    \n    CompletionProvider --\u003e Providers\n    HoverProvider --\u003e Providers\n    DiagnosticProvider --\u003e Providers\n    DefinitionProvider --\u003e Providers\n```\n\n**Sources:** [src/vs/workbench/api/common/extHostLanguageFeatures.ts:1-100](), [src/vs/workbench/api/browser/mainThreadLanguageFeatures.ts:38-100]()\n\n### Provider Registration Flow\n\nThe language feature registration follows this pattern:\n\n1. Extension calls `vscode.languages.registerXProvider()`\n2. `ExtHostLanguageFeatures` creates adapter and caches provider\n3. RPC call to `MainThreadLanguageFeatures.$registerXProvider()`\n4. Main thread registers with `ILanguageFeaturesService`\n5. Editor requests trigger provider calls through RPC back to extension host\n\n**Sources:** [src/vs/workbench/api/common/extHostLanguageFeatures.ts:43-103](), [src/vs/workbench/api/browser/mainThreadLanguageFeatures.ts:457-503]()\n\n## Extension Discovery and Installation\n\nExtensions are discovered through the marketplace and installed via the extension management infrastructure.\n\n### Extension Gallery Service\n\n```mermaid\ngraph TB\n    subgraph \"Gallery Service\"\n        GallerySvc[\"ExtensionGalleryService\"]\n        QueryOpts[\"IQueryOptions\"]\n        GalleryAPI[\"Marketplace API\"]\n    end\n    \n    subgraph \"Extension Data\"\n        IGalleryExt[\"IGalleryExtension\"]\n        ExtManifest[\"IExtensionManifest\"]\n        ExtAssets[\"IGalleryExtensionAssets\"]\n    end\n    \n    subgraph \"Installation Process\"\n        InstallAction[\"InstallAction\"]\n        DownloadSvc[\"ExtensionsDownloader\"]\n        ExtractSvc[\"Extension Extraction\"]\n    end\n    \n    subgraph \"Local Management\"\n        LocalExt[\"ILocalExtension\"]\n        ExtScanner[\"ExtensionsScanner\"]\n        ExtWatcher[\"ExtensionsWatcher\"]\n    end\n    \n    GallerySvc --\u003e QueryOpts\n    QueryOpts --\u003e GalleryAPI\n    GalleryAPI --\u003e IGalleryExt\n    IGalleryExt --\u003e ExtManifest\n    IGalleryExt --\u003e ExtAssets\n    \n    InstallAction --\u003e DownloadSvc\n    DownloadSvc --\u003e ExtractSvc\n    ExtractSvc --\u003e LocalExt\n    LocalExt --\u003e ExtScanner\n    ExtScanner --\u003e ExtWatcher\n```\n\n**Sources:** [src/vs/platform/extensionManagement/common/extensionGalleryService.ts:1-100](), [src/vs/platform/extensionManagement/node/extensionManagementService.ts:1-100](), [src/vs/workbench/contrib/extensions/browser/extensionsActions.ts:79-278]()\n\n### Extension Package Structure\n\nExtensions follow a standardized package structure with a `package.json` manifest:\n\n- Extension manifest contains activation events, contribution points, and dependencies\n- Main entry point specified in `main` field loads extension code\n- Contribution points define how extension extends VS Code (commands, languages, etc.)\n\n**Sources:** [src/vscode-dts/vscode.d.ts:1-50](), [extensions/vscode-api-tests/package.json:1-50]()\n\n## Extension Actions and UI\n\nThe Extensions viewlet provides a comprehensive UI for managing extensions through various action classes.\n\n### Extension Action Hierarchy\n\n```mermaid\ngraph TB\n    subgraph \"Action Base Classes\"\n        ExtAction[\"ExtensionAction\"]\n        ButtonDropdownAction[\"ButtonWithDropDownExtensionAction\"]\n        DropdownAction[\"DropDownExtensionAction\"]\n    end\n    \n    subgraph \"Install Actions\"\n        InstallAction[\"InstallAction\"]\n        LocalInstallAction[\"LocalInstallAction\"]\n        RemoteInstallAction[\"RemoteInstallAction\"]\n        WebInstallAction[\"WebInstallAction\"]\n    end\n    \n    subgraph \"Management Actions\"\n        UpdateAction[\"UpdateAction\"]\n        UninstallAction[\"UninstallAction\"]\n        EnableAction[\"EnableDropDownAction\"]\n        DisableAction[\"DisableDropDownAction\"]\n    end\n    \n    subgraph \"State Actions\"\n        ExtStatusAction[\"ExtensionStatusAction\"]\n        RuntimeStateAction[\"ExtensionRuntimeStateAction\"]\n        ReloadAction[\"ReloadAction\"]\n    end\n    \n    ExtAction --\u003e InstallAction\n    ExtAction --\u003e UpdateAction\n    ExtAction --\u003e UninstallAction\n    ExtAction --\u003e ExtStatusAction\n    \n    ButtonDropdownAction --\u003e EnableAction\n    ButtonDropdownAction --\u003e DisableAction\n    \n    InstallAction --\u003e LocalInstallAction\n    InstallAction --\u003e RemoteInstallAction\n    InstallAction --\u003e WebInstallAction\n```\n\n**Sources:** [src/vs/workbench/contrib/extensions/browser/extensionsActions.ts:285-330](), [src/vs/workbench/contrib/extensions/browser/extensionsActions.ts:2500-2600]()\n\n### Extension Views and Filtering\n\nThe Extensions viewlet provides multiple views for different extension categories:\n\n- **Installed**: Shows locally installed extensions\n- **Popular**: Displays popular marketplace extensions  \n- **Recommended**: Extensions recommended for current workspace\n- **Disabled**: Shows disabled extensions\n- **Outdated**: Extensions with available updates\n\n**Sources:** [src/vs/workbench/contrib/extensions/browser/extensionsViews.ts:1-100](), [src/vs/workbench/contrib/extensions/browser/extensionsViewlet.ts:1-100]()\n\nThis extension system provides a robust, secure foundation for extending VS Code's functionality while maintaining performance and stability through process isolation and well-defined APIs."])</script>
    <script>self.__next_f.push([1, "1f:T3a8d,"])</script>
    <script>self.__next_f.push([1, "# Extension Host and Language Features\n\n\u003cdetails\u003e\n\u003csummary\u003eRelevant source files\u003c/summary\u003e\n\nThe following files were used as context for generating this wiki page:\n\n- [extensions/vscode-api-tests/package.json](extensions/vscode-api-tests/package.json)\n- [src/vs/editor/common/languages.ts](src/vs/editor/common/languages.ts)\n- [src/vs/editor/common/services/languageFeatures.ts](src/vs/editor/common/services/languageFeatures.ts)\n- [src/vs/editor/common/services/languageFeaturesService.ts](src/vs/editor/common/services/languageFeaturesService.ts)\n- [src/vs/editor/contrib/gotoSymbol/browser/goToCommands.ts](src/vs/editor/contrib/gotoSymbol/browser/goToCommands.ts)\n- [src/vs/editor/contrib/gotoSymbol/browser/goToSymbol.ts](src/vs/editor/contrib/gotoSymbol/browser/goToSymbol.ts)\n- [src/vs/editor/contrib/gotoSymbol/browser/link/clickLinkGesture.ts](src/vs/editor/contrib/gotoSymbol/browser/link/clickLinkGesture.ts)\n- [src/vs/editor/contrib/gotoSymbol/browser/link/goToDefinitionAtPosition.css](src/vs/editor/contrib/gotoSymbol/browser/link/goToDefinitionAtPosition.css)\n- [src/vs/editor/contrib/gotoSymbol/browser/link/goToDefinitionAtPosition.ts](src/vs/editor/contrib/gotoSymbol/browser/link/goToDefinitionAtPosition.ts)\n- [src/vs/editor/contrib/inPlaceReplace/browser/inPlaceReplace.css](src/vs/editor/contrib/inPlaceReplace/browser/inPlaceReplace.css)\n- [src/vs/editor/contrib/inPlaceReplace/browser/inPlaceReplace.ts](src/vs/editor/contrib/inPlaceReplace/browser/inPlaceReplace.ts)\n- [src/vs/editor/contrib/inlayHints/browser/inlayHintsLocations.ts](src/vs/editor/contrib/inlayHints/browser/inlayHintsLocations.ts)\n- [src/vs/editor/contrib/links/browser/links.css](src/vs/editor/contrib/links/browser/links.css)\n- [src/vs/editor/contrib/links/browser/links.ts](src/vs/editor/contrib/links/browser/links.ts)\n- [src/vs/editor/standalone/browser/standaloneLanguages.ts](src/vs/editor/standalone/browser/standaloneLanguages.ts)\n- [src/vs/workbench/api/browser/extensionHost.contribution.ts](src/vs/workbench/api/browser/extensionHost.contribution.ts)\n- [src/vs/workbench/api/browser/mainThreadLanguageFeatures.ts](src/vs/workbench/api/browser/mainThreadLanguageFeatures.ts)\n- [src/vs/workbench/api/common/extHost.api.impl.ts](src/vs/workbench/api/common/extHost.api.impl.ts)\n- [src/vs/workbench/api/common/extHost.protocol.ts](src/vs/workbench/api/common/extHost.protocol.ts)\n- [src/vs/workbench/api/common/extHostLanguageFeatures.ts](src/vs/workbench/api/common/extHostLanguageFeatures.ts)\n- [src/vs/workbench/api/common/extHostTypeConverters.ts](src/vs/workbench/api/common/extHostTypeConverters.ts)\n- [src/vs/workbench/api/common/extHostTypes.ts](src/vs/workbench/api/common/extHostTypes.ts)\n- [src/vs/workbench/api/node/extHostExtensionService.ts](src/vs/workbench/api/node/extHostExtensionService.ts)\n- [src/vs/workbench/api/test/browser/extHostLanguageFeatures.test.ts](src/vs/workbench/api/test/browser/extHostLanguageFeatures.test.ts)\n- [src/vscode-dts/vscode.d.ts](src/vscode-dts/vscode.d.ts)\n\n\u003c/details\u003e\n\n\n\nThis document covers VS Code's extension host architecture and how it enables third-party extensions to provide language features such as IntelliSense, hover information, go-to-definition, and other language-specific functionality. For information about the core Monaco editor features, see [Monaco Editor](#3). For details about extension management and activation, see [Extension Management](#4.2).\n\n## Architecture Overview\n\nThe extension host system provides a secure, isolated environment where extensions can run while seamlessly integrating with VS Code's language features. Extensions run in a separate process and communicate with the main workbench through a well-defined RPC protocol.\n\n### Process Architecture\n\n```mermaid\ngraph TB\n    subgraph \"Main Process\"\n        MainThread[\"Main Thread\u003cbr/\u003eWorkbench UI\"]\n        LanguageFeaturesService[\"ILanguageFeaturesService\u003cbr/\u003eLanguage Feature Registries\"]\n        MainThreadLanguageFeatures[\"MainThreadLanguageFeatures\u003cbr/\u003eRPC Handler\"]\n    end\n    \n    subgraph \"Extension Host Process\"\n        ExtHostLanguageFeatures[\"ExtHostLanguageFeatures\u003cbr/\u003eExtension API Handler\"] \n        ExtensionAPI[\"vscode.languages\u003cbr/\u003eExtension API Surface\"]\n        Extension1[\"Extension A\u003cbr/\u003eTypeScript Provider\"]\n        Extension2[\"Extension B\u003cbr/\u003ePython Provider\"]\n    end\n    \n    subgraph \"Editor Components\"\n        Monaco[\"Monaco Editor\"]\n        LanguageProviders[\"Language Providers\u003cbr/\u003e(Hover, Completion, etc.)\"]\n    end\n    \n    MainThread \u003c--\u003e|\"RPC Protocol\u003cbr/\u003eextHost.protocol.ts\"| ExtHostLanguageFeatures\n    MainThreadLanguageFeatures --\u003e LanguageFeaturesService\n    LanguageFeaturesService --\u003e LanguageProviders\n    LanguageProviders --\u003e Monaco\n    \n    ExtHostLanguageFeatures --\u003e ExtensionAPI\n    ExtensionAPI --\u003e Extension1\n    ExtensionAPI --\u003e Extension2\n```\n\nSources: [src/vs/workbench/api/common/extHost.protocol.ts:1-913](), [src/vs/workbench/api/common/extHostLanguageFeatures.ts:1-228](), [src/vs/workbench/api/browser/mainThreadLanguageFeatures.ts:1-138]()\n\n### Key Components\n\n| Component | Location | Purpose |\n|-----------|----------|---------|\n| `ExtHostLanguageFeatures` | [src/vs/workbench/api/common/extHostLanguageFeatures.ts]() | Extension host side language feature management |\n| `MainThreadLanguageFeatures` | [src/vs/workbench/api/browser/mainThreadLanguageFeatures.ts]() | Main thread RPC handler and feature registration |\n| `ILanguageFeaturesService` | [src/vs/editor/common/services/languageFeatures.ts]() | Core service managing language feature registries |\n| Language Feature Adapters | [src/vs/workbench/api/common/extHostLanguageFeatures.ts:43-4000]() | Bridge extension providers to internal APIs |\n\n## Language Feature Registration Flow\n\nExtensions register language features through the `vscode.languages` API, which gets translated into internal VS Code language feature registrations.\n\n```mermaid\nsequenceDiagram\n    participant Ext as \"Extension\"\n    participant API as \"vscode.languages\"\n    participant ExtHost as \"ExtHostLanguageFeatures\"\n    participant Protocol as \"RPC Protocol\"\n    participant MainThread as \"MainThreadLanguageFeatures\"\n    participant Service as \"ILanguageFeaturesService\"\n    \n    Ext-\u003e\u003eAPI: registerHoverProvider(selector, provider)\n    API-\u003e\u003eExtHost: registerHoverProvider()\n    ExtHost-\u003e\u003eExtHost: Create HoverAdapter\n    ExtHost-\u003e\u003eProtocol: $registerHoverProvider(handle, selector)\n    Protocol-\u003e\u003eMainThread: $registerHoverProvider()\n    MainThread-\u003e\u003eService: hoverProvider.register(selector, provider)\n    Service--\u003e\u003eMainThread: IDisposable\n    MainThread--\u003e\u003eProtocol: Registration complete\n```\n\nSources: [src/vs/workbench/api/common/extHost.api.impl.ts:536-700](), [src/vs/workbench/api/common/extHostLanguageFeatures.ts:4500-4600](), [src/vs/workbench/api/browser/mainThreadLanguageFeatures.ts:250-270]()\n\n## Language Feature Execution Flow\n\nWhen language features are requested (e.g., user hovers over code), the system routes the request back to the appropriate extension through the RPC protocol.\n\n```mermaid\nsequenceDiagram\n    participant Editor as \"Monaco Editor\"\n    participant Provider as \"Language Provider\"\n    participant MainThread as \"MainThreadLanguageFeatures\"\n    participant Protocol as \"RPC Protocol\"\n    participant ExtHost as \"ExtHostLanguageFeatures\"\n    participant Adapter as \"HoverAdapter\"\n    participant Extension as \"Extension Provider\"\n    \n    Editor-\u003e\u003eProvider: provideHover(model, position)\n    Provider-\u003e\u003eMainThread: Registered provider function\n    MainThread-\u003e\u003eProtocol: $provideHover(handle, uri, position)\n    Protocol-\u003e\u003eExtHost: $provideHover()\n    ExtHost-\u003e\u003eAdapter: provideHover()\n    Adapter-\u003e\u003eExtension: provideHover(document, position, token)\n    Extension--\u003e\u003eAdapter: Hover result\n    Adapter--\u003e\u003eExtHost: Converted hover\n    ExtHost--\u003e\u003eProtocol: Hover DTO\n    Protocol--\u003e\u003eMainThread: Hover result\n    MainThread--\u003e\u003eProvider: Hover object\n    Provider--\u003e\u003eEditor: Hover display\n```\n\nSources: [src/vs/workbench/api/common/extHostLanguageFeatures.ts:262-320](), [src/vs/workbench/api/browser/mainThreadLanguageFeatures.ts:257-270](), [src/vs/editor/common/languages.ts:201-208]()\n\n## Core Language Feature Adapters\n\nThe extension host contains adapter classes that bridge the extension API with VS Code's internal language feature interfaces.\n\n### Adapter Architecture\n\n```mermaid\ngraph TB\n    subgraph \"Extension API Types\"\n        vscodeHover[\"vscode.Hover\"]\n        vscodeCompletion[\"vscode.CompletionItem\"]\n        vscodeDefinition[\"vscode.Location\"]\n        vscodeCodeAction[\"vscode.CodeAction\"]\n    end\n    \n    subgraph \"Adapters\"\n        HoverAdapter[\"HoverAdapter\"]\n        CompletionAdapter[\"CompletionItemAdapter\"] \n        DefinitionAdapter[\"DefinitionAdapter\"]\n        CodeActionAdapter[\"CodeActionAdapter\"]\n    end\n    \n    subgraph \"Internal Types\"\n        internalHover[\"languages.Hover\"]\n        internalCompletion[\"languages.CompletionItem\"]\n        internalDefinition[\"languages.LocationLink\"]\n        internalCodeAction[\"languages.CodeAction\"]\n    end\n    \n    subgraph \"Type Converters\"\n        TypeConverters[\"extHostTypeConverters\"]\n    end\n    \n    vscodeHover --\u003e HoverAdapter\n    vscodeCompletion --\u003e CompletionAdapter\n    vscodeDefinition --\u003e DefinitionAdapter\n    vscodeCodeAction --\u003e CodeActionAdapter\n    \n    HoverAdapter --\u003e TypeConverters\n    CompletionAdapter --\u003e TypeConverters\n    DefinitionAdapter --\u003e TypeConverters\n    CodeActionAdapter --\u003e TypeConverters\n    \n    TypeConverters --\u003e internalHover\n    TypeConverters --\u003e internalCompletion\n    TypeConverters --\u003e internalDefinition\n    TypeConverters --\u003e internalCodeAction\n```\n\nSources: [src/vs/workbench/api/common/extHostLanguageFeatures.ts:262-4000](), [src/vs/workbench/api/common/extHostTypeConverters.ts:1-343]()\n\n### Major Language Feature Categories\n\n| Category | Adapters | Purpose |\n|----------|----------|---------|\n| **Navigation** | `DefinitionAdapter`, `DeclarationAdapter`, `ImplementationAdapter`, `TypeDefinitionAdapter` | Go-to-definition, find references |\n| **IntelliSense** | `CompletionItemAdapter`, `SignatureHelpAdapter`, `HoverAdapter` | Code completion and information |\n| **Code Actions** | `CodeActionAdapter`, `CodeLensAdapter` | Quick fixes, refactoring |\n| **Formatting** | `DocumentFormattingEditProvider`, `RangeFormattingEditProvider` | Code formatting |\n| **Symbols** | `DocumentSymbolAdapter`, `WorkspaceSymbolAdapter` | Symbol search and outline |\n\n## RPC Protocol and Communication\n\nCommunication between the main thread and extension host uses a strongly-typed RPC protocol defined in `extHost.protocol.ts`.\n\n### Protocol Interface Definition\n\n```mermaid\ngraph LR\n    subgraph \"Protocol Definitions\"\n        ExtHostShape[\"ExtHostLanguageFeaturesShape\u003cbr/\u003eExtension Host Interface\"]\n        MainThreadShape[\"MainThreadLanguageFeaturesShape\u003cbr/\u003eMain Thread Interface\"]\n        DTOs[\"Protocol DTOs\u003cbr/\u003e(IHoverDto, ICompletionDto, etc.)\"]\n    end\n    \n    subgraph \"Main Thread\"\n        MainThreadImpl[\"MainThreadLanguageFeatures\u003cbr/\u003eimplements MainThreadShape\"]\n        ExtHostProxy[\"Proxy to ExtHost\"]\n    end\n    \n    subgraph \"Extension Host\"\n        ExtHostImpl[\"ExtHostLanguageFeatures\u003cbr/\u003eimplements ExtHostShape\"]  \n        MainThreadProxy[\"Proxy to MainThread\"]\n    end\n    \n    ExtHostShape --\u003e ExtHostImpl\n    MainThreadShape --\u003e MainThreadImpl\n    DTOs --\u003e ExtHostProxy\n    DTOs --\u003e MainThreadProxy\n    \n    MainThreadImpl \u003c--\u003e ExtHostProxy\n    ExtHostImpl \u003c--\u003e MainThreadProxy\n```\n\nSources: [src/vs/workbench/api/common/extHost.protocol.ts:457-503](), [src/vs/workbench/api/common/extHost.protocol.ts:110-528]()\n\n### Key Protocol Methods\n\n| Method Category | Main Thread → Extension Host | Extension Host → Main Thread |\n|-----------------|------------------------------|-------------------------------|\n| **Registration** | N/A | `$registerHoverProvider`, `$registerCompletionProvider` |\n| **Feature Requests** | `$provideHover`, `$provideCompletionItems` | N/A |\n| **Lifecycle** | `$releaseHover`, `$releaseCodeLenses` | `$unregister` |\n\n## Extension API Surface\n\nExtensions interact with language features through the `vscode.languages` namespace, which provides a clean, TypeScript-friendly API.\n\n### API Registration Methods\n\n```typescript\n// From vscode.d.ts API surface\nnamespace languages {\n    export function registerHoverProvider(\n        selector: DocumentSelector, \n        provider: HoverProvider\n    ): Disposable;\n    \n    export function registerCompletionItemProvider(\n        selector: DocumentSelector,\n        provider: CompletionItemProvider,\n        ...triggerCharacters: string[]\n    ): Disposable;\n    \n    export function registerDefinitionProvider(\n        selector: DocumentSelector,\n        provider: DefinitionProvider\n    ): Disposable;\n}\n```\n\nThis API is implemented in `ExtHostLanguageFeatures` through adapter classes that handle the conversion between extension-provided objects and VS Code's internal representations.\n\nSources: [src/vscode-dts/vscode.d.ts:1-288](), [src/vs/workbench/api/common/extHost.api.impl.ts:536-700](), [src/vs/workbench/api/common/extHostLanguageFeatures.ts:4470-4600]()\n\n### Document Selectors and Provider Registration\n\nExtensions specify which files their language features apply to using document selectors, which are converted to internal filter objects and used by the language feature registries.\n\n```mermaid\ngraph LR\n    subgraph \"Extension Input\"\n        DocSelector[\"DocumentSelector\u003cbr/\u003e{ language: 'typescript', scheme: 'file' }\"]\n        Provider[\"HoverProvider\u003cbr/\u003eExtension Implementation\"]\n    end\n    \n    subgraph \"Processing\"\n        Converter[\"DocumentSelector.from()\"]\n        FilterDto[\"IDocumentFilterDto\"]\n    end\n    \n    subgraph \"Registration\"\n        Registry[\"LanguageFeatureRegistry\u003cbr/\u003eHoverProvider\"]\n        InternalProvider[\"Internal Provider Function\"]\n    end\n    \n    DocSelector --\u003e Converter\n    Converter --\u003e FilterDto\n    FilterDto --\u003e Registry\n    Provider --\u003e InternalProvider\n    InternalProvider --\u003e Registry\n```\n\nSources: [src/vs/workbench/api/common/extHostTypeConverters.ts:174-210](), [src/vs/workbench/api/common/extHost.protocol.ts:394-402](), [src/vs/editor/common/languageFeatureRegistry.ts]()\n\n## Error Handling and Performance\n\nThe language features system includes robust error handling and performance monitoring to ensure extensions cannot break the editor experience.\n\n### Error Isolation\n\nEach extension's language feature providers are wrapped in error-catching adapters that prevent exceptions from propagating to the main editor. Failed providers are logged and may be disabled automatically.\n\n### Caching and Lifecycle Management\n\nMany language features use caching mechanisms to improve performance, with proper cleanup when providers are unregistered or extensions are deactivated.\n\nSources: [src/vs/workbench/api/common/extHostLanguageFeatures.ts:105-190](), [src/vs/workbench/api/common/extHostLanguageFeatures.ts:262-320]()"])</script>
    <script>self.__next_f.push([1, "20:T5389,"])</script>
    <script>self.__next_f.push([1, "# Extension Management\n\n\u003cdetails\u003e\n\u003csummary\u003eRelevant source files\u003c/summary\u003e\n\nThe following files were used as context for generating this wiki page:\n\n- [src/vs/platform/extensionManagement/common/abstractExtensionManagementService.ts](src/vs/platform/extensionManagement/common/abstractExtensionManagementService.ts)\n- [src/vs/platform/extensionManagement/common/extensionGalleryService.ts](src/vs/platform/extensionManagement/common/extensionGalleryService.ts)\n- [src/vs/platform/extensionManagement/common/extensionManagement.ts](src/vs/platform/extensionManagement/common/extensionManagement.ts)\n- [src/vs/platform/extensionManagement/common/extensionManagementIpc.ts](src/vs/platform/extensionManagement/common/extensionManagementIpc.ts)\n- [src/vs/platform/extensionManagement/common/extensionManagementUtil.ts](src/vs/platform/extensionManagement/common/extensionManagementUtil.ts)\n- [src/vs/platform/extensionManagement/node/extensionManagementService.ts](src/vs/platform/extensionManagement/node/extensionManagementService.ts)\n- [src/vs/workbench/contrib/extensions/browser/extensionEditor.ts](src/vs/workbench/contrib/extensions/browser/extensionEditor.ts)\n- [src/vs/workbench/contrib/extensions/browser/extensions.contribution.ts](src/vs/workbench/contrib/extensions/browser/extensions.contribution.ts)\n- [src/vs/workbench/contrib/extensions/browser/extensionsActions.ts](src/vs/workbench/contrib/extensions/browser/extensionsActions.ts)\n- [src/vs/workbench/contrib/extensions/browser/extensionsList.ts](src/vs/workbench/contrib/extensions/browser/extensionsList.ts)\n- [src/vs/workbench/contrib/extensions/browser/extensionsViewer.ts](src/vs/workbench/contrib/extensions/browser/extensionsViewer.ts)\n- [src/vs/workbench/contrib/extensions/browser/extensionsViewlet.ts](src/vs/workbench/contrib/extensions/browser/extensionsViewlet.ts)\n- [src/vs/workbench/contrib/extensions/browser/extensionsViews.ts](src/vs/workbench/contrib/extensions/browser/extensionsViews.ts)\n- [src/vs/workbench/contrib/extensions/browser/extensionsWidgets.ts](src/vs/workbench/contrib/extensions/browser/extensionsWidgets.ts)\n- [src/vs/workbench/contrib/extensions/browser/extensionsWorkbenchService.ts](src/vs/workbench/contrib/extensions/browser/extensionsWorkbenchService.ts)\n- [src/vs/workbench/contrib/extensions/browser/media/extension.css](src/vs/workbench/contrib/extensions/browser/media/extension.css)\n- [src/vs/workbench/contrib/extensions/browser/media/extensionActions.css](src/vs/workbench/contrib/extensions/browser/media/extensionActions.css)\n- [src/vs/workbench/contrib/extensions/browser/media/extensionEditor.css](src/vs/workbench/contrib/extensions/browser/media/extensionEditor.css)\n- [src/vs/workbench/contrib/extensions/browser/media/extensionsViewlet.css](src/vs/workbench/contrib/extensions/browser/media/extensionsViewlet.css)\n- [src/vs/workbench/contrib/extensions/browser/media/extensionsWidgets.css](src/vs/workbench/contrib/extensions/browser/media/extensionsWidgets.css)\n- [src/vs/workbench/contrib/extensions/common/extensions.ts](src/vs/workbench/contrib/extensions/common/extensions.ts)\n- [src/vs/workbench/contrib/extensions/test/electron-browser/extensionRecommendationsService.test.ts](src/vs/workbench/contrib/extensions/test/electron-browser/extensionRecommendationsService.test.ts)\n- [src/vs/workbench/contrib/extensions/test/electron-browser/extensionsActions.test.ts](src/vs/workbench/contrib/extensions/test/electron-browser/extensionsActions.test.ts)\n- [src/vs/workbench/contrib/extensions/test/electron-browser/extensionsViews.test.ts](src/vs/workbench/contrib/extensions/test/electron-browser/extensionsViews.test.ts)\n- [src/vs/workbench/contrib/extensions/test/electron-browser/extensionsWorkbenchService.test.ts](src/vs/workbench/contrib/extensions/test/electron-browser/extensionsWorkbenchService.test.ts)\n- [src/vs/workbench/services/extensionManagement/browser/extensionEnablementService.ts](src/vs/workbench/services/extensionManagement/browser/extensionEnablementService.ts)\n- [src/vs/workbench/services/extensionManagement/common/extensionManagement.ts](src/vs/workbench/services/extensionManagement/common/extensionManagement.ts)\n- [src/vs/workbench/services/extensionManagement/common/extensionManagementChannelClient.ts](src/vs/workbench/services/extensionManagement/common/extensionManagementChannelClient.ts)\n- [src/vs/workbench/services/extensionManagement/common/extensionManagementServerService.ts](src/vs/workbench/services/extensionManagement/common/extensionManagementServerService.ts)\n- [src/vs/workbench/services/extensionManagement/common/extensionManagementService.ts](src/vs/workbench/services/extensionManagement/common/extensionManagementService.ts)\n- [src/vs/workbench/services/extensionManagement/common/webExtensionManagementService.ts](src/vs/workbench/services/extensionManagement/common/webExtensionManagementService.ts)\n- [src/vs/workbench/services/extensionManagement/electron-browser/extensionManagementServerService.ts](src/vs/workbench/services/extensionManagement/electron-browser/extensionManagementServerService.ts)\n- [src/vs/workbench/services/extensionManagement/electron-browser/remoteExtensionManagementService.ts](src/vs/workbench/services/extensionManagement/electron-browser/remoteExtensionManagementService.ts)\n- [src/vs/workbench/services/extensionManagement/test/browser/extensionEnablementService.test.ts](src/vs/workbench/services/extensionManagement/test/browser/extensionEnablementService.test.ts)\n\n\u003c/details\u003e\n\n\n\nThis document covers VS Code's extension management system, which handles the discovery, installation, updating, and lifecycle management of extensions within the workbench. The system encompasses both platform-level services for core extension operations and workbench-level components for user interface and interaction.\n\nFor information about the extension host and runtime execution of extensions, see [Extension Host and Language Features](#4.1). For details about the build system that packages extensions, see [Build System and Package Management](#1.2).\n\n## Architecture Overview\n\nThe extension management system is organized into multiple layers that separate platform concerns from workbench-specific functionality:\n\n### Extension Management System Architecture\n\n```mermaid\ngraph TB\n    subgraph \"Platform Layer\"\n        ExtMgmt[\"ExtensionManagementService\"]\n        Gallery[\"ExtensionGalleryService\"]\n        Scanner[\"ExtensionsScannerService\"]\n        Downloader[\"ExtensionsDownloader\"]\n    end\n    \n    subgraph \"Workbench Layer\"\n        WorkbenchExtMgmt[\"ExtensionManagementService\"]\n        Enablement[\"ExtensionEnablementService\"]\n        WorkbenchSvc[\"ExtensionsWorkbenchService\"]\n        RecommendationSvc[\"ExtensionRecommendationsService\"]\n    end\n    \n    subgraph \"UI Layer\"\n        ExtActions[\"ExtensionsActions\"]\n        ExtViews[\"ExtensionsViews\"]\n        ExtEditor[\"ExtensionEditor\"]\n        ExtViewlet[\"ExtensionsViewPaneContainer\"]\n    end\n    \n    subgraph \"Extension Host\"\n        ExtHost[\"Extension Host Process\"]\n    end\n    \n    ExtMgmt --\u003e Scanner\n    ExtMgmt --\u003e Downloader\n    Gallery --\u003e ExtMgmt\n    \n    WorkbenchExtMgmt --\u003e ExtMgmt\n    Enablement --\u003e WorkbenchExtMgmt\n    WorkbenchSvc --\u003e WorkbenchExtMgmt\n    WorkbenchSvc --\u003e Gallery\n    WorkbenchSvc --\u003e RecommendationSvc\n    \n    ExtActions --\u003e WorkbenchSvc\n    ExtViews --\u003e WorkbenchSvc\n    ExtEditor --\u003e WorkbenchSvc\n    ExtViewlet --\u003e ExtViews\n    \n    WorkbenchExtMgmt --\u003e ExtHost\n```\n\nSources: [src/vs/workbench/contrib/extensions/browser/extensions.contribution.ts:88-91](), [src/vs/workbench/services/extensionManagement/common/extensionManagementService.ts:59-129](), [src/vs/platform/extensionManagement/node/extensionManagementService.ts:72-106]()\n\n## Core Extension Management Services\n\n### IExtensionManagementService\n\nThe `IExtensionManagementService` is the primary interface for extension lifecycle operations. The platform-level implementation handles the actual installation, uninstallation, and scanning of extensions.\n\n```mermaid\ngraph LR\n    subgraph \"Extension Management Services\"\n        IExtMgmt[\"IExtensionManagementService\"]\n        NativeExtMgmt[\"ExtensionManagementService (Native)\"]\n        WebExtMgmt[\"WebExtensionManagementService\"]\n        AbstractExtMgmt[\"AbstractExtensionManagementService\"]\n    end\n    \n    subgraph \"Core Operations\"\n        Install[\"install()\"]\n        Uninstall[\"uninstall()\"]\n        GetInstalled[\"getInstalled()\"]\n        UpdateMetadata[\"updateMetadata()\"]\n    end\n    \n    IExtMgmt --\u003e NativeExtMgmt\n    IExtMgmt --\u003e WebExtMgmt\n    AbstractExtMgmt --\u003e NativeExtMgmt\n    AbstractExtMgmt --\u003e WebExtMgmt\n    \n    NativeExtMgmt --\u003e Install\n    NativeExtMgmt --\u003e Uninstall\n    NativeExtMgmt --\u003e GetInstalled\n    NativeExtMgmt --\u003e UpdateMetadata\n```\n\nKey responsibilities include:\n- Installing extensions from VSIX files or gallery\n- Uninstalling extensions and cleaning up files\n- Scanning installed extensions\n- Managing extension metadata and profiles\n\nSources: [src/vs/platform/extensionManagement/common/extensionManagement.ts:525-543](), [src/vs/platform/extensionManagement/node/extensionManagementService.ts:72-243]()\n\n### ExtensionsWorkbenchService\n\nThe `ExtensionsWorkbenchService` provides the main workbench-level API for extension operations:\n\n```mermaid\ngraph TB\n    subgraph \"ExtensionsWorkbenchService\"\n        WorkbenchSvc[\"ExtensionsWorkbenchService\"]\n        ExtensionModel[\"Extension Model\"]\n        QueryEngine[\"Query Engine\"]\n        UpdateChecker[\"Auto Update Checker\"]\n    end\n    \n    subgraph \"Extension States\"\n        Installing[\"Installing\"]\n        Installed[\"Installed\"]\n        Uninstalling[\"Uninstalling\"]\n        Uninstalled[\"Uninstalled\"]\n    end\n    \n    subgraph \"Data Sources\"\n        Local[\"Local Extensions\"]\n        Gallery[\"Gallery Extensions\"]\n        Recommendations[\"Recommendations\"]\n    end\n    \n    WorkbenchSvc --\u003e ExtensionModel\n    WorkbenchSvc --\u003e QueryEngine\n    WorkbenchSvc --\u003e UpdateChecker\n    \n    ExtensionModel --\u003e Installing\n    ExtensionModel --\u003e Installed\n    ExtensionModel --\u003e Uninstalling\n    ExtensionModel --\u003e Uninstalled\n    \n    QueryEngine --\u003e Local\n    QueryEngine --\u003e Gallery\n    QueryEngine --\u003e Recommendations\n```\n\nThe service manages:\n- Extension state tracking and notifications\n- Auto-update functionality\n- Extension queries and filtering\n- Integration with gallery and local extension sources\n\nSources: [src/vs/workbench/contrib/extensions/browser/extensionsWorkbenchService.ts:591-735](), [src/vs/workbench/contrib/extensions/common/extensions.ts:39-44]()\n\n## Extension Gallery Integration\n\n### ExtensionGalleryService\n\nThe `ExtensionGalleryService` handles communication with the VS Code Marketplace:\n\n```mermaid\ngraph LR\n    subgraph \"Gallery Service\"\n        GallerySvc[\"ExtensionGalleryService\"]\n        Query[\"query()\"]\n        GetExtensions[\"getExtensions()\"]\n        Download[\"download()\"]\n        GetManifest[\"getManifest()\"]\n    end\n    \n    subgraph \"Marketplace API\"\n        MarketplaceAPI[\"VS Code Marketplace\"]\n        QueryEndpoint[\"/extensionquery\"]\n        AssetEndpoint[\"/assets\"]\n    end\n    \n    subgraph \"Gallery Operations\"\n        Search[\"Extension Search\"]\n        Metadata[\"Extension Metadata\"]\n        Assets[\"Extension Assets\"]\n        Statistics[\"Usage Statistics\"]\n    end\n    \n    GallerySvc --\u003e Query\n    GallerySvc --\u003e GetExtensions\n    GallerySvc --\u003e Download\n    GallerySvc --\u003e GetManifest\n    \n    Query --\u003e QueryEndpoint\n    Download --\u003e AssetEndpoint\n    GetManifest --\u003e AssetEndpoint\n    \n    Query --\u003e Search\n    GetExtensions --\u003e Metadata\n    Download --\u003e Assets\n    Query --\u003e Statistics\n```\n\nKey capabilities:\n- Searching and filtering extensions in the marketplace\n- Downloading extension packages and assets\n- Retrieving extension manifests and metadata\n- Reporting usage statistics\n\nSources: [src/vs/platform/extensionManagement/common/extensionGalleryService.ts:396-421](), [src/vs/platform/extensionManagement/common/extensionManagement.ts:396-421]()\n\n## Extension Installation and Management\n\n### Installation Process\n\nThe extension installation process involves multiple coordinated steps:\n\n```mermaid\ngraph TD\n    StartInstall[\"Install Request\"]\n    ValidateExt[\"Validate Extension\"]\n    CheckCompat[\"Check Compatibility\"]\n    DownloadExt[\"Download Extension\"]\n    ExtractVSIX[\"Extract VSIX\"]\n    ScanMetadata[\"Scan Metadata\"]\n    UpdateProfile[\"Update Profile\"]\n    NotifyInstalled[\"Notify Installation Complete\"]\n    \n    StartInstall --\u003e ValidateExt\n    ValidateExt --\u003e CheckCompat\n    CheckCompat --\u003e DownloadExt\n    DownloadExt --\u003e ExtractVSIX\n    ExtractVSIX --\u003e ScanMetadata\n    ScanMetadata --\u003e UpdateProfile\n    UpdateProfile --\u003e NotifyInstalled\n    \n    subgraph \"Validation Steps\"\n        ValidateExt\n        CheckCompat\n    end\n    \n    subgraph \"Download \u0026 Extract\"\n        DownloadExt\n        ExtractVSIX\n    end\n    \n    subgraph \"Registration\"\n        ScanMetadata\n        UpdateProfile\n    end\n```\n\nThe `InstallExtensionTask` class coordinates this process:\n\nSources: [src/vs/platform/extensionManagement/node/extensionManagementService.ts:280-293](), [src/vs/platform/extensionManagement/common/abstractExtensionManagementService.ts:37-50]()\n\n### Extension Actions\n\nExtension actions provide the user interface for extension operations:\n\n```mermaid\ngraph TB\n    subgraph \"Extension Actions\"\n        InstallAction[\"InstallAction\"]\n        UninstallAction[\"UninstallAction\"]\n        UpdateAction[\"UpdateAction\"]\n        EnableAction[\"EnableDropDownAction\"]\n        DisableAction[\"DisableDropDownAction\"]\n    end\n    \n    subgraph \"Compound Actions\"\n        InstallDropdown[\"InstallDropdownAction\"]\n        ButtonWithDropdown[\"ButtonWithDropDownExtensionAction\"]\n        ManageAction[\"ExtensionEditorManageExtensionAction\"]\n    end\n    \n    subgraph \"Status Actions\"\n        StatusAction[\"ExtensionStatusAction\"]\n        RuntimeAction[\"ExtensionRuntimeStateAction\"]\n        InstallingAction[\"InstallingLabelAction\"]\n    end\n    \n    InstallDropdown --\u003e InstallAction\n    ButtonWithDropdown --\u003e UninstallAction\n    ManageAction --\u003e EnableAction\n    ManageAction --\u003e DisableAction\n    \n    InstallAction --\u003e StatusAction\n    UpdateAction --\u003e RuntimeAction\n    InstallAction --\u003e InstallingAction\n```\n\nAction classes extend `ExtensionAction` and provide:\n- Context-sensitive visibility and enablement\n- Integration with extension state changes\n- Dropdown menus for complex operations\n\nSources: [src/vs/workbench/contrib/extensions/browser/extensionsActions.ts:285-319](), [src/vs/workbench/contrib/extensions/browser/extensionsActions.ts:428-496]()\n\n## Extension Views and UI\n\n### Extensions Viewlet Structure\n\nThe Extensions viewlet organizes extension management into multiple specialized views:\n\n```mermaid\ngraph TB\n    subgraph \"Extensions Viewlet\"\n        ViewPaneContainer[\"ExtensionsViewPaneContainer\"]\n        SearchInput[\"Extension Search Input\"]\n        ViewRegistry[\"Views Registry\"]\n    end\n    \n    subgraph \"Extension Views\"\n        InstalledView[\"Server Installed Extensions View\"]\n        RecommendedView[\"Recommended Extensions View\"]\n        PopularView[\"Popular Extensions View\"]\n        EnabledView[\"Enabled Extensions View\"]\n        DisabledView[\"Disabled Extensions View\"]\n        OutdatedView[\"Outdated Extensions View\"]\n        BuiltinView[\"Built-in Extensions View\"]\n    end\n    \n    subgraph \"Specialized Views\"\n        WorkspaceRec[\"Workspace Recommendations\"]\n        UntrustedView[\"Untrusted Workspace Extensions\"]\n        VirtualView[\"Virtual Workspace Extensions\"]\n        DeprecatedView[\"Deprecated Extensions\"]\n    end\n    \n    ViewPaneContainer --\u003e SearchInput\n    ViewPaneContainer --\u003e ViewRegistry\n    \n    ViewRegistry --\u003e InstalledView\n    ViewRegistry --\u003e RecommendedView\n    ViewRegistry --\u003e PopularView\n    ViewRegistry --\u003e EnabledView\n    ViewRegistry --\u003e DisabledView\n    ViewRegistry --\u003e OutdatedView\n    ViewRegistry --\u003e BuiltinView\n    \n    ViewRegistry --\u003e WorkspaceRec\n    ViewRegistry --\u003e UntrustedView\n    ViewRegistry --\u003e VirtualView\n    ViewRegistry --\u003e DeprecatedView\n```\n\nEach view is registered dynamically based on context and provides filtered extension lists with specific query criteria.\n\nSources: [src/vs/workbench/contrib/extensions/browser/extensionsViewlet.ts:111-132](), [src/vs/workbench/contrib/extensions/browser/extensionsViews.ts:112-171]()\n\n### Extension Editor\n\nThe `ExtensionEditor` displays detailed information about individual extensions:\n\n```mermaid\ngraph LR\n    subgraph \"Extension Editor\"\n        EditorPane[\"ExtensionEditor\"]\n        Template[\"Editor Template\"]\n        Navbar[\"Navigation Bar\"]\n        Content[\"Content Container\"]\n    end\n    \n    subgraph \"Editor Tabs\"\n        Readme[\"Readme Tab\"]\n        Features[\"Features Tab\"]\n        Changelog[\"Changelog Tab\"]\n        Dependencies[\"Dependencies Tab\"]\n        ExtensionPack[\"Extension Pack Tab\"]\n    end\n    \n    subgraph \"Header Components\"\n        Icon[\"Extension Icon\"]\n        Title[\"Extension Title\"]\n        Publisher[\"Publisher Info\"]\n        Actions[\"Action Bar\"]\n        Status[\"Status Widget\"]\n    end\n    \n    EditorPane --\u003e Template\n    Template --\u003e Navbar\n    Template --\u003e Content\n    \n    Navbar --\u003e Readme\n    Navbar --\u003e Features\n    Navbar --\u003e Changelog\n    Navbar --\u003e Dependencies\n    Navbar --\u003e ExtensionPack\n    \n    Template --\u003e Icon\n    Template --\u003e Title\n    Template --\u003e Publisher\n    Template --\u003e Actions\n    Template --\u003e Status\n```\n\nThe editor provides comprehensive extension information including manifests, readme content, and interactive actions.\n\nSources: [src/vs/workbench/contrib/extensions/browser/extensionEditor.ts:209-256](), [src/vs/workbench/contrib/extensions/browser/extensionEditor.ts:426-456]()\n\n## Extension Enablement and State Management\n\n### Extension Enablement Service\n\nThe `ExtensionEnablementService` manages the enabled/disabled state of extensions:\n\n```mermaid\ngraph TB\n    subgraph \"Enablement Service\"\n        EnablementSvc[\"ExtensionEnablementService\"]\n        GlobalStorage[\"Global Enablement Storage\"]\n        WorkspaceStorage[\"Workspace Enablement Storage\"]\n        StateProvider[\"Enablement State Provider\"]\n    end\n    \n    subgraph \"Enablement States\"\n        EnabledGlobally[\"EnabledGlobally\"]\n        DisabledGlobally[\"DisabledGlobally\"]\n        EnabledWorkspace[\"EnabledWorkspace\"]\n        DisabledWorkspace[\"DisabledWorkspace\"]\n        DisabledByTrust[\"DisabledByTrustRequirement\"]\n        DisabledByVirtual[\"DisabledByVirtualWorkspace\"]\n        DisabledByMalicious[\"DisabledByMalicious\"]\n    end\n    \n    subgraph \"State Influences\"\n        WorkspaceTrust[\"Workspace Trust\"]\n        VirtualWorkspace[\"Virtual Workspace\"]\n        MaliciousExt[\"Malicious Extensions\"]\n        UserConfig[\"User Configuration\"]\n    end\n    \n    EnablementSvc --\u003e GlobalStorage\n    EnablementSvc --\u003e WorkspaceStorage\n    EnablementSvc --\u003e StateProvider\n    \n    StateProvider --\u003e EnabledGlobally\n    StateProvider --\u003e DisabledGlobally\n    StateProvider --\u003e EnabledWorkspace\n    StateProvider --\u003e DisabledWorkspace\n    StateProvider --\u003e DisabledByTrust\n    StateProvider --\u003e DisabledByVirtual\n    StateProvider --\u003e DisabledByMalicious\n    \n    WorkspaceTrust --\u003e DisabledByTrust\n    VirtualWorkspace --\u003e DisabledByVirtual\n    MaliciousExt --\u003e DisabledByMalicious\n    UserConfig --\u003e DisabledGlobally\n```\n\nThe service considers multiple factors when determining extension enablement including workspace trust, virtual workspace support, and malicious extension detection.\n\nSources: [src/vs/workbench/services/extensionManagement/browser/extensionEnablementService.ts:1-49](), [src/vs/workbench/services/extensionManagement/common/extensionManagement.ts:85-128]()\n\n## Extension Lifecycle Events\n\n### Event Flow Architecture\n\nExtension management operations trigger events that coordinate updates across the system:\n\n```mermaid\ngraph TD\n    subgraph \"Installation Events\"\n        InstallStart[\"onInstallExtension\"]\n        InstallComplete[\"onDidInstallExtensions\"]\n        InstallError[\"Installation Error\"]\n    end\n    \n    subgraph \"Uninstallation Events\"\n        UninstallStart[\"onUninstallExtension\"]\n        UninstallComplete[\"onDidUninstallExtension\"]\n        UninstallError[\"Uninstallation Error\"]\n    end\n    \n    subgraph \"State Change Events\"\n        EnablementChange[\"onEnablementChanged\"]\n        MetadataUpdate[\"onDidUpdateExtensionMetadata\"]\n        ProfileChange[\"onDidChangeProfile\"]\n    end\n    \n    subgraph \"Listeners\"\n        WorkbenchService[\"ExtensionsWorkbenchService\"]\n        StatusUpdater[\"StatusUpdater\"]\n        ActivityService[\"ActivityService\"]\n        RecommendationService[\"RecommendationService\"]\n    end\n    \n    InstallStart --\u003e WorkbenchService\n    InstallComplete --\u003e WorkbenchService\n    InstallComplete --\u003e StatusUpdater\n    \n    UninstallComplete --\u003e WorkbenchService\n    UninstallComplete --\u003e ActivityService\n    \n    EnablementChange --\u003e WorkbenchService\n    MetadataUpdate --\u003e WorkbenchService\n    ProfileChange --\u003e RecommendationService\n```\n\nEvent coordination ensures that UI components stay synchronized with extension state changes and that dependent services are notified of relevant changes.\n\nSources: [src/vs/workbench/contrib/extensions/browser/extensionsWorkbenchService.ts:593-622](), [src/vs/workbench/services/extensionManagement/common/extensionManagementService.ts:65-87]()"])</script>
    <script>self.__next_f.push([1, "21:T4a32,"])</script>
    <script>self.__next_f.push([1, "# Integrated Terminal\n\n\u003cdetails\u003e\n\u003csummary\u003eRelevant source files\u003c/summary\u003e\n\nThe following files were used as context for generating this wiki page:\n\n- [src/vs/platform/terminal/common/terminal.ts](src/vs/platform/terminal/common/terminal.ts)\n- [src/vs/platform/terminal/node/ptyHostService.ts](src/vs/platform/terminal/node/ptyHostService.ts)\n- [src/vs/platform/terminal/node/ptyService.ts](src/vs/platform/terminal/node/ptyService.ts)\n- [src/vs/platform/terminal/node/terminalProcess.ts](src/vs/platform/terminal/node/terminalProcess.ts)\n- [src/vs/workbench/api/browser/mainThreadTerminalService.ts](src/vs/workbench/api/browser/mainThreadTerminalService.ts)\n- [src/vs/workbench/api/common/extHostTerminalService.ts](src/vs/workbench/api/common/extHostTerminalService.ts)\n- [src/vs/workbench/api/node/extHostTerminalService.ts](src/vs/workbench/api/node/extHostTerminalService.ts)\n- [src/vs/workbench/contrib/terminal/browser/media/terminal.css](src/vs/workbench/contrib/terminal/browser/media/terminal.css)\n- [src/vs/workbench/contrib/terminal/browser/media/xterm.css](src/vs/workbench/contrib/terminal/browser/media/xterm.css)\n- [src/vs/workbench/contrib/terminal/browser/remotePty.ts](src/vs/workbench/contrib/terminal/browser/remotePty.ts)\n- [src/vs/workbench/contrib/terminal/browser/terminal.contribution.ts](src/vs/workbench/contrib/terminal/browser/terminal.contribution.ts)\n- [src/vs/workbench/contrib/terminal/browser/terminal.ts](src/vs/workbench/contrib/terminal/browser/terminal.ts)\n- [src/vs/workbench/contrib/terminal/browser/terminalActions.ts](src/vs/workbench/contrib/terminal/browser/terminalActions.ts)\n- [src/vs/workbench/contrib/terminal/browser/terminalEditor.ts](src/vs/workbench/contrib/terminal/browser/terminalEditor.ts)\n- [src/vs/workbench/contrib/terminal/browser/terminalEditorInput.ts](src/vs/workbench/contrib/terminal/browser/terminalEditorInput.ts)\n- [src/vs/workbench/contrib/terminal/browser/terminalEditorService.ts](src/vs/workbench/contrib/terminal/browser/terminalEditorService.ts)\n- [src/vs/workbench/contrib/terminal/browser/terminalGroup.ts](src/vs/workbench/contrib/terminal/browser/terminalGroup.ts)\n- [src/vs/workbench/contrib/terminal/browser/terminalGroupService.ts](src/vs/workbench/contrib/terminal/browser/terminalGroupService.ts)\n- [src/vs/workbench/contrib/terminal/browser/terminalInstance.ts](src/vs/workbench/contrib/terminal/browser/terminalInstance.ts)\n- [src/vs/workbench/contrib/terminal/browser/terminalMenus.ts](src/vs/workbench/contrib/terminal/browser/terminalMenus.ts)\n- [src/vs/workbench/contrib/terminal/browser/terminalProcessExtHostProxy.ts](src/vs/workbench/contrib/terminal/browser/terminalProcessExtHostProxy.ts)\n- [src/vs/workbench/contrib/terminal/browser/terminalProcessManager.ts](src/vs/workbench/contrib/terminal/browser/terminalProcessManager.ts)\n- [src/vs/workbench/contrib/terminal/browser/terminalProfileResolverService.ts](src/vs/workbench/contrib/terminal/browser/terminalProfileResolverService.ts)\n- [src/vs/workbench/contrib/terminal/browser/terminalProfileService.ts](src/vs/workbench/contrib/terminal/browser/terminalProfileService.ts)\n- [src/vs/workbench/contrib/terminal/browser/terminalService.ts](src/vs/workbench/contrib/terminal/browser/terminalService.ts)\n- [src/vs/workbench/contrib/terminal/browser/terminalTabbedView.ts](src/vs/workbench/contrib/terminal/browser/terminalTabbedView.ts)\n- [src/vs/workbench/contrib/terminal/browser/terminalTabsList.ts](src/vs/workbench/contrib/terminal/browser/terminalTabsList.ts)\n- [src/vs/workbench/contrib/terminal/browser/terminalView.ts](src/vs/workbench/contrib/terminal/browser/terminalView.ts)\n- [src/vs/workbench/contrib/terminal/browser/xterm/xtermTerminal.ts](src/vs/workbench/contrib/terminal/browser/xterm/xtermTerminal.ts)\n- [src/vs/workbench/contrib/terminal/common/terminal.ts](src/vs/workbench/contrib/terminal/common/terminal.ts)\n- [src/vs/workbench/contrib/terminal/common/terminalColorRegistry.ts](src/vs/workbench/contrib/terminal/common/terminalColorRegistry.ts)\n- [src/vs/workbench/contrib/terminal/common/terminalConfiguration.ts](src/vs/workbench/contrib/terminal/common/terminalConfiguration.ts)\n- [src/vs/workbench/contrib/terminal/common/terminalStrings.ts](src/vs/workbench/contrib/terminal/common/terminalStrings.ts)\n\n\u003c/details\u003e\n\n\n\nThe Integrated Terminal system provides command-line access directly within VS Code, enabling users to run shell commands, scripts, and development tools without leaving the editor. This system manages terminal processes, user interfaces, extension APIs, and integrates with VS Code's workbench architecture.\n\nFor information about terminal contributions and extensions, see the Extension System documentation. For task-related terminal usage, see the Task System documentation.\n\n## Architecture Overview\n\nThe terminal system operates across multiple processes and follows VS Code's layered architecture:\n\n### Process Architecture\n\n```mermaid\ngraph TB\n    subgraph \"Main Process\"\n        MainApp[\"Application\"]\n        FileSystem[\"File System Access\"]\n    end\n    \n    subgraph \"Renderer Process\"\n        TerminalService[\"TerminalService\"]\n        TerminalGroupService[\"TerminalGroupService\"]\n        TerminalEditorService[\"TerminalEditorService\"]\n        TerminalInstanceService[\"TerminalInstanceService\"]\n        XtermTerminal[\"XtermTerminal\"]\n        TerminalViewPane[\"TerminalViewPane\"]\n    end\n    \n    subgraph \"Extension Host Process\"\n        ExtHostTerminalService[\"ExtHostTerminalService\"]\n        ExtHostTerminal[\"ExtHostTerminal\"]\n        ExtensionAPI[\"Extension Terminal API\"]\n    end\n    \n    subgraph \"Pty Host Process\"\n        PtyService[\"PtyService\"]\n        TerminalProcess[\"TerminalProcess\"]\n        NodePty[\"node-pty\"]\n        ShellProcesses[\"Shell Processes\"]\n    end\n    \n    MainApp -.-\u003e|\"IPC\"| TerminalService\n    TerminalService \u003c-.-\u003e|\"RPC\"| ExtHostTerminalService\n    TerminalService \u003c-.-\u003e|\"IPC\"| PtyService\n    ExtHostTerminalService --\u003e ExtHostTerminal\n    ExtHostTerminal --\u003e ExtensionAPI\n    PtyService --\u003e TerminalProcess\n    TerminalProcess --\u003e NodePty\n    NodePty --\u003e ShellProcesses\n    \n    TerminalService --\u003e TerminalGroupService\n    TerminalService --\u003e TerminalEditorService\n    TerminalService --\u003e TerminalInstanceService\n    TerminalInstanceService --\u003e XtermTerminal\n    TerminalGroupService --\u003e TerminalViewPane\n```\n\nSources: [src/vs/workbench/contrib/terminal/browser/terminalService.ts:62-241](), [src/vs/platform/terminal/node/ptyService.ts:71-122](), [src/vs/workbench/api/common/extHostTerminalService.ts:32-61]()\n\n### Core Service Dependencies\n\n```mermaid\ngraph TB\n    subgraph \"Terminal Services\"\n        ITerminalService[\"ITerminalService\u003cbr/\u003e(terminalService.ts)\"]\n        ITerminalConfigurationService[\"ITerminalConfigurationService\u003cbr/\u003e(terminalConfigurationService.ts)\"]\n        ITerminalGroupService[\"ITerminalGroupService\u003cbr/\u003e(terminalGroupService.ts)\"]\n        ITerminalEditorService[\"ITerminalEditorService\u003cbr/\u003e(terminalEditorService.ts)\"]\n        ITerminalInstanceService[\"ITerminalInstanceService\u003cbr/\u003e(terminalInstanceService.ts)\"]\n        ITerminalProfileService[\"ITerminalProfileService\u003cbr/\u003e(terminalProfileService.ts)\"]\n        ITerminalProfileResolverService[\"ITerminalProfileResolverService\u003cbr/\u003e(terminalProfileResolverService.ts)\"]\n    end\n    \n    subgraph \"Core Instances\"\n        TerminalInstance[\"TerminalInstance\u003cbr/\u003e(terminalInstance.ts)\"]\n        TerminalGroup[\"TerminalGroup\u003cbr/\u003e(terminalGroup.ts)\"]\n        TerminalProcessManager[\"TerminalProcessManager\u003cbr/\u003e(terminalProcessManager.ts)\"]\n        XtermTerminal[\"XtermTerminal\u003cbr/\u003e(xtermTerminal.ts)\"]\n    end\n    \n    subgraph \"Backend Services\"\n        ITerminalBackend[\"ITerminalBackend\"]\n        IPtyService[\"IPtyService\u003cbr/\u003e(ptyService.ts)\"]\n    end\n    \n    ITerminalService --\u003e ITerminalGroupService\n    ITerminalService --\u003e ITerminalEditorService\n    ITerminalService --\u003e ITerminalInstanceService\n    ITerminalService --\u003e ITerminalConfigurationService\n    \n    ITerminalInstanceService --\u003e TerminalInstance\n    ITerminalGroupService --\u003e TerminalGroup\n    TerminalGroup --\u003e TerminalInstance\n    \n    TerminalInstance --\u003e TerminalProcessManager\n    TerminalInstance --\u003e XtermTerminal\n    TerminalProcessManager --\u003e ITerminalBackend\n    ITerminalBackend --\u003e IPtyService\n    \n    ITerminalProfileResolverService --\u003e ITerminalProfileService\n    ITerminalConfigurationService --\u003e ITerminalProfileService\n```\n\nSources: [src/vs/workbench/contrib/terminal/browser/terminal.ts:36-41](), [src/vs/workbench/contrib/terminal/browser/terminalService.ts:170-192](), [src/vs/workbench/contrib/terminal/common/terminal.ts:44-87]()\n\n## Core Services\n\n### TerminalService\n\nThe `TerminalService` is the primary orchestrator for all terminal operations, implementing `ITerminalService` and serving as the main entry point for terminal management.\n\n**Key Responsibilities:**\n- Creating and disposing terminal instances\n- Managing active terminals across panel and editor locations\n- Coordinating between different terminal hosts\n- Handling terminal reconnection and persistence\n- Managing backend connections\n\n**Core Methods:**\n- `createTerminal(options?: ICreateTerminalOptions): Promise\u003cITerminalInstance\u003e`\n- `getActiveOrCreateInstance(): Promise\u003cITerminalInstance\u003e`\n- `setActiveInstance(value: ITerminalInstance): void`\n- `moveToEditor(source: ITerminalInstance): void`\n- `safeDisposeTerminal(instance: ITerminalInstance): Promise\u003cvoid\u003e`\n\nSources: [src/vs/workbench/contrib/terminal/browser/terminalService.ts:62-342](), [src/vs/workbench/contrib/terminal/browser/terminal.ts:246-358]()\n\n### TerminalInstance\n\n`TerminalInstance` represents individual terminal instances and manages their lifecycle, UI rendering, and process communication.\n\n**Key Properties:**\n- `instanceId: number` - Unique identifier\n- `processId: number | undefined` - Shell process ID\n- `target: TerminalLocation` - Panel or editor location\n- `xterm?: XtermTerminal` - xterm.js wrapper\n- `capabilities: ITerminalCapabilityStore` - Terminal capabilities\n\n**Key Events:**\n- `onData: Event\u003cstring\u003e` - Terminal output data\n- `onExit: Event\u003cnumber | ITerminalLaunchError | undefined\u003e` - Process exit\n- `onTitleChanged: Event\u003cITerminalInstance\u003e` - Title updates\n\nSources: [src/vs/workbench/contrib/terminal/browser/terminalInstance.ts:127-648](), [src/vs/workbench/contrib/terminal/browser/terminal.ts:477-766]()\n\n### TerminalProcessManager\n\n`TerminalProcessManager` handles the communication between terminal instances and their underlying processes, managing process state and capabilities.\n\n**Process States:**\n- `Uninitialized` - Not yet created\n- `Launching` - Being created\n- `Running` - Active process\n- `KilledDuringLaunch` - Failed to start\n- `KilledByUser` - User terminated\n- `KilledByProcess` - Process terminated itself\n\n**Key Methods:**\n- `createProcess(shellLaunchConfig, cols, rows): Promise\u003cITerminalLaunchError | undefined\u003e`\n- `write(data: string): Promise\u003cvoid\u003e`\n- `setDimensions(cols: number, rows: number): Promise\u003cvoid\u003e`\n\nSources: [src/vs/workbench/contrib/terminal/browser/terminalProcessManager.ts:70-155](), [src/vs/workbench/contrib/terminal/common/terminal.ts:314-331]()\n\n## Terminal Lifecycle\n\n### Terminal Creation Flow\n\n```mermaid\nsequenceDiagram\n    participant User\n    participant TerminalService\n    participant TerminalInstanceService\n    participant TerminalInstance\n    participant TerminalProcessManager\n    participant PtyService\n    participant TerminalProcess\n\n    User-\u003e\u003eTerminalService: \"createTerminal(options)\"\n    TerminalService-\u003e\u003eTerminalInstanceService: \"createInstance(launchConfig, target)\"\n    TerminalInstanceService-\u003e\u003eTerminalInstance: \"new TerminalInstance()\"\n    TerminalInstance-\u003e\u003eTerminalProcessManager: \"new TerminalProcessManager()\"\n    \n    TerminalInstance-\u003e\u003eTerminalInstance: \"_createXterm()\"\n    TerminalInstance-\u003e\u003eTerminalProcessManager: \"createProcess(shellLaunchConfig)\"\n    TerminalProcessManager-\u003e\u003ePtyService: \"createProcess()\"\n    PtyService-\u003e\u003eTerminalProcess: \"new TerminalProcess()\"\n    TerminalProcess--\u003e\u003ePtyService: \"Process created\"\n    PtyService--\u003e\u003eTerminalProcessManager: \"Process ready\"\n    TerminalProcessManager--\u003e\u003eTerminalInstance: \"Process attached\"\n    TerminalInstance--\u003e\u003eTerminalService: \"Instance ready\"\n    TerminalService--\u003e\u003eUser: \"Terminal created\"\n```\n\nSources: [src/vs/workbench/contrib/terminal/browser/terminalService.ts:516-650](), [src/vs/workbench/contrib/terminal/browser/terminalInstance.ts:514-563](), [src/vs/workbench/contrib/terminal/browser/terminalProcessManager.ts:260-380]()\n\n### Process Communication\n\n```mermaid\ngraph LR\n    subgraph \"Renderer Process\"\n        TerminalInstance[\"TerminalInstance\"]\n        XtermTerminal[\"XtermTerminal\"]\n        TerminalProcessManager[\"TerminalProcessManager\"]\n    end\n    \n    subgraph \"Pty Host Process\"\n        PtyService[\"PtyService\"]\n        TerminalProcess[\"TerminalProcess\"]\n        NodePty[\"node-pty IPty\"]\n    end\n    \n    subgraph \"Shell Process\"\n        Shell[\"bash/zsh/pwsh/cmd\"]\n    end\n    \n    TerminalInstance --\u003e XtermTerminal\n    TerminalInstance --\u003e TerminalProcessManager\n    XtermTerminal --\u003e|\"onData\"| TerminalProcessManager\n    TerminalProcessManager --\u003e|\"IPC write()\"| PtyService\n    PtyService --\u003e TerminalProcess\n    TerminalProcess --\u003e|\"pty.write()\"| NodePty\n    NodePty --\u003e Shell\n    \n    Shell --\u003e|\"stdout/stderr\"| NodePty\n    NodePty --\u003e|\"onData\"| TerminalProcess\n    TerminalProcess --\u003e|\"_onProcessData\"| PtyService\n    PtyService --\u003e|\"IPC onProcessData\"| TerminalProcessManager\n    TerminalProcessManager --\u003e|\"onProcessData\"| XtermTerminal\n    XtermTerminal --\u003e|\"terminal.write()\"| TerminalInstance\n```\n\nSources: [src/vs/workbench/contrib/terminal/browser/terminalProcessManager.ts:680-740](), [src/vs/platform/terminal/node/ptyService.ts:400-450](), [src/vs/platform/terminal/node/terminalProcess.ts:200-300]()\n\n## User Interface Components\n\n### Terminal Panel View\n\nThe terminal panel is managed by `TerminalViewPane` which hosts either individual terminals or a tabbed interface through `TerminalTabbedView`.\n\n**Key Components:**\n- **TerminalViewPane**: Main panel container implementing `ViewPane`\n- **TerminalTabbedView**: Manages tabs and split terminal groups\n- **TerminalTabList**: Displays terminal tabs with status indicators\n- **TerminalGroup**: Container for related terminal instances\n\nSources: [src/vs/workbench/contrib/terminal/browser/terminalView.ts:56-400](), [src/vs/workbench/contrib/terminal/browser/terminalTabbedView.ts:37-150]()\n\n### Terminal Editor\n\nTerminals can also appear as editors through `TerminalEditor`, managed by `TerminalEditorService`.\n\n**Editor Integration:**\n- Implements `EditorPane` interface\n- Uses `TerminalEditorInput` as input type\n- Supports multi-group editor layouts\n- Handles editor-specific actions and context menus\n\nSources: [src/vs/workbench/contrib/terminal/browser/terminalEditor.ts:30-200](), [src/vs/workbench/contrib/terminal/browser/terminalEditorService.ts:20-150]()\n\n### XtermTerminal Integration\n\n`XtermTerminal` wraps the xterm.js library and provides VS Code-specific functionality:\n\n**Key Features:**\n- Theme integration with VS Code colors\n- Font and rendering configuration\n- Clipboard integration\n- Accessibility support\n- Shell integration addons\n- Search and navigation\n\n**Core Addons:**\n- `SearchAddon` - Find in terminal\n- `Unicode11Addon` - Unicode support\n- `WebglAddon` - GPU acceleration\n- `ShellIntegrationAddon` - Command tracking\n- `DecorationAddon` - Visual decorations\n\nSources: [src/vs/workbench/contrib/terminal/browser/xterm/xtermTerminal.ts:70-400](), [src/vs/workbench/contrib/terminal/browser/xterm/xtermTerminal.ts:800-1000]()\n\n## Extension API Integration\n\n### Extension Host Communication\n\n```mermaid\ngraph TB\n    subgraph \"Extension Host Process\"\n        ExtHostTerminalService[\"ExtHostTerminalService\"]\n        ExtHostTerminal[\"ExtHostTerminal\"]\n        ExtensionAPI[\"Extension vscode.Terminal API\"]\n        PseudoterminalAPI[\"Pseudoterminal API\"]\n    end\n    \n    subgraph \"Main Thread\"\n        MainThreadTerminalService[\"MainThreadTerminalService\"]\n        TerminalService[\"TerminalService\"]\n        TerminalProcessExtHostProxy[\"TerminalProcessExtHostProxy\"]\n    end\n    \n    ExtensionAPI --\u003e ExtHostTerminal\n    ExtHostTerminal --\u003e ExtHostTerminalService\n    ExtHostTerminalService \u003c--\u003e|\"RPC Calls\"| MainThreadTerminalService\n    MainThreadTerminalService --\u003e TerminalService\n    \n    PseudoterminalAPI --\u003e ExtHostTerminalService\n    ExtHostTerminalService \u003c--\u003e|\"Pty Events\"| TerminalProcessExtHostProxy\n    TerminalProcessExtHostProxy --\u003e TerminalService\n```\n\nSources: [src/vs/workbench/api/common/extHostTerminalService.ts:80-200](), [src/vs/workbench/api/browser/mainThreadTerminalService.ts:30-150](), [src/vs/workbench/contrib/terminal/browser/terminalProcessExtHostProxy.ts:20-100]()\n\n### Extension API Surface\n\nThe extension API provides several interfaces for terminal integration:\n\n**Terminal Creation:**\n- `vscode.window.createTerminal(options?: TerminalOptions): Terminal`\n- `vscode.window.createTerminalFromOptions(options: ExtensionTerminalOptions): Terminal`\n\n**Terminal Control:**\n- `Terminal.sendText(text: string, shouldExecute?: boolean): void`\n- `Terminal.show(preserveFocus?: boolean): void`\n- `Terminal.dispose(): void`\n\n**Pseudoterminal Implementation:**\n- `Pseudoterminal` interface for custom terminal backends\n- `onDidWriteData` and `onDidChangeDimensions` events\n- `handleInput(data: string): void` method\n\nSources: [src/vs/workbench/api/common/extHostTerminalService.ts:82-163](), [src/vs/workbench/api/common/extHostTerminalService.ts:540-700]()\n\n## Configuration and Profiles\n\n### Terminal Configuration\n\nTerminal behavior is managed through `TerminalConfigurationService` which handles:\n\n**Font Settings:**\n- `terminal.integrated.fontFamily`\n- `terminal.integrated.fontSize`\n- `terminal.integrated.lineHeight`\n- `terminal.integrated.letterSpacing`\n\n**Shell Configuration:**\n- `terminal.integrated.defaultProfile.*`\n- `terminal.integrated.profiles.*`\n- `terminal.integrated.shell.*` (legacy)\n\n**Behavior Settings:**\n- `terminal.integrated.confirmOnKill`\n- `terminal.integrated.enablePersistentSessions`\n- `terminal.integrated.splitCwd`\n\nSources: [src/vs/workbench/contrib/terminal/common/terminalConfiguration.ts:43-500](), [src/vs/workbench/contrib/terminal/browser/terminalConfigurationService.ts:20-200]()\n\n### Profile Management\n\n`TerminalProfileService` manages terminal profiles across platforms:\n\n**Profile Resolution:**\n- Detects available shells on the system\n- Resolves profile-specific settings\n- Handles contributed profiles from extensions\n- Manages profile icons and colors\n\n**Profile Types:**\n- Built-in profiles (bash, zsh, PowerShell, etc.)\n- User-configured profiles\n- Extension-contributed profiles\n- Automation profiles for tasks\n\nSources: [src/vs/workbench/contrib/terminal/browser/terminalProfileService.ts:50-200](), [src/vs/workbench/contrib/terminal/browser/terminalProfileResolverService.ts:30-150]()"])</script>
    <script>self.__next_f.push([1, "22:T3a12,"])</script>
    <script>self.__next_f.push([1, "# Terminal Architecture and Process Management\n\n\u003cdetails\u003e\n\u003csummary\u003eRelevant source files\u003c/summary\u003e\n\nThe following files were used as context for generating this wiki page:\n\n- [src/vs/platform/terminal/common/terminal.ts](src/vs/platform/terminal/common/terminal.ts)\n- [src/vs/platform/terminal/node/ptyHostService.ts](src/vs/platform/terminal/node/ptyHostService.ts)\n- [src/vs/platform/terminal/node/ptyService.ts](src/vs/platform/terminal/node/ptyService.ts)\n- [src/vs/platform/terminal/node/terminalProcess.ts](src/vs/platform/terminal/node/terminalProcess.ts)\n- [src/vs/workbench/api/browser/mainThreadTerminalService.ts](src/vs/workbench/api/browser/mainThreadTerminalService.ts)\n- [src/vs/workbench/api/common/extHostTerminalService.ts](src/vs/workbench/api/common/extHostTerminalService.ts)\n- [src/vs/workbench/api/node/extHostTerminalService.ts](src/vs/workbench/api/node/extHostTerminalService.ts)\n- [src/vs/workbench/contrib/terminal/browser/media/terminal.css](src/vs/workbench/contrib/terminal/browser/media/terminal.css)\n- [src/vs/workbench/contrib/terminal/browser/media/xterm.css](src/vs/workbench/contrib/terminal/browser/media/xterm.css)\n- [src/vs/workbench/contrib/terminal/browser/remotePty.ts](src/vs/workbench/contrib/terminal/browser/remotePty.ts)\n- [src/vs/workbench/contrib/terminal/browser/terminal.contribution.ts](src/vs/workbench/contrib/terminal/browser/terminal.contribution.ts)\n- [src/vs/workbench/contrib/terminal/browser/terminal.ts](src/vs/workbench/contrib/terminal/browser/terminal.ts)\n- [src/vs/workbench/contrib/terminal/browser/terminalActions.ts](src/vs/workbench/contrib/terminal/browser/terminalActions.ts)\n- [src/vs/workbench/contrib/terminal/browser/terminalEditor.ts](src/vs/workbench/contrib/terminal/browser/terminalEditor.ts)\n- [src/vs/workbench/contrib/terminal/browser/terminalEditorInput.ts](src/vs/workbench/contrib/terminal/browser/terminalEditorInput.ts)\n- [src/vs/workbench/contrib/terminal/browser/terminalEditorService.ts](src/vs/workbench/contrib/terminal/browser/terminalEditorService.ts)\n- [src/vs/workbench/contrib/terminal/browser/terminalGroup.ts](src/vs/workbench/contrib/terminal/browser/terminalGroup.ts)\n- [src/vs/workbench/contrib/terminal/browser/terminalGroupService.ts](src/vs/workbench/contrib/terminal/browser/terminalGroupService.ts)\n- [src/vs/workbench/contrib/terminal/browser/terminalInstance.ts](src/vs/workbench/contrib/terminal/browser/terminalInstance.ts)\n- [src/vs/workbench/contrib/terminal/browser/terminalMenus.ts](src/vs/workbench/contrib/terminal/browser/terminalMenus.ts)\n- [src/vs/workbench/contrib/terminal/browser/terminalProcessExtHostProxy.ts](src/vs/workbench/contrib/terminal/browser/terminalProcessExtHostProxy.ts)\n- [src/vs/workbench/contrib/terminal/browser/terminalProcessManager.ts](src/vs/workbench/contrib/terminal/browser/terminalProcessManager.ts)\n- [src/vs/workbench/contrib/terminal/browser/terminalProfileResolverService.ts](src/vs/workbench/contrib/terminal/browser/terminalProfileResolverService.ts)\n- [src/vs/workbench/contrib/terminal/browser/terminalProfileService.ts](src/vs/workbench/contrib/terminal/browser/terminalProfileService.ts)\n- [src/vs/workbench/contrib/terminal/browser/terminalService.ts](src/vs/workbench/contrib/terminal/browser/terminalService.ts)\n- [src/vs/workbench/contrib/terminal/browser/terminalTabbedView.ts](src/vs/workbench/contrib/terminal/browser/terminalTabbedView.ts)\n- [src/vs/workbench/contrib/terminal/browser/terminalTabsList.ts](src/vs/workbench/contrib/terminal/browser/terminalTabsList.ts)\n- [src/vs/workbench/contrib/terminal/browser/terminalView.ts](src/vs/workbench/contrib/terminal/browser/terminalView.ts)\n- [src/vs/workbench/contrib/terminal/browser/xterm/xtermTerminal.ts](src/vs/workbench/contrib/terminal/browser/xterm/xtermTerminal.ts)\n- [src/vs/workbench/contrib/terminal/common/terminal.ts](src/vs/workbench/contrib/terminal/common/terminal.ts)\n- [src/vs/workbench/contrib/terminal/common/terminalColorRegistry.ts](src/vs/workbench/contrib/terminal/common/terminalColorRegistry.ts)\n- [src/vs/workbench/contrib/terminal/common/terminalConfiguration.ts](src/vs/workbench/contrib/terminal/common/terminalConfiguration.ts)\n- [src/vs/workbench/contrib/terminal/common/terminalStrings.ts](src/vs/workbench/contrib/terminal/common/terminalStrings.ts)\n\n\u003c/details\u003e\n\n\n\nThis document covers the core architecture of VS Code's integrated terminal system, focusing on process management, service coordination, and the lifecycle of terminal instances. It explains how terminal instances are created, managed, and coordinated with underlying shell processes.\n\nFor information about the Monaco editor system that powers text editing, see [3](#3). For details about extension system integration, see [4](#4).\n\n## Purpose and Scope\n\nThe terminal system in VS Code provides integrated shell access through a multi-layered architecture that separates UI concerns from process management. The system handles terminal instance lifecycle, process coordination, and communication between the frontend UI and backend shell processes.\n\n## Overall Terminal Architecture\n\nThe terminal architecture follows a layered approach with clear separation between UI, service coordination, and process management:\n\n```mermaid\ngraph TB\n    subgraph \"UI Layer\"\n        TerminalInstance[\"TerminalInstance\"]\n        XtermTerminal[\"XtermTerminal\"]\n        TerminalView[\"TerminalViewPane\"]\n    end\n    \n    subgraph \"Service Layer\"\n        TerminalService[\"TerminalService\"]\n        TerminalInstanceService[\"TerminalInstanceService\"]\n        TerminalGroupService[\"TerminalGroupService\"]\n        TerminalConfigurationService[\"TerminalConfigurationService\"]\n    end\n    \n    subgraph \"Process Management\"\n        TerminalProcessManager[\"TerminalProcessManager\"]\n        ITerminalBackend[\"ITerminalBackend\"]\n        PtyService[\"PtyService\"]\n    end\n    \n    subgraph \"Shell Processes\"\n        TerminalProcess[\"TerminalProcess\"]\n        IPty[\"node-pty (IPty)\"]\n        ShellProcess[\"Shell Process\"]\n    end\n    \n    TerminalInstance --\u003e TerminalProcessManager\n    TerminalInstance --\u003e XtermTerminal\n    TerminalService --\u003e TerminalInstanceService\n    TerminalInstanceService --\u003e TerminalInstance\n    TerminalProcessManager --\u003e ITerminalBackend\n    ITerminalBackend --\u003e PtyService\n    PtyService --\u003e TerminalProcess\n    TerminalProcess --\u003e IPty\n    IPty --\u003e ShellProcess\n```\n\nSources: [src/vs/workbench/contrib/terminal/browser/terminalInstance.ts:127-649](), [src/vs/workbench/contrib/terminal/browser/terminalService.ts:62-241](), [src/vs/workbench/contrib/terminal/browser/terminalProcessManager.ts:70-155]()\n\n## Core Terminal Components\n\n### TerminalInstance - The Central Terminal Representation\n\n`TerminalInstance` serves as the primary representation of a single terminal within VS Code. It coordinates between the UI layer (xterm.js) and the process management layer:\n\n| Component | Responsibility |\n|-----------|----------------|\n| `_processManager` | Manages the underlying shell process |\n| `xterm` | The xterm.js terminal UI instance |\n| `capabilities` | Terminal capability detection and management |\n| `statusList` | Terminal status and diagnostic information |\n\n```mermaid\ngraph LR\n    TerminalInstance[\"TerminalInstance\"]\n    ProcessManager[\"TerminalProcessManager\"]\n    XtermTerminal[\"XtermTerminal\"]\n    Capabilities[\"TerminalCapabilityStore\"]\n    \n    TerminalInstance --\u003e ProcessManager\n    TerminalInstance --\u003e XtermTerminal\n    TerminalInstance --\u003e Capabilities\n    \n    ProcessManager --\u003e |\"process events\"| TerminalInstance\n    XtermTerminal --\u003e |\"UI events\"| TerminalInstance\n    Capabilities --\u003e |\"shell integration\"| TerminalInstance\n```\n\nSources: [src/vs/workbench/contrib/terminal/browser/terminalInstance.ts:127-218](), [src/vs/workbench/contrib/terminal/browser/terminalInstance.ts:364-449]()\n\n### TerminalProcessManager - Process Lifecycle Management\n\n`TerminalProcessManager` handles all aspects of the underlying shell process lifecycle:\n\n```mermaid\nstateDiagram-v2\n    [*] --\u003e Uninitialized\n    Uninitialized --\u003e Launching: createProcess()\n    Launching --\u003e Running: process ready\n    Launching --\u003e KilledDuringLaunch: launch failure\n    Running --\u003e KilledByUser: dispose()\n    Running --\u003e KilledByProcess: process exit\n    KilledByUser --\u003e [*]\n    KilledByProcess --\u003e [*]\n    KilledDuringLaunch --\u003e [*]\n```\n\nThe process manager coordinates with backends through the `ITerminalBackend` interface, which abstracts local and remote process creation.\n\nSources: [src/vs/workbench/contrib/terminal/browser/terminalProcessManager.ts:70-133](), [src/vs/workbench/contrib/terminal/common/terminal.ts:313-330]()\n\n## Terminal Service Coordination\n\nThe service layer provides centralized coordination and management of terminal instances:\n\n```mermaid\ngraph TB\n    subgraph \"Terminal Service Layer\"\n        TerminalService[\"TerminalService\u003cbr/\u003e- instances coordination\u003cbr/\u003e- active instance tracking\u003cbr/\u003e- creation orchestration\"]\n        TerminalInstanceService[\"TerminalInstanceService\u003cbr/\u003e- instance creation\u003cbr/\u003e- backend management\"]\n        TerminalGroupService[\"TerminalGroupService\u003cbr/\u003e- panel terminal groups\u003cbr/\u003e- tab management\"]\n        TerminalEditorService[\"TerminalEditorService\u003cbr/\u003e- editor terminal instances\"]\n    end\n    \n    subgraph \"Backends\"\n        LocalBackend[\"Local Backend\u003cbr/\u003e(PtyService)\"]\n        RemoteBackend[\"Remote Backend\u003cbr/\u003e(RemotePty)\"]\n    end\n    \n    TerminalService --\u003e TerminalInstanceService\n    TerminalService --\u003e TerminalGroupService\n    TerminalService --\u003e TerminalEditorService\n    \n    TerminalInstanceService --\u003e LocalBackend\n    TerminalInstanceService --\u003e RemoteBackend\n    \n    LocalBackend --\u003e |\"createProcess\"| TerminalProcess[\"TerminalProcess\"]\n    RemoteBackend --\u003e |\"remote calls\"| RemotePtyHost[\"Remote Pty Host\"]\n```\n\nSources: [src/vs/workbench/contrib/terminal/browser/terminalService.ts:95-127](), [src/vs/workbench/contrib/terminal/browser/terminal.ts:61-98]()\n\n## Process Creation and Management Flow\n\nThe terminal creation process follows a specific sequence through the service layers:\n\n```mermaid\nsequenceDiagram\n    participant User\n    participant TerminalService\n    participant TerminalInstanceService\n    participant TerminalInstance\n    participant TerminalProcessManager\n    participant ITerminalBackend\n    participant TerminalProcess\n    \n    User-\u003e\u003eTerminalService: createTerminal()\n    TerminalService-\u003e\u003eTerminalInstanceService: createInstance()\n    TerminalInstanceService-\u003e\u003eTerminalInstance: new TerminalInstance()\n    TerminalInstance-\u003e\u003eTerminalProcessManager: _createProcessManager()\n    \n    Note over TerminalInstance: Wait for container ready\n    TerminalInstance-\u003e\u003eTerminalProcessManager: createProcess()\n    TerminalProcessManager-\u003e\u003eITerminalBackend: createProcess()\n    ITerminalBackend-\u003e\u003eTerminalProcess: spawn process\n    TerminalProcess--\u003e\u003eTerminalProcessManager: process ready event\n    TerminalProcessManager--\u003e\u003eTerminalInstance: onProcessReady\n    TerminalInstance--\u003e\u003eTerminalService: instance ready\n```\n\nKey steps in the process creation:\n\n1. **Service Coordination**: `TerminalService.createTerminal()` orchestrates the creation\n2. **Instance Creation**: `TerminalInstanceService.createInstance()` creates the `TerminalInstance`\n3. **Process Manager Setup**: `TerminalInstance` creates its `TerminalProcessManager`\n4. **Backend Communication**: Process manager communicates with appropriate backend\n5. **Process Spawning**: Backend creates the actual shell process\n6. **Event Propagation**: Process events flow back up the chain\n\nSources: [src/vs/workbench/contrib/terminal/browser/terminalService.ts:282-339](), [src/vs/workbench/contrib/terminal/browser/terminalInstance.ts:510-563](), [src/vs/workbench/contrib/terminal/browser/terminalProcessManager.ts:185-245]()\n\n## Backend Abstraction and Process Types\n\nThe system supports different types of backends through the `ITerminalBackend` interface:\n\n| Backend Type | Implementation | Use Case |\n|--------------|----------------|----------|\n| **Local** | `PtyService` | Local shell processes |\n| **Remote** | Remote connection | SSH/WSL/Dev Containers |\n| **Extension** | `TerminalProcessExtHostProxy` | Extension-owned terminals |\n\n```mermaid\ngraph LR\n    subgraph \"Frontend\"\n        TerminalProcessManager[\"TerminalProcessManager\"]\n    end\n    \n    subgraph \"Backend Implementations\"\n        PtyService[\"PtyService\u003cbr/\u003e(Local)\"]\n        RemotePty[\"RemotePty\u003cbr/\u003e(Remote)\"]\n        ExtHostProxy[\"TerminalProcessExtHostProxy\u003cbr/\u003e(Extension)\"]\n    end\n    \n    subgraph \"Process Layer\"\n        NodePty[\"node-pty\u003cbr/\u003e(IPty)\"]\n        RemoteProcess[\"Remote Shell\"]\n        ExtensionPty[\"Extension Pseudoterminal\"]\n    end\n    \n    TerminalProcessManager --\u003e |\"ITerminalBackend\"| PtyService\n    TerminalProcessManager --\u003e |\"ITerminalBackend\"| RemotePty\n    TerminalProcessManager --\u003e |\"ITerminalBackend\"| ExtHostProxy\n    \n    PtyService --\u003e NodePty\n    RemotePty --\u003e RemoteProcess\n    ExtHostProxy --\u003e ExtensionPty\n```\n\nSources: [src/vs/workbench/contrib/terminal/browser/terminalProcessManager.ts:170-180](), [src/vs/platform/terminal/node/ptyService.ts:71-124](), [src/vs/workbench/contrib/terminal/browser/terminalProcessExtHostProxy.ts:1-50]()\n\n## Extension Integration Architecture\n\nExtensions can create and manage their own terminals through a proxy system that bridges the extension host and main processes:\n\n```mermaid\ngraph TB\n    subgraph \"Extension Host Process\"\n        Extension[\"Extension Code\"]\n        ExtHostTerminalService[\"ExtHostTerminalService\"]\n        ExtHostTerminal[\"ExtHostTerminal\"]\n    end\n    \n    subgraph \"Main Process\"\n        MainThreadTerminalService[\"MainThreadTerminalService\"]\n        TerminalService[\"TerminalService\"]\n        TerminalProcessExtHostProxy[\"TerminalProcessExtHostProxy\"]\n    end\n    \n    subgraph \"Terminal Instance\"\n        TerminalInstance[\"TerminalInstance\"]\n        TerminalProcessManager[\"TerminalProcessManager\"]\n    end\n    \n    Extension --\u003e ExtHostTerminalService\n    ExtHostTerminalService --\u003e ExtHostTerminal\n    ExtHostTerminal --\u003e |\"RPC calls\"| MainThreadTerminalService\n    MainThreadTerminalService --\u003e TerminalService\n    TerminalService --\u003e TerminalInstance\n    TerminalInstance --\u003e TerminalProcessManager\n    TerminalProcessManager --\u003e TerminalProcessExtHostProxy\n    TerminalProcessExtHostProxy --\u003e |\"RPC events\"| ExtHostTerminal\n```\n\nThe extension integration uses RPC communication to bridge the process boundary, allowing extensions to:\n- Create custom terminals with `vscode.Pseudoterminal`\n- Send and receive data from terminal processes\n- Manage terminal lifecycle and properties\n\nSources: [src/vs/workbench/api/common/extHostTerminalService.ts:79-162](), [src/vs/workbench/api/browser/mainThreadTerminalService.ts:1-50](), [src/vs/workbench/contrib/terminal/browser/terminalProcessExtHostProxy.ts:1-100]()"])</script>
    <script>self.__next_f.push([1, "23:T45b5,"])</script>
    <script>self.__next_f.push([1, "# Notebook Editor\n\n\u003cdetails\u003e\n\u003csummary\u003eRelevant source files\u003c/summary\u003e\n\nThe following files were used as context for generating this wiki page:\n\n- [src/vs/workbench/api/browser/mainThreadNotebook.ts](src/vs/workbench/api/browser/mainThreadNotebook.ts)\n- [src/vs/workbench/api/common/extHostNotebook.ts](src/vs/workbench/api/common/extHostNotebook.ts)\n- [src/vs/workbench/contrib/notebook/browser/media/notebook.css](src/vs/workbench/contrib/notebook/browser/media/notebook.css)\n- [src/vs/workbench/contrib/notebook/browser/notebook.contribution.ts](src/vs/workbench/contrib/notebook/browser/notebook.contribution.ts)\n- [src/vs/workbench/contrib/notebook/browser/notebookBrowser.ts](src/vs/workbench/contrib/notebook/browser/notebookBrowser.ts)\n- [src/vs/workbench/contrib/notebook/browser/notebookEditor.ts](src/vs/workbench/contrib/notebook/browser/notebookEditor.ts)\n- [src/vs/workbench/contrib/notebook/browser/notebookEditorWidget.ts](src/vs/workbench/contrib/notebook/browser/notebookEditorWidget.ts)\n- [src/vs/workbench/contrib/notebook/browser/view/notebookCellList.ts](src/vs/workbench/contrib/notebook/browser/view/notebookCellList.ts)\n- [src/vs/workbench/contrib/notebook/browser/view/renderers/backLayerWebView.ts](src/vs/workbench/contrib/notebook/browser/view/renderers/backLayerWebView.ts)\n- [src/vs/workbench/contrib/notebook/browser/view/renderers/cellRenderer.ts](src/vs/workbench/contrib/notebook/browser/view/renderers/cellRenderer.ts)\n- [src/vs/workbench/contrib/notebook/browser/view/renderers/webviewMessages.ts](src/vs/workbench/contrib/notebook/browser/view/renderers/webviewMessages.ts)\n- [src/vs/workbench/contrib/notebook/browser/view/renderers/webviewPreloads.ts](src/vs/workbench/contrib/notebook/browser/view/renderers/webviewPreloads.ts)\n- [src/vs/workbench/contrib/notebook/browser/viewModel/baseCellViewModel.ts](src/vs/workbench/contrib/notebook/browser/viewModel/baseCellViewModel.ts)\n- [src/vs/workbench/contrib/notebook/browser/viewModel/codeCellViewModel.ts](src/vs/workbench/contrib/notebook/browser/viewModel/codeCellViewModel.ts)\n- [src/vs/workbench/contrib/notebook/browser/viewModel/markupCellViewModel.ts](src/vs/workbench/contrib/notebook/browser/viewModel/markupCellViewModel.ts)\n- [src/vs/workbench/contrib/notebook/common/model/notebookCellTextModel.ts](src/vs/workbench/contrib/notebook/common/model/notebookCellTextModel.ts)\n- [src/vs/workbench/contrib/notebook/common/model/notebookTextModel.ts](src/vs/workbench/contrib/notebook/common/model/notebookTextModel.ts)\n- [src/vs/workbench/contrib/notebook/common/notebookCommon.ts](src/vs/workbench/contrib/notebook/common/notebookCommon.ts)\n- [src/vs/workbench/contrib/notebook/common/notebookEditorModel.ts](src/vs/workbench/contrib/notebook/common/notebookEditorModel.ts)\n- [src/vs/workbench/contrib/notebook/common/notebookService.ts](src/vs/workbench/contrib/notebook/common/notebookService.ts)\n\n\u003c/details\u003e\n\n\n\nThis document covers the Notebook Editor system in VS Code, which provides the interactive editing experience for Jupyter notebooks and other notebook formats. The Notebook Editor enables users to create, edit, and execute code and markdown cells within a unified interface.\n\nThe scope includes the editor widget architecture, cell rendering pipeline, webview integration for outputs, and the underlying data models. For information about notebook services and kernel management, see [Notebook System](#6.1). For details about the extension API for notebooks, refer to the Extension System documentation.\n\n## Architecture Overview\n\nThe Notebook Editor follows a layered architecture with clear separation between the editor pane, widget implementation, cell management, and underlying data models.\n\n### High-Level Component Structure\n\n```mermaid\ngraph TB\n    NotebookEditor[\"NotebookEditor\u003cbr/\u003e(Editor Pane)\"] --\u003e NotebookEditorWidget[\"NotebookEditorWidget\u003cbr/\u003e(Core Widget)\"]\n    NotebookEditorWidget --\u003e NotebookCellList[\"NotebookCellList\u003cbr/\u003e(Cell Management)\"]\n    NotebookEditorWidget --\u003e BackLayerWebView[\"BackLayerWebView\u003cbr/\u003e(Output Rendering)\"]\n    NotebookCellList --\u003e CodeCellRenderer[\"CodeCellRenderer\"]\n    NotebookCellList --\u003e MarkupCellRenderer[\"MarkupCellRenderer\"]\n    NotebookEditorWidget --\u003e NotebookViewModel[\"NotebookViewModel\"]\n    NotebookViewModel --\u003e NotebookTextModel[\"NotebookTextModel\"]\n    NotebookTextModel --\u003e NotebookCellTextModel[\"NotebookCellTextModel[]\"]\n    CodeCellRenderer --\u003e CodeCellViewModel[\"CodeCellViewModel\"]\n    MarkupCellRenderer --\u003e MarkupCellViewModel[\"MarkupCellViewModel\"]\n```\n\nSources: [src/vs/workbench/contrib/notebook/browser/notebookEditor.ts:54-105](), [src/vs/workbench/contrib/notebook/browser/notebookEditorWidget.ts:138-471](), [src/vs/workbench/contrib/notebook/browser/view/notebookCellList.ts:80-131]()\n\n### Editor Pane and Widget Separation\n\nThe `NotebookEditor` serves as the editor pane that integrates with VS Code's editor system, while `NotebookEditorWidget` contains the actual notebook editing implementation.\n\n```mermaid\ngraph LR\n    EditorPane[\"EditorPane\u003cbr/\u003e(VS Code Framework)\"] --\u003e NotebookEditor[\"NotebookEditor\u003cbr/\u003enotebookEditor.ts\"]\n    NotebookEditor --\u003e NotebookEditorWidget[\"NotebookEditorWidget\u003cbr/\u003enotebookEditorWidget.ts\"]\n    NotebookEditor --\u003e MemoryManagement[\"Editor Memento\u003cbr/\u003eView State Persistence\"]\n    NotebookEditorWidget --\u003e CellManagement[\"Cell List \u0026 Rendering\"]\n    NotebookEditorWidget --\u003e WebviewIntegration[\"Output Webview\"]\n    NotebookEditorWidget --\u003e ToolbarManagement[\"Notebook Toolbar\"]\n```\n\nSources: [src/vs/workbench/contrib/notebook/browser/notebookEditor.ts:54-143](), [src/vs/workbench/contrib/notebook/browser/notebookEditorWidget.ts:138-298]()\n\n## Cell Rendering System\n\nThe notebook editor uses specialized renderers for different cell types, with a sophisticated rendering pipeline that handles both code and markup cells.\n\n### Cell Renderer Architecture\n\n```mermaid\ngraph TB\n    NotebookCellListDelegate[\"NotebookCellListDelegate\u003cbr/\u003egetTemplateId()\"] --\u003e CellRenderers[\"Cell Renderers\"]\n    CellRenderers --\u003e CodeCellRenderer[\"CodeCellRenderer\u003cbr/\u003eTEMPLATE_ID: 'code_cell'\"]\n    CellRenderers --\u003e MarkupCellRenderer[\"MarkupCellRenderer\u003cbr/\u003eTEMPLATE_ID: 'markdown_cell'\"]\n    \n    CodeCellRenderer --\u003e CodeCellTemplate[\"CodeCellRenderTemplate\u003cbr/\u003eEditor + Output Container\"]\n    MarkupCellRenderer --\u003e MarkdownCellTemplate[\"MarkdownCellRenderTemplate\u003cbr/\u003ePreview + Editor Container\"]\n    \n    CodeCellTemplate --\u003e CellParts1[\"CellPartsCollection\u003cbr/\u003e- CellExecutionPart\u003cbr/\u003e- CellProgressBar\u003cbr/\u003e- RunToolbar\"]\n    MarkdownCellTemplate --\u003e CellParts2[\"CellPartsCollection\u003cbr/\u003e- CellFocusPart\u003cbr/\u003e- CellDecorations\u003cbr/\u003e- CollapsedCellInput\"]\n    \n    CellParts1 --\u003e CodeCellVM[\"CodeCellViewModel\"]\n    CellParts2 --\u003e MarkupCellVM[\"MarkupCellViewModel\"]\n```\n\nSources: [src/vs/workbench/contrib/notebook/browser/view/renderers/cellRenderer.ts:57-85](), [src/vs/workbench/contrib/notebook/browser/view/renderers/cellRenderer.ts:112-235](), [src/vs/workbench/contrib/notebook/browser/view/renderers/cellRenderer.ts:237-354]()\n\n### Cell Parts System\n\nEach cell is composed of multiple parts that handle different aspects of the cell's functionality and rendering.\n\n```mermaid\ngraph LR\n    CellPartsCollection[\"CellPartsCollection\"] --\u003e CoreParts[\"Core Parts\"]\n    CellPartsCollection --\u003e ToolbarParts[\"Toolbar Parts\"]\n    \n    CoreParts --\u003e CellChatPart[\"CellChatPart\u003cbr/\u003eAI Integration\"]\n    CoreParts --\u003e CellEditorStatusBar[\"CellEditorStatusBar\u003cbr/\u003eStatus Display\"]\n    CoreParts --\u003e CellFocusIndicator[\"CellFocusIndicator\u003cbr/\u003eVisual Focus State\"]\n    CoreParts --\u003e CellDecorations[\"CellDecorations\u003cbr/\u003eCell Decorations\"]\n    CoreParts --\u003e CellDragAndDropPart[\"CellDragAndDropPart\u003cbr/\u003eDnD Support\"]\n    \n    ToolbarParts --\u003e CellTitleToolbarPart[\"CellTitleToolbarPart\u003cbr/\u003eCell Actions\"]\n    ToolbarParts --\u003e BetweenCellToolbar[\"BetweenCellToolbar\u003cbr/\u003eInsert Actions\"]\n    ToolbarParts --\u003e RunToolbar[\"RunToolbar\u003cbr/\u003eExecution Controls\"]\n```\n\nSources: [src/vs/workbench/contrib/notebook/browser/view/renderers/cellRenderer.ts:175-189](), [src/vs/workbench/contrib/notebook/browser/view/renderers/cellRenderer.ts:298-320]()\n\n## Output Rendering and Webview Integration\n\nThe notebook editor uses a sophisticated webview-based system for rendering cell outputs, particularly for rich content like HTML, images, and interactive widgets.\n\n### BackLayerWebView Architecture\n\n```mermaid\ngraph TB\n    NotebookEditorWidget --\u003e BackLayerWebView[\"BackLayerWebView\u003cbr/\u003eOutput Rendering Engine\"]\n    BackLayerWebView --\u003e WebviewElement[\"IWebviewElement\u003cbr/\u003eWebview Container\"]\n    BackLayerWebView --\u003e InsetMapping[\"Map\u003cIDisplayOutputViewModel, ICachedInset\u003e\"]\n    BackLayerWebView --\u003e RendererMessaging[\"IScopedRendererMessaging\u003cbr/\u003eExtension Communication\"]\n    \n    WebviewElement --\u003e WebviewPreloads[\"webviewPreloads.ts\u003cbr/\u003eInjected JavaScript\"]\n    WebviewPreloads --\u003e RendererRegistry[\"Notebook Renderers\u003cbr/\u003eExtension-provided\"]\n    WebviewPreloads --\u003e OutputHandling[\"Output Event Handling\u003cbr/\u003e- Focus/Blur\u003cbr/\u003e- Mouse Events\u003cbr/\u003e- Scroll Events\"]\n    \n    InsetMapping --\u003e CachedInsets[\"ICachedInset\u003cbr/\u003e- outputId\u003cbr/\u003e- versionId\u003cbr/\u003e- cellInfo\u003cbr/\u003e- renderer\"]\n```\n\nSources: [src/vs/workbench/contrib/notebook/browser/view/renderers/backLayerWebView.ts:128-225](), [src/vs/workbench/contrib/notebook/browser/view/renderers/webviewPreloads.ts:92-500]()\n\n### Output Rendering Pipeline\n\n```mermaid\ngraph LR\n    CellOutput[\"ICellOutput\u003cbr/\u003eCell Output Data\"] --\u003e OutputViewModel[\"ICellOutputViewModel\u003cbr/\u003eDisplay Abstraction\"]\n    OutputViewModel --\u003e MimeTypeResolution[\"resolveMimeTypes()\u003cbr/\u003eRenderer Selection\"]\n    MimeTypeResolution --\u003e RenderDecision[\"IInsetRenderOutput\u003cbr/\u003eHtml vs Extension\"]\n    \n    RenderDecision --\u003e HtmlRendering[\"IRenderPlainHtmlOutput\u003cbr/\u003eDirect HTML\"]\n    RenderDecision --\u003e ExtensionRendering[\"IRenderOutputViaExtension\u003cbr/\u003eCustom Renderer\"]\n    \n    HtmlRendering --\u003e WebviewInsertion[\"Webview DOM Insertion\"]\n    ExtensionRendering --\u003e RendererActivation[\"Extension Renderer\u003cbr/\u003eActivation \u0026 Messaging\"]\n    \n    WebviewInsertion --\u003e DimensionTracking[\"Output Dimension\u003cbr/\u003eTracking \u0026 Updates\"]\n    RendererActivation --\u003e DimensionTracking\n```\n\nSources: [src/vs/workbench/contrib/notebook/browser/notebookBrowser.ts:103-121](), [src/vs/workbench/contrib/notebook/browser/view/renderers/backLayerWebView.ts:535-670]()\n\n## Data Model Layer\n\nThe notebook editor operates on a multi-layered data model that separates text content, cell metadata, and view state.\n\n### Model Hierarchy\n\n```mermaid\ngraph TB\n    NotebookTextModel[\"NotebookTextModel\u003cbr/\u003eDocument Root\"] --\u003e NotebookCells[\"cells: readonly ICell[]\"]\n    NotebookTextModel --\u003e DocumentMetadata[\"metadata: NotebookDocumentMetadata\"]\n    NotebookTextModel --\u003e TransientOptions[\"transientOptions: TransientOptions\"]\n    \n    NotebookCells --\u003e NotebookCellTextModel[\"NotebookCellTextModel\u003cbr/\u003eIndividual Cell Data\"]\n    NotebookCellTextModel --\u003e CellTextBuffer[\"textBuffer: IReadonlyTextBuffer\"]\n    NotebookCellTextModel --\u003e CellMetadata[\"metadata: NotebookCellMetadata\"]\n    NotebookCellTextModel --\u003e CellOutputs[\"outputs: ICellOutput[]\"]\n    NotebookCellTextModel --\u003e InternalMetadata[\"internalMetadata: NotebookCellInternalMetadata\"]\n    \n    CellOutputs --\u003e NotebookCellOutputTextModel[\"NotebookCellOutputTextModel\u003cbr/\u003eOutput Data Management\"]\n```\n\nSources: [src/vs/workbench/contrib/notebook/common/model/notebookTextModel.ts:570-615](), [src/vs/workbench/contrib/notebook/common/model/notebookCellTextModel.ts:25-125]()\n\n### View Model Layer\n\n```mermaid\ngraph TB\n    NotebookViewModel[\"NotebookViewModel\u003cbr/\u003eView State Management\"] --\u003e ViewCells[\"viewCells: ICellViewModel[]\"]\n    NotebookViewModel --\u003e SelectionState[\"Selection \u0026 Focus State\"]\n    NotebookViewModel --\u003e LayoutInfo[\"NotebookLayoutInfo\"]\n    \n    ViewCells --\u003e CodeCellViewModel[\"CodeCellViewModel\u003cbr/\u003eCode Cell View State\"]\n    ViewCells --\u003e MarkupCellViewModel[\"MarkupCellViewModel\u003cbr/\u003eMarkdown Cell View State\"]\n    \n    CodeCellViewModel --\u003e CodeCellLayout[\"CodeCellLayoutInfo\u003cbr/\u003e- editorHeight\u003cbr/\u003e- outputTotalHeight\u003cbr/\u003e- outputContainerOffset\"]\n    CodeCellViewModel --\u003e ExecutionState[\"Execution State\u003cbr/\u003e- isExecuting\u003cbr/\u003e- executionOrder\"]\n    CodeCellViewModel --\u003e OutputViewModels[\"outputsViewModels: ICellOutputViewModel[]\"]\n    \n    MarkupCellViewModel --\u003e MarkupCellLayout[\"MarkupCellLayoutInfo\u003cbr/\u003e- editorHeight\u003cbr/\u003e- previewHeight\u003cbr/\u003e- foldHintHeight\"]\n    MarkupCellViewModel --\u003e EditingState[\"Editing State\u003cbr/\u003e- editState\u003cbr/\u003e- renderedHtml\"]\n```\n\nSources: [src/vs/workbench/contrib/notebook/browser/viewModel/notebookViewModelImpl.ts:40-100](), [src/vs/workbench/contrib/notebook/browser/viewModel/codeCellViewModel.ts:30-125](), [src/vs/workbench/contrib/notebook/browser/viewModel/markupCellViewModel.ts:22-110]()\n\n## Cell List Management\n\nThe `NotebookCellList` manages the virtual scrolling and rendering of cells within the notebook editor.\n\n### Cell List Architecture\n\n```mermaid\ngraph TB\n    WorkbenchList[\"WorkbenchList\u003cCellViewModel\u003e\"] --\u003e NotebookCellList[\"NotebookCellList\u003cbr/\u003eCell Management\"]\n    NotebookCellList --\u003e NotebookCellListView[\"NotebookCellListView\u003cbr/\u003eCustom List Implementation\"]\n    NotebookCellList --\u003e ViewZones[\"NotebookViewZones\u003cbr/\u003eCustom Content Areas\"]\n    NotebookCellList --\u003e CellOverlays[\"NotebookCellOverlays\u003cbr/\u003eOverlay Management\"]\n    \n    NotebookCellListView --\u003e VirtualizedRendering[\"Virtualized Cell Rendering\"]\n    NotebookCellListView --\u003e ScrollManagement[\"Scroll Event Handling\"]\n    \n    ViewZones --\u003e INotebookViewZone[\"INotebookViewZone\u003cbr/\u003e- afterModelPosition\u003cbr/\u003e- domNode\u003cbr/\u003e- heightInPx\"]\n    CellOverlays --\u003e INotebookCellOverlay[\"INotebookCellOverlay\u003cbr/\u003e- cell\u003cbr/\u003e- domNode\"]\n    \n    NotebookCellList --\u003e VisibleRanges[\"visibleRanges: ICellRange[]\u003cbr/\u003eViewport Management\"]\n    NotebookCellList --\u003e HiddenRanges[\"Hidden Range Support\u003cbr/\u003eFolding \u0026 Filtering\"]\n```\n\nSources: [src/vs/workbench/contrib/notebook/browser/view/notebookCellList.ts:80-131](), [src/vs/workbench/contrib/notebook/browser/view/notebookCellListView.ts:1-100]()\n\n## Toolbar and UI Components\n\nThe notebook editor includes multiple toolbar areas and UI components for notebook and cell-level actions.\n\n### Toolbar System\n\n```mermaid\ngraph TB\n    NotebookEditorWidget --\u003e ToolbarContainers[\"Toolbar Containers\"]\n    ToolbarContainers --\u003e NotebookTopToolbar[\"NotebookEditorWorkbenchToolbar\u003cbr/\u003eDocument-level Actions\"]\n    ToolbarContainers --\u003e CellToolbars[\"Cell-level Toolbars\"]\n    \n    CellToolbars --\u003e CellTitleToolbar[\"CellTitleToolbarPart\u003cbr/\u003eCell Action Menu\"]\n    CellToolbars --\u003e CellDeleteToolbar[\"Cell Delete Actions\"]\n    CellToolbars --\u003e CellInsertToolbar[\"Between-cell Insert\"]\n    CellToolbars --\u003e CellExecuteToolbar[\"Cell Execution Controls\"]\n    \n    NotebookTopToolbar --\u003e KernelSelection[\"Kernel Selection UI\"]\n    NotebookTopToolbar --\u003e DocumentActions[\"Document Actions\u003cbr/\u003e- Save\u003cbr/\u003e- Export\u003cbr/\u003e- Trust\"]\n    \n    CellTitleToolbar --\u003e MenuIds[\"MenuId Configuration\u003cbr/\u003e- cellTitleToolbar\u003cbr/\u003e- cellDeleteToolbar\u003cbr/\u003e- cellInsertToolbar\u003cbr/\u003e- cellExecuteToolbar\"]\n```\n\nSources: [src/vs/workbench/contrib/notebook/browser/notebookEditorWidget.ts:189-194](), [src/vs/workbench/contrib/notebook/browser/viewParts/notebookEditorToolbar.ts:1-50]()\n\n## Event System and State Management\n\nThe notebook editor uses a sophisticated event system to coordinate between different layers and components.\n\n### Event Flow\n\n```mermaid\ngraph LR\n    ModelEvents[\"Model Events\u003cbr/\u003eNotebookTextModel\"] --\u003e ViewModelEvents[\"View Model Events\u003cbr/\u003eNotebookViewModel\"]\n    ViewModelEvents --\u003e WidgetEvents[\"Widget Events\u003cbr/\u003eNotebookEditorWidget\"]\n    WidgetEvents --\u003e UIUpdates[\"UI Updates\u003cbr/\u003eCell List \u0026 Renderers\"]\n    \n    ModelEvents --\u003e CellContentChanged[\"onDidChangeContent\"]\n    ModelEvents --\u003e CellOutputChanged[\"onDidChangeOutputs\"]\n    ModelEvents --\u003e CellMetadataChanged[\"onDidChangeMetadata\"]\n    \n    ViewModelEvents --\u003e SelectionChanged[\"onDidChangeSelection\"]\n    ViewModelEvents --\u003e VisibleRangesChanged[\"onDidChangeVisibleRanges\"]\n    ViewModelEvents --\u003e CellStateChanged[\"onDidChangeCellState\"]\n    \n    WidgetEvents --\u003e LayoutChanged[\"onDidChangeLayout\"]\n    WidgetEvents --\u003e ActiveCellChanged[\"onDidChangeActiveCell\"]\n    WidgetEvents --\u003e FocusChanged[\"onDidChangeFocus\"]\n```\n\nSources: [src/vs/workbench/contrib/notebook/browser/notebookEditorWidget.ts:140-185](), [src/vs/workbench/contrib/notebook/browser/notebookViewEvents.ts:1-100]()\n\n## Integration Points\n\nThe Notebook Editor integrates with various VS Code systems and provides extension points for customization.\n\n### Extension Integration\n\n```mermaid\ngraph TB\n    NotebookEditor --\u003e ExtensionAPI[\"Extension API Integration\"]\n    ExtensionAPI --\u003e NotebookRenderers[\"Notebook Renderers\u003cbr/\u003eCustom Output Rendering\"]\n    ExtensionAPI --\u003e NotebookSerializers[\"Notebook Serializers\u003cbr/\u003eFile Format Support\"]\n    ExtensionAPI --\u003e KernelProviders[\"Kernel Providers\u003cbr/\u003eExecution Environments\"]\n    \n    NotebookRenderers --\u003e RendererMessaging[\"INotebookRendererMessagingService\u003cbr/\u003eBidirectional Communication\"]\n    NotebookSerializers --\u003e NotebookService[\"INotebookService\u003cbr/\u003eFormat Registration\"]\n    KernelProviders --\u003e KernelService[\"INotebookKernelService\u003cbr/\u003eKernel Management\"]\n    \n    ExtensionAPI --\u003e ContributionPoints[\"Contribution Points\u003cbr/\u003e- commands\u003cbr/\u003e- menus\u003cbr/\u003e- keybindings\"]\n```\n\nSources: [src/vs/workbench/contrib/notebook/browser/notebookEditorWidget.ts:309-361](), [src/vs/workbench/contrib/notebook/common/notebookRendererMessagingService.ts:1-50]()\n\nThe Notebook Editor provides a comprehensive editing experience for interactive documents, combining rich text editing, code execution, and extensible output rendering in a unified interface that integrates seamlessly with VS Code's editor framework."])</script>
    <script>self.__next_f.push([1, "24:T3cb2,"])</script>
    <script>self.__next_f.push([1, "# Notebook Model and Components\n\n\u003cdetails\u003e\n\u003csummary\u003eRelevant source files\u003c/summary\u003e\n\nThe following files were used as context for generating this wiki page:\n\n- [src/vs/workbench/api/browser/mainThreadNotebook.ts](src/vs/workbench/api/browser/mainThreadNotebook.ts)\n- [src/vs/workbench/api/common/extHostNotebook.ts](src/vs/workbench/api/common/extHostNotebook.ts)\n- [src/vs/workbench/contrib/notebook/browser/media/notebook.css](src/vs/workbench/contrib/notebook/browser/media/notebook.css)\n- [src/vs/workbench/contrib/notebook/browser/notebook.contribution.ts](src/vs/workbench/contrib/notebook/browser/notebook.contribution.ts)\n- [src/vs/workbench/contrib/notebook/browser/notebookBrowser.ts](src/vs/workbench/contrib/notebook/browser/notebookBrowser.ts)\n- [src/vs/workbench/contrib/notebook/browser/notebookEditor.ts](src/vs/workbench/contrib/notebook/browser/notebookEditor.ts)\n- [src/vs/workbench/contrib/notebook/browser/notebookEditorWidget.ts](src/vs/workbench/contrib/notebook/browser/notebookEditorWidget.ts)\n- [src/vs/workbench/contrib/notebook/browser/view/notebookCellList.ts](src/vs/workbench/contrib/notebook/browser/view/notebookCellList.ts)\n- [src/vs/workbench/contrib/notebook/browser/view/renderers/backLayerWebView.ts](src/vs/workbench/contrib/notebook/browser/view/renderers/backLayerWebView.ts)\n- [src/vs/workbench/contrib/notebook/browser/view/renderers/cellRenderer.ts](src/vs/workbench/contrib/notebook/browser/view/renderers/cellRenderer.ts)\n- [src/vs/workbench/contrib/notebook/browser/view/renderers/webviewMessages.ts](src/vs/workbench/contrib/notebook/browser/view/renderers/webviewMessages.ts)\n- [src/vs/workbench/contrib/notebook/browser/view/renderers/webviewPreloads.ts](src/vs/workbench/contrib/notebook/browser/view/renderers/webviewPreloads.ts)\n- [src/vs/workbench/contrib/notebook/browser/viewModel/baseCellViewModel.ts](src/vs/workbench/contrib/notebook/browser/viewModel/baseCellViewModel.ts)\n- [src/vs/workbench/contrib/notebook/browser/viewModel/codeCellViewModel.ts](src/vs/workbench/contrib/notebook/browser/viewModel/codeCellViewModel.ts)\n- [src/vs/workbench/contrib/notebook/browser/viewModel/markupCellViewModel.ts](src/vs/workbench/contrib/notebook/browser/viewModel/markupCellViewModel.ts)\n- [src/vs/workbench/contrib/notebook/common/model/notebookCellTextModel.ts](src/vs/workbench/contrib/notebook/common/model/notebookCellTextModel.ts)\n- [src/vs/workbench/contrib/notebook/common/model/notebookTextModel.ts](src/vs/workbench/contrib/notebook/common/model/notebookTextModel.ts)\n- [src/vs/workbench/contrib/notebook/common/notebookCommon.ts](src/vs/workbench/contrib/notebook/common/notebookCommon.ts)\n- [src/vs/workbench/contrib/notebook/common/notebookEditorModel.ts](src/vs/workbench/contrib/notebook/common/notebookEditorModel.ts)\n- [src/vs/workbench/contrib/notebook/common/notebookService.ts](src/vs/workbench/contrib/notebook/common/notebookService.ts)\n\n\u003c/details\u003e\n\n\n\nThis document covers the core data model, view model architecture, and rendering components that power VS Code's notebook editor functionality. It focuses on the internal structure of notebooks, cells, and their visual representation.\n\nFor information about notebook services and extension APIs, see [Notebook Service](). For details about the notebook editor UI and user interactions, see [Notebook Editor Widget]().\n\n## Core Architecture Overview\n\nThe notebook system follows a Model-View-ViewModel (MVVM) pattern with clear separation between data representation, business logic, and UI rendering. The architecture consists of three main layers:\n\n**Data Model Layer**: Represents the notebook document structure and cell content  \n**View Model Layer**: Manages UI state and provides computed properties for rendering  \n**View Layer**: Handles actual rendering and user interactions through specialized components\n\n### Notebook Model Hierarchy\n\n```mermaid\ngraph TB\n    subgraph \"Data Model Layer\"\n        NotebookTextModel[\"NotebookTextModel\u003cbr/\u003eimplements INotebookTextModel\"]\n        NotebookCellTextModel[\"NotebookCellTextModel\u003cbr/\u003eimplements ICell\"]\n        NotebookCellOutputTextModel[\"NotebookCellOutputTextModel\u003cbr/\u003eimplements ICellOutput\"]\n    end\n    \n    subgraph \"View Model Layer\"\n        NotebookViewModel[\"NotebookViewModel\u003cbr/\u003eextends Disposable\"]\n        CodeCellViewModel[\"CodeCellViewModel\u003cbr/\u003eextends BaseCellViewModel\"]\n        MarkupCellViewModel[\"MarkupCellViewModel\u003cbr/\u003eextends BaseCellViewModel\"]\n        CellOutputViewModel[\"CellOutputViewModel\u003cbr/\u003eimplements ICellOutputViewModel\"]\n    end\n    \n    subgraph \"View Layer\"\n        NotebookEditorWidget[\"NotebookEditorWidget\u003cbr/\u003eimplements INotebookEditor\"]\n        CodeCellRenderer[\"CodeCellRenderer\u003cbr/\u003eimplements IListRenderer\"]\n        MarkupCellRenderer[\"MarkupCellRenderer\u003cbr/\u003eimplements IListRenderer\"]\n        BackLayerWebView[\"BackLayerWebView\u003cbr/\u003eextends Themable\"]\n        NotebookCellList[\"NotebookCellList\u003cbr/\u003eextends WorkbenchList\"]\n    end\n    \n    NotebookTextModel --\u003e NotebookViewModel\n    NotebookCellTextModel --\u003e CodeCellViewModel\n    NotebookCellTextModel --\u003e MarkupCellViewModel\n    NotebookCellOutputTextModel --\u003e CellOutputViewModel\n    \n    NotebookViewModel --\u003e NotebookEditorWidget\n    CodeCellViewModel --\u003e CodeCellRenderer\n    MarkupCellViewModel --\u003e MarkupCellRenderer\n    CellOutputViewModel --\u003e BackLayerWebView\n    \n    NotebookEditorWidget --\u003e NotebookCellList\n    NotebookCellList --\u003e CodeCellRenderer\n    NotebookCellList --\u003e MarkupCellRenderer\n    \n    NotebookTextModel --\u003e NotebookCellTextModel\n    NotebookCellTextModel --\u003e NotebookCellOutputTextModel\n```\n\nSources: [src/vs/workbench/contrib/notebook/common/model/notebookTextModel.ts:295-311](), [src/vs/workbench/contrib/notebook/browser/viewModel/notebookViewModelImpl.ts:73-100](), [src/vs/workbench/contrib/notebook/browser/notebookEditorWidget.ts:138-210](), [src/vs/workbench/contrib/notebook/browser/view/renderers/cellRenderer.ts:112-237]()\n\n## Data Model Components\n\n### NotebookTextModel\n\nThe `NotebookTextModel` serves as the primary document model, managing the notebook's cells, metadata, and change events. It implements the `INotebookTextModel` interface and provides the foundation for all notebook operations.\n\nKey responsibilities:\n- Cell collection management (`cells` property)\n- Document metadata handling (`metadata` property)  \n- Change tracking and events (`onDidChangeContent`)\n- Undo/redo coordination with cell-level operations\n- Snapshot creation for backup/restore scenarios\n\n### NotebookCellTextModel\n\nIndividual cells are represented by `NotebookCellTextModel`, which wraps the text content and metadata for each cell:\n\n- **Content Management**: Maintains the cell's source code or markdown text\n- **Output Handling**: Manages execution outputs for code cells (`outputs` property)\n- **Metadata Storage**: Cell-specific metadata and internal execution state\n- **Language Services**: Integration with Monaco editor for language features\n\n### Cell Output Model\n\nCell outputs are managed through the `ICellOutput` interface and `NotebookCellOutputTextModel` implementation:\n\n```mermaid\ngraph LR\n    ICellOutput[\"ICellOutput\u003cbr/\u003eInterface\"] --\u003e OutputItems[\"IOutputItemDto[]\u003cbr/\u003eMIME type data\"]\n    ICellOutput --\u003e OutputMetadata[\"metadata\u003cbr/\u003eDisplay hints\"]\n    ICellOutput --\u003e OutputId[\"outputId\u003cbr/\u003eUnique identifier\"]\n    \n    OutputItems --\u003e MimeData[\"VSBuffer\u003cbr/\u003eRaw content data\"]\n    OutputItems --\u003e MimeType[\"mime: string\u003cbr/\u003eContent type\"]\n```\n\nSources: [src/vs/workbench/contrib/notebook/common/model/notebookTextModel.ts:295-311](), [src/vs/workbench/contrib/notebook/common/model/notebookCellTextModel.ts:25-50](), [src/vs/workbench/contrib/notebook/common/notebookCommon.ts:229-245]()\n\n## View Model Architecture\n\n### NotebookViewModel\n\nThe `NotebookViewModel` bridges the data model and UI components, providing:\n\n- **Cell View Management**: Maintains `viewCells` array of cell view models\n- **Selection State**: Tracks focused and selected cells\n- **Layout Information**: Manages notebook-level layout properties\n- **Folding Support**: Handles cell folding and hidden ranges\n- **Change Propagation**: Converts model events to view events\n\n### Cell View Models\n\nCell view models extend `BaseCellViewModel` and provide cell-specific UI state:\n\n#### CodeCellViewModel\n- **Execution State**: Tracks running/idle status and execution results\n- **Output Layout**: Manages output container sizing and positioning  \n- **Editor Integration**: Coordinates with Monaco editor instances\n- **Collapse State**: Handles input/output expansion/collapse\n\n#### MarkupCellViewModel  \n- **Preview Rendering**: Manages markdown rendering and height calculation\n- **Edit State**: Switches between preview and edit modes\n- **Layout Optimization**: Handles dynamic height based on content\n\n```mermaid\ngraph TB\n    BaseCellViewModel[\"BaseCellViewModel\u003cbr/\u003eCommon cell functionality\"]\n    \n    CodeCellViewModel[\"CodeCellViewModel\u003cbr/\u003eCode execution \u0026 outputs\"]\n    MarkupCellViewModel[\"MarkupCellViewModel\u003cbr/\u003eMarkdown preview \u0026 edit\"]\n    \n    BaseCellViewModel --\u003e CodeCellViewModel\n    BaseCellViewModel --\u003e MarkupCellViewModel\n    \n    CodeCellViewModel --\u003e ExecutionState[\"Execution tracking\"]\n    CodeCellViewModel --\u003e OutputLayout[\"Output positioning\"]\n    \n    MarkupCellViewModel --\u003e PreviewState[\"Preview rendering\"]\n    MarkupCellViewModel --\u003e EditMode[\"Edit mode switching\"]\n```\n\nSources: [src/vs/workbench/contrib/notebook/browser/viewModel/baseCellViewModel.ts:30-50](), [src/vs/workbench/contrib/notebook/browser/viewModel/codeCellViewModel.ts:30-51](), [src/vs/workbench/contrib/notebook/browser/viewModel/markupCellViewModel.ts:22-40]()\n\n## Rendering Components\n\n### NotebookEditorWidget\n\nThe main editor container orchestrates all notebook UI components:\n\n- **Cell List Management**: Uses `NotebookCellList` for virtualized rendering\n- **Webview Coordination**: Manages `BackLayerWebView` for output rendering\n- **Focus Management**: Handles focus between cells and outputs\n- **Event Coordination**: Bridges view model events to UI updates\n\n### Cell Renderers\n\nCell rendering is handled by specialized renderer classes:\n\n#### CodeCellRenderer\n- **Template Management**: Creates reusable DOM templates for code cells\n- **Editor Integration**: Embeds Monaco editors using `NotebookCellEditorPool`\n- **Toolbar Rendering**: Manages cell action toolbars and execution buttons\n- **Output Container**: Provides mounting points for output rendering\n\n#### MarkupCellRenderer\n- **Preview Container**: Manages markdown preview rendering area\n- **Edit Mode Support**: Switches between preview and editor modes\n- **Content Sizing**: Handles dynamic height based on rendered content\n\n### BackLayerWebView\n\nOutput rendering is delegated to a specialized webview component:\n\n```mermaid\ngraph TB\n    BackLayerWebView[\"BackLayerWebView\u003cbr/\u003eOutput rendering engine\"]\n    \n    WebviewElement[\"IWebviewElement\u003cbr/\u003eSandbox container\"]\n    RendererRegistry[\"Notebook renderers\u003cbr/\u003eExtension-provided\"]\n    OutputMapping[\"insetMapping\u003cbr/\u003eOutput to DOM mapping\"]\n    \n    BackLayerWebView --\u003e WebviewElement\n    BackLayerWebView --\u003e RendererRegistry\n    BackLayerWebView --\u003e OutputMapping\n    \n    WebviewElement --\u003e PreloadScripts[\"preloadsScriptStr\u003cbr/\u003eRuntime environment\"]\n    RendererRegistry --\u003e MimeHandlers[\"MIME type handlers\"]\n    OutputMapping --\u003e DOMNodes[\"Output DOM elements\"]\n```\n\nSources: [src/vs/workbench/contrib/notebook/browser/notebookEditorWidget.ts:138-250](), [src/vs/workbench/contrib/notebook/browser/view/renderers/cellRenderer.ts:112-136](), [src/vs/workbench/contrib/notebook/browser/view/renderers/backLayerWebView.ts:128-150]()\n\n## Key Interfaces and Contracts\n\n### INotebookEditor Interface\n\nThe primary editor interface defines the contract for notebook editor implementations:\n\n| Property/Method | Purpose |\n|----------------|---------|\n| `textModel` | Access to underlying `NotebookTextModel` |\n| `viewModel` | Access to `NotebookViewModel` for UI state |\n| `activeCodeEditor` | Currently focused Monaco editor instance |\n| `visibleRanges` | Currently visible cell ranges for virtualization |\n| `focusNotebookCell()` | Programmatic cell focus management |\n| `executeNotebookCells()` | Cell execution coordination |\n\n### ICellViewModel Interface\n\nCell view models implement this interface for consistent behavior:\n\n| Property/Method | Purpose |\n|----------------|---------|\n| `model` | Reference to underlying `NotebookCellTextModel` |\n| `layoutInfo` | Cell layout dimensions and positioning |\n| `focusMode` | Current focus state (editor, container, output) |\n| `outputsViewModels` | Array of output view models |\n| `onDidChangeLayout` | Layout change event for rerendering |\n\n### INotebookWebviewMessage\n\nCommunication between the editor and output webview uses a message-based protocol:\n\n| Message Type | Purpose |\n|-------------|---------|\n| `dimension` | Output size updates for layout calculation |\n| `outputFocus`/`outputBlur` | Focus state changes in outputs |\n| `scroll-to-reveal` | Coordinate scrolling between editor and webview |\n| `clicked-link` | Handle link navigation from rendered outputs |\n\nSources: [src/vs/workbench/contrib/notebook/browser/notebookBrowser.ts:512-625](), [src/vs/workbench/contrib/notebook/browser/notebookBrowser.ts:240-286](), [src/vs/workbench/contrib/notebook/browser/view/renderers/webviewMessages.ts:10-50]()\n\n## Cell Lifecycle and State Management\n\n### Cell Creation and Initialization\n\nNew cells follow a standardized creation process:\n\n1. **Model Creation**: `NotebookCellTextModel` instantiation with cell data\n2. **View Model Wrapping**: Creation of appropriate `CellViewModel` subclass  \n3. **Renderer Assignment**: Association with `CodeCellRenderer` or `MarkupCellRenderer`\n4. **Editor Integration**: Monaco editor creation and configuration\n5. **Event Wire-up**: Connection of model/view model events to UI updates\n\n### State Synchronization\n\nThe notebook system maintains consistency between layers through event propagation:\n\n```mermaid\ngraph LR\n    ModelChange[\"Model Change\u003cbr/\u003eCell content update\"] --\u003e ViewModelEvent[\"View Model Event\u003cbr/\u003eLayout recalculation\"]\n    ViewModelEvent --\u003e RendererUpdate[\"Renderer Update\u003cbr/\u003eDOM manipulation\"]\n    RendererUpdate --\u003e UserVisible[\"User Visible Change\u003cbr/\u003eUI reflection\"]\n    \n    UserAction[\"User Action\u003cbr/\u003eEdit, execute, etc.\"] --\u003e ModelChange\n```\n\nSources: [src/vs/workbench/contrib/notebook/browser/view/renderers/cellRenderer.ts:210-235](), [src/vs/workbench/contrib/notebook/browser/viewModel/notebookViewModelImpl.ts:200-250]()\n\n## Output Rendering Pipeline\n\n### MIME Type Resolution\n\nOutput rendering begins with MIME type negotiation:\n\n1. **Available Types**: Extract MIME types from `ICellOutput.outputs`\n2. **Renderer Matching**: Find compatible notebook renderers via `INotebookRendererInfo`\n3. **Priority Ordering**: Apply user preferences and renderer capabilities\n4. **Fallback Handling**: Default to built-in text/HTML renderers if needed\n\n### Webview Integration\n\nRich outputs are rendered in the `BackLayerWebView` component:\n\n- **Sandboxing**: Isolated execution environment for renderer scripts\n- **Message Protocol**: Bi-directional communication for sizing and events\n- **Resource Loading**: Secure loading of renderer assets and dependencies\n- **DOM Management**: Output element lifecycle and cleanup\n\nSources: [src/vs/workbench/contrib/notebook/browser/view/renderers/backLayerWebView.ts:501-525](), [src/vs/workbench/contrib/notebook/browser/notebookBrowser.ts:104-123]()"])</script>
    <script>self.__next_f.push([1, "25:Ta130,"])</script>
    <script>self.__next_f.push([1, "# Chat and AI Integration\n\n\u003cdetails\u003e\n\u003csummary\u003eRelevant source files\u003c/summary\u003e\n\nThe following files were used as context for generating this wiki page:\n\n- [extensions/vscode-api-tests/src/singlefolder-tests/chat.test.ts](extensions/vscode-api-tests/src/singlefolder-tests/chat.test.ts)\n- [src/vs/base/browser/ui/hover/hoverWidget.css](src/vs/base/browser/ui/hover/hoverWidget.css)\n- [src/vs/editor/browser/services/hoverService/hover.css](src/vs/editor/browser/services/hoverService/hover.css)\n- [src/vs/workbench/api/browser/mainThreadChatAgents2.ts](src/vs/workbench/api/browser/mainThreadChatAgents2.ts)\n- [src/vs/workbench/api/browser/mainThreadChatStatus.ts](src/vs/workbench/api/browser/mainThreadChatStatus.ts)\n- [src/vs/workbench/api/common/extHostChatAgents2.ts](src/vs/workbench/api/common/extHostChatAgents2.ts)\n- [src/vs/workbench/api/common/extHostChatStatus.ts](src/vs/workbench/api/common/extHostChatStatus.ts)\n- [src/vs/workbench/contrib/chat/browser/actions/chatActions.ts](src/vs/workbench/contrib/chat/browser/actions/chatActions.ts)\n- [src/vs/workbench/contrib/chat/browser/actions/chatClearActions.ts](src/vs/workbench/contrib/chat/browser/actions/chatClearActions.ts)\n- [src/vs/workbench/contrib/chat/browser/actions/chatContextActions.ts](src/vs/workbench/contrib/chat/browser/actions/chatContextActions.ts)\n- [src/vs/workbench/contrib/chat/browser/actions/chatDeveloperActions.ts](src/vs/workbench/contrib/chat/browser/actions/chatDeveloperActions.ts)\n- [src/vs/workbench/contrib/chat/browser/actions/chatExecuteActions.ts](src/vs/workbench/contrib/chat/browser/actions/chatExecuteActions.ts)\n- [src/vs/workbench/contrib/chat/browser/actions/chatGettingStarted.ts](src/vs/workbench/contrib/chat/browser/actions/chatGettingStarted.ts)\n- [src/vs/workbench/contrib/chat/browser/actions/chatMoveActions.ts](src/vs/workbench/contrib/chat/browser/actions/chatMoveActions.ts)\n- [src/vs/workbench/contrib/chat/browser/actions/chatQuickInputActions.ts](src/vs/workbench/contrib/chat/browser/actions/chatQuickInputActions.ts)\n- [src/vs/workbench/contrib/chat/browser/actions/chatTitleActions.ts](src/vs/workbench/contrib/chat/browser/actions/chatTitleActions.ts)\n- [src/vs/workbench/contrib/chat/browser/chat.contribution.ts](src/vs/workbench/contrib/chat/browser/chat.contribution.ts)\n- [src/vs/workbench/contrib/chat/browser/chat.ts](src/vs/workbench/contrib/chat/browser/chat.ts)\n- [src/vs/workbench/contrib/chat/browser/chatEditor.ts](src/vs/workbench/contrib/chat/browser/chatEditor.ts)\n- [src/vs/workbench/contrib/chat/browser/chatEditorInput.ts](src/vs/workbench/contrib/chat/browser/chatEditorInput.ts)\n- [src/vs/workbench/contrib/chat/browser/chatInputPart.ts](src/vs/workbench/contrib/chat/browser/chatInputPart.ts)\n- [src/vs/workbench/contrib/chat/browser/chatListRenderer.ts](src/vs/workbench/contrib/chat/browser/chatListRenderer.ts)\n- [src/vs/workbench/contrib/chat/browser/chatQuick.ts](src/vs/workbench/contrib/chat/browser/chatQuick.ts)\n- [src/vs/workbench/contrib/chat/browser/chatSetup.ts](src/vs/workbench/contrib/chat/browser/chatSetup.ts)\n- [src/vs/workbench/contrib/chat/browser/chatStatus.ts](src/vs/workbench/contrib/chat/browser/chatStatus.ts)\n- [src/vs/workbench/contrib/chat/browser/chatStatusItemService.ts](src/vs/workbench/contrib/chat/browser/chatStatusItemService.ts)\n- [src/vs/workbench/contrib/chat/browser/chatViewPane.ts](src/vs/workbench/contrib/chat/browser/chatViewPane.ts)\n- [src/vs/workbench/contrib/chat/browser/chatWidget.ts](src/vs/workbench/contrib/chat/browser/chatWidget.ts)\n- [src/vs/workbench/contrib/chat/browser/media/chat.css](src/vs/workbench/contrib/chat/browser/media/chat.css)\n- [src/vs/workbench/contrib/chat/browser/media/chatStatus.css](src/vs/workbench/contrib/chat/browser/media/chatStatus.css)\n- [src/vs/workbench/contrib/chat/common/chatAgents.ts](src/vs/workbench/contrib/chat/common/chatAgents.ts)\n- [src/vs/workbench/contrib/chat/common/chatContextKeys.ts](src/vs/workbench/contrib/chat/common/chatContextKeys.ts)\n- [src/vs/workbench/contrib/chat/common/chatEntitlementService.ts](src/vs/workbench/contrib/chat/common/chatEntitlementService.ts)\n- [src/vs/workbench/contrib/chat/common/chatModel.ts](src/vs/workbench/contrib/chat/common/chatModel.ts)\n- [src/vs/workbench/contrib/chat/common/chatService.ts](src/vs/workbench/contrib/chat/common/chatService.ts)\n- [src/vs/workbench/contrib/chat/common/chatServiceImpl.ts](src/vs/workbench/contrib/chat/common/chatServiceImpl.ts)\n- [src/vs/workbench/contrib/chat/common/chatViewModel.ts](src/vs/workbench/contrib/chat/common/chatViewModel.ts)\n- [src/vs/workbench/contrib/chat/common/constants.ts](src/vs/workbench/contrib/chat/common/constants.ts)\n- [src/vs/workbench/contrib/chat/test/common/chatService.test.ts](src/vs/workbench/contrib/chat/test/common/chatService.test.ts)\n- [src/vs/workbench/contrib/chat/test/common/voiceChatService.test.ts](src/vs/workbench/contrib/chat/test/common/voiceChatService.test.ts)\n- [src/vscode-dts/vscode.proposed.chatParticipantAdditions.d.ts](src/vscode-dts/vscode.proposed.chatParticipantAdditions.d.ts)\n- [src/vscode-dts/vscode.proposed.chatStatusItem.d.ts](src/vscode-dts/vscode.proposed.chatStatusItem.d.ts)\n- [src/vscode-dts/vscode.proposed.defaultChatParticipant.d.ts](src/vscode-dts/vscode.proposed.defaultChatParticipant.d.ts)\n\n\u003c/details\u003e\n\n\n\nVS Code's chat and AI integration system enables conversational AI features including Copilot Chat, inline editing assistance, and agent-based tool execution. The system orchestrates interactions between users and language models through a multi-layered architecture spanning UI components, services, data models, and extension APIs.\n\nThe chat system supports multiple interaction modes (`ChatMode.Ask`, `ChatMode.Edit`, `ChatMode.Agent`) and various integration points (`ChatAgentLocation.Panel`, `ChatAgentLocation.Editor`, etc.) throughout the VS Code interface.\n\n## Architecture Overview\n\nThe chat system comprises UI components, core services, data models, and extension APIs organized in distinct layers. The architecture bridges user interactions through `ChatWidget` down to language model invocations via `IChatAgentImplementation`.\n\n**Chat System Architecture**\n\n```mermaid\ngraph TD\n    subgraph \"UI_Layer\" [\"UI Layer\"]\n        ChatWidget[\"ChatWidget\"]\n        ChatInputPart[\"ChatInputPart\"]\n        ChatListItemRenderer[\"ChatListItemRenderer\"]\n        ChatViewPane[\"ChatViewPane\"]\n    end\n    \n    subgraph \"Service_Layer\" [\"Service Layer\"]\n        ChatService[\"ChatService\"]\n        ChatAgentService[\"ChatAgentService\"]\n        ChatSlashCommandService[\"ChatSlashCommandService\"]\n        ChatEditingService[\"ChatEditingService\"]\n        ChatWidgetService[\"ChatWidgetService\"]\n    end\n    \n    subgraph \"Model_Layer\" [\"Model Layer\"]\n        ChatModel[\"ChatModel\"]\n        ChatRequestModel[\"ChatRequestModel\"]\n        ChatResponseModel[\"ChatResponseModel\"]\n        ChatViewModel[\"ChatViewModel\"]\n        ChatAttachmentModel[\"ChatAttachmentModel\"]\n    end\n    \n    subgraph \"Extension_Layer\" [\"Extension Layer\"]\n        ExtHostChatAgents2[\"ExtHostChatAgents2\"]\n        MainThreadChatAgents2[\"MainThreadChatAgents2\"]\n        IChatAgentImplementation[\"IChatAgentImplementation\"]\n        ChatAgentResponseStream[\"ChatAgentResponseStream\"]\n    end\n    \n    subgraph \"Language_Layer\" [\"Language Model Layer\"]\n        ILanguageModelsService[\"ILanguageModelsService\"]\n        ILanguageModelToolsService[\"ILanguageModelToolsService\"]\n    end\n    \n    ChatWidget --\u003e ChatInputPart\n    ChatWidget --\u003e ChatListItemRenderer\n    ChatWidget --\u003e ChatService\n    ChatInputPart --\u003e ChatAttachmentModel\n    \n    ChatService --\u003e ChatAgentService\n    ChatService --\u003e ChatModel\n    ChatAgentService --\u003e IChatAgentImplementation\n    \n    ChatModel --\u003e ChatRequestModel\n    ChatModel --\u003e ChatResponseModel\n    ChatWidget --\u003e ChatViewModel\n    ChatViewModel --\u003e ChatModel\n    \n    ExtHostChatAgents2 --\u003e ChatAgentResponseStream\n    ExtHostChatAgents2 -.-\u003e|\"RPC\"| MainThreadChatAgents2\n    MainThreadChatAgents2 --\u003e ChatAgentService\n    IChatAgentImplementation --\u003e ILanguageModelsService\n```\n\nSources:\n- [src/vs/workbench/contrib/chat/browser/chatWidget.ts:106-440]()\n- [src/vs/workbench/contrib/chat/common/chatServiceImpl.ts:108-198]()\n- [src/vs/workbench/contrib/chat/common/chatAgents.ts:650-720]()\n- [src/vs/workbench/contrib/chat/browser/chatInputPart.ts:140-498]()\n- [src/vs/workbench/contrib/chat/browser/chatListRenderer.ts:127-200]()\n\n## Chat Request-Response Flow\n\nThe chat system processes user inputs and generates responses through a series of interactions between components. This flow starts with user input and ends with a rendered response.\n\n**Chat Request-Response Flow**\n\n```mermaid\nsequenceDiagram\n    participant User\n    participant ChatInputPart\n    participant ChatWidget\n    participant ChatService\n    participant ChatAgentService\n    participant ExtHostChatAgents2\n    participant ChatAgentResponseStream\n    participant ILanguageModelsService\n\n    User-\u003e\u003eChatInputPart: \"acceptInput(query)\"\n    ChatInputPart-\u003e\u003eChatWidget: \"acceptInput(query)\"\n    ChatWidget-\u003e\u003eChatService: \"sendRequest(sessionId, request, options)\"\n    \n    ChatService-\u003e\u003eChatService: \"new ChatRequestModel(params)\"\n    ChatService-\u003e\u003eChatAgentService: \"invokeAgent(agent, request, progress)\"\n    ChatAgentService-\u003e\u003eExtHostChatAgents2: \"invoke(request, progress, history, token)\"\n    \n    ExtHostChatAgents2-\u003e\u003eChatAgentResponseStream: \"new ChatAgentResponseStream()\"\n    ExtHostChatAgents2-\u003e\u003eILanguageModelsService: \"sendRequest with context\"\n    \n    ILanguageModelsService--\u003e\u003eExtHostChatAgents2: \"Stream response chunks\"\n    \n    loop \"For each response chunk\"\n        ExtHostChatAgents2-\u003e\u003eChatAgentResponseStream: \"markdown(content)\"\n        ChatAgentResponseStream--\u003e\u003eChatService: \"$handleProgressChunk(requestId, progress)\"\n        ChatService--\u003e\u003eChatWidget: \"onDidChange event\"\n        ChatWidget--\u003e\u003eUser: \"Render via ChatListItemRenderer\"\n    end\n    \n    ExtHostChatAgents2--\u003e\u003eChatService: \"Return IChatAgentResult\"\n    ChatService-\u003e\u003eChatService: \"new ChatResponseModel(result)\"\n    ChatService--\u003e\u003eChatWidget: \"Response complete\"\n```\n\nSources:\n- [src/vs/workbench/contrib/chat/browser/chatWidget.ts:1260-1310]()\n- [src/vs/workbench/contrib/chat/common/chatServiceImpl.ts:460-580]()\n- [src/vs/workbench/contrib/chat/browser/chatInputPart.ts:760-830]()\n- [src/vs/workbench/contrib/chat/common/chatAgents.ts:125-145]()\n\n## Key Components\n\n### Chat Widget\n\n`ChatWidget` is the primary UI orchestrator implementing `IChatWidget`. It coordinates between the input area (`ChatInputPart`), message list (`WorkbenchObjectTree\u003cChatTreeItem\u003e`), and view model (`ChatViewModel`).\n\nCore responsibilities:\n- Session lifecycle via `initForNewChatModel()` and `clear()`\n- Input processing through `acceptInput()` and `getInput()`\n- Message rendering using `ChatListItemRenderer`\n- Extension integration via `ChatWidget.CONTRIBS` contributions\n- Focus management with `focusInput()` and `hasInputFocus()`\n\n```mermaid\nclassDiagram\n    class ChatWidget {\n        -ChatViewModel _viewModel\n        -ChatInputPart inputPart\n        -WorkbenchObjectTree~ChatTreeItem~ tree\n        -ChatListItemRenderer renderer\n        -CodeBlockModelCollection _codeBlockModelCollection\n        -IChatWidgetContrib[] contribs\n        -boolean _isReady\n        +render(container: HTMLElement)\n        +acceptInput(query?: string)\n        +setInput(value: string, transient: boolean)\n        +getInput(): string\n        +focusInput(): void\n        +hasInputFocus(): boolean\n        +reveal(item: ChatTreeItem, relativeTop?: number)\n        +getSibling(item: ChatTreeItem, type: string)\n        +waitForReady(): Promise~void~\n        +clear(): void\n        +initForNewChatModel(state: IChatViewState, modelIsEmpty: boolean)\n    }\n    \n    class IChatWidget {\n        \u003c\u003cinterface\u003e\u003e\n        +readonly onDidSubmitAgent: Event~IChatAgentData~\n        +readonly onDidChangeViewModel: Event~void~\n        +readonly input: ChatInputPart\n        +readonly inputEditor: ICodeEditor\n        +readonly inputUri: URI\n        +readonly contentHeight: number\n        +readonly attachmentModel: ChatAttachmentModel\n        +readonly viewModel: ChatViewModel\n        +readonly parsedInput: IParsedChatRequest\n        +lastSelectedAgent: IChatAgentData\n        +readonly supportsFileReferences: boolean\n    }\n    \n    class IChatWidgetContrib {\n        \u003c\u003cinterface\u003e\u003e\n        +readonly id: string\n        +getInputState?(): any\n        +setInputState?(s: any): void\n    }\n    \n    IChatWidget \u003c|.. ChatWidget\n    ChatWidget *-- ChatViewModel\n    ChatWidget *-- ChatInputPart\n    ChatWidget *-- ChatListItemRenderer\n    ChatWidget o-- IChatWidgetContrib\n```\n\nSources:\n- [src/vs/workbench/contrib/chat/browser/chatWidget.ts:106-492]()\n- [src/vs/workbench/contrib/chat/browser/chat.ts:98-180]()\n\n### Chat Input Part\n\n`ChatInputPart` manages the input area including the `CodeEditorWidget` for text input, `ChatAttachmentModel` for context variables, and mode switching between `ChatMode.Ask`, `ChatMode.Edit`, and `ChatMode.Agent`.\n\nKey implementation details:\n- Input editor via `createInput()` using `PROMPT_LANGUAGE_ID`\n- Context collection through `getAttachedAndImplicitContext(sessionId)`\n- History navigation using `HistoryNavigator2\u003cIChatHistoryEntry\u003e`\n- Mode management via `setChatMode2()` and `currentMode2` property\n- Tool selection through `ChatSelectedTools.selectedToolsModel`\n\n```mermaid\nclassDiagram\n    class ChatInputPart {\n        -ChatAttachmentModel _attachmentModel\n        -CodeEditorWidget _inputEditor\n        -HistoryNavigator2~IChatHistoryEntry~ history\n        -IChatMode _currentMode\n        -ChatSelectedTools selectedToolsModel\n        -ILanguageModelChatMetadataAndIdentifier _currentLanguageModel\n        -URI inputUri\n        -MenuWorkbenchToolBar executeToolbar\n        -MenuWorkbenchToolBar inputActionsToolbar\n        +acceptInput(query?: string): void\n        +setValue(value: string, transient: boolean): void\n        +getValue(): string\n        +focus(): void\n        +hasFocus(): boolean\n        +getAttachedAndImplicitContext(sessionId: string): Promise~ChatRequestVariableSet~\n        +setChatMode2(mode: IChatMode, storeSelection: boolean): void\n        +get currentMode(): ChatMode\n        +get currentMode2(): IChatMode\n        +showPreviousValue(): Promise~void~\n        +showNextValue(): Promise~void~\n        +saveCurrentValue(inputState: IChatInputState): void\n        +switchModel(modelMetadata): void\n        +openModelPicker(): void\n        +get hasPromptFileAttachments(): boolean\n    }\n    \n    class ChatAttachmentModel {\n        -IChatRequestVariableEntry[] _attachments\n        +get attachments(): readonly IChatRequestVariableEntry[]\n        +get size(): number\n        +addContext(entry: IChatRequestVariableEntry): void\n        +addFile(uri: URI): void\n        +clear(): void\n        +clearAndSetContext(entries: IChatRequestVariableEntry[]): void\n        +hasPromptFiles(languageId: string): boolean\n        +getPromptFileVariables(): Promise~IChatRequestVariableEntry[]~\n        +updateContext(toRemove: Set~string~, toAdd: Iterable~IChatRequestVariableEntry~): void\n    }\n    \n    class IChatInputPartOptions {\n        \u003c\u003cinterface\u003e\u003e\n        +renderFollowups: boolean\n        +renderStyle?: string\n        +menus: object\n        +editorOverflowWidgetsDomNode?: HTMLElement\n        +renderWorkingSet?: boolean\n        +enableImplicitContext?: boolean\n        +supportsChangingModes?: boolean\n        +dndContainer?: HTMLElement\n        +widgetViewKindTag: string\n    }\n    \n    ChatInputPart *-- ChatAttachmentModel\n    ChatInputPart ..\u003e IChatInputPartOptions\n    ChatInputPart *-- ChatSelectedTools\n```\n\nSources:\n- [src/vs/workbench/contrib/chat/browser/chatInputPart.ts:140-498]()\n- [src/vs/workbench/contrib/chat/browser/chatInputPart.ts:118-132]()\n- [src/vs/workbench/contrib/chat/browser/chatAttachmentModel.ts]()\n\n### Chat Service\n\n`ChatService` implements `IChatService` for session management, request processing, and agent coordination. It maintains session state through `ChatModel` instances and handles persistence via `ChatSessionStore`.\n\nCore methods and data structures:\n- Session creation: `startSession(location: ChatAgentLocation, token?: CancellationToken)`\n- Request dispatch: `sendRequest(sessionId: string, request: string, options?: IChatSendRequestOptions)`\n- Model management: `getSession(sessionId: string)` and `getOrRestoreSession(sessionId: string)`\n- Agent invocation: `doSendRequest()` → `invokeAgent()` flow\n- Progress handling: `handleProgress()` for streaming responses\n\n```mermaid\nclassDiagram\n    class ChatService {\n        -DisposableMap~string,ChatModel~ _sessionModels\n        -DisposableMap~string,CancellableRequest~ _pendingRequests\n        -ISerializableChatsData _persistedSessions\n        -ChatSessionStore _chatSessionStore\n        -ChatServiceTelemetry _chatServiceTelemetry\n        +startSession(location: ChatAgentLocation, token?: CancellationToken): ChatModel\n        +sendRequest(sessionId: string, request: string, options?: IChatSendRequestOptions): void\n        +getSession(sessionId: string): IChatModel\n        +getOrRestoreSession(sessionId: string): IChatModel\n        +clearSession(sessionId: string): void\n        +addCompleteRequest(sessionId: string, message: string, variables: IChatRequestVariableData, response: IChatCompleteResponse): void\n        +getHistory(location: ChatAgentLocation): IChatDetail[]\n        +removeRequest(sessionId: string, requestId: string): Promise~void~\n        +cancelCurrentRequestForSession(sessionId: string): void\n        +getSessionId(workspaceUri: URI): string\n        +transferChatSession(transferredSessionData: IChatTransferredSessionData, toWorkspace: URI): void\n        +isEnabled(location: ChatAgentLocation): boolean\n        +get edits2Enabled(): boolean\n        -doSendRequest(model: ChatModel, message: string, response: ChatResponseModel, options: IChatSendRequestOptions): Promise~void~\n        -invokeAgent(agent: IChatAgentData, request: IChatAgentRequest, progress: (part: IChatProgress) =\u003e void): Promise~IChatAgentResult~\n        -handleProgress(model: ChatModel, response: ChatResponseModel, part: IChatProgress): boolean\n    }\n    \n    class IChatService {\n        \u003c\u003cinterface\u003e\u003e\n        +readonly onDidSubmitRequest: Event~object~\n        +readonly onDidDisposeSession: Event~object~\n        +readonly onDidPerformUserAction: Event~IChatUserActionEvent~\n        +readonly transferredSessionData?: IChatTransferredSessionData\n        +readonly edits2Enabled: boolean\n    }\n    \n    class CancellableRequest {\n        +readonly cancellationTokenSource: CancellationTokenSource\n        +requestId: string\n        +cancel(): void\n        +dispose(): void\n    }\n    \n    class ChatSessionStore {\n        +migrateDataIfNeeded(getPersistedSessions: Function): void\n        +storeSessions(sessions: ChatModel[]): void\n        +loadSessions(): ISerializableChatsData\n    }\n    \n    IChatService \u003c|.. ChatService\n    ChatService *-- ChatSessionStore\n    ChatService o-- ChatModel\n    ChatService o-- CancellableRequest\n```\n\nSources:\n- [src/vs/workbench/contrib/chat/common/chatServiceImpl.ts:108-240]()\n- [src/vs/workbench/contrib/chat/common/chatServiceImpl.ts:88-106]()\n- [src/vs/workbench/contrib/chat/common/chatService.ts:277-400]()\n\n### Chat Agents\n\nChat agents implement `IChatAgentImplementation` to process user queries through language models. The `ChatAgentService` manages registration, selection, and invocation of agents including default system agents and extension-contributed agents.\n\nAgent system components:\n- `ChatAgentService.registerAgent()` for registration with `IChatAgentData`\n- `ChatAgentService.invokeAgent()` for request dispatch\n- `SetupAgent` for initial setup flow when Copilot isn't configured\n- Extension agents via `ExtHostChatAgents2` implementing the agent protocol\n\n```mermaid\nclassDiagram\n    class ChatAgentService {\n        -Map~string,IChatAgentData~ _agents\n        -Map~string,IChatAgentImplementation~ _agentImplementations\n        -IObservable~readonly IChatAgentData[]~ _agentsObs\n        -IContextKey~boolean~ _hasToolsAgent\n        +registerAgent(id: string, data: IChatAgentData): IDisposable\n        +registerAgentImplementation(id: string, impl: IChatAgentImplementation): IDisposable\n        +getAgent(id: string): IChatAgentData\n        +getAgentsByName(name: string): IChatAgentData[]\n        +getContributedDefaultAgent(location: ChatAgentLocation): IChatAgentData\n        +getSecondaryAgent(): IChatAgentData\n        +updateAgent(id: string, updateMetadata: IChatAgentMetadata): void\n        +invokeAgent(agentId: string, request: IChatAgentRequest, progress: Function, history: IChatAgentHistoryEntry[], token: CancellationToken): Promise~IChatAgentResult~\n        +get hasToolsAgent(): boolean\n        +getAgents(): IChatAgentData[]\n        +getActivatedAgents(): Array~IChatAgentData~\n    }\n    \n    class IChatAgentImplementation {\n        \u003c\u003cinterface\u003e\u003e\n        +invoke(request: IChatAgentRequest, progress: Function, history: IChatAgentHistoryEntry[], token: CancellationToken): Promise~IChatAgentResult~\n        +provideWelcomeMessage?(location: ChatAgentLocation, token: CancellationToken): Promise~IChatWelcomeMessageContent[]~\n        +provideSampleQuestions?(location: ChatAgentLocation, token: CancellationToken): Promise~IChatFollowup[]~\n        +provideFollowups?(request: IChatAgentRequest, result: IChatAgentResult, history: IChatAgentHistoryEntry[], token: CancellationToken): Promise~IChatFollowup[]~\n    }\n    \n    class IChatAgentData {\n        \u003c\u003cinterface\u003e\u003e\n        +id: string\n        +name: string\n        +fullName?: string\n        +description?: string\n        +when?: string\n        +extensionId: ExtensionIdentifier\n        +extensionPublisherId: string\n        +extensionDisplayName: string\n        +publisherDisplayName?: string\n        +isDefault?: boolean\n        +isDynamic?: boolean\n        +isCore?: boolean\n        +metadata: IChatAgentMetadata\n        +slashCommands: IChatAgentCommand[]\n        +disambiguation: IChatAgentCommand[]\n        +locations: ChatAgentLocation[]\n        +modes?: ChatMode[]\n        +welcomeMessage?: string | IChatWelcomeMessageContent[]\n        +hasDynamicFollowups?: boolean\n        +requiresDynamicVariables?: boolean\n        +themeIcon?: ThemeIcon\n    }\n    \n    class IChatAgentRequest {\n        \u003c\u003cinterface\u003e\u003e\n        +sessionId: string\n        +requestId: string\n        +agentId: string\n        +message: string\n        +command?: string\n        +variables: IChatRequestVariableData\n        +location: ChatAgentLocation\n        +acceptedConfirmationData?: any[]\n        +rejectedConfirmationData?: any[]\n        +attempt: number\n        +enableCommandDetection: boolean\n        +userSelectedModelId?: string\n    }\n    \n    class SetupAgent {\n        +invoke(request: IChatAgentRequest, progress: Function): Promise~IChatAgentResult~\n        +static registerDefaultAgents(instantiationService, location, mode, context, controller): object\n        +static registerVSCodeAgent(instantiationService, context, controller): object\n        -doInvokeWithSetup(request, progress, chatService, languageModelsService, chatWidgetService, chatAgentService, languageModelToolsService): Promise~IChatAgentResult~\n        -doInvokeWithoutSetup(request, progress, chatService, languageModelsService, chatWidgetService, chatAgentService, languageModelToolsService): Promise~IChatAgentResult~\n        -forwardRequestToCopilot(requestModel, progress, chatService, languageModelsService, chatAgentService, chatWidgetService, languageModelToolsService): Promise~void~\n    }\n    \n    ChatAgentService o-- IChatAgentImplementation\n    ChatAgentService o-- IChatAgentData\n    IChatAgentImplementation ..\u003e IChatAgentRequest\n    IChatAgentImplementation \u003c|.. SetupAgent\n```\n\nSources:\n- [src/vs/workbench/contrib/chat/common/chatAgents.ts:650-850]()\n- [src/vs/workbench/contrib/chat/common/chatAgents.ts:125-170]()\n- [src/vs/workbench/contrib/chat/common/chatAgents.ts:40-85]()\n- [src/vs/workbench/contrib/chat/common/chatAgents.ts:240-290]()\n\n### Chat List Renderer\n\n`ChatListItemRenderer` implements `ITreeRenderer\u003cChatTreeItem\u003e` to render chat messages in the `WorkbenchObjectTree`. It manages content part rendering, editor pools for code blocks, and interactive elements through various specialized components.\n\nRendering architecture:\n- Template creation via `renderTemplate()` returning `IChatListItemTemplate`\n- Element rendering through `renderChatTreeItem()` with content part diffing\n- Code block management using `EditorPool` and `DiffEditorPool`\n- Progressive rendering based on `getProgressiveRenderRate()`\n- Content parts: `ChatMarkdownContentPart`, `ChatTextEditContentPart`, `ChatTreeContentPart`, etc.\n\n```mermaid\nclassDiagram\n    class ChatListItemRenderer {\n        -MarkdownRenderer renderer\n        -ChatMarkdownDecorationsRenderer markdownDecorationsRenderer\n        -EditorPool _editorPool\n        -EditorPool _toolEditorPool\n        -DiffEditorPool _diffEditorPool\n        -TreePool _treePool\n        -CollapsibleListPool _contentReferencesListPool\n        -CodeBlockModelCollection _toolInvocationCodeBlockCollection\n        -Map~string,IChatCodeBlockInfo[]~ codeBlocksByResponseId\n        -ResourceMap~IChatCodeBlockInfo~ codeBlocksByEditorUri\n        -Map~string,IChatFileTreeInfo[]~ fileTreesByResponseId\n        +get templateId(): string\n        +renderTemplate(container: HTMLElement): IChatListItemTemplate\n        +renderElement(node: ITreeNode~ChatTreeItem~, index: number, templateData: IChatListItemTemplate): void\n        +renderChatTreeItem(element: ChatTreeItem, index: number, templateData: IChatListItemTemplate): void\n        +getCodeBlockInfosForResponse(response: IChatResponseViewModel): IChatCodeBlockInfo[]\n        +getCodeBlockInfoForEditor(uri: URI): IChatCodeBlockInfo\n        +getFileTreeInfosForResponse(response: IChatResponseViewModel): IChatFileTreeInfo[]\n        +getLastFocusedFileTreeForResponse(response: IChatResponseViewModel): IChatFileTreeInfo\n        +editorsInUse(): Iterable~CodeBlockPart~\n        +setVisible(visible: boolean): void\n        +layout(width: number): void\n        -getProgressiveRenderRate(element: IChatResponseViewModel): number\n        -renderContentParts(elements: IChatProgressRenderableResponseContent[], templateData: IChatListItemTemplate): IChatContentPart[]\n        -renderMarkdown(markdown: IMarkdownString, templateData: IChatListItemTemplate): ChatMarkdownContentPart\n        -renderTextEdit(textEdit: IChatTextEditGroup, templateData: IChatListItemTemplate): ChatTextEditContentPart\n    }\n    \n    class IChatRendererDelegate {\n        \u003c\u003cinterface\u003e\u003e\n        +container: HTMLElement\n        +getListLength(): number\n        +currentChatMode(): ChatMode\n        +readonly onDidScroll?: Event~void~\n    }\n    \n    class IChatListItemTemplate {\n        \u003c\u003cinterface\u003e\u003e\n        +currentElement?: ChatTreeItem\n        +renderedParts?: IChatContentPart[]\n        +readonly rowContainer: HTMLElement\n        +readonly titleToolbar?: MenuWorkbenchToolBar\n        +readonly header?: HTMLElement\n        +readonly footerToolbar: MenuWorkbenchToolBar\n        +readonly avatarContainer: HTMLElement\n        +readonly username: HTMLElement\n        +readonly detail: HTMLElement\n        +readonly value: HTMLElement\n        +readonly contextKeyService: IContextKeyService\n        +readonly instantiationService: IInstantiationService\n        +readonly templateDisposables: IDisposable\n        +readonly elementDisposables: DisposableStore\n        +readonly agentHover: ChatAgentHover\n        +readonly requestHover: HTMLElement\n    }\n    \n    class IChatContentPart {\n        \u003c\u003cinterface\u003e\u003e\n        +readonly onDidChangeHeight?: Event~void~\n        +readonly domNode: HTMLElement\n        +dispose(): void\n        +hasSameContent(other: IChatProgressRenderableResponseContent): boolean\n        +addProgress?(progress: IChatProgressRenderableResponseContent): void\n        +setVisible?(visible: boolean): void\n    }\n    \n    ChatListItemRenderer --\u003e IChatRendererDelegate\n    ChatListItemRenderer ..\u003e IChatListItemTemplate\n    ChatListItemRenderer ..\u003e IChatContentPart\n```\n\nSources:\n- [src/vs/workbench/contrib/chat/browser/chatListRenderer.ts:127-191]()\n- [src/vs/workbench/contrib/chat/browser/chatListRenderer.ts:280-384]()\n- [src/vs/workbench/contrib/chat/browser/chatListRenderer.ts:85-106]()\n- [src/vs/workbench/contrib/chat/browser/chatListRenderer.ts:117-124]()\n\n### Content Parts System\n\nChat responses are rendered using a modular content part system that supports various content types:\n\n| Content Part Type | Description |\n|------------------|-------------|\n| `ChatMarkdownContentPart` | Renders markdown content including text and simple formatting |\n| `ChatCodeBlockPart` | Renders code with syntax highlighting and actions |\n| `ChatTextEditContentPart` | Shows text edits with diff viewer |\n| `ChatTreeContentPart` | Displays file trees and hierarchical data |\n| `ChatAttachmentsContentPart` | Shows attached files and resources |\n| `ChatToolInvocationPart` | Shows tool execution and results |\n| `ChatProgressContentPart` | Shows loading and progress indicators |\n| `ChatFollowups` | Displays suggested follow-up questions |\n\nSources:\n- [src/vs/workbench/contrib/chat/browser/chatContentParts/chatMarkdownContentPart.ts]()\n- [src/vs/workbench/contrib/chat/browser/codeBlockPart.ts:1-100]()\n- [src/vs/workbench/contrib/chat/browser/chatFollowups.ts]()\n\n## Chat Modes and Agent Locations\n\nThe chat system supports different modes and locations within VS Code:\n\n### Chat Modes\n\nVS Code's chat system supports three primary modes:\n\n1. **Ask Mode (`ChatMode.Ask`)**: Standard chat interaction for asking questions and getting information.\n2. **Edit Mode (`ChatMode.Edit`)**: Focuses on making edits to code files based on natural language instructions.\n3. **Agent Mode (`ChatMode.Agent`)**: Advanced mode where the AI can use tools and perform complex tasks.\n\n```mermaid\ngraph TD\n    subgraph \"Chat Modes\"\n        AskMode[\"Ask Mode\\n(Default Q\u0026A)\"]\n        EditMode[\"Edit Mode\\n(Code modifications)\"]\n        AgentMode[\"Agent Mode\\n(Tool-enabled)\"]\n    end\n    \n    User --\u003e AskMode\n    User --\u003e EditMode\n    User --\u003e AgentMode\n    \n    AskMode --\u003e Response[\"Information responses\"]\n    EditMode --\u003e CodeEdits[\"Code edits \u0026 suggestions\"]\n    AgentMode --\u003e ToolInvocation[\"Tool invocation \u0026 execution\"]\n```\n\n### Chat Locations\n\nChat can be used in multiple locations within VS Code:\n\n| Location | Description | Use Cases |\n|----------|-------------|-----------|\n| `ChatAgentLocation.Panel` | Main chat panel view | General Q\u0026A, workspace-wide tasks |\n| `ChatAgentLocation.Editor` | Inline editor chat | Context-specific code help |\n| `ChatAgentLocation.Terminal` | Terminal integration | Command assistance |\n| `ChatAgentLocation.Notebook` | Notebook integration | Data analysis and explanation |\n\nSources:\n- [src/vs/workbench/contrib/chat/common/constants.ts:8-38]()\n- [src/vs/workbench/contrib/chat/browser/actions/chatExecuteActions.ts:50-150]()\n- [src/vs/workbench/contrib/chat/browser/chatInputPart.ts:480-490]()\n\n## Chat Request Variables and Context\n\nThe chat system supports various types of context that can be attached to chat requests for better results:\n\n### Variable Types\n\n| Variable Type | Interface | Description | Usage |\n|---------------|-----------|-------------|-------|\n| File Entry | `IChatRequestFileEntry` | A file from the workspace | Providing context from code files |\n| Directory Entry | `IChatRequestDirectoryEntry` | A folder from the workspace | Including multiple related files |\n| Paste Variable | `IChatRequestPasteVariableEntry` | Copied code snippet with metadata | Sharing code without saving to a file |\n| Symbol Variable | `ISymbolVariableEntry` | Code symbol reference with location | Referencing specific functions/classes |\n| Image Variable | `IImageVariableEntry` | Image data with MIME type | Sharing screenshots or images |\n| Implicit Variable | `IChatRequestImplicitVariableEntry` | Automatically attached context | Current file or selection |\n| Tool Variable | `IChatRequestToolEntry` | Reference to available tools | Allowing AI to use specific tools |\n| Tool Set Variable | `IChatRequestToolSetEntry` | Collection of related tools | Group tool functionality |\n| Diagnostic Variable | `IDiagnosticVariableEntry` | Code problems with severity | Asking about errors or warnings |\n| Command Result | `ICommandResultVariableEntry` | Output from executed commands | Including command results |\n| Notebook Output | `INotebookOutputVariableEntry` | Cell execution output | Notebook context |\n| Element Variable | `IElementVariableEntry` | Web/UI element reference | Browser elements |\n| SCM History Item | `ISCMHistoryItemVariableEntry` | Source control history | Git commits and changes |\n\nVariables can be referenced in prompts using the `#` prefix, and the system manages their serialization and attachment to requests.\n\n```mermaid\ngraph TD\n    subgraph \"Context Collection\"\n        FileContext[\"File Context\\n(#file)\"]\n        SymbolContext[\"Symbol Context\\n(#symbol)\"]\n        SelectionContext[\"Selection Context\\n(Implicit)\"]\n        DiagnosticContext[\"Diagnostic Context\\n(#problem)\"]\n        ToolContext[\"Tool Reference\\n(#tool)\"]\n        ImageContext[\"Image Context\\n(#image)\"]\n    end\n    \n    subgraph \"Chat Request Processing\"\n        ContextCollection[\"ChatAttachmentModel\"]\n        Request[\"ChatRequestModel\"]\n        AgentProcessing[\"Agent Processing\"]\n    end\n    \n    FileContext --\u003e ContextCollection\n    SymbolContext --\u003e ContextCollection\n    SelectionContext --\u003e ContextCollection\n    DiagnosticContext --\u003e ContextCollection\n    ToolContext --\u003e ContextCollection\n    ImageContext --\u003e ContextCollection\n    \n    ContextCollection --\u003e Request\n    Request --\u003e AgentProcessing\n```\n\nSources:\n- [src/vs/workbench/contrib/chat/common/chatModel.ts:35-223]()\n- [src/vs/workbench/contrib/chat/browser/chatInputPart.ts:169-206]()\n- [src/vs/workbench/contrib/chat/browser/actions/chatContextActions.ts:68-163]()\n\n## Chat UI Components\n\n### Core UI Structure\n\nThe chat UI is composed of several key components:\n\n```mermaid\ngraph TD\n    subgraph \"Chat Widget Structure\"\n        ChatWidget[\"ChatWidget (Main container)\"]\n        \n        subgraph \"Message List\"\n            MessageList[\"WorkbenchObjectTree\"]\n            UserRequests[\"Request Items\"]\n            AIResponses[\"Response Items\"]\n        end\n        \n        subgraph \"Input Area\"\n            InputPart[\"ChatInputPart\"]\n            AttachmentsArea[\"Attachments Container\"]\n            InputEditor[\"Input Editor\"]\n            ActionButtons[\"Action Buttons\"]\n        end\n    end\n    \n    ChatWidget --\u003e MessageList\n    ChatWidget --\u003e InputPart\n    \n    MessageList --\u003e UserRequests\n    MessageList --\u003e AIResponses\n    \n    InputPart --\u003e AttachmentsArea\n    InputPart --\u003e InputEditor\n    InputPart --\u003e ActionButtons\n```\n\n### Message Rendering Structure\n\nChat messages are rendered using a component-based approach:\n\n```mermaid\ngraph TD\n    subgraph \"Chat Message Rendering\"\n        ListItem[\"Chat List Item\"]\n        \n        subgraph \"Header\"\n            Avatar[\"Avatar\"]\n            Username[\"Username\"]\n            Actions[\"Actions Toolbar\"]\n        end\n        \n        subgraph \"Content\"\n            ContentContainer[\"Message Content\"]\n            MarkdownParts[\"Markdown Content\"]\n            CodeBlocks[\"Code Blocks\"]\n            References[\"References\"]\n            Followups[\"Followup Suggestions\"]\n        end\n        \n        subgraph \"Footer\"\n            FooterActions[\"Feedback Buttons\"]\n        end\n    end\n    \n    ListItem --\u003e Header\n    ListItem --\u003e Content\n    ListItem --\u003e Footer\n    \n    Header --\u003e Avatar\n    Header --\u003e Username\n    Header --\u003e Actions\n    \n    Content --\u003e ContentContainer\n    ContentContainer --\u003e MarkdownParts\n    ContentContainer --\u003e CodeBlocks\n    ContentContainer --\u003e References\n    ContentContainer --\u003e Followups\n```\n\nSources:\n- [src/vs/workbench/contrib/chat/browser/media/chat.css:17-100]()\n- [src/vs/workbench/contrib/chat/browser/chatListRenderer.ts:119-185]()\n- [src/vs/workbench/contrib/chat/browser/chatWidget.ts:140-200]()\n\n## Chat Actions and Commands\n\nThe chat system provides numerous actions and commands for interacting with chat:\n\n| Action Category | Examples | Purpose |\n|----------------|----------|---------|\n| Chat Execution | Submit, Cancel, Retry | Control chat requests |\n| Chat Navigation | New Chat, History, Clear | Manage chat sessions |\n| Context Actions | Attach File, Attach Selection | Add context to chats |\n| Code Actions | Insert, Copy, Apply | Work with code from responses |\n| Editing Actions | Accept Changes, Show Changes | Manage AI-suggested edits |\n| Feedback Actions | Helpful, Not Helpful | Provide feedback on responses |\n\nSources:\n- [src/vs/workbench/contrib/chat/browser/actions/chatActions.ts:104-188]()\n- [src/vs/workbench/contrib/chat/browser/actions/chatExecuteActions.ts:50-97]()\n- [src/vs/workbench/contrib/chat/browser/actions/chatContextActions.ts:68-95]()\n- [src/vs/workbench/contrib/chat/browser/actions/chatCodeblockActions.ts:68-95]()\n\n## Chat Editing Integration\n\nThe chat system includes powerful capabilities for code editing:\n\n### Edit Flow\n\n```mermaid\nsequenceDiagram\n    participant User\n    participant ChatWidget\n    participant ChatEditingService\n    participant Editor\n    participant LanguageModel\n    \n    User-\u003e\u003eChatWidget: Request edit in Edit mode\n    ChatWidget-\u003e\u003eChatEditingService: Create editing session\n    ChatWidget-\u003e\u003eLanguageModel: Send edit request\n    LanguageModel--\u003e\u003eChatWidget: Return edit suggestions\n    ChatWidget-\u003e\u003eChatEditingService: Add edits to session\n    ChatEditingService-\u003e\u003eEditor: Show edits as preview\n    User-\u003e\u003eChatEditingService: Accept/Reject edits\n    ChatEditingService-\u003e\u003eEditor: Apply accepted edits\n```\n\n### Editing Features\n\n- Preview changes before applying\n- Accept/reject individual edits\n- View diffs of proposed changes\n- Apply edits to multiple files\n- Track edit history for undo/redo\n\nSources:\n- [src/vs/workbench/contrib/chat/browser/chatEditing/chatEditingActions.ts:1-40]()\n- [src/vs/workbench/contrib/chat/common/chatEditingService.ts]()\n- [src/vs/workbench/contrib/chat/browser/actions/chatExecuteActions.ts:248-310]()\n\n## Extension Integration\n\nExtensions contribute chat agents through the `vscode.chat` API via `ExtHostChatAgents2` which implements the extension host side of the chat protocol. Extensions register `ChatParticipant` objects that get bridged to `IChatAgentImplementation` in the main thread.\n\nExtension API flow:\n- Registration: `vscode.chat.createChatParticipant(id, handler)` \n- Invocation: Extension `handler(request, context, stream, token)` → `ChatAgentResponseStream`\n- Streaming: `stream.markdown()`, `stream.reference()`, `stream.progress()` etc.\n- Tooling: `vscode.lm.tools` for tool access in agent mode\n\n```mermaid\ngraph TD\n    subgraph \"Extension_Host\" [\"Extension Host Process\"]\n        ExtensionCode[\"Extension Code\\n(vscode.chat.createChatParticipant)\"]\n        ExtHostChatAgents2[\"ExtHostChatAgents2\"]\n        ChatAgentResponseStream[\"ChatAgentResponseStream\"]\n        ExtHostLanguageModelTools[\"ExtHostLanguageModelTools\"]\n    end\n    \n    subgraph \"Main_Thread\" [\"Main Thread Process\"]\n        MainThreadChatAgents2[\"MainThreadChatAgents2\"]\n        ChatAgentService[\"ChatAgentService\"]\n        ChatService[\"ChatService\"]\n    end\n    \n    subgraph \"Extension_API\" [\"Extension APIs\"]\n        vscode_chat[\"vscode.chat API\"]\n        vscode_lm[\"vscode.lm API\"]\n        ChatParticipant[\"ChatParticipant interface\"]\n        ChatRequest[\"ChatRequest interface\"]\n        ChatResponseStream_API[\"ChatResponseStream interface\"]\n    end\n    \n    ExtensionCode --\u003e vscode_chat\n    vscode_chat --\u003e ChatParticipant\n    ExtensionCode --\u003e ExtHostChatAgents2\n    ExtHostChatAgents2 --\u003e ChatAgentResponseStream\n    ExtHostChatAgents2 -.-\u003e|\"$registerAgent\\n$handleRequest\\n$handleProgressChunk\"| MainThreadChatAgents2\n    MainThreadChatAgents2 --\u003e ChatAgentService\n    ChatAgentService --\u003e ChatService\n    \n    ExtensionCode --\u003e vscode_lm\n    vscode_lm --\u003e ExtHostLanguageModelTools\n    \n    ChatParticipant ..\u003e ChatRequest\n    ChatParticipant ..\u003e ChatResponseStream_API\n```\n\nSources:\n- [src/vs/workbench/api/common/extHostChatAgents2.ts:27-110]()\n- [src/vs/workbench/api/browser/mainThreadChatAgents2.ts:1-50]()\n- [src/vscode-dts/vscode.proposed.chatParticipantAdditions.d.ts:8-43]()\n- [src/vs/workbench/contrib/chat/browser/chat.contribution.ts:54-107]()\n\n## Conclusion\n\nVS Code's Chat and AI Integration system provides a comprehensive framework for AI-assisted development. The modular architecture separates concerns between UI, services, and AI interactions, enabling a flexible and extensible chat experience. The system supports various usage modes from simple Q\u0026A to complex agent-based interactions with tools, and integrates with multiple parts of the VS Code UI.\n\nThe combination of rich context capabilities, detailed response rendering, and editing integration makes this system powerful for developers seeking AI assistance throughout their development workflow."])</script>
    <script>self.__next_f.push([1, "26:T6daa,"])</script>
    <script>self.__next_f.push([1, "# Chat System Architecture\n\n\u003cdetails\u003e\n\u003csummary\u003eRelevant source files\u003c/summary\u003e\n\nThe following files were used as context for generating this wiki page:\n\n- [extensions/vscode-api-tests/src/singlefolder-tests/chat.test.ts](extensions/vscode-api-tests/src/singlefolder-tests/chat.test.ts)\n- [src/vs/base/browser/ui/hover/hoverWidget.css](src/vs/base/browser/ui/hover/hoverWidget.css)\n- [src/vs/editor/browser/services/hoverService/hover.css](src/vs/editor/browser/services/hoverService/hover.css)\n- [src/vs/workbench/api/browser/mainThreadChatAgents2.ts](src/vs/workbench/api/browser/mainThreadChatAgents2.ts)\n- [src/vs/workbench/api/browser/mainThreadChatStatus.ts](src/vs/workbench/api/browser/mainThreadChatStatus.ts)\n- [src/vs/workbench/api/common/extHostChatAgents2.ts](src/vs/workbench/api/common/extHostChatAgents2.ts)\n- [src/vs/workbench/api/common/extHostChatStatus.ts](src/vs/workbench/api/common/extHostChatStatus.ts)\n- [src/vs/workbench/contrib/chat/browser/actions/chatActions.ts](src/vs/workbench/contrib/chat/browser/actions/chatActions.ts)\n- [src/vs/workbench/contrib/chat/browser/actions/chatClearActions.ts](src/vs/workbench/contrib/chat/browser/actions/chatClearActions.ts)\n- [src/vs/workbench/contrib/chat/browser/actions/chatContextActions.ts](src/vs/workbench/contrib/chat/browser/actions/chatContextActions.ts)\n- [src/vs/workbench/contrib/chat/browser/actions/chatDeveloperActions.ts](src/vs/workbench/contrib/chat/browser/actions/chatDeveloperActions.ts)\n- [src/vs/workbench/contrib/chat/browser/actions/chatExecuteActions.ts](src/vs/workbench/contrib/chat/browser/actions/chatExecuteActions.ts)\n- [src/vs/workbench/contrib/chat/browser/actions/chatGettingStarted.ts](src/vs/workbench/contrib/chat/browser/actions/chatGettingStarted.ts)\n- [src/vs/workbench/contrib/chat/browser/actions/chatMoveActions.ts](src/vs/workbench/contrib/chat/browser/actions/chatMoveActions.ts)\n- [src/vs/workbench/contrib/chat/browser/actions/chatQuickInputActions.ts](src/vs/workbench/contrib/chat/browser/actions/chatQuickInputActions.ts)\n- [src/vs/workbench/contrib/chat/browser/actions/chatTitleActions.ts](src/vs/workbench/contrib/chat/browser/actions/chatTitleActions.ts)\n- [src/vs/workbench/contrib/chat/browser/chat.contribution.ts](src/vs/workbench/contrib/chat/browser/chat.contribution.ts)\n- [src/vs/workbench/contrib/chat/browser/chat.ts](src/vs/workbench/contrib/chat/browser/chat.ts)\n- [src/vs/workbench/contrib/chat/browser/chatEditor.ts](src/vs/workbench/contrib/chat/browser/chatEditor.ts)\n- [src/vs/workbench/contrib/chat/browser/chatEditorInput.ts](src/vs/workbench/contrib/chat/browser/chatEditorInput.ts)\n- [src/vs/workbench/contrib/chat/browser/chatInputPart.ts](src/vs/workbench/contrib/chat/browser/chatInputPart.ts)\n- [src/vs/workbench/contrib/chat/browser/chatListRenderer.ts](src/vs/workbench/contrib/chat/browser/chatListRenderer.ts)\n- [src/vs/workbench/contrib/chat/browser/chatQuick.ts](src/vs/workbench/contrib/chat/browser/chatQuick.ts)\n- [src/vs/workbench/contrib/chat/browser/chatSetup.ts](src/vs/workbench/contrib/chat/browser/chatSetup.ts)\n- [src/vs/workbench/contrib/chat/browser/chatStatus.ts](src/vs/workbench/contrib/chat/browser/chatStatus.ts)\n- [src/vs/workbench/contrib/chat/browser/chatStatusItemService.ts](src/vs/workbench/contrib/chat/browser/chatStatusItemService.ts)\n- [src/vs/workbench/contrib/chat/browser/chatViewPane.ts](src/vs/workbench/contrib/chat/browser/chatViewPane.ts)\n- [src/vs/workbench/contrib/chat/browser/chatWidget.ts](src/vs/workbench/contrib/chat/browser/chatWidget.ts)\n- [src/vs/workbench/contrib/chat/browser/media/chat.css](src/vs/workbench/contrib/chat/browser/media/chat.css)\n- [src/vs/workbench/contrib/chat/browser/media/chatStatus.css](src/vs/workbench/contrib/chat/browser/media/chatStatus.css)\n- [src/vs/workbench/contrib/chat/common/chatAgents.ts](src/vs/workbench/contrib/chat/common/chatAgents.ts)\n- [src/vs/workbench/contrib/chat/common/chatContextKeys.ts](src/vs/workbench/contrib/chat/common/chatContextKeys.ts)\n- [src/vs/workbench/contrib/chat/common/chatEntitlementService.ts](src/vs/workbench/contrib/chat/common/chatEntitlementService.ts)\n- [src/vs/workbench/contrib/chat/common/chatModel.ts](src/vs/workbench/contrib/chat/common/chatModel.ts)\n- [src/vs/workbench/contrib/chat/common/chatService.ts](src/vs/workbench/contrib/chat/common/chatService.ts)\n- [src/vs/workbench/contrib/chat/common/chatServiceImpl.ts](src/vs/workbench/contrib/chat/common/chatServiceImpl.ts)\n- [src/vs/workbench/contrib/chat/common/chatViewModel.ts](src/vs/workbench/contrib/chat/common/chatViewModel.ts)\n- [src/vs/workbench/contrib/chat/common/constants.ts](src/vs/workbench/contrib/chat/common/constants.ts)\n- [src/vs/workbench/contrib/chat/test/common/chatService.test.ts](src/vs/workbench/contrib/chat/test/common/chatService.test.ts)\n- [src/vs/workbench/contrib/chat/test/common/voiceChatService.test.ts](src/vs/workbench/contrib/chat/test/common/voiceChatService.test.ts)\n- [src/vscode-dts/vscode.proposed.chatParticipantAdditions.d.ts](src/vscode-dts/vscode.proposed.chatParticipantAdditions.d.ts)\n- [src/vscode-dts/vscode.proposed.chatStatusItem.d.ts](src/vscode-dts/vscode.proposed.chatStatusItem.d.ts)\n- [src/vscode-dts/vscode.proposed.defaultChatParticipant.d.ts](src/vscode-dts/vscode.proposed.defaultChatParticipant.d.ts)\n\n\u003c/details\u003e\n\n\n\nThis document covers VS Code's chat system architecture, including UI components, service layer, and agent integration patterns. The chat system provides a conversational interface for interacting with AI assistants like GitHub Copilot through a modular, extensible architecture.\n\n## System Architecture Overview\n\nVS Code's chat system is built on a multi-layered architecture that separates UI components, business logic, and agent integration. The system supports multiple chat modes (Ask, Edit, Agent) and provides extensible patterns for integrating various AI providers.\n\n### High-Level System Architecture\n\n```mermaid\nflowchart TD\n    subgraph \"UI Layer\"\n        ChatWidget[\"ChatWidget\"]\n        ChatInputPart[\"ChatInputPart\"]\n        ChatListItemRenderer[\"ChatListItemRenderer\"]\n        ChatViewPane[\"ChatViewPane\"]\n    end\n    \n    subgraph \"Service Layer\"\n        IChatService[\"IChatService\"]\n        ChatService[\"ChatService\"]\n        IChatWidgetService[\"IChatWidgetService\"]\n        ChatWidgetService[\"ChatWidgetService\"]\n    end\n    \n    subgraph \"Agent Integration Layer\"\n        IChatAgentService[\"IChatAgentService\"]\n        ChatAgentService[\"ChatAgentService\"]\n        SetupAgent[\"SetupAgent\"]\n        ExtHostChatAgents[\"ExtHostChatAgents2\"]\n    end\n    \n    subgraph \"Data Layer\"\n        ChatModel[\"ChatModel\"]\n        ChatViewModel[\"ChatViewModel\"]\n        ChatRequestModel[\"ChatRequestModel\"]\n        ChatResponseModel[\"ChatResponseModel\"]\n    end\n    \n    subgraph \"Extension Host\"\n        MainThreadChatAgents[\"MainThreadChatAgents2\"]\n        ExtensionAPI[\"vscode.chat API\"]\n    end\n    \n    ChatWidget --\u003e IChatService\n    ChatInputPart --\u003e IChatAgentService\n    IChatService --\u003e ChatService\n    IChatWidgetService --\u003e ChatWidgetService\n    ChatService --\u003e IChatAgentService\n    IChatAgentService --\u003e ChatAgentService\n    ChatAgentService --\u003e SetupAgent\n    ChatService --\u003e ChatModel\n    ChatWidget --\u003e ChatViewModel\n    ChatViewModel --\u003e ChatModel\n    \n    ExtHostChatAgents --\u003e MainThreadChatAgents\n    MainThreadChatAgents --\u003e IChatAgentService\n    ExtensionAPI --\u003e ExtHostChatAgents\n```\n\n### Core System Components\n\n| Layer | Component | Purpose | Key Implementation |\n|-------|-----------|---------|-------------------|\n| UI | `ChatWidget` | Main chat container | [chatWidget.ts:106-692]() |\n| UI | `ChatInputPart` | User input handling | [chatInputPart.ts:140-1815]() |\n| UI | `ChatListItemRenderer` | Message rendering | [chatListRenderer.ts:127-458]() |\n| Service | `ChatService` | Message orchestration | [chatServiceImpl.ts:108-756]() |\n| Service | `ChatAgentService` | Agent management | [chatAgents.ts:600-950]() |\n| Agent | `SetupAgent` | Default agent implementation | [chatSetup.ts:107-194]() |\n| Data | `ChatModel` | Session data model | [chatModel.ts:534-1150]() |\n\nSources:\n- [src/vs/workbench/contrib/chat/browser/chatWidget.ts:106-250]()\n- [src/vs/workbench/contrib/chat/browser/chatInputPart.ts:140-378]()\n- [src/vs/workbench/contrib/chat/common/chatServiceImpl.ts:108-200]()\n- [src/vs/workbench/contrib/chat/common/chatAgents.ts:600-750]()\n- [src/vs/workbench/contrib/chat/browser/chatSetup.ts:107-194]()\n\n## UI Components\n\nThe chat UI is built around several key components that work together to provide the chat experience.\n\n### ChatWidget Architecture\n\nThe `ChatWidget` serves as the main container component that orchestrates the chat experience. It implements the `IChatWidget` interface and manages the view model, message list, input handling, and user interactions.\n\n```mermaid\nclassDiagram\n    class IChatWidget {\n        \u003c\u003cinterface\u003e\u003e\n        +viewModel: ChatViewModel\n        +input: ChatInputPart\n        +inputEditor: ICodeEditor\n        +supportsFileReferences: boolean\n        +focusInput()\n        +acceptInput(query: string)\n        +clear()\n        +getContrib(id: string)\n    }\n    \n    class ChatWidget {\n        +viewModel: ChatViewModel\n        +inputPart: ChatInputPart\n        +tree: WorkbenchObjectTree\n        +renderer: ChatListItemRenderer\n        +codeBlockModelCollection: CodeBlockModelCollection\n        +attachmentModel: ChatAttachmentModel\n        +render(parent: HTMLElement)\n        +waitForReady(): Promise~void~\n        +setInput(value: string)\n    }\n    \n    class ChatViewPane {\n        +widget: ChatWidget\n        +render(container: HTMLElement)\n        +focus()\n        +saveState()\n    }\n    \n    class QuickChatService {\n        +toggle(options: IQuickChatOpenOptions)\n        +focus()\n        +open(options: IQuickChatOpenOptions)\n    }\n    \n    IChatWidget \u003c|-- ChatWidget\n    ChatViewPane --\u003e ChatWidget\n    QuickChatService --\u003e ChatWidget\n```\n\n### Widget Registration and Lifecycle\n\nChat widgets are registered with the `IChatWidgetService` to enable coordination and access patterns:\n\n```mermaid\nflowchart TD\n    ChatWidgetService[\"ChatWidgetService\"] \n    ChatViewPane[\"ChatViewPane\"]\n    QuickChatService[\"QuickChatService\"]\n    ChatEditor[\"ChatEditor\"]\n    \n    subgraph \"Widget Registration\"\n        RegisterWidget[\"register(widget: IChatWidget)\"]\n        GetWidgetBySession[\"getWidgetBySessionId(id: string)\"]\n        GetLastFocused[\"lastFocusedWidget: IChatWidget\"]\n        GetByLocation[\"getWidgetsByLocations(location: ChatAgentLocation)\"]\n    end\n    \n    ChatViewPane --\u003e|\"register\"| ChatWidgetService\n    QuickChatService --\u003e|\"register\"| ChatWidgetService  \n    ChatEditor --\u003e|\"register\"| ChatWidgetService\n    \n    ChatWidgetService --\u003e RegisterWidget\n    ChatWidgetService --\u003e GetWidgetBySession\n    ChatWidgetService --\u003e GetLastFocused\n    ChatWidgetService --\u003e GetByLocation\n```\n\nSources:\n- [src/vs/workbench/contrib/chat/browser/chatWidget.ts:106-250]()\n- [src/vs/workbench/contrib/chat/browser/chat.ts:28-101]()\n- [src/vs/workbench/contrib/chat/browser/chatViewPane.ts:60-150]()\n- [src/vs/workbench/contrib/chat/browser/chatQuick.ts:50-200]()\n\n## Chat Input Part\n\nThe `ChatInputPart` is a sophisticated component that handles user input. It includes:\n- An input editor for text entry\n- Support for variable attachments (files, code snippets, etc.)\n- UI for showing which mode is active (Ask, Edit, Agent)\n- Toolbar with actions (send, switch model, etc.)\n- History navigation\n\n### Input Part Structure\n\n```mermaid\nflowchart TD\n    InputPart[\"ChatInputPart\"]\n    Editor[\"Input Editor\\n(Monaco Editor)\"]\n    AttachmentModel[\"ChatAttachmentModel\\n(File/variable attachments)\"]\n    SelectedTools[\"ChatSelectedTools\\n(Selected AI tools)\"]\n    Toolbar[\"Chat Execute Toolbar\\n(Submit, Mode Toggle)\"]\n    InputSideToolbar[\"Input Side Toolbar\\n(Attach files)\"]\n    \n    InputPart --\u003e Editor\n    InputPart --\u003e AttachmentModel\n    InputPart --\u003e SelectedTools\n    InputPart --\u003e Toolbar\n    InputPart --\u003e InputSideToolbar\n    \n    subgraph InputListeners\n        HistoryNavigation[\"Input History Navigation\"]\n        FocusHandling[\"Focus Handling\"]\n        HeightChanges[\"Height Changes\"]\n    end\n    \n    Editor -.-\u003e InputListeners\n    \n    subgraph ExtensibleComponents\n        FollowupsContainer[\"Followups Container\"]\n        EditingSessionWidget[\"Chat Editing Session Widget\"]\n        AttachmentsContainer[\"Attachments Container\"]\n    end\n    \n    InputPart --\u003e ExtensibleComponents\n```\n\nThe `ChatInputPart` input section has a modular design to support different features:\n- Input editor for text entry with Monaco editor features\n- Support for attaching context (files, code snippets, images)\n- Followups for suggested responses\n- Editing session for showing files being modified\n\nSources:\n- [src/vs/workbench/contrib/chat/browser/chatInputPart.ts:134-1815]()\n- [src/vs/workbench/contrib/chat/browser/media/chat.css:583-1092]()\n\n### Input Modes\n\nThe chat input supports several modes:\n\n| Mode | Description | UI Components | Primary Action |\n|------|-------------|--------------|----------------|\n| Ask | Standard chat queries | Text input, context attachments | ChatSubmitAction |\n| Edit | Modify workspace files | Text input, working set files | ChatEditingSessionSubmitAction |\n| Agent | Tool-augmented responses | Text input, tools selection | ChatAgentSubmitAction |\n\nThe input part adapts its UI based on the active mode:\n\n```mermaid\nflowchart TD\n    InputMode[\"Chat Mode\"]\n    AskMode[\"Ask Mode\\n(Simple queries)\"]\n    EditMode[\"Edit Mode\\n(File modification)\"]\n    AgentMode[\"Agent Mode\\n(Tool usage)\"]\n    \n    InputMode --\u003e|\"ChatMode.Ask\"| AskMode\n    InputMode --\u003e|\"ChatMode.Edit\"| EditMode\n    InputMode --\u003e|\"ChatMode.Agent\"| AgentMode\n    \n    AskMode --\u003e|\"Renders\"| SimpleInput[\"Text Input + Submit\"]\n    EditMode --\u003e|\"Renders\"| EditInput[\"Text Input + File List\"]\n    AgentMode --\u003e|\"Renders\"| AgentInput[\"Text Input + Tool Selection\"]\n    \n    class AskMode,SimpleInput askMode\n    class EditMode,EditInput editMode\n    class AgentMode,AgentInput agentMode\n```\n\nSources:\n- [src/vs/workbench/contrib/chat/browser/actions/chatExecuteActions.ts:50-229]()\n- [src/vs/workbench/contrib/chat/browser/chatInputPart.ts:475-497]()\n- [src/vs/workbench/contrib/chat/common/constants.ts]()\n\n### Attachments\n\nThe input part includes robust support for attachments through the `ChatAttachmentModel`:\n\n| Attachment Type | Description | Icon | Implementation |\n|-----------------|-------------|------|----------------|\n| File | Workspace file | File icon | IChatRequestFileEntry |\n| Directory | Workspace folder | Folder icon | IChatRequestDirectoryEntry |\n| Code Paste | Code snippet | Code icon | IChatRequestPasteVariableEntry |\n| Image | Image data | Image icon | IImageVariableEntry |\n| Tool | AI tool reference | Tool icon | IChatRequestToolEntry |\n| Implicit Context | Active editor content | File icon | IChatRequestImplicitVariableEntry |\n| Diagnostic | Error information | Error icon | IDiagnosticVariableEntry |\n\nSources:\n- [src/vs/workbench/contrib/chat/common/chatModel.ts:34-211]()\n- [src/vs/workbench/contrib/chat/browser/chatInputPart.ts:158-218]()\n- [src/vs/workbench/contrib/chat/browser/actions/chatContextActions.ts:68-113]()\n\n## Service Layer\n\nThe service layer provides the core business logic and coordination for the chat system. It handles message routing, session management, and integration with various chat agents.\n\n### ChatService Architecture\n\nThe `ChatService` orchestrates chat sessions and manages communication between the UI and chat agents:\n\n```mermaid\nflowchart TD\n    IChatService[\"IChatService\\n(Interface)\"]\n    ChatService[\"ChatService\\n(Implementation)\"]\n    \n    subgraph \"Session Management\"\n        SessionModels[\"_sessionModels: DisposableMap~string, ChatModel~\"]\n        PendingRequests[\"_pendingRequests: DisposableMap~string, CancellableRequest~\"]\n        SessionStore[\"ChatSessionStore\"]\n    end\n    \n    subgraph \"Request Processing\"\n        SendRequestWithProgress[\"sendRequestWithProgress()\"]\n        AddCompleteRequest[\"addCompleteRequest()\"]\n        RemoveRequest[\"removeRequest()\"]\n    end\n    \n    subgraph \"Integration Points\"\n        ChatAgentService[\"IChatAgentService\"]\n        LanguageModelsService[\"ILanguageModelsService\"]\n        ChatSlashCommandService[\"IChatSlashCommandService\"]\n    end\n    \n    IChatService \u003c|-- ChatService\n    ChatService --\u003e SessionModels\n    ChatService --\u003e PendingRequests\n    ChatService --\u003e SessionStore\n    ChatService --\u003e SendRequestWithProgress\n    ChatService --\u003e AddCompleteRequest\n    ChatService --\u003e RemoveRequest\n    \n    SendRequestWithProgress --\u003e ChatAgentService\n    SendRequestWithProgress --\u003e LanguageModelsService\n    ChatService --\u003e ChatSlashCommandService\n```\n\n### Request Flow and Processing\n\n```mermaid\nsequenceDiagram\n    participant Widget as ChatWidget\n    participant Service as ChatService\n    participant Agent as IChatAgentService\n    participant Model as ChatModel\n    \n    Widget-\u003e\u003eService: sendRequestWithProgress(request)\n    Service-\u003e\u003eModel: addRequest(request)\n    Service-\u003e\u003eAgent: getDefaultAgent(location)\n    Service-\u003e\u003eAgent: invokeAgent(request, progress)\n    Agent--\u003e\u003eService: progress updates\n    Service--\u003e\u003eWidget: progress notifications\n    Agent-\u003e\u003eService: final result\n    Service-\u003e\u003eModel: completeResponse(result)\n    Service--\u003e\u003eWidget: completion event\n```\n\n### Service Interface and Capabilities\n\n| Service Method | Purpose | Parameters | Return Type |\n|----------------|---------|------------|-------------|\n| `sendRequestWithProgress` | Send chat request | `sessionId`, `request`, `options` | `Promise\u003cIChatSendRequestResponseState\u003e` |\n| `getHistory` | Get session history | `sessionId` | `IChatModel` |\n| `clearSession` | Clear chat session | `sessionId` | `void` |\n| `addCompleteRequest` | Add pre-completed request | `sessionId`, `message`, `response` | `void` |\n| `removeRequest` | Remove request from session | `sessionId`, `requestId` | `Promise\u003cvoid\u003e` |\n\nSources:\n- [src/vs/workbench/contrib/chat/common/chatService.ts:280-350]()\n- [src/vs/workbench/contrib/chat/common/chatServiceImpl.ts:108-756]()\n- [src/vs/workbench/contrib/chat/common/chatModel.ts:534-600]()\n\n### Widget Service Integration\n\nThe `IChatWidgetService` manages widget registration and provides access patterns for the UI layer:\n\n```mermaid\nflowchart TD\n    IChatWidgetService[\"IChatWidgetService\"]\n    \n    subgraph \"Widget Registry\"\n        WidgetMap[\"Map~string, IChatWidget~\"]\n        LastFocused[\"lastFocusedWidget: IChatWidget\"]\n        OnDidAddWidget[\"onDidAddWidget: Event~IChatWidget~\"]\n    end\n    \n    subgraph \"Access Methods\"\n        GetAllWidgets[\"getAllWidgets()\"]\n        GetByInputUri[\"getWidgetByInputUri(uri: URI)\"]\n        GetBySessionId[\"getWidgetBySessionId(sessionId: string)\"]\n        GetByLocation[\"getWidgetsByLocations(location: ChatAgentLocation)\"]\n    end\n    \n    IChatWidgetService --\u003e WidgetMap\n    IChatWidgetService --\u003e LastFocused\n    IChatWidgetService --\u003e OnDidAddWidget\n    IChatWidgetService --\u003e GetAllWidgets\n    IChatWidgetService --\u003e GetByInputUri\n    IChatWidgetService --\u003e GetBySessionId\n    IChatWidgetService --\u003e GetByLocation\n```\n\nSources:\n- [src/vs/workbench/contrib/chat/browser/chat.ts:28-70]()\n- [src/vs/workbench/contrib/chat/browser/chatWidget.ts:536-560]()\n\n## Agent Integration\n\nThe agent integration layer provides extensible patterns for integrating various AI providers and chat agents with the VS Code chat system.\n\n### Agent Service Architecture\n\nThe `IChatAgentService` manages registration, discovery, and invocation of chat agents:\n\n```mermaid\nflowchart TD\n    IChatAgentService[\"IChatAgentService\"]\n    \n    subgraph \"Agent Registration\"\n        RegisterAgent[\"registerAgent(id: string, data: IChatAgentData)\"]\n        RegisterImplementation[\"registerAgentImplementation(id: string, agent: IChatAgentImplementation)\"]\n        UpdateAgent[\"updateAgent(id: string, updateMetadata: IChatAgentData)\"]\n    end\n    \n    subgraph \"Agent Discovery\"\n        GetAgent[\"getAgent(id: string)\"]\n        GetAgents[\"getAgents()\"]\n        GetDefaultAgent[\"getDefaultAgent(location: ChatAgentLocation)\"]\n        GetActivatedAgents[\"getActivatedAgents()\"]\n    end\n    \n    subgraph \"Agent Invocation\"\n        InvokeAgent[\"invokeAgent(id: string, request: IChatAgentRequest, progress: Function)\"]\n        GetAgentsByName[\"getAgentsByName(name: string)\"]\n    end\n    \n    IChatAgentService --\u003e RegisterAgent\n    IChatAgentService --\u003e RegisterImplementation\n    IChatAgentService --\u003e UpdateAgent\n    IChatAgentService --\u003e GetAgent\n    IChatAgentService --\u003e GetAgents\n    IChatAgentService --\u003e GetDefaultAgent\n    IChatAgentService --\u003e GetActivatedAgents\n    IChatAgentService --\u003e InvokeAgent\n    IChatAgentService --\u003e GetAgentsByName\n```\n\n### Agent Implementation Patterns\n\nChat agents implement the `IChatAgentImplementation` interface and follow specific patterns for integration:\n\n```mermaid\nclassDiagram\n    class IChatAgentImplementation {\n        \u003c\u003cinterface\u003e\u003e\n        +invoke(request: IChatAgentRequest, progress: Function, token: CancellationToken): Promise~IChatAgentResult~\n        +provideFollowups?(request: IChatAgentRequest, result: IChatAgentResult, token: CancellationToken): Promise~IChatFollowup[]~\n        +provideWelcomeMessage?(token: CancellationToken): Promise~IChatWelcomeMessageContent[]~\n    }\n    \n    class SetupAgent {\n        +invoke(request: IChatAgentRequest, progress: Function): Promise~IChatAgentResult~\n        +registerDefaultAgents(): object\n        +registerVSCodeAgent(): object\n        -doInvoke(request: IChatAgentRequest, progress: Function): Promise~IChatAgentResult~\n        -forwardRequestToCopilot(): Promise~void~\n    }\n    \n    class ExtensionAgent {\n        +invoke(request: IChatAgentRequest, progress: Function): Promise~IChatAgentResult~\n        +provideFollowups(): Promise~IChatFollowup[]~\n    }\n    \n    IChatAgentImplementation \u003c|-- SetupAgent\n    IChatAgentImplementation \u003c|-- ExtensionAgent\n```\n\n### Extension Host Communication\n\nChat agents running in extensions communicate with the main thread through the extension host protocol:\n\n```mermaid\nsequenceDiagram\n    participant Ext as Extension\n    participant ExtHost as ExtHostChatAgents2\n    participant MainThread as MainThreadChatAgents2\n    participant Service as IChatAgentService\n    \n    Ext-\u003e\u003eExtHost: registerChatAgent(agent)\n    ExtHost-\u003e\u003eMainThread: $registerAgent(id, data)\n    MainThread-\u003e\u003eService: registerAgent(id, data)\n    \n    Note over Service: User sends chat request\n    \n    Service-\u003e\u003eMainThread: invokeAgent(id, request)\n    MainThread-\u003e\u003eExtHost: $invokeAgent(handle, request)\n    ExtHost-\u003e\u003eExt: agent.invoke(request, progress)\n    Ext--\u003e\u003eExtHost: progress updates\n    ExtHost--\u003e\u003eMainThread: $handleProgressChunk(requestId, progress)\n    MainThread--\u003e\u003eService: progress notifications\n    Ext-\u003e\u003eExtHost: return result\n    ExtHost-\u003e\u003eMainThread: return result\n    MainThread-\u003e\u003eService: return result\n```\n\n### Agent Registration and Metadata\n\n| Agent Property | Purpose | Example | Required |\n|----------------|---------|---------|----------|\n| `id` | Unique identifier | `\"github.copilot-chat\"` | Yes |\n| `name` | Display name | `\"Copilot\"` | Yes |\n| `locations` | Supported locations | `[ChatAgentLocation.Panel]` | Yes |\n| `modes` | Supported chat modes | `[ChatMode.Ask, ChatMode.Edit]` | No |\n| `when` | Activation context | `\"config.github.copilot.enable\"` | No |\n| `slashCommands` | Available commands | `[{name: \"explain\", description: \"...\"}]` | No |\n| `isDefault` | Default for location | `true` | No |\n\nSources:\n- [src/vs/workbench/contrib/chat/common/chatAgents.ts:600-950]()\n- [src/vs/workbench/contrib/chat/browser/chatSetup.ts:107-194]()\n- [src/vs/workbench/api/common/extHostChatAgents2.ts:50-200]()\n- [src/vs/workbench/api/browser/mainThreadChatAgents2.ts:50-300]()\n\n## Chat Styling\n\nThe chat UI uses a consistent styling system defined in CSS:\n\n### Message Containers\n\n```\n.interactive-session                     (Main container)\n├── .interactive-list                    (Message list)\n│   └── .monaco-list-row                 (List row)\n│       └── .interactive-item-container  (Message container)\n│           ├── .header                  (Contains user info)\n│           │   ├── .user                (User section)\n│           │   │   ├── .avatar-container (Avatar)\n│           │   │   └── .username        (Username)\n│           │   └── .monaco-toolbar      (Message toolbar)\n│           ├── .value                   (Message content)\n│           │   └── .rendered-markdown   (Markdown content)\n│           └── .chat-footer-toolbar     (Vote buttons, etc.)\n└── .interactive-input-part             (Input container)\n    └── .chat-input-container           (Input editor)\n```\n\nSources:\n- [src/vs/workbench/contrib/chat/browser/media/chat.css:6-800]()\n- [src/vs/workbench/contrib/chat/browser/chatListRenderer.ts:265-307]()\n\n### Input Part Styling\n\nThe input part has its own styling structure:\n\n```\n.interactive-input-part\n├── .chat-input-container               (Main input container)\n│   ├── .chat-editor-container          (Editor container)\n│   └── .chat-input-toolbars            (Input toolbars container)\n│       ├── .chat-execute-toolbar       (Submit button, model picker)\n│       └── [other toolbars]\n├── .chat-attachments-container         (Attachments area)\n│   ├── .chat-attachment-toolbar        (Attachment actions)\n│   ├── .chat-attached-context          (Attached files/variables)\n│   └── .chat-related-files             (Related files section)\n└── .interactive-input-followups        (Followups section)\n```\n\nSources:\n- [src/vs/workbench/contrib/chat/browser/media/chat.css:583-948]()\n- [src/vs/workbench/contrib/chat/browser/chatInputPart.ts:825-867]()\n\n## Widget Registration and Service Integration\n\nThe chat UI components integrate with VS Code's service architecture through several services:\n\n```mermaid\nflowchart TD\n    ChatWidget[\"ChatWidget\"]\n    ChatInputPart[\"ChatInputPart\"]\n    \n    subgraph Services\n        IChatService[\"IChatService\\n(Message handling)\"]\n        IChatWidgetService[\"IChatWidgetService\\n(Widget registry)\"]\n        IChatAgentService[\"IChatAgentService\\n(Agent registry)\"]\n        ILanguageModelsService[\"ILanguageModelsService\\n(Model registry)\"]\n        IChatVariablesService[\"IChatVariablesService\\n(Variable handling)\"]\n    end\n    \n    ChatWidget --\u003e|\"register\"| IChatWidgetService\n    ChatWidget --\u003e|\"submit request\"| IChatService\n    ChatWidget --\u003e|\"get current agent\"| IChatAgentService\n    \n    ChatInputPart --\u003e|\"get available models\"| ILanguageModelsService\n    ChatInputPart --\u003e|\"resolve variables\"| IChatVariablesService\n    \n    ChatWidget --\u003e ChatInputPart\n```\n\nThe `ChatWidgetService` serves as a registry for all chat widgets, allowing coordination between them and providing access to the most recently focused widget.\n\nSources:\n- [src/vs/workbench/contrib/chat/browser/chat.ts:28-62]()\n- [src/vs/workbench/contrib/chat/browser/chatWidget.ts:482-499]()\n- [src/vs/workbench/contrib/chat/browser/chat.contribution.ts:350-443]()\n\n## Conclusion\n\nThe VS Code Chat UI Components form a comprehensive and extensible system for conversational interfaces. The architecture employs a modular approach with specialized components for input handling, message rendering, and code block interactions. The system integrates with VS Code services for chat agent management, language model access, and widget registration.\n\nThis modular design allows for:\n1. Multiple chat implementations (panel, editor, quick chat)\n2. Extensibility through custom content parts\n3. Rich interactions with code blocks and other content\n4. Efficient rendering of large chat histories\n\nUnderstanding these components provides a foundation for extending VS Code's chat capabilities or implementing similar conversational interfaces."])</script>
    <script>self.__next_f.push([1, "27:T4541,"])</script>
    <script>self.__next_f.push([1, "# Source Control Management\n\n\u003cdetails\u003e\n\u003csummary\u003eRelevant source files\u003c/summary\u003e\n\nThe following files were used as context for generating this wiki page:\n\n- [extensions/git/package.json](extensions/git/package.json)\n- [extensions/git/package.nls.json](extensions/git/package.nls.json)\n- [extensions/git/src/actionButton.ts](extensions/git/src/actionButton.ts)\n- [extensions/git/src/api/api1.ts](extensions/git/src/api/api1.ts)\n- [extensions/git/src/api/extension.ts](extensions/git/src/api/extension.ts)\n- [extensions/git/src/api/git.d.ts](extensions/git/src/api/git.d.ts)\n- [extensions/git/src/askpass-empty.sh](extensions/git/src/askpass-empty.sh)\n- [extensions/git/src/askpass-main.ts](extensions/git/src/askpass-main.ts)\n- [extensions/git/src/askpass.sh](extensions/git/src/askpass.sh)\n- [extensions/git/src/askpass.ts](extensions/git/src/askpass.ts)\n- [extensions/git/src/autofetch.ts](extensions/git/src/autofetch.ts)\n- [extensions/git/src/commands.ts](extensions/git/src/commands.ts)\n- [extensions/git/src/git.ts](extensions/git/src/git.ts)\n- [extensions/git/src/gitEditor.ts](extensions/git/src/gitEditor.ts)\n- [extensions/git/src/historyProvider.ts](extensions/git/src/historyProvider.ts)\n- [extensions/git/src/ipc/ipcClient.ts](extensions/git/src/ipc/ipcClient.ts)\n- [extensions/git/src/ipc/ipcServer.ts](extensions/git/src/ipc/ipcServer.ts)\n- [extensions/git/src/main.ts](extensions/git/src/main.ts)\n- [extensions/git/src/model.ts](extensions/git/src/model.ts)\n- [extensions/git/src/postCommitCommands.ts](extensions/git/src/postCommitCommands.ts)\n- [extensions/git/src/repository.ts](extensions/git/src/repository.ts)\n- [extensions/git/src/ssh-askpass-empty.sh](extensions/git/src/ssh-askpass-empty.sh)\n- [extensions/git/src/ssh-askpass.sh](extensions/git/src/ssh-askpass.sh)\n- [extensions/git/src/statusbar.ts](extensions/git/src/statusbar.ts)\n- [extensions/git/src/terminal.ts](extensions/git/src/terminal.ts)\n- [extensions/git/src/test/git.test.ts](extensions/git/src/test/git.test.ts)\n- [extensions/git/src/util.ts](extensions/git/src/util.ts)\n- [extensions/git/tsconfig.json](extensions/git/tsconfig.json)\n- [src/vs/workbench/api/browser/mainThreadSCM.ts](src/vs/workbench/api/browser/mainThreadSCM.ts)\n- [src/vs/workbench/api/common/extHostSCM.ts](src/vs/workbench/api/common/extHostSCM.ts)\n- [src/vs/workbench/contrib/scm/browser/activity.ts](src/vs/workbench/contrib/scm/browser/activity.ts)\n- [src/vs/workbench/contrib/scm/browser/media/scm.css](src/vs/workbench/contrib/scm/browser/media/scm.css)\n- [src/vs/workbench/contrib/scm/browser/menus.ts](src/vs/workbench/contrib/scm/browser/menus.ts)\n- [src/vs/workbench/contrib/scm/browser/scm.contribution.ts](src/vs/workbench/contrib/scm/browser/scm.contribution.ts)\n- [src/vs/workbench/contrib/scm/browser/scmHistory.ts](src/vs/workbench/contrib/scm/browser/scmHistory.ts)\n- [src/vs/workbench/contrib/scm/browser/scmHistoryViewPane.ts](src/vs/workbench/contrib/scm/browser/scmHistoryViewPane.ts)\n- [src/vs/workbench/contrib/scm/browser/scmRepositoriesViewPane.ts](src/vs/workbench/contrib/scm/browser/scmRepositoriesViewPane.ts)\n- [src/vs/workbench/contrib/scm/browser/scmRepositoryRenderer.ts](src/vs/workbench/contrib/scm/browser/scmRepositoryRenderer.ts)\n- [src/vs/workbench/contrib/scm/browser/scmViewPane.ts](src/vs/workbench/contrib/scm/browser/scmViewPane.ts)\n- [src/vs/workbench/contrib/scm/browser/scmViewService.ts](src/vs/workbench/contrib/scm/browser/scmViewService.ts)\n- [src/vs/workbench/contrib/scm/browser/util.ts](src/vs/workbench/contrib/scm/browser/util.ts)\n- [src/vs/workbench/contrib/scm/common/history.ts](src/vs/workbench/contrib/scm/common/history.ts)\n- [src/vs/workbench/contrib/scm/common/scm.ts](src/vs/workbench/contrib/scm/common/scm.ts)\n- [src/vs/workbench/contrib/scm/test/browser/scmHistory.test.ts](src/vs/workbench/contrib/scm/test/browser/scmHistory.test.ts)\n- [src/vscode-dts/vscode.proposed.scmHistoryProvider.d.ts](src/vscode-dts/vscode.proposed.scmHistoryProvider.d.ts)\n\n\u003c/details\u003e\n\n\n\nThis document covers VS Code's Source Control Management (SCM) system, which provides a generic framework for integrating version control systems like Git into the editor. The SCM system consists of a core framework that defines common abstractions for source control providers, along with built-in implementations like the Git extension.\n\nFor information about the Extension System that enables third-party SCM providers, see [Extension System](#4). For details about UI Components like Trees and Lists used in SCM views, see [UI Components: Lists and Trees](#2.3).\n\n## SCM Framework Architecture\n\nThe SCM framework provides a provider-based architecture where different version control systems can register providers that implement common interfaces. The core abstractions include repositories, resource groups, resources, and input boxes for commit messages.\n\n```mermaid\ngraph TB\n    subgraph \"SCM Core Framework\"\n        ISCMService[\"ISCMService\u003cbr/\u003escmService.ts\"]\n        ISCMViewService[\"ISCMViewService\u003cbr/\u003escmViewService.ts\"]\n        ISCMProvider[\"ISCMProvider\u003cbr/\u003einterface\"]\n        ISCMRepository[\"ISCMRepository\u003cbr/\u003einterface\"]\n    end\n    \n    subgraph \"UI Layer\"\n        SCMViewPane[\"SCMViewPane\u003cbr/\u003escmViewPane.ts\"]\n        SCMHistoryViewPane[\"SCMHistoryViewPane\u003cbr/\u003escmHistoryViewPane.ts\"]\n        SCMRepositoriesViewPane[\"SCMRepositoriesViewPane\u003cbr/\u003escmRepositoriesViewPane.ts\"]\n    end\n    \n    subgraph \"Extension API\"\n        MainThreadSCM[\"MainThreadSCM\u003cbr/\u003emainThreadSCM.ts\"]\n        ExtHostSCM[\"ExtHostSCM\u003cbr/\u003eextHostSCM.ts\"]\n    end\n    \n    subgraph \"Git Extension\"\n        GitExtension[\"Git Extension\u003cbr/\u003emain.ts\"]\n        Repository[\"Repository\u003cbr/\u003erepository.ts\"]\n        GitHistoryProvider[\"GitHistoryProvider\u003cbr/\u003ehistoryProvider.ts\"]\n    end\n    \n    ISCMService --\u003e ISCMProvider\n    ISCMProvider --\u003e ISCMRepository\n    ISCMViewService --\u003e SCMViewPane\n    ISCMViewService --\u003e SCMHistoryViewPane\n    ISCMViewService --\u003e SCMRepositoriesViewPane\n    \n    MainThreadSCM --\u003e ISCMService\n    ExtHostSCM --\u003e MainThreadSCM\n    \n    GitExtension --\u003e ExtHostSCM\n    Repository --\u003e ISCMRepository\n    GitHistoryProvider --\u003e Repository\n```\n\nThe `ISCMService` acts as the central registry for SCM providers, while `ISCMViewService` manages the visual presentation of source control information. Each provider implements `ISCMProvider` and can create multiple `ISCMRepository` instances.\n\nSources: [src/vs/workbench/contrib/scm/common/scm.ts:34-200](), [src/vs/workbench/contrib/scm/common/scmService.ts](), [src/vs/workbench/contrib/scm/browser/scmViewService.ts]()\n\n## SCM Provider Interface\n\nThe `ISCMProvider` interface defines the contract that all source control providers must implement. It includes methods for managing repositories, handling input validation, and providing commands.\n\n| Component | Purpose | Key Methods |\n|-----------|---------|-------------|\n| `ISCMProvider` | Core provider interface | `getOriginalResource()`, `createRepository()` |\n| `ISCMRepository` | Repository abstraction | `provider`, `input`, `resourceGroups` |\n| `ISCMResourceGroup` | Groups of related resources | `id`, `label`, `resourceStates` |\n| `ISCMResource` | Individual file resources | `resourceUri`, `command`, `decorations` |\n| `ISCMInput` | Commit message input | `value`, `placeholder`, `validateInput()` |\n\nThe provider system supports features like input validation, action buttons, and history providers through optional interfaces.\n\nSources: [src/vs/workbench/contrib/scm/common/scm.ts:92-180]()\n\n## Git Extension Implementation\n\nThe Git extension serves as the primary implementation of the SCM framework, providing comprehensive Git functionality within VS Code.\n\n```mermaid\ngraph TB\n    subgraph \"Git Extension Core\"\n        GitMain[\"main.ts\u003cbr/\u003eExtension Entry\"]\n        Model[\"Model\u003cbr/\u003emodel.ts\"]\n        CommandCenter[\"CommandCenter\u003cbr/\u003ecommands.ts\"]\n    end\n    \n    subgraph \"Git Operations\"\n        Git[\"Git\u003cbr/\u003egit.ts\"]\n        Repository[\"Repository\u003cbr/\u003erepository.ts\"]\n        GitHistoryProvider[\"GitHistoryProvider\u003cbr/\u003ehistoryProvider.ts\"]\n    end\n    \n    subgraph \"Resource Management\"\n        Resource[\"Resource\u003cbr/\u003erepository.ts:49-333\"]\n        ResourceCommandResolver[\"ResourceCommandResolver\u003cbr/\u003erepository.ts:491-602\"]\n        GitResourceGroup[\"GitResourceGroup\u003cbr/\u003erepository.ts:335-337\"]\n    end\n    \n    subgraph \"UI Components\"\n        ActionButton[\"ActionButton\u003cbr/\u003eactionButton.ts\"]\n        StatusBar[\"StatusBarCommands\u003cbr/\u003estatusbar.ts\"]\n        ProgressManager[\"ProgressManager\u003cbr/\u003erepository.ts:346-404\"]\n    end\n    \n    GitMain --\u003e Model\n    GitMain --\u003e CommandCenter\n    Model --\u003e Repository\n    Repository --\u003e Git\n    Repository --\u003e GitHistoryProvider\n    Repository --\u003e Resource\n    Resource --\u003e ResourceCommandResolver\n    Repository --\u003e GitResourceGroup\n    Repository --\u003e ActionButton\n    Repository --\u003e StatusBar\n    Repository --\u003e ProgressManager\n```\n\nThe Git extension creates a `Repository` instance for each Git repository, which implements the `ISCMRepository` interface and manages resource states, commands, and history.\n\nSources: [extensions/git/src/main.ts:39-150](), [extensions/git/src/model.ts:174-550](), [extensions/git/src/repository.ts:1-50]()\n\n## Git Repository Model\n\nThe `Repository` class is the core of Git integration, managing repository state and providing Git operations through the SCM framework.\n\n```mermaid\ngraph TB\n    subgraph \"Repository State\"\n        RepositoryState[\"RepositoryState\u003cbr/\u003eenum\"]\n        HEAD[\"HEAD\u003cbr/\u003eBranch\"]\n        Refs[\"refs\u003cbr/\u003eRef[]\"]\n        Remotes[\"remotes\u003cbr/\u003eRemote[]\"]\n    end\n    \n    subgraph \"Resource Groups\"\n        MergeGroup[\"mergeGroup\u003cbr/\u003eResourceGroupType.Merge\"]\n        IndexGroup[\"indexGroup\u003cbr/\u003eResourceGroupType.Index\"]\n        WorkingTreeGroup[\"workingTreeGroup\u003cbr/\u003eResourceGroupType.WorkingTree\"]\n        UntrackedGroup[\"untrackedGroup\u003cbr/\u003eResourceGroupType.Untracked\"]\n    end\n    \n    subgraph \"Operations\"\n        OperationManager[\"OperationManager\u003cbr/\u003eoperation.ts\"]\n        AutoFetcher[\"AutoFetcher\u003cbr/\u003eautofetch.ts\"]\n        FileWatcher[\"DotGitWatcher\u003cbr/\u003erepository.ts:439-489\"]\n    end\n    \n    subgraph \"UI Integration\"\n        SourceControl[\"SourceControl\u003cbr/\u003eVS Code API\"]\n        QuickDiffProvider[\"QuickDiffProvider\u003cbr/\u003einterface\"]\n        FileDecorationProvider[\"FileDecorationProvider\u003cbr/\u003einterface\"]\n    end\n    \n    RepositoryState --\u003e HEAD\n    RepositoryState --\u003e Refs\n    RepositoryState --\u003e Remotes\n    \n    MergeGroup --\u003e Resource\n    IndexGroup --\u003e Resource\n    WorkingTreeGroup --\u003e Resource\n    UntrackedGroup --\u003e Resource\n    \n    OperationManager --\u003e Git\n    AutoFetcher --\u003e Git\n    FileWatcher --\u003e Repository\n    \n    Repository --\u003e SourceControl\n    Repository --\u003e QuickDiffProvider\n    Repository --\u003e FileDecorationProvider\n```\n\nEach `Repository` maintains four resource groups that categorize files by their Git status, and provides operations through the `OperationManager` to ensure thread safety.\n\nSources: [extensions/git/src/repository.ts:37-47](), [extensions/git/src/repository.ts:603-1500](), [extensions/git/src/operation.ts]()\n\n## SCM View Components\n\nThe SCM UI consists of multiple view panes that present source control information in different ways.\n\n```mermaid\ngraph TB\n    subgraph \"Main SCM View\"\n        SCMViewPane[\"SCMViewPane\u003cbr/\u003escmViewPane.ts\"]\n        InputRenderer[\"InputRenderer\u003cbr/\u003escmViewPane.ts:299-421\"]\n        ResourceGroupRenderer[\"ResourceGroupRenderer\u003cbr/\u003escmViewPane.ts:431-490\"]\n        ResourceRenderer[\"ResourceRenderer\u003cbr/\u003escmViewPane.ts:532-800\"]\n    end\n    \n    subgraph \"Repository Management\"\n        SCMRepositoriesViewPane[\"SCMRepositoriesViewPane\u003cbr/\u003escmRepositoriesViewPane.ts\"]\n        RepositoryRenderer[\"RepositoryRenderer\u003cbr/\u003escmRepositoryRenderer.ts\"]\n    end\n    \n    subgraph \"History View\"\n        SCMHistoryViewPane[\"SCMHistoryViewPane\u003cbr/\u003escmHistoryViewPane.ts\"]\n        HistoryItemRenderer[\"HistoryItemRenderer\u003cbr/\u003escmHistoryViewPane.ts\"]\n        HistoryItemChangeRenderer[\"HistoryItemChangeRenderer\u003cbr/\u003escmHistoryViewPane.ts\"]\n    end\n    \n    subgraph \"Tree Infrastructure\"\n        WorkbenchAsyncDataTree[\"WorkbenchCompressibleAsyncDataTree\u003cbr/\u003elistService.ts\"]\n        TreeDataSource[\"SCMTreeDataSource\u003cbr/\u003escmViewPane.ts\"]\n        TreeSorter[\"SCMTreeSorter\u003cbr/\u003escmViewPane.ts\"]\n    end\n    \n    SCMViewPane --\u003e InputRenderer\n    SCMViewPane --\u003e ResourceGroupRenderer\n    SCMViewPane --\u003e ResourceRenderer\n    SCMViewPane --\u003e WorkbenchAsyncDataTree\n    \n    SCMRepositoriesViewPane --\u003e RepositoryRenderer\n    SCMHistoryViewPane --\u003e HistoryItemRenderer\n    SCMHistoryViewPane --\u003e HistoryItemChangeRenderer\n    \n    WorkbenchAsyncDataTree --\u003e TreeDataSource\n    WorkbenchAsyncDataTree --\u003e TreeSorter\n```\n\nThe main `SCMViewPane` uses a tree structure with specialized renderers for different node types, while the history view provides a graph visualization of commit history.\n\nSources: [src/vs/workbench/contrib/scm/browser/scmViewPane.ts:115-2500](), [src/vs/workbench/contrib/scm/browser/scmHistoryViewPane.ts:1-2000](), [src/vs/workbench/contrib/scm/browser/scmRepositoriesViewPane.ts]()\n\n## Extension API Bridge\n\nThe SCM system exposes its functionality to extensions through a bridge between the extension host and main thread.\n\n```mermaid\ngraph LR\n    subgraph \"Extension Host\"\n        ExtHostSCM[\"ExtHostSCM\u003cbr/\u003eextHostSCM.ts\"]\n        SCMProviderImpl[\"SourceControlManager\u003cbr/\u003eextHostSCM.ts:800-1200\"]\n        SCMRepositoryImpl[\"SourceControlManager\u003cbr/\u003eextHostSCM.ts:600-800\"]\n    end\n    \n    subgraph \"Main Thread\"\n        MainThreadSCM[\"MainThreadSCM\u003cbr/\u003emainThreadSCM.ts\"]\n        MainThreadProvider[\"MainThreadSCMProvider\u003cbr/\u003emainThreadSCM.ts:200-600\"]\n        MainThreadRepository[\"MainThreadSCMRepository\u003cbr/\u003emainThreadSCM.ts:100-200\"]\n    end\n    \n    subgraph \"VS Code API\"\n        vscode_scm[\"vscode.scm\u003cbr/\u003ecreateSourceControl()\"]\n        SourceControlAPI[\"SourceControl\u003cbr/\u003eVS Code API\"]\n    end\n    \n    vscode_scm --\u003e ExtHostSCM\n    ExtHostSCM --\u003e SCMProviderImpl\n    SCMProviderImpl --\u003e SCMRepositoryImpl\n    \n    ExtHostSCM -.-\u003e|RPC| MainThreadSCM\n    MainThreadSCM --\u003e MainThreadProvider\n    MainThreadProvider --\u003e MainThreadRepository\n    \n    MainThreadSCM --\u003e ISCMService\n```\n\nExtensions create SCM providers through the `vscode.scm.createSourceControl()` API, which creates proxy objects that communicate with the main thread via RPC.\n\nSources: [src/vs/workbench/api/common/extHostSCM.ts:1-1500](), [src/vs/workbench/api/browser/mainThreadSCM.ts:1-1000]()\n\n## SCM Data Flow\n\nThe SCM system processes repository changes through a pipeline that updates UI components and notifies extensions.\n\n```mermaid\ngraph TB\n    subgraph \"Data Sources\"\n        FileSystem[\"File System Changes\"]\n        GitOperations[\"Git Operations\u003cbr/\u003egit.ts\"]\n        UserActions[\"User Actions\u003cbr/\u003ecommands.ts\"]\n    end\n    \n    subgraph \"Repository Layer\"\n        Repository[\"Repository\u003cbr/\u003erepository.ts\"]\n        ResourceUpdate[\"updateResources()\u003cbr/\u003erepository.ts:1200-1400\"]\n        ResourceGroups[\"Resource Groups\u003cbr/\u003emerge, index, working, untracked\"]\n    end\n    \n    subgraph \"SCM Framework\"\n        ISCMService[\"ISCMService\u003cbr/\u003eonDidChangeRepository\"]\n        ISCMViewService[\"ISCMViewService\u003cbr/\u003eonDidChangeSelectedRepos\"]\n    end\n    \n    subgraph \"UI Updates\"\n        SCMViewPane[\"SCM View Pane\u003cbr/\u003etree refresh\"]\n        StatusBar[\"Status Bar\u003cbr/\u003ebranch info\"]\n        Decorations[\"File Decorations\u003cbr/\u003egit status\"]\n    end\n    \n    FileSystem --\u003e Repository\n    GitOperations --\u003e Repository\n    UserActions --\u003e Repository\n    \n    Repository --\u003e ResourceUpdate\n    ResourceUpdate --\u003e ResourceGroups\n    ResourceGroups --\u003e ISCMService\n    \n    ISCMService --\u003e ISCMViewService\n    ISCMViewService --\u003e SCMViewPane\n    ISCMService --\u003e StatusBar\n    ISCMService --\u003e Decorations\n```\n\nRepository state changes trigger updates through the SCM service, which notifies views and other components to refresh their display.\n\nSources: [extensions/git/src/repository.ts:1200-1500](), [src/vs/workbench/contrib/scm/browser/scmViewPane.ts:2000-2500](), [src/vs/workbench/contrib/scm/browser/activity.ts]()\n\n## History Provider System\n\nThe SCM framework includes support for history providers that can display commit graphs and timeline information.\n\n```mermaid\ngraph TB\n    subgraph \"History Interfaces\"\n        ISCMHistoryProvider[\"ISCMHistoryProvider\u003cbr/\u003ehistory.ts\"]\n        ISCMHistoryItem[\"ISCMHistoryItem\u003cbr/\u003ecommit data\"]\n        ISCMHistoryItemRef[\"ISCMHistoryItemRef\u003cbr/\u003ebranch/tag refs\"]\n    end\n    \n    subgraph \"Git History Implementation\"\n        GitHistoryProvider[\"GitHistoryProvider\u003cbr/\u003ehistoryProvider.ts\"]\n        GitCommitData[\"Git Commit Data\u003cbr/\u003elog operations\"]\n        BranchTracking[\"Branch Tracking\u003cbr/\u003eref management\"]\n    end\n    \n    subgraph \"History UI\"\n        SCMHistoryViewPane[\"SCMHistoryViewPane\u003cbr/\u003egraph visualization\"]\n        HistoryItemRenderer[\"History Item Renderer\u003cbr/\u003ecommit display\"]\n        GraphRenderer[\"Graph Renderer\u003cbr/\u003ebranch lines\"]\n    end\n    \n    ISCMHistoryProvider --\u003e ISCMHistoryItem\n    ISCMHistoryProvider --\u003e ISCMHistoryItemRef\n    \n    GitHistoryProvider --\u003e ISCMHistoryProvider\n    GitHistoryProvider --\u003e GitCommitData\n    GitHistoryProvider --\u003e BranchTracking\n    \n    SCMHistoryViewPane --\u003e ISCMHistoryProvider\n    SCMHistoryViewPane --\u003e HistoryItemRenderer\n    SCMHistoryViewPane --\u003e GraphRenderer\n```\n\nThe Git extension implements the history provider interface to display commit graphs, branch relationships, and commit details in the SCM history view.\n\nSources: [src/vs/workbench/contrib/scm/common/history.ts](), [extensions/git/src/historyProvider.ts:40-400](), [src/vs/workbench/contrib/scm/browser/scmHistoryViewPane.ts:300-800]()"])</script>
    <script>self.__next_f.push([1, "28:T3b67,"])</script>
    <script>self.__next_f.push([1, "# SCM Framework\n\n\u003cdetails\u003e\n\u003csummary\u003eRelevant source files\u003c/summary\u003e\n\nThe following files were used as context for generating this wiki page:\n\n- [extensions/git/src/historyProvider.ts](extensions/git/src/historyProvider.ts)\n- [src/vs/workbench/api/browser/mainThreadSCM.ts](src/vs/workbench/api/browser/mainThreadSCM.ts)\n- [src/vs/workbench/api/common/extHostSCM.ts](src/vs/workbench/api/common/extHostSCM.ts)\n- [src/vs/workbench/contrib/scm/browser/activity.ts](src/vs/workbench/contrib/scm/browser/activity.ts)\n- [src/vs/workbench/contrib/scm/browser/media/scm.css](src/vs/workbench/contrib/scm/browser/media/scm.css)\n- [src/vs/workbench/contrib/scm/browser/menus.ts](src/vs/workbench/contrib/scm/browser/menus.ts)\n- [src/vs/workbench/contrib/scm/browser/scm.contribution.ts](src/vs/workbench/contrib/scm/browser/scm.contribution.ts)\n- [src/vs/workbench/contrib/scm/browser/scmHistory.ts](src/vs/workbench/contrib/scm/browser/scmHistory.ts)\n- [src/vs/workbench/contrib/scm/browser/scmHistoryViewPane.ts](src/vs/workbench/contrib/scm/browser/scmHistoryViewPane.ts)\n- [src/vs/workbench/contrib/scm/browser/scmRepositoriesViewPane.ts](src/vs/workbench/contrib/scm/browser/scmRepositoriesViewPane.ts)\n- [src/vs/workbench/contrib/scm/browser/scmRepositoryRenderer.ts](src/vs/workbench/contrib/scm/browser/scmRepositoryRenderer.ts)\n- [src/vs/workbench/contrib/scm/browser/scmViewPane.ts](src/vs/workbench/contrib/scm/browser/scmViewPane.ts)\n- [src/vs/workbench/contrib/scm/browser/scmViewService.ts](src/vs/workbench/contrib/scm/browser/scmViewService.ts)\n- [src/vs/workbench/contrib/scm/browser/util.ts](src/vs/workbench/contrib/scm/browser/util.ts)\n- [src/vs/workbench/contrib/scm/common/history.ts](src/vs/workbench/contrib/scm/common/history.ts)\n- [src/vs/workbench/contrib/scm/common/scm.ts](src/vs/workbench/contrib/scm/common/scm.ts)\n- [src/vs/workbench/contrib/scm/test/browser/scmHistory.test.ts](src/vs/workbench/contrib/scm/test/browser/scmHistory.test.ts)\n- [src/vscode-dts/vscode.proposed.scmHistoryProvider.d.ts](src/vscode-dts/vscode.proposed.scmHistoryProvider.d.ts)\n\n\u003c/details\u003e\n\n\n\nThe SCM Framework provides VS Code's core abstraction layer for source control management, enabling multiple source control providers (Git, SVN, etc.) to integrate seamlessly with the editor. This framework defines the interfaces, services, and UI components that allow extensions to register source control providers and display repository information, file changes, and commit interfaces.\n\nFor information about the Git extension's specific implementation of SCM providers, see [Git Extension](#8.2). For details about the Monaco editor integration, see [Monaco Editor](#3).\n\n## Purpose and Scope\n\nThe SCM Framework serves as the foundation for all source control functionality in VS Code by:\n\n- Defining standardized interfaces (`ISCMProvider`, `ISCMRepository`, `ISCMResource`) that source control extensions implement\n- Managing provider registration, lifecycle, and UI integration through `ISCMService` and `ISCMViewService`\n- Providing reusable UI components for displaying changes, commit inputs, and repository status\n- Supporting advanced features like history visualization, quick diff, and multi-repository workflows\n- Abstracting provider-specific implementations behind common interfaces\n\n## Core Architecture\n\nThe SCM Framework follows a layered architecture with clear separation between core services, provider interfaces, and UI components.\n\n### Framework Architecture Overview\n\n```mermaid\ngraph TB\n    subgraph \"Core Services\"\n        SCMService[\"ISCMService\u003cbr/\u003eProvider Registration\"]\n        SCMViewService[\"ISCMViewService\u003cbr/\u003eUI Management\"]\n        QuickDiffService[\"IQuickDiffService\u003cbr/\u003eDiff Integration\"]\n    end\n    \n    subgraph \"Provider Interface Layer\"\n        ISCMProvider[\"ISCMProvider\u003cbr/\u003eProvider Contract\"]\n        ISCMRepository[\"ISCMRepository\u003cbr/\u003eRepository Instance\"]\n        ISCMHistoryProvider[\"ISCMHistoryProvider\u003cbr/\u003eHistory/Graph Support\"]\n    end\n    \n    subgraph \"Resource Model\"\n        ISCMResourceGroup[\"ISCMResourceGroup\u003cbr/\u003eChange Groups\"]\n        ISCMResource[\"ISCMResource\u003cbr/\u003eChanged Files\"]\n        ISCMInput[\"ISCMInput\u003cbr/\u003eCommit Message\"]\n    end\n    \n    subgraph \"UI Components\"\n        SCMViewPane[\"SCMViewPane\u003cbr/\u003eMain Changes View\"]\n        SCMHistoryViewPane[\"SCMHistoryViewPane\u003cbr/\u003eHistory/Graph View\"]\n        SCMRepositoriesViewPane[\"SCMRepositoriesViewPane\u003cbr/\u003eRepository List\"]\n    end\n    \n    subgraph \"Extension Integration\"\n        MainThreadSCM[\"MainThreadSCM\u003cbr/\u003eExtension Host Bridge\"]\n        ExtHostSCM[\"ExtHostSCM\u003cbr/\u003eExtension API\"]\n    end\n    \n    SCMService --\u003e ISCMProvider\n    SCMService --\u003e ISCMRepository\n    ISCMProvider --\u003e ISCMResourceGroup\n    ISCMProvider --\u003e ISCMHistoryProvider\n    ISCMResourceGroup --\u003e ISCMResource\n    ISCMRepository --\u003e ISCMInput\n    \n    SCMViewService --\u003e SCMViewPane\n    SCMViewService --\u003e SCMHistoryViewPane\n    SCMViewService --\u003e SCMRepositoriesViewPane\n    \n    SCMViewPane --\u003e ISCMResourceGroup\n    SCMHistoryViewPane --\u003e ISCMHistoryProvider\n    \n    MainThreadSCM --\u003e SCMService\n    ExtHostSCM --\u003e MainThreadSCM\n```\n\nSources: [src/vs/workbench/contrib/scm/common/scm.ts:34-242](), [src/vs/workbench/contrib/scm/browser/scmViewService.ts:1-25](), [src/vs/workbench/api/browser/mainThreadSCM.ts:1-30]()\n\n### Service Layer Components\n\n| Component | Purpose | Key Responsibilities |\n|-----------|---------|---------------------|\n| `ISCMService` | Provider Management | Repository registration, provider discovery, lifecycle management |\n| `ISCMViewService` | UI Coordination | View state management, repository visibility, menu integration |\n| `IQuickDiffService` | Diff Integration | Editor gutter decorations, inline diff providers |\n| `SCMMenus` | Action Integration | Context menus, toolbar actions, command routing |\n\nSources: [src/vs/workbench/contrib/scm/common/scm.ts:170-242](), [src/vs/workbench/contrib/scm/browser/menus.ts:17-30]()\n\n## Provider Interface\n\nThe SCM Framework defines a comprehensive provider interface that extensions implement to integrate with VS Code's source control system.\n\n### Provider Contract\n\n```mermaid\ngraph TB\n    subgraph \"ISCMProvider Interface\"\n        ProviderCore[\"Core Properties\u003cbr/\u003eid, label, rootUri\"]\n        ProviderState[\"Observable State\u003cbr/\u003ecount, statusBarCommands\"]\n        ProviderGroups[\"Resource Management\u003cbr/\u003egroups, onDidChangeResources\"]\n        ProviderInput[\"Input Integration\u003cbr/\u003einputBoxTextModel, acceptInputCommand\"]\n        ProviderHistory[\"History Support\u003cbr/\u003ehistoryProvider\"]\n    end\n    \n    subgraph \"Resource Hierarchy\"\n        ResourceGroups[\"ISCMResourceGroup[]\u003cbr/\u003eStaged, Working Tree, etc.\"]\n        Resources[\"ISCMResource[]\u003cbr/\u003eIndividual file changes\"]\n        ResourceTree[\"ResourceTree\u003cbr/\u003eHierarchical view\"]\n    end\n    \n    subgraph \"State Management\"\n        ObservableCount[\"IObservable\u003cnumber\u003e\u003cbr/\u003eBadge count\"]\n        ObservableCommands[\"IObservable\u003cCommand[]\u003e\u003cbr/\u003eStatus bar actions\"]\n        ObservableTemplate[\"IObservable\u003cstring\u003e\u003cbr/\u003eCommit template\"]\n    end\n    \n    ProviderGroups --\u003e ResourceGroups\n    ResourceGroups --\u003e Resources\n    ResourceGroups --\u003e ResourceTree\n    \n    ProviderState --\u003e ObservableCount\n    ProviderState --\u003e ObservableCommands\n    ProviderState --\u003e ObservableTemplate\n    \n    ProviderHistory --\u003e ISCMHistoryProvider[\"ISCMHistoryProvider\u003cbr/\u003eGit log, refs, etc.\"]\n```\n\nSources: [src/vs/workbench/contrib/scm/common/scm.ts:71-91](), [src/vs/workbench/contrib/scm/common/scm.ts:55-69]()\n\n### Resource Model\n\nThe framework organizes changed files into a hierarchical structure:\n\n```typescript\ninterface ISCMResource {\n  readonly resourceGroup: ISCMResourceGroup;\n  readonly sourceUri: URI;\n  readonly decorations: ISCMResourceDecorations;\n  readonly contextValue: string | undefined;\n  readonly command: Command | undefined;\n}\n\ninterface ISCMResourceGroup {\n  readonly id: string;\n  readonly provider: ISCMProvider;\n  readonly resources: readonly ISCMResource[];\n  readonly resourceTree: ResourceTree\u003cISCMResource, ISCMResourceGroup\u003e;\n  readonly label: string;\n  readonly hideWhenEmpty: boolean;\n}\n```\n\nSources: [src/vs/workbench/contrib/scm/common/scm.ts:44-69]()\n\n## UI Integration\n\nThe SCM Framework provides several view components that automatically render provider data and handle user interactions.\n\n### View Component Hierarchy\n\n```mermaid\ngraph TB\n    subgraph \"SCM View Container\"\n        ViewContainer[\"SCMViewPaneContainer\u003cbr/\u003eMain container\"]\n    end\n    \n    subgraph \"Primary Views\"\n        ChangesView[\"SCMViewPane\u003cbr/\u003eChanges \u0026 Input\"]\n        HistoryView[\"SCMHistoryViewPane\u003cbr/\u003eCommit History\"]\n        ReposView[\"SCMRepositoriesViewPane\u003cbr/\u003eMulti-repo management\"]\n    end\n    \n    subgraph \"Rendering System\"\n        ResourceRenderer[\"ResourceRenderer\u003cbr/\u003eFile change items\"]\n        RepositoryRenderer[\"RepositoryRenderer\u003cbr/\u003eRepository headers\"]\n        HistoryRenderer[\"HistoryItemRenderer\u003cbr/\u003eCommit entries\"]\n        InputRenderer[\"InputRenderer\u003cbr/\u003eCommit message box\"]\n    end\n    \n    subgraph \"Tree Infrastructure\"\n        TreeDelegate[\"ListDelegate\u003cbr/\u003eVirtual scrolling\"]\n        TreeDataSource[\"AsyncDataSource\u003cbr/\u003eHistory loading\"]\n        TreeFilter[\"SCMTreeFilter\u003cbr/\u003eResource filtering\"]\n    end\n    \n    ViewContainer --\u003e ChangesView\n    ViewContainer --\u003e HistoryView\n    ViewContainer --\u003e ReposView\n    \n    ChangesView --\u003e ResourceRenderer\n    ChangesView --\u003e InputRenderer\n    HistoryView --\u003e HistoryRenderer\n    ReposView --\u003e RepositoryRenderer\n    \n    ResourceRenderer --\u003e TreeDelegate\n    HistoryRenderer --\u003e TreeDataSource\n    ResourceRenderer --\u003e TreeFilter\n```\n\nSources: [src/vs/workbench/contrib/scm/browser/scmViewPane.ts:1-50](), [src/vs/workbench/contrib/scm/browser/scmHistoryViewPane.ts:1-40](), [src/vs/workbench/contrib/scm/browser/scmRepositoriesViewPane.ts:1-30]()\n\n### Input System\n\nThe commit input system provides a rich text editing experience with validation and history:\n\n| Component | Purpose | Implementation |\n|-----------|---------|----------------|\n| `SCMInputWidget` | Rich text editor | Monaco editor integration |\n| `IInputValidator` | Message validation | Async validation with decorations |\n| `SCMInputBox` | Extension API | Bridge to extension host |\n| History navigation | Previous commits | Up/down arrow navigation |\n\nSources: [src/vs/workbench/contrib/scm/browser/scmViewPane.ts:292-421](), [src/vs/workbench/api/common/extHostSCM.ts:272-384]()\n\n## History System\n\nThe SCM Framework includes a sophisticated history system for displaying commit graphs, branches, and file changes over time.\n\n### History Provider Interface\n\n```mermaid\ngraph TB\n    subgraph \"History Core\"\n        HistoryProvider[\"ISCMHistoryProvider\u003cbr/\u003eExtension implementation\"]\n        HistoryOptions[\"ISCMHistoryOptions\u003cbr/\u003ePagination, filtering\"]\n        HistoryItems[\"ISCMHistoryItem[]\u003cbr/\u003eCommit data\"]\n    end\n    \n    subgraph \"Reference Management\"\n        CurrentRef[\"historyItemRef\u003cbr/\u003eCurrent branch/commit\"]\n        RemoteRef[\"historyItemRemoteRef\u003cbr/\u003eRemote tracking\"]\n        BaseRef[\"historyItemBaseRef\u003cbr/\u003eMerge base\"]\n        RefChanges[\"historyItemRefChanges\u003cbr/\u003eBranch updates\"]\n    end\n    \n    subgraph \"Graph Visualization\"\n        GraphNodes[\"ISCMHistoryItemGraphNode[]\u003cbr/\u003eSwimlane positioning\"]\n        GraphRenderer[\"renderSCMHistoryItemGraph\u003cbr/\u003eSVG generation\"]\n        HistoryTree[\"WorkbenchCompressibleAsyncDataTree\u003cbr/\u003eVirtual scrolling\"]\n    end\n    \n    subgraph \"Change Details\"\n        ItemChanges[\"ISCMHistoryItemChange[]\u003cbr/\u003eFile modifications\"]\n        DiffUris[\"MultiDiffEditor URIs\u003cbr/\u003eSide-by-side comparison\"]\n        ChatContext[\"resolveHistoryItemChatContext\u003cbr/\u003eAI integration\"]\n    end\n    \n    HistoryProvider --\u003e HistoryOptions\n    HistoryProvider --\u003e HistoryItems\n    HistoryProvider --\u003e CurrentRef\n    HistoryProvider --\u003e RemoteRef\n    HistoryProvider --\u003e BaseRef\n    \n    HistoryItems --\u003e GraphNodes\n    GraphNodes --\u003e GraphRenderer\n    GraphRenderer --\u003e HistoryTree\n    \n    HistoryProvider --\u003e ItemChanges\n    ItemChanges --\u003e DiffUris\n    HistoryProvider --\u003e ChatContext\n```\n\nSources: [src/vs/workbench/contrib/scm/common/history.ts:18-30](), [src/vs/workbench/contrib/scm/browser/scmHistory.ts:1-50](), [src/vs/workbench/contrib/scm/browser/scmHistoryViewPane.ts:30-80]()\n\n### Graph Rendering\n\nThe history view renders commit graphs using SVG with swimlane visualization:\n\n```typescript\ninterface ISCMHistoryItemViewModel {\n  readonly historyItem: ISCMHistoryItem;\n  readonly isCurrent: boolean;\n  readonly inputSwimlanes: ISCMHistoryItemGraphNode[];\n  readonly outputSwimlanes: ISCMHistoryItemGraphNode[];\n}\n```\n\nThe graph rendering system creates visual connections between commits using colored paths and circles, with each branch getting its own swimlane.\n\nSources: [src/vs/workbench/contrib/scm/common/history.ts:81-86](), [src/vs/workbench/contrib/scm/browser/scmHistory.ts:200-300]()\n\n## Extension Integration\n\nThe SCM Framework bridges between the core VS Code workbench and extension host through a well-defined RPC protocol.\n\n### Extension Host Bridge\n\n```mermaid\ngraph LR\n    subgraph \"Extension Host\"\n        ExtensionCode[\"Extension Code\u003cbr/\u003eGit, SVN, etc.\"]\n        ExtHostSCM[\"ExtHostSCM\u003cbr/\u003eAPI Implementation\"]\n        SourceControlAPI[\"vscode.SourceControl\u003cbr/\u003ePublic API\"]\n    end\n    \n    subgraph \"RPC Layer\"\n        RPCProtocol[\"RPC Protocol\u003cbr/\u003eJSON serialization\"]\n        DTOs[\"Data Transfer Objects\u003cbr/\u003eSerializable types\"]\n    end\n    \n    subgraph \"Main Thread\"\n        MainThreadSCM[\"MainThreadSCM\u003cbr/\u003eWorkbench integration\"]\n        SCMService[\"SCMService\u003cbr/\u003eProvider registration\"]\n        SCMViewService[\"SCMViewService\u003cbr/\u003eUI updates\"]\n    end\n    \n    ExtensionCode --\u003e SourceControlAPI\n    SourceControlAPI --\u003e ExtHostSCM\n    ExtHostSCM --\u003e RPCProtocol\n    RPCProtocol --\u003e DTOs\n    DTOs --\u003e MainThreadSCM\n    MainThreadSCM --\u003e SCMService\n    MainThreadSCM --\u003e SCMViewService\n```\n\nSources: [src/vs/workbench/api/common/extHostSCM.ts:1-50](), [src/vs/workbench/api/browser/mainThreadSCM.ts:1-50]()\n\n### Provider Registration Flow\n\n1. **Extension Activation**: Extension creates `vscode.SourceControl` instance\n2. **Proxy Creation**: `ExtHostSCM` creates provider proxy with unique handle\n3. **RPC Registration**: `MainThreadSCM` receives registration via RPC protocol\n4. **Service Integration**: Provider registered with `ISCMService` and `ISCMViewService`\n5. **UI Creation**: View components automatically render provider data\n\nSources: [src/vs/workbench/api/common/extHostSCM.ts:750-800](), [src/vs/workbench/api/browser/mainThreadSCM.ts:390-450]()\n\n### Configuration Integration\n\nThe framework provides extensive configuration options that affect both core behavior and provider implementations:\n\n| Setting | Purpose | Default |\n|---------|---------|---------|\n| `scm.defaultViewMode` | List vs. tree view | `list` |\n| `scm.alwaysShowRepositories` | Multi-repo visibility | `false` |\n| `scm.countBadge` | Activity bar badge | `all` |\n| `scm.autoReveal` | Auto-select changed files | `true` |\n| `scm.inputFontFamily` | Commit message font | `default` |\n\nSources: [src/vs/workbench/contrib/scm/browser/scm.contribution.ts:174-400]()"])</script>
    <script>self.__next_f.push([1, "29:T4090,"])</script>
    <script>self.__next_f.push([1, "# Git Extension\n\n\u003cdetails\u003e\n\u003csummary\u003eRelevant source files\u003c/summary\u003e\n\nThe following files were used as context for generating this wiki page:\n\n- [extensions/git/package.json](extensions/git/package.json)\n- [extensions/git/package.nls.json](extensions/git/package.nls.json)\n- [extensions/git/src/actionButton.ts](extensions/git/src/actionButton.ts)\n- [extensions/git/src/api/api1.ts](extensions/git/src/api/api1.ts)\n- [extensions/git/src/api/extension.ts](extensions/git/src/api/extension.ts)\n- [extensions/git/src/api/git.d.ts](extensions/git/src/api/git.d.ts)\n- [extensions/git/src/askpass-empty.sh](extensions/git/src/askpass-empty.sh)\n- [extensions/git/src/askpass-main.ts](extensions/git/src/askpass-main.ts)\n- [extensions/git/src/askpass.sh](extensions/git/src/askpass.sh)\n- [extensions/git/src/askpass.ts](extensions/git/src/askpass.ts)\n- [extensions/git/src/autofetch.ts](extensions/git/src/autofetch.ts)\n- [extensions/git/src/commands.ts](extensions/git/src/commands.ts)\n- [extensions/git/src/git.ts](extensions/git/src/git.ts)\n- [extensions/git/src/gitEditor.ts](extensions/git/src/gitEditor.ts)\n- [extensions/git/src/ipc/ipcClient.ts](extensions/git/src/ipc/ipcClient.ts)\n- [extensions/git/src/ipc/ipcServer.ts](extensions/git/src/ipc/ipcServer.ts)\n- [extensions/git/src/main.ts](extensions/git/src/main.ts)\n- [extensions/git/src/model.ts](extensions/git/src/model.ts)\n- [extensions/git/src/postCommitCommands.ts](extensions/git/src/postCommitCommands.ts)\n- [extensions/git/src/repository.ts](extensions/git/src/repository.ts)\n- [extensions/git/src/ssh-askpass-empty.sh](extensions/git/src/ssh-askpass-empty.sh)\n- [extensions/git/src/ssh-askpass.sh](extensions/git/src/ssh-askpass.sh)\n- [extensions/git/src/statusbar.ts](extensions/git/src/statusbar.ts)\n- [extensions/git/src/terminal.ts](extensions/git/src/terminal.ts)\n- [extensions/git/src/test/git.test.ts](extensions/git/src/test/git.test.ts)\n- [extensions/git/src/util.ts](extensions/git/src/util.ts)\n- [extensions/git/tsconfig.json](extensions/git/tsconfig.json)\n\n\u003c/details\u003e\n\n\n\nThe Git Extension is VS Code's built-in source control extension that provides comprehensive Git functionality within the editor. It implements Git operations, repository management, and integrates with VS Code's Source Control Management (SCM) framework to provide version control capabilities directly in the editor interface.\n\nFor information about the generic SCM framework that this extension uses, see [SCM Framework](#8.1).\n\n## Extension Architecture\n\nThe Git extension follows a layered architecture with clear separation between low-level Git operations, repository management, and user interface components.\n\n### Core System Overview\n\n```mermaid\ngraph TB\n    subgraph \"Extension Entry Point\"\n        Main[\"main.ts\u003cbr/\u003eExtension Activation\"]\n        ExtImpl[\"GitExtensionImpl\u003cbr/\u003eAPI Implementation\"]\n    end\n    \n    subgraph \"Command Layer\"\n        CommandCenter[\"CommandCenter\u003cbr/\u003eGit Commands\"]\n        StatusBar[\"StatusBarCommands\u003cbr/\u003eStatus Integration\"]\n        ActionButton[\"ActionButton\u003cbr/\u003eSCM Actions\"]\n    end\n    \n    subgraph \"Repository Management\"\n        Model[\"Model\u003cbr/\u003eRepository Manager\"]\n        Repository[\"Repository\u003cbr/\u003eGit Repository\"]\n        Resource[\"Resource\u003cbr/\u003eFile Changes\"]\n    end\n    \n    subgraph \"Git Operations\"\n        Git[\"Git\u003cbr/\u003eCommand Execution\"]\n        BaseRepository[\"BaseRepository\u003cbr/\u003eGit Operations\"]\n    end\n    \n    subgraph \"External Integrations\"\n        SCM[\"VS Code SCM\"]\n        FileSystem[\"GitFileSystemProvider\"]\n        Terminal[\"TerminalEnvironmentManager\"]\n    end\n    \n    Main --\u003e Model\n    Main --\u003e CommandCenter\n    CommandCenter --\u003e Repository\n    Model --\u003e Repository\n    Repository --\u003e BaseRepository\n    BaseRepository --\u003e Git\n    Repository --\u003e SCM\n    Repository --\u003e Resource\n    Model --\u003e ExtImpl\n    CommandCenter --\u003e StatusBar\n    Repository --\u003e ActionButton\n    Main --\u003e FileSystem\n    Main --\u003e Terminal\n```\n\n**Sources:** [extensions/git/src/main.ts:39-138](), [extensions/git/src/model.ts:174](), [extensions/git/src/commands.ts:718](), [extensions/git/src/repository.ts:673]()\n\n### Git Command Execution Flow\n\n```mermaid\ngraph LR\n    subgraph \"User Interface\"\n        Command[\"Git Command\"]\n        Palette[\"Command Palette\"]\n        Button[\"Action Button\"]\n    end\n    \n    subgraph \"Command Processing\"\n        CommandCenter[\"CommandCenter\"]\n        Decorator[\"@command decorator\"]\n        Operation[\"OperationManager\"]\n    end\n    \n    subgraph \"Repository Operations\"\n        Repository[\"Repository\"]\n        BaseRepo[\"BaseRepository\"]\n        Git[\"Git\"]\n    end\n    \n    subgraph \"External Process\"\n        GitExe[\"git.exe\"]\n        ChildProcess[\"Child Process\"]\n    end\n    \n    Command --\u003e CommandCenter\n    Palette --\u003e CommandCenter\n    Button --\u003e CommandCenter\n    CommandCenter --\u003e Decorator\n    Decorator --\u003e Repository\n    Repository --\u003e Operation\n    Repository --\u003e BaseRepo\n    BaseRepo --\u003e Git\n    Git --\u003e GitExe\n    GitExe --\u003e ChildProcess\n```\n\n**Sources:** [extensions/git/src/commands.ts:316-326](), [extensions/git/src/repository.ts:673-1500](), [extensions/git/src/git.ts:372-485]()\n\n## Key Components\n\n### CommandCenter Class\n\nThe `CommandCenter` class implements all Git commands exposed through VS Code's command palette and UI. It uses a decorator pattern to register commands and handles repository operations.\n\n```mermaid\ngraph TB\n    subgraph \"Command Registration\"\n        Commands[\"Commands Array\"]\n        Decorator[\"@command decorator\"]\n        Register[\"commands.registerCommand\"]\n    end\n    \n    subgraph \"CommandCenter Methods\"\n        Clone[\"clone()\"]\n        Commit[\"commit()\"]\n        Push[\"push()\"]\n        Pull[\"pull()\"]\n        Branch[\"branch()\"]\n        Checkout[\"checkout()\"]\n    end\n    \n    subgraph \"Command Execution\"\n        Repository[\"Repository instance\"]\n        GitOps[\"Git Operations\"]\n        UI[\"User Interface\"]\n    end\n    \n    Decorator --\u003e Commands\n    Commands --\u003e Register\n    Register --\u003e Clone\n    Register --\u003e Commit\n    Register --\u003e Push\n    Register --\u003e Pull\n    Register --\u003e Branch\n    Register --\u003e Checkout\n    \n    Clone --\u003e Repository\n    Commit --\u003e Repository\n    Push --\u003e Repository\n    Pull --\u003e Repository\n    Branch --\u003e Repository\n    Checkout --\u003e Repository\n    \n    Repository --\u003e GitOps\n    Repository --\u003e UI\n```\n\n**Sources:** [extensions/git/src/commands.ts:316-326](), [extensions/git/src/commands.ts:718-728](), [extensions/git/src/commands.ts:889-1025]()\n\n### Repository Management\n\nThe `Repository` class represents a Git repository and provides high-level operations. It integrates with VS Code's SCM API and manages resource states.\n\n| Component | Purpose | Key Methods |\n|-----------|---------|-------------|\n| `Repository` | Git repository representation | `commit()`, `push()`, `pull()`, `checkout()` |\n| `Resource` | File change representation | `open()`, `openFile()`, `openChange()` |\n| `ResourceCommandResolver` | Command resolution for resources | `resolveDefaultCommand()`, `resolveChangeCommand()` |\n| `GitResourceGroup` | Groups of resources | Staging, working tree, merge, untracked |\n\n**Sources:** [extensions/git/src/repository.ts:673-700](), [extensions/git/src/repository.ts:49-333](), [extensions/git/src/repository.ts:491-653]()\n\n### Git Command Execution\n\nThe `Git` class handles low-level Git command execution through child processes.\n\n```mermaid\ngraph LR\n    subgraph \"Git Class\"\n        GitClass[\"Git\"]\n        Exec[\"exec()\"]\n        Stream[\"stream()\"]\n        Spawn[\"spawn()\"]\n    end\n    \n    subgraph \"Command Processing\"\n        Args[\"Command Args\"]\n        Options[\"SpawnOptions\"]\n        Environment[\"Environment Variables\"]\n    end\n    \n    subgraph \"Process Management\"\n        ChildProcess[\"Child Process\"]\n        Stdout[\"stdout\"]\n        Stderr[\"stderr\"]\n        ExitCode[\"Exit Code\"]\n    end\n    \n    subgraph \"Results\"\n        Result[\"IExecutionResult\"]\n        Error[\"GitError\"]\n        Output[\"Command Output\"]\n    end\n    \n    GitClass --\u003e Exec\n    Exec --\u003e Args\n    Exec --\u003e Options\n    Args --\u003e Environment\n    Options --\u003e ChildProcess\n    ChildProcess --\u003e Stdout\n    ChildProcess --\u003e Stderr\n    ChildProcess --\u003e ExitCode\n    Stdout --\u003e Result\n    Stderr --\u003e Error\n    ExitCode --\u003e Output\n```\n\n**Sources:** [extensions/git/src/git.ts:372-410](), [extensions/git/src/git.ts:564-627](), [extensions/git/src/git.ts:174-261]()\n\n### Model and Repository Discovery\n\nThe `Model` class manages multiple repositories and handles repository discovery across the workspace.\n\n```mermaid\ngraph TB\n    subgraph \"Repository Discovery\"\n        WorkspaceFolders[\"Workspace Folders\"]\n        FileWatcher[\"File System Watcher\"]\n        Scanner[\"Repository Scanner\"]\n    end\n    \n    subgraph \"Model Management\"\n        Model[\"Model\"]\n        OpenRepos[\"Open Repositories\"]\n        ClosedRepos[\"Closed Repositories\"]\n        UnsafeRepos[\"Unsafe Repositories\"]\n    end\n    \n    subgraph \"Repository Lifecycle\"\n        Create[\"Create Repository\"]\n        Open[\"Open Repository\"]\n        Close[\"Close Repository\"]\n        Dispose[\"Dispose Repository\"]\n    end\n    \n    subgraph \"Events\"\n        OnOpen[\"onDidOpenRepository\"]\n        OnClose[\"onDidCloseRepository\"]\n        OnChange[\"onDidChangeRepository\"]\n    end\n    \n    WorkspaceFolders --\u003e Scanner\n    FileWatcher --\u003e Scanner\n    Scanner --\u003e Model\n    Model --\u003e OpenRepos\n    Model --\u003e ClosedRepos\n    Model --\u003e UnsafeRepos\n    \n    Create --\u003e Open\n    Open --\u003e OnOpen\n    Close --\u003e OnClose\n    Open --\u003e OnChange\n    Close --\u003e Dispose\n```\n\n**Sources:** [extensions/git/src/model.ts:174-289](), [extensions/git/src/model.ts:292-400](), [extensions/git/src/model.ts:52-172]()\n\n## Source Control Integration\n\n### SCM API Integration\n\nThe Git extension integrates deeply with VS Code's Source Control Management API to provide native Git functionality.\n\n| SCM Component | Git Implementation | Purpose |\n|---------------|-------------------|---------|\n| `SourceControl` | `Repository.sourceControl` | Main SCM provider |\n| `SourceControlResourceGroup` | `GitResourceGroup` | Groups files by status |\n| `SourceControlResourceState` | `Resource` | Individual file changes |\n| `SourceControlInputBox` | `Repository.inputBox` | Commit message input |\n\n**Sources:** [extensions/git/src/repository.ts:701-710](), [extensions/git/src/repository.ts:335-344](), [extensions/git/src/repository.ts:49-84]()\n\n### Resource State Management\n\nGit file states are mapped to VS Code's SCM resource states with visual decorations and commands.\n\n```mermaid\ngraph LR\n    subgraph \"Git Status\"\n        Modified[\"MODIFIED\"]\n        Added[\"INDEX_ADDED\"]\n        Deleted[\"DELETED\"]\n        Untracked[\"UNTRACKED\"]\n        Conflict[\"BOTH_MODIFIED\"]\n    end\n    \n    subgraph \"Resource Groups\"\n        WorkingTree[\"Working Tree Group\"]\n        Index[\"Index Group\"]\n        Merge[\"Merge Group\"]\n        UntrackedGroup[\"Untracked Group\"]\n    end\n    \n    subgraph \"UI Representation\"\n        Icons[\"Status Icons\"]\n        Colors[\"Status Colors\"]\n        Commands[\"Context Commands\"]\n        Decorations[\"File Decorations\"]\n    end\n    \n    Modified --\u003e WorkingTree\n    Added --\u003e Index\n    Deleted --\u003e WorkingTree\n    Untracked --\u003e UntrackedGroup\n    Conflict --\u003e Merge\n    \n    WorkingTree --\u003e Icons\n    Index --\u003e Colors\n    Merge --\u003e Commands\n    UntrackedGroup --\u003e Decorations\n```\n\n**Sources:** [extensions/git/src/repository.ts:42-47](), [extensions/git/src/repository.ts:51-143](), [extensions/git/src/repository.ts:186-233]()\n\n## Extension API\n\n### Public API Structure\n\nThe Git extension exposes an API for other extensions to interact with Git repositories.\n\n```mermaid\ngraph TB\n    subgraph \"API Interface\"\n        GitExtension[\"GitExtension\"]\n        API[\"API\"]\n        Repository[\"Repository\"]\n        RepositoryState[\"RepositoryState\"]\n    end\n    \n    subgraph \"API Implementation\"\n        GitExtensionImpl[\"GitExtensionImpl\"]\n        ApiImpl[\"ApiImpl\"]\n        ApiRepository[\"ApiRepository\"]\n        ApiRepositoryState[\"ApiRepositoryState\"]\n    end\n    \n    subgraph \"Core Types\"\n        Branch[\"Branch\"]\n        Remote[\"Remote\"]\n        Commit[\"Commit\"]\n        Change[\"Change\"]\n    end\n    \n    GitExtension --\u003e API\n    API --\u003e Repository\n    Repository --\u003e RepositoryState\n    \n    GitExtensionImpl --\u003e ApiImpl\n    ApiImpl --\u003e ApiRepository\n    ApiRepository --\u003e ApiRepositoryState\n    \n    RepositoryState --\u003e Branch\n    RepositoryState --\u003e Remote\n    RepositoryState --\u003e Commit\n    RepositoryState --\u003e Change\n```\n\n**Sources:** [extensions/git/src/api/git.d.ts:9-396](), [extensions/git/src/api/extension.ts:23-46](), [extensions/git/src/api/api1.ts:74-277]()\n\n### Extension Points\n\nThe Git extension provides several extension points for other extensions:\n\n| Extension Point | Interface | Purpose |\n|----------------|-----------|---------|\n| Remote Source Publishers | `RemoteSourcePublisher` | Publish repositories to remote services |\n| Credentials Providers | `CredentialsProvider` | Provide authentication credentials |\n| Post-Commit Commands | `PostCommitCommandsProvider` | Commands to run after commits |\n| Branch Protection | `BranchProtectionProvider` | Define protected branches |\n| Push Error Handlers | `PushErrorHandler` | Handle push operation errors |\n\n**Sources:** [extensions/git/src/api/git.d.ts:285-330](), [extensions/git/src/model.ts:221-241]()\n\n## Configuration and Settings\n\n### Extension Configuration\n\nThe Git extension provides extensive configuration options through VS Code settings.\n\n```mermaid\ngraph TB\n    subgraph \"Core Settings\"\n        Enabled[\"git.enabled\"]\n        Path[\"git.path\"]\n        AutoRefresh[\"git.autorefresh\"]\n        AutoFetch[\"git.autofetch\"]\n    end\n    \n    subgraph \"UI Settings\"\n        Decorations[\"git.decorations.enabled\"]\n        ShowProgress[\"git.showProgress\"]\n        CountBadge[\"git.countBadge\"]\n        StatusBar[\"git.enableStatusBarSync\"]\n    end\n    \n    subgraph \"Behavior Settings\"\n        SmartCommit[\"git.enableSmartCommit\"]\n        PostCommit[\"git.postCommitCommand\"]\n        BranchProtection[\"git.branchProtection\"]\n        AutoStash[\"git.autoStash\"]\n    end\n    \n    subgraph \"Advanced Settings\"\n        CommandsToLog[\"git.commandsToLog\"]\n        TerminalAuth[\"git.terminalAuthentication\"]\n        UnsafeRepos[\"git.ignoredRepositories\"]\n        ScanRepos[\"git.scanRepositories\"]\n    end\n    \n    Enabled --\u003e AutoRefresh\n    AutoRefresh --\u003e AutoFetch\n    Path --\u003e Enabled\n    \n    Decorations --\u003e ShowProgress\n    ShowProgress --\u003e CountBadge\n    CountBadge --\u003e StatusBar\n    \n    SmartCommit --\u003e PostCommit\n    PostCommit --\u003e BranchProtection\n    BranchProtection --\u003e AutoStash\n    \n    CommandsToLog --\u003e TerminalAuth\n    TerminalAuth --\u003e UnsafeRepos\n    UnsafeRepos --\u003e ScanRepos\n```\n\n**Sources:** [extensions/git/package.nls.json:142-280](), [extensions/git/package.json:66-1095]()\n\n## Terminal and Authentication Integration\n\n### Terminal Environment Management\n\nThe Git extension configures terminal environments to provide seamless Git authentication and editor integration.\n\n```mermaid\ngraph LR\n    subgraph \"Authentication\"\n        Askpass[\"Askpass\"]\n        SSHAgent[\"SSH Agent\"]\n        Credentials[\"Credentials Provider\"]\n    end\n    \n    subgraph \"Terminal Integration\"\n        TerminalEnv[\"TerminalEnvironmentManager\"]\n        EnvVars[\"Environment Variables\"]\n        IPCServer[\"IPC Server\"]\n    end\n    \n    subgraph \"Git Editor\"\n        GitEditor[\"GitEditor\"]\n        CommitMessage[\"Commit Message Editor\"]\n        MergeEditor[\"Merge Editor\"]\n    end\n    \n    Askpass --\u003e TerminalEnv\n    SSHAgent --\u003e TerminalEnv\n    Credentials --\u003e Askpass\n    \n    TerminalEnv --\u003e EnvVars\n    EnvVars --\u003e IPCServer\n    \n    GitEditor --\u003e CommitMessage\n    CommitMessage --\u003e MergeEditor\n    GitEditor --\u003e IPCServer\n```\n\n**Sources:** [extensions/git/src/terminal.ts:15-73](), [extensions/git/src/askpass.ts:13-104](), [extensions/git/src/gitEditor.ts:31-149]()\n\n## Operation Management\n\n### Git Operation Coordination\n\nThe extension uses an operation management system to coordinate Git operations and provide progress feedback.\n\n| Operation Type | Description | Exclusive |\n|----------------|-------------|-----------|\n| `Commit` | Commit changes | Yes |\n| `Push` | Push to remote | No |\n| `Pull` | Pull from remote | No |\n| `Fetch` | Fetch from remote | No |\n| `Checkout` | Checkout branch/commit | Yes |\n| `Merge` | Merge branches | Yes |\n| `Rebase` | Rebase current branch | Yes |\n\n**Sources:** [extensions/git/src/operation.ts:7-79](), [extensions/git/src/repository.ts:2090-2140]()"])</script>
    <script>self.__next_f.push([1, "2a:T53ea,"])</script>
    <script>self.__next_f.push([1, "# Debugging System\n\n\u003cdetails\u003e\n\u003csummary\u003eRelevant source files\u003c/summary\u003e\n\nThe following files were used as context for generating this wiki page:\n\n- [src/vs/editor/contrib/hover/browser/glyphHoverWidget.ts](src/vs/editor/contrib/hover/browser/glyphHoverWidget.ts)\n- [src/vs/workbench/api/browser/mainThreadDebugService.ts](src/vs/workbench/api/browser/mainThreadDebugService.ts)\n- [src/vs/workbench/api/common/extHostDebugService.ts](src/vs/workbench/api/common/extHostDebugService.ts)\n- [src/vs/workbench/contrib/debug/browser/baseDebugView.ts](src/vs/workbench/contrib/debug/browser/baseDebugView.ts)\n- [src/vs/workbench/contrib/debug/browser/breakpointEditorContribution.ts](src/vs/workbench/contrib/debug/browser/breakpointEditorContribution.ts)\n- [src/vs/workbench/contrib/debug/browser/breakpointWidget.ts](src/vs/workbench/contrib/debug/browser/breakpointWidget.ts)\n- [src/vs/workbench/contrib/debug/browser/breakpointsView.ts](src/vs/workbench/contrib/debug/browser/breakpointsView.ts)\n- [src/vs/workbench/contrib/debug/browser/callStackEditorContribution.ts](src/vs/workbench/contrib/debug/browser/callStackEditorContribution.ts)\n- [src/vs/workbench/contrib/debug/browser/callStackView.ts](src/vs/workbench/contrib/debug/browser/callStackView.ts)\n- [src/vs/workbench/contrib/debug/browser/debug.contribution.ts](src/vs/workbench/contrib/debug/browser/debug.contribution.ts)\n- [src/vs/workbench/contrib/debug/browser/debugActionViewItems.ts](src/vs/workbench/contrib/debug/browser/debugActionViewItems.ts)\n- [src/vs/workbench/contrib/debug/browser/debugCommands.ts](src/vs/workbench/contrib/debug/browser/debugCommands.ts)\n- [src/vs/workbench/contrib/debug/browser/debugConfigurationManager.ts](src/vs/workbench/contrib/debug/browser/debugConfigurationManager.ts)\n- [src/vs/workbench/contrib/debug/browser/debugEditorActions.ts](src/vs/workbench/contrib/debug/browser/debugEditorActions.ts)\n- [src/vs/workbench/contrib/debug/browser/debugEditorContribution.ts](src/vs/workbench/contrib/debug/browser/debugEditorContribution.ts)\n- [src/vs/workbench/contrib/debug/browser/debugHover.ts](src/vs/workbench/contrib/debug/browser/debugHover.ts)\n- [src/vs/workbench/contrib/debug/browser/debugService.ts](src/vs/workbench/contrib/debug/browser/debugService.ts)\n- [src/vs/workbench/contrib/debug/browser/debugSession.ts](src/vs/workbench/contrib/debug/browser/debugSession.ts)\n- [src/vs/workbench/contrib/debug/browser/debugToolBar.ts](src/vs/workbench/contrib/debug/browser/debugToolBar.ts)\n- [src/vs/workbench/contrib/debug/browser/debugViewlet.ts](src/vs/workbench/contrib/debug/browser/debugViewlet.ts)\n- [src/vs/workbench/contrib/debug/browser/disassemblyView.ts](src/vs/workbench/contrib/debug/browser/disassemblyView.ts)\n- [src/vs/workbench/contrib/debug/browser/exceptionWidget.ts](src/vs/workbench/contrib/debug/browser/exceptionWidget.ts)\n- [src/vs/workbench/contrib/debug/browser/loadedScriptsView.ts](src/vs/workbench/contrib/debug/browser/loadedScriptsView.ts)\n- [src/vs/workbench/contrib/debug/browser/media/breakpointWidget.css](src/vs/workbench/contrib/debug/browser/media/breakpointWidget.css)\n- [src/vs/workbench/contrib/debug/browser/media/callStackEditorContribution.css](src/vs/workbench/contrib/debug/browser/media/callStackEditorContribution.css)\n- [src/vs/workbench/contrib/debug/browser/media/debug.contribution.css](src/vs/workbench/contrib/debug/browser/media/debug.contribution.css)\n- [src/vs/workbench/contrib/debug/browser/media/debugHover.css](src/vs/workbench/contrib/debug/browser/media/debugHover.css)\n- [src/vs/workbench/contrib/debug/browser/media/debugToolBar.css](src/vs/workbench/contrib/debug/browser/media/debugToolBar.css)\n- [src/vs/workbench/contrib/debug/browser/media/debugViewlet.css](src/vs/workbench/contrib/debug/browser/media/debugViewlet.css)\n- [src/vs/workbench/contrib/debug/browser/media/exceptionWidget.css](src/vs/workbench/contrib/debug/browser/media/exceptionWidget.css)\n- [src/vs/workbench/contrib/debug/browser/media/repl.css](src/vs/workbench/contrib/debug/browser/media/repl.css)\n- [src/vs/workbench/contrib/debug/browser/rawDebugSession.ts](src/vs/workbench/contrib/debug/browser/rawDebugSession.ts)\n- [src/vs/workbench/contrib/debug/browser/repl.ts](src/vs/workbench/contrib/debug/browser/repl.ts)\n- [src/vs/workbench/contrib/debug/browser/replFilter.ts](src/vs/workbench/contrib/debug/browser/replFilter.ts)\n- [src/vs/workbench/contrib/debug/browser/replViewer.ts](src/vs/workbench/contrib/debug/browser/replViewer.ts)\n- [src/vs/workbench/contrib/debug/browser/variablesView.ts](src/vs/workbench/contrib/debug/browser/variablesView.ts)\n- [src/vs/workbench/contrib/debug/browser/watchExpressionsView.ts](src/vs/workbench/contrib/debug/browser/watchExpressionsView.ts)\n- [src/vs/workbench/contrib/debug/common/debug.ts](src/vs/workbench/contrib/debug/common/debug.ts)\n- [src/vs/workbench/contrib/debug/common/debugModel.ts](src/vs/workbench/contrib/debug/common/debugModel.ts)\n- [src/vs/workbench/contrib/debug/common/debugStorage.ts](src/vs/workbench/contrib/debug/common/debugStorage.ts)\n- [src/vs/workbench/contrib/debug/common/debugViewModel.ts](src/vs/workbench/contrib/debug/common/debugViewModel.ts)\n- [src/vs/workbench/contrib/debug/common/replModel.ts](src/vs/workbench/contrib/debug/common/replModel.ts)\n- [src/vs/workbench/contrib/debug/test/browser/baseDebugView.test.ts](src/vs/workbench/contrib/debug/test/browser/baseDebugView.test.ts)\n- [src/vs/workbench/contrib/debug/test/browser/breakpoints.test.ts](src/vs/workbench/contrib/debug/test/browser/breakpoints.test.ts)\n- [src/vs/workbench/contrib/debug/test/browser/callStack.test.ts](src/vs/workbench/contrib/debug/test/browser/callStack.test.ts)\n- [src/vs/workbench/contrib/debug/test/browser/debugHover.test.ts](src/vs/workbench/contrib/debug/test/browser/debugHover.test.ts)\n- [src/vs/workbench/contrib/debug/test/browser/debugSource.test.ts](src/vs/workbench/contrib/debug/test/browser/debugSource.test.ts)\n- [src/vs/workbench/contrib/debug/test/browser/debugViewModel.test.ts](src/vs/workbench/contrib/debug/test/browser/debugViewModel.test.ts)\n- [src/vs/workbench/contrib/debug/test/browser/mockDebugModel.ts](src/vs/workbench/contrib/debug/test/browser/mockDebugModel.ts)\n- [src/vs/workbench/contrib/debug/test/browser/rawDebugSession.test.ts](src/vs/workbench/contrib/debug/test/browser/rawDebugSession.test.ts)\n- [src/vs/workbench/contrib/debug/test/browser/repl.test.ts](src/vs/workbench/contrib/debug/test/browser/repl.test.ts)\n- [src/vs/workbench/contrib/debug/test/browser/watch.test.ts](src/vs/workbench/contrib/debug/test/browser/watch.test.ts)\n- [src/vs/workbench/contrib/debug/test/common/debugModel.test.ts](src/vs/workbench/contrib/debug/test/common/debugModel.test.ts)\n- [src/vs/workbench/contrib/debug/test/common/mockDebug.ts](src/vs/workbench/contrib/debug/test/common/mockDebug.ts)\n- [src/vs/workbench/contrib/files/browser/views/emptyView.ts](src/vs/workbench/contrib/files/browser/views/emptyView.ts)\n- [src/vs/workbench/contrib/files/browser/views/openEditorsView.ts](src/vs/workbench/contrib/files/browser/views/openEditorsView.ts)\n\n\u003c/details\u003e\n\n\n\nThis document covers VS Code's comprehensive debugging infrastructure, which enables users to debug various programming languages and runtimes through a unified interface. The system implements the Debug Adapter Protocol (DAP) and provides multiple specialized views for managing breakpoints, variables, call stacks, and interactive debugging sessions.\n\nFor information about individual language debugging extensions, see the Extension System documentation. For details about the underlying editor features that support debugging (like hover and inline values), see the Monaco Editor documentation.\n\n## Architecture Overview\n\nThe debugging system follows a layered architecture with clear separation between protocol handling, session management, UI components, and editor integration.\n\n### Core Architecture Diagram\n\n```mermaid\ngraph TB\n    subgraph \"UI Layer\"\n        CallStackView[\"CallStackView\"]\n        VariablesView[\"VariablesView\"] \n        BreakpointsView[\"BreakpointsView\"]\n        Repl[\"Repl\"]\n        DebugToolBar[\"DebugToolBar\"]\n    end\n    \n    subgraph \"Service Layer\"\n        DebugService[\"DebugService\"]\n        ConfigurationManager[\"ConfigurationManager\"]\n        AdapterManager[\"AdapterManager\"]\n    end\n    \n    subgraph \"Session Layer\"\n        DebugSession[\"DebugSession\"]\n        RawDebugSession[\"RawDebugSession\"]\n        DebugModel[\"DebugModel\"]\n    end\n    \n    subgraph \"Editor Integration\"\n        DebugEditorContribution[\"DebugEditorContribution\"]\n        BreakpointEditorContribution[\"BreakpointEditorContribution\"]\n    end\n    \n    subgraph \"Protocol Layer\"\n        IDebugAdapter[\"IDebugAdapter\"]\n        DAP[\"Debug Adapter Protocol\"]\n    end\n    \n    CallStackView --\u003e DebugService\n    VariablesView --\u003e DebugService\n    BreakpointsView --\u003e DebugService\n    Repl --\u003e DebugService\n    DebugToolBar --\u003e DebugService\n    \n    DebugService --\u003e DebugSession\n    DebugService --\u003e ConfigurationManager\n    DebugService --\u003e AdapterManager\n    DebugService --\u003e DebugModel\n    \n    DebugSession --\u003e RawDebugSession\n    RawDebugSession --\u003e IDebugAdapter\n    IDebugAdapter --\u003e DAP\n    \n    DebugEditorContribution --\u003e DebugService\n    BreakpointEditorContribution --\u003e DebugService\n```\n\nSources: [src/vs/workbench/contrib/debug/browser/debugService.ts:62-116](), [src/vs/workbench/contrib/debug/browser/debugSession.ts:53-188](), [src/vs/workbench/contrib/debug/common/debugModel.ts:1-31]()\n\n## Core Services\n\n### DebugService\n\nThe `DebugService` is the central orchestrator for all debugging operations. It implements `IDebugService` and manages the entire debugging lifecycle.\n\n```mermaid\ngraph LR\n    subgraph \"DebugService Responsibilities\"\n        SessionMgmt[\"Session Management\"]\n        StateTracking[\"State Tracking\"] \n        ModelAccess[\"Model Access\"]\n        ConfigMgmt[\"Configuration Management\"]\n        UICoordination[\"UI Coordination\"]\n    end\n    \n    DebugService --\u003e SessionMgmt\n    DebugService --\u003e StateTracking\n    DebugService --\u003e ModelAccess\n    DebugService --\u003e ConfigMgmt\n    DebugService --\u003e UICoordination\n    \n    SessionMgmt --\u003e startDebugging[\"startDebugging()\"]\n    SessionMgmt --\u003e createSession[\"createSession()\"]\n    SessionMgmt --\u003e focusStackFrame[\"focusStackFrame()\"]\n    \n    StateTracking --\u003e onDidChangeState[\"onDidChangeState\"]\n    StateTracking --\u003e state[\"state: State\"]\n    \n    ModelAccess --\u003e getModel[\"getModel()\"]\n    ModelAccess --\u003e getViewModel[\"getViewModel()\"]\n```\n\nKey responsibilities include:\n- **Session Lifecycle**: Creating, managing, and terminating debug sessions via `startDebugging()` and `createSession()`\n- **State Management**: Tracking debugging state (Inactive, Initializing, Running, Stopped) through context keys\n- **UI Coordination**: Coordinating between different debug views and the editor\n- **Model Access**: Providing access to `DebugModel` and `ViewModel` instances\n\nSources: [src/vs/workbench/contrib/debug/browser/debugService.ts:237-250](), [src/vs/workbench/contrib/debug/browser/debugService.ts:352-449]()\n\n### ConfigurationManager\n\nThe `ConfigurationManager` handles debug configurations from `launch.json` files and dynamic configuration providers.\n\n```mermaid\ngraph TB\n    ConfigurationManager --\u003e getLaunches[\"getLaunches()\"]\n    ConfigurationManager --\u003e resolveConfigurationByProviders[\"resolveConfigurationByProviders()\"]\n    ConfigurationManager --\u003e selectedConfiguration[\"selectedConfiguration\"]\n    \n    getLaunches --\u003e Launch1[\"Launch (workspace 1)\"]\n    getLaunches --\u003e Launch2[\"Launch (workspace 2)\"]\n    \n    Launch1 --\u003e Config1[\"Configuration 1\"]\n    Launch1 --\u003e Config2[\"Configuration 2\"]\n    Launch2 --\u003e Config3[\"Configuration 3\"]\n    \n    resolveConfigurationByProviders --\u003e IDebugConfigurationProvider1[\"IDebugConfigurationProvider\"]\n    resolveConfigurationByProviders --\u003e IDebugConfigurationProvider2[\"IDebugConfigurationProvider\"]\n```\n\nSources: [src/vs/workbench/contrib/debug/browser/debugConfigurationManager.ts:52-95](), [src/vs/workbench/contrib/debug/browser/debugConfigurationManager.ts:127-151]()\n\n## Debug Sessions and Protocol\n\n### Session Hierarchy\n\n```mermaid\ngraph TB\n    subgraph \"Session Architecture\"\n        IDebugSession[\"IDebugSession (interface)\"]\n        DebugSession[\"DebugSession (implementation)\"]\n        RawDebugSession[\"RawDebugSession\"]\n        IDebugAdapter[\"IDebugAdapter\"]\n    end\n    \n    subgraph \"Session Data\"\n        configuration[\"configuration: IConfig\"]\n        state[\"state: State\"]\n        capabilities[\"capabilities: DebugProtocol.Capabilities\"]\n        threads[\"threads: Map\u003cnumber, Thread\u003e\"]\n    end\n    \n    subgraph \"DAP Events\"\n        onDidStop[\"onDidStop\"]\n        onDidContinued[\"onDidContinued\"]\n        onDidThread[\"onDidThread\"]\n        onDidOutput[\"onDidOutput\"]\n    end\n    \n    IDebugSession --\u003e DebugSession\n    DebugSession --\u003e RawDebugSession\n    RawDebugSession --\u003e IDebugAdapter\n    \n    DebugSession --\u003e configuration\n    DebugSession --\u003e state\n    DebugSession --\u003e capabilities\n    DebugSession --\u003e threads\n    \n    RawDebugSession --\u003e onDidStop\n    RawDebugSession --\u003e onDidContinued\n    RawDebugSession --\u003e onDidThread\n    RawDebugSession --\u003e onDidOutput\n```\n\nThe `DebugSession` class manages individual debugging sessions and wraps the `RawDebugSession` which handles the Debug Adapter Protocol communication.\n\nKey session methods:\n- **Control Operations**: `continue()`, `pause()`, `stepIn()`, `stepOut()`, `stepOver()`\n- **Breakpoint Management**: `sendBreakpoints()`, `sendFunctionBreakpoints()`, `sendDataBreakpoints()`\n- **Evaluation**: `evaluate()`, `variables()`, `stackTrace()`\n\nSources: [src/vs/workbench/contrib/debug/browser/debugSession.ts:372-487](), [src/vs/workbench/contrib/debug/browser/rawDebugSession.ts:42-68]()\n\n## Data Model\n\n### DebugModel Structure\n\n```mermaid\ngraph TB\n    subgraph \"DebugModel Components\"\n        DebugModel[\"DebugModel\"]\n        Sessions[\"sessions: IDebugSession[]\"]\n        Breakpoints[\"breakpoints: Breakpoint[]\"] \n        FunctionBreakpoints[\"functionBreakpoints: FunctionBreakpoint[]\"]\n        DataBreakpoints[\"dataBreakpoints: DataBreakpoint[]\"]\n        ExceptionBreakpoints[\"exceptionBreakpoints: ExceptionBreakpoint[]\"]\n    end\n    \n    subgraph \"Session Hierarchy\"\n        Session[\"DebugSession\"]\n        Threads[\"threads: Thread[]\"]\n        StackFrames[\"stackFrames: StackFrame[]\"]\n        Scopes[\"scopes: Scope[]\"]\n        Variables[\"variables: Variable[]\"]\n    end\n    \n    DebugModel --\u003e Sessions\n    DebugModel --\u003e Breakpoints\n    DebugModel --\u003e FunctionBreakpoints\n    DebugModel --\u003e DataBreakpoints\n    DebugModel --\u003e ExceptionBreakpoints\n    \n    Sessions --\u003e Session\n    Session --\u003e Threads\n    Threads --\u003e StackFrames\n    StackFrames --\u003e Scopes\n    Scopes --\u003e Variables\n```\n\nThe model provides a hierarchical view of debugging data:\n- **Breakpoints**: Line breakpoints with conditions, hit counts, and log messages\n- **Function Breakpoints**: Breakpoints on function names  \n- **Data Breakpoints**: Watchpoints on variable values\n- **Call Stack**: Thread → StackFrame → Scope → Variable hierarchy\n\nSources: [src/vs/workbench/contrib/debug/common/debugModel.ts:1089-1150](), [src/vs/workbench/contrib/debug/common/debugModel.ts:37-240]()\n\n## UI Components\n\n### Debug Views Integration\n\n```mermaid\ngraph TB\n    subgraph \"Debug Viewlet (VIEWLET_ID)\"\n        ViewletContainer[\"DebugViewPaneContainer\"]\n        \n        subgraph \"Views\"\n            CallStackView[\"CallStackView (CALLSTACK_VIEW_ID)\"]\n            VariablesView[\"VariablesView (VARIABLES_VIEW_ID)\"]\n            WatchView[\"WatchExpressionsView (WATCH_VIEW_ID)\"]\n            BreakpointsView[\"BreakpointsView (BREAKPOINTS_VIEW_ID)\"]\n            LoadedScriptsView[\"LoadedScriptsView (LOADED_SCRIPTS_VIEW_ID)\"]\n        end\n        \n        DebugToolBar[\"DebugToolBar\"]\n    end\n    \n    subgraph \"Panel\"\n        ReplView[\"Repl (REPL_VIEW_ID)\"]\n    end\n    \n    subgraph \"Editor Integration\"\n        DebugEditorContribution[\"DebugEditorContribution\"]\n        BreakpointEditorContribution[\"BreakpointEditorContribution\"]\n        InlineValues[\"Inline Values\"]\n        DebugHover[\"Debug Hover\"]\n    end\n    \n    ViewletContainer --\u003e CallStackView\n    ViewletContainer --\u003e VariablesView\n    ViewletContainer --\u003e WatchView\n    ViewletContainer --\u003e BreakpointsView\n    ViewletContainer --\u003e LoadedScriptsView\n    ViewletContainer --\u003e DebugToolBar\n```\n\n### Call Stack View\n\nThe `CallStackView` displays the current execution state with sessions, threads, and stack frames in a tree structure.\n\nKey features:\n- **Multi-session Support**: Shows multiple debug sessions simultaneously\n- **Thread Management**: Displays all threads per session with their states\n- **Stack Frame Navigation**: Clicking stack frames changes editor focus\n- **Compression**: Uses `CallStackCompressionDelegate` to group similar items\n\nSources: [src/vs/workbench/contrib/debug/browser/callStackView.ts:135-213](), [src/vs/workbench/contrib/debug/browser/callStackView.ts:287-331]()\n\n### Variables View\n\nThe `VariablesView` shows variable values in the current scope using a tree structure with lazy loading.\n\n```mermaid\ngraph LR\n    subgraph \"Variable Hierarchy\"\n        StackFrame[\"StackFrame\"]\n        Scopes[\"Scope[]\"]\n        Variables[\"Variable[]\"]\n        ChildVars[\"Child Variables\"]\n    end\n    \n    StackFrame --\u003e Scopes\n    Scopes --\u003e Variables\n    Variables --\u003e ChildVars\n    \n    subgraph \"Features\"\n        LazyLoading[\"Lazy Loading\"]\n        SetValue[\"Set Value\"]\n        CopyValue[\"Copy Value\"]\n        AddToWatch[\"Add to Watch\"]\n    end\n```\n\nSources: [src/vs/workbench/contrib/debug/browser/variablesView.ts:87-142]()\n\n### REPL (Read-Eval-Print Loop)\n\nThe `Repl` component provides an interactive console for expression evaluation during debugging.\n\nKey capabilities:\n- **Expression Evaluation**: Evaluate arbitrary expressions in the current context\n- **Command History**: Navigate through previous commands using arrow keys\n- **Auto-completion**: IntelliSense support for variables and functions\n- **Multi-session Support**: Switch between different debug session REPLs\n\nSources: [src/vs/workbench/contrib/debug/browser/repl.ts:95-168](), [src/vs/workbench/contrib/debug/browser/repl.ts:255-325]()\n\n## Editor Integration\n\n### Breakpoint Management\n\n```mermaid\ngraph TB\n    subgraph \"Breakpoint Editor Integration\"\n        BreakpointEditorContribution[\"BreakpointEditorContribution\"]\n        BreakpointWidget[\"BreakpointWidget\"]\n        BreakpointDecorations[\"Breakpoint Decorations\"]\n    end\n    \n    subgraph \"Breakpoint Types\"\n        LineBreakpoint[\"Line Breakpoint\"]\n        ConditionalBreakpoint[\"Conditional Breakpoint\"]\n        LogPoint[\"Log Point\"]\n        InlineBreakpoint[\"Inline Breakpoint\"]\n    end\n    \n    BreakpointEditorContribution --\u003e BreakpointWidget\n    BreakpointEditorContribution --\u003e BreakpointDecorations\n    \n    BreakpointWidget --\u003e LineBreakpoint\n    BreakpointWidget --\u003e ConditionalBreakpoint\n    BreakpointWidget --\u003e LogPoint\n    BreakpointWidget --\u003e InlineBreakpoint\n```\n\nThe `BreakpointEditorContribution` manages breakpoint visualization and interaction in editors:\n- **Gutter Decorations**: Shows breakpoint icons in the editor gutter\n- **Hover Messages**: Displays breakpoint status and conditions on hover\n- **Inline Widgets**: Provides UI for conditional breakpoints and log points\n- **Context Menus**: Right-click options for breakpoint management\n\nSources: [src/vs/workbench/contrib/debug/browser/breakpointEditorContribution.ts:61-81](), [src/vs/workbench/contrib/debug/browser/breakpointEditorContribution.ts:680-750]()\n\n### Debug Hover and Inline Values\n\nThe `DebugEditorContribution` provides runtime value display during debugging:\n- **Variable Hover**: Shows variable values when hovering over identifiers\n- **Inline Values**: Displays variable values inline at the end of lines\n- **Expression Evaluation**: Evaluates selected expressions in hover\n\nSources: [src/vs/workbench/contrib/debug/browser/debugEditorContribution.ts:70-99](), [src/vs/workbench/contrib/debug/browser/debugHover.ts:1-50]()\n\n## Data Flow and Communication\n\n### Debug Session Lifecycle\n\n```mermaid\nsequenceDiagram\n    participant User\n    participant DebugService\n    participant ConfigManager\n    participant DebugSession\n    participant RawDebugSession\n    participant DebugAdapter\n    \n    User-\u003e\u003eDebugService: startDebugging()\n    DebugService-\u003e\u003eConfigManager: resolveConfiguration()\n    ConfigManager--\u003e\u003eDebugService: resolved config\n    DebugService-\u003e\u003eDebugSession: createSession()\n    DebugSession-\u003e\u003eRawDebugSession: initialize()\n    RawDebugSession-\u003e\u003eDebugAdapter: initialize request\n    DebugAdapter--\u003e\u003eRawDebugSession: initialized event\n    RawDebugSession-\u003e\u003eDebugAdapter: launch/attach request\n    DebugAdapter--\u003e\u003eRawDebugSession: DAP events\n    RawDebugSession--\u003e\u003eDebugSession: processed events\n    DebugSession--\u003e\u003eDebugService: session events\n    DebugService--\u003e\u003eUser: UI updates\n```\n\nSources: [src/vs/workbench/contrib/debug/browser/debugService.ts:352-449](), [src/vs/workbench/contrib/debug/browser/debugSession.ts:339-404]()\n\nThe debugging system provides a comprehensive, extensible platform for debugging various programming languages through a unified interface. It separates concerns between protocol handling, session management, data modeling, and user interface components while maintaining tight integration with VS Code's editor and extension systems."])</script>
    <script>self.__next_f.push([1, "2b:T4653,"])</script>
    <script>self.__next_f.push([1, "# Debug Service and Protocol\n\n\u003cdetails\u003e\n\u003csummary\u003eRelevant source files\u003c/summary\u003e\n\nThe following files were used as context for generating this wiki page:\n\n- [src/vs/editor/contrib/hover/browser/glyphHoverWidget.ts](src/vs/editor/contrib/hover/browser/glyphHoverWidget.ts)\n- [src/vs/workbench/api/browser/mainThreadDebugService.ts](src/vs/workbench/api/browser/mainThreadDebugService.ts)\n- [src/vs/workbench/api/common/extHostDebugService.ts](src/vs/workbench/api/common/extHostDebugService.ts)\n- [src/vs/workbench/contrib/debug/browser/baseDebugView.ts](src/vs/workbench/contrib/debug/browser/baseDebugView.ts)\n- [src/vs/workbench/contrib/debug/browser/breakpointEditorContribution.ts](src/vs/workbench/contrib/debug/browser/breakpointEditorContribution.ts)\n- [src/vs/workbench/contrib/debug/browser/breakpointWidget.ts](src/vs/workbench/contrib/debug/browser/breakpointWidget.ts)\n- [src/vs/workbench/contrib/debug/browser/breakpointsView.ts](src/vs/workbench/contrib/debug/browser/breakpointsView.ts)\n- [src/vs/workbench/contrib/debug/browser/callStackEditorContribution.ts](src/vs/workbench/contrib/debug/browser/callStackEditorContribution.ts)\n- [src/vs/workbench/contrib/debug/browser/callStackView.ts](src/vs/workbench/contrib/debug/browser/callStackView.ts)\n- [src/vs/workbench/contrib/debug/browser/debug.contribution.ts](src/vs/workbench/contrib/debug/browser/debug.contribution.ts)\n- [src/vs/workbench/contrib/debug/browser/debugActionViewItems.ts](src/vs/workbench/contrib/debug/browser/debugActionViewItems.ts)\n- [src/vs/workbench/contrib/debug/browser/debugCommands.ts](src/vs/workbench/contrib/debug/browser/debugCommands.ts)\n- [src/vs/workbench/contrib/debug/browser/debugConfigurationManager.ts](src/vs/workbench/contrib/debug/browser/debugConfigurationManager.ts)\n- [src/vs/workbench/contrib/debug/browser/debugEditorActions.ts](src/vs/workbench/contrib/debug/browser/debugEditorActions.ts)\n- [src/vs/workbench/contrib/debug/browser/debugEditorContribution.ts](src/vs/workbench/contrib/debug/browser/debugEditorContribution.ts)\n- [src/vs/workbench/contrib/debug/browser/debugHover.ts](src/vs/workbench/contrib/debug/browser/debugHover.ts)\n- [src/vs/workbench/contrib/debug/browser/debugService.ts](src/vs/workbench/contrib/debug/browser/debugService.ts)\n- [src/vs/workbench/contrib/debug/browser/debugSession.ts](src/vs/workbench/contrib/debug/browser/debugSession.ts)\n- [src/vs/workbench/contrib/debug/browser/debugToolBar.ts](src/vs/workbench/contrib/debug/browser/debugToolBar.ts)\n- [src/vs/workbench/contrib/debug/browser/debugViewlet.ts](src/vs/workbench/contrib/debug/browser/debugViewlet.ts)\n- [src/vs/workbench/contrib/debug/browser/disassemblyView.ts](src/vs/workbench/contrib/debug/browser/disassemblyView.ts)\n- [src/vs/workbench/contrib/debug/browser/exceptionWidget.ts](src/vs/workbench/contrib/debug/browser/exceptionWidget.ts)\n- [src/vs/workbench/contrib/debug/browser/loadedScriptsView.ts](src/vs/workbench/contrib/debug/browser/loadedScriptsView.ts)\n- [src/vs/workbench/contrib/debug/browser/media/breakpointWidget.css](src/vs/workbench/contrib/debug/browser/media/breakpointWidget.css)\n- [src/vs/workbench/contrib/debug/browser/media/callStackEditorContribution.css](src/vs/workbench/contrib/debug/browser/media/callStackEditorContribution.css)\n- [src/vs/workbench/contrib/debug/browser/media/debug.contribution.css](src/vs/workbench/contrib/debug/browser/media/debug.contribution.css)\n- [src/vs/workbench/contrib/debug/browser/media/debugHover.css](src/vs/workbench/contrib/debug/browser/media/debugHover.css)\n- [src/vs/workbench/contrib/debug/browser/media/debugToolBar.css](src/vs/workbench/contrib/debug/browser/media/debugToolBar.css)\n- [src/vs/workbench/contrib/debug/browser/media/debugViewlet.css](src/vs/workbench/contrib/debug/browser/media/debugViewlet.css)\n- [src/vs/workbench/contrib/debug/browser/media/exceptionWidget.css](src/vs/workbench/contrib/debug/browser/media/exceptionWidget.css)\n- [src/vs/workbench/contrib/debug/browser/media/repl.css](src/vs/workbench/contrib/debug/browser/media/repl.css)\n- [src/vs/workbench/contrib/debug/browser/rawDebugSession.ts](src/vs/workbench/contrib/debug/browser/rawDebugSession.ts)\n- [src/vs/workbench/contrib/debug/browser/repl.ts](src/vs/workbench/contrib/debug/browser/repl.ts)\n- [src/vs/workbench/contrib/debug/browser/replFilter.ts](src/vs/workbench/contrib/debug/browser/replFilter.ts)\n- [src/vs/workbench/contrib/debug/browser/replViewer.ts](src/vs/workbench/contrib/debug/browser/replViewer.ts)\n- [src/vs/workbench/contrib/debug/browser/variablesView.ts](src/vs/workbench/contrib/debug/browser/variablesView.ts)\n- [src/vs/workbench/contrib/debug/browser/watchExpressionsView.ts](src/vs/workbench/contrib/debug/browser/watchExpressionsView.ts)\n- [src/vs/workbench/contrib/debug/common/debug.ts](src/vs/workbench/contrib/debug/common/debug.ts)\n- [src/vs/workbench/contrib/debug/common/debugModel.ts](src/vs/workbench/contrib/debug/common/debugModel.ts)\n- [src/vs/workbench/contrib/debug/common/debugStorage.ts](src/vs/workbench/contrib/debug/common/debugStorage.ts)\n- [src/vs/workbench/contrib/debug/common/debugViewModel.ts](src/vs/workbench/contrib/debug/common/debugViewModel.ts)\n- [src/vs/workbench/contrib/debug/common/replModel.ts](src/vs/workbench/contrib/debug/common/replModel.ts)\n- [src/vs/workbench/contrib/debug/test/browser/baseDebugView.test.ts](src/vs/workbench/contrib/debug/test/browser/baseDebugView.test.ts)\n- [src/vs/workbench/contrib/debug/test/browser/breakpoints.test.ts](src/vs/workbench/contrib/debug/test/browser/breakpoints.test.ts)\n- [src/vs/workbench/contrib/debug/test/browser/callStack.test.ts](src/vs/workbench/contrib/debug/test/browser/callStack.test.ts)\n- [src/vs/workbench/contrib/debug/test/browser/debugHover.test.ts](src/vs/workbench/contrib/debug/test/browser/debugHover.test.ts)\n- [src/vs/workbench/contrib/debug/test/browser/debugSource.test.ts](src/vs/workbench/contrib/debug/test/browser/debugSource.test.ts)\n- [src/vs/workbench/contrib/debug/test/browser/debugViewModel.test.ts](src/vs/workbench/contrib/debug/test/browser/debugViewModel.test.ts)\n- [src/vs/workbench/contrib/debug/test/browser/mockDebugModel.ts](src/vs/workbench/contrib/debug/test/browser/mockDebugModel.ts)\n- [src/vs/workbench/contrib/debug/test/browser/rawDebugSession.test.ts](src/vs/workbench/contrib/debug/test/browser/rawDebugSession.test.ts)\n- [src/vs/workbench/contrib/debug/test/browser/repl.test.ts](src/vs/workbench/contrib/debug/test/browser/repl.test.ts)\n- [src/vs/workbench/contrib/debug/test/browser/watch.test.ts](src/vs/workbench/contrib/debug/test/browser/watch.test.ts)\n- [src/vs/workbench/contrib/debug/test/common/debugModel.test.ts](src/vs/workbench/contrib/debug/test/common/debugModel.test.ts)\n- [src/vs/workbench/contrib/debug/test/common/mockDebug.ts](src/vs/workbench/contrib/debug/test/common/mockDebug.ts)\n- [src/vs/workbench/contrib/files/browser/views/emptyView.ts](src/vs/workbench/contrib/files/browser/views/emptyView.ts)\n- [src/vs/workbench/contrib/files/browser/views/openEditorsView.ts](src/vs/workbench/contrib/files/browser/views/openEditorsView.ts)\n\n\u003c/details\u003e\n\n\n\nThe Debug Service and Protocol system provides VS Code's debugging infrastructure, implementing the Debug Adapter Protocol (DAP) to communicate with debug adapters and managing the complete debugging experience from UI to adapter communication.\n\nThis document covers the core debug service architecture, DAP implementation, and session management. For information about specific debug views and UI components, see the individual view documentation. For extension API related to debugging, see the Extension API documentation.\n\n## Architecture Overview\n\nThe debug system is built around a layered architecture that separates protocol handling, session management, and UI concerns:\n\n```mermaid\ngraph TB\n    subgraph \"UI Layer\"\n        CallStackView[\"CallStackView\"]\n        VariablesView[\"VariablesView\"] \n        BreakpointsView[\"BreakpointsView\"]\n        WatchView[\"WatchExpressionsView\"]\n        ReplView[\"Repl\"]\n    end\n    \n    subgraph \"Service Layer\"\n        DebugService[\"DebugService\"]\n        ConfigMgr[\"ConfigurationManager\"]\n        AdapterMgr[\"AdapterManager\"]\n    end\n    \n    subgraph \"Session Layer\"\n        DebugSession[\"DebugSession\"]\n        RawDebugSession[\"RawDebugSession\"]\n        DebugModel[\"DebugModel\"]\n    end\n    \n    subgraph \"Protocol Layer\"\n        DebugAdapter[\"IDebugAdapter\"]\n        DAP[\"Debug Adapter Protocol\"]\n    end\n    \n    CallStackView --\u003e DebugService\n    VariablesView --\u003e DebugService\n    BreakpointsView --\u003e DebugService\n    WatchView --\u003e DebugService\n    ReplView --\u003e DebugService\n    \n    DebugService --\u003e ConfigMgr\n    DebugService --\u003e AdapterMgr\n    DebugService --\u003e DebugSession\n    \n    DebugSession --\u003e RawDebugSession\n    DebugSession --\u003e DebugModel\n    \n    RawDebugSession --\u003e DebugAdapter\n    DebugAdapter --\u003e DAP\n```\n\nSources: [src/vs/workbench/contrib/debug/common/debug.ts:1-1000](), [src/vs/workbench/contrib/debug/browser/debugService.ts:1-100](), [src/vs/workbench/contrib/debug/browser/debugSession.ts:1-100]()\n\n## Core Debug Service\n\nThe `DebugService` class serves as the central coordinator for all debugging activities, implementing the `IDebugService` interface:\n\n### Key Service Responsibilities\n\n| Component | Responsibility |\n|-----------|---------------|\n| Session Management | Creating, tracking, and terminating debug sessions |\n| Breakpoint Management | Managing breakpoints across sessions and files |\n| Configuration Handling | Loading and resolving launch configurations |\n| State Management | Tracking debug state and notifying consumers |\n| Adapter Coordination | Working with debug adapters through the adapter manager |\n\n### Debug Service State Management\n\n```mermaid\nstateDiagram-v2\n    [*] --\u003e Inactive\n    Inactive --\u003e Initializing : startDebugging()\n    Initializing --\u003e Running : session.launch()\n    Running --\u003e Stopped : breakpoint hit\n    Stopped --\u003e Running : continue()\n    Running --\u003e Inactive : terminate()\n    Stopped --\u003e Inactive : terminate()\n    Initializing --\u003e Inactive : launch failure\n```\n\nSources: [src/vs/workbench/contrib/debug/browser/debugService.ts:62-300](), [src/vs/workbench/contrib/debug/common/debug.ts:203-217]()\n\n### Service Interface Structure\n\nThe `IDebugService` provides these key operations:\n\n```typescript\ninterface IDebugService {\n    // Session management\n    startDebugging(launch: ILaunch, config: IConfig, options?: IDebugSessionOptions): Promise\u003cboolean\u003e\n    \n    // State access\n    getModel(): IDebugModel\n    getViewModel(): IViewModel\n    get state(): State\n    \n    // Event handling\n    onDidChangeState: Event\u003cState\u003e\n    onDidNewSession: Event\u003cIDebugSession\u003e\n    onDidEndSession: Event\u003c{ session: IDebugSession; restart: boolean }\u003e\n}\n```\n\nSources: [src/vs/workbench/contrib/debug/common/debug.ts:1070-1150]()\n\n## Debug Session Management\n\n### Session Lifecycle\n\nDebug sessions follow a well-defined lifecycle managed by the `DebugSession` class:\n\n```mermaid\nsequenceSequence\n    participant DS as \"DebugService\"\n    participant Session as \"DebugSession\" \n    participant Raw as \"RawDebugSession\"\n    participant Adapter as \"DebugAdapter\"\n    \n    DS-\u003e\u003eSession: createSession()\n    Session-\u003e\u003eRaw: initialize()\n    Raw-\u003e\u003eAdapter: initialize request\n    Adapter--\u003e\u003eRaw: initialize response\n    Raw--\u003e\u003eSession: initialized event\n    Session-\u003e\u003eRaw: launchOrAttach()\n    Raw-\u003e\u003eAdapter: launch/attach request\n    Adapter--\u003e\u003eRaw: launch/attach response\n    Raw--\u003e\u003eSession: process events\n    Session--\u003e\u003eDS: state changes\n```\n\n### Session Types and Options\n\nThe debug system supports various session configurations through `IDebugSessionOptions`:\n\n| Option | Purpose |\n|--------|---------|\n| `noDebug` | Run without debugging capabilities |\n| `parentSession` | Link to parent session for multi-session debugging |\n| `compact` | Reduced UI footprint |\n| `suppressDebugToolbar` | Hide debug toolbar |\n| `testRun` | Associate with test execution |\n\nSources: [src/vs/workbench/contrib/debug/browser/debugSession.ts:53-188](), [src/vs/workbench/contrib/debug/common/debug.ts:237-254]()\n\n## Debug Adapter Protocol Implementation\n\n### RawDebugSession Protocol Handling\n\nThe `RawDebugSession` class implements the actual DAP communication:\n\n```mermaid\ngraph LR\n    subgraph \"VS Code Process\"\n        RawSession[\"RawDebugSession\"]\n        Adapter[\"IDebugAdapter\"]\n    end\n    \n    subgraph \"Debug Adapter Process\"\n        DAImpl[\"Debug Adapter Implementation\"]\n    end\n    \n    RawSession --\u003e|\"DAP Requests\"| Adapter\n    Adapter --\u003e|\"stdio/socket\"| DAImpl\n    DAImpl --\u003e|\"DAP Events\"| Adapter  \n    Adapter --\u003e|\"DAP Responses\"| RawSession\n```\n\n### Key DAP Message Types\n\nThe protocol implementation handles these essential message categories:\n\n| Message Type | Examples | Handler |\n|--------------|----------|---------|\n| Requests | `initialize`, `launch`, `setBreakpoints` | Request/response pattern |\n| Events | `stopped`, `continued`, `terminated` | Event emission |\n| Responses | Success/error responses | Promise resolution |\n\n### Protocol Event Flow\n\n```mermaid\nsequenceSequence\n    participant UI as \"Debug UI\"\n    participant Session as \"DebugSession\"\n    participant Raw as \"RawDebugSession\"\n    participant Adapter as \"Debug Adapter\"\n    \n    UI-\u003e\u003eSession: continue()\n    Session-\u003e\u003eRaw: continue(threadId)\n    Raw-\u003e\u003eAdapter: continue request\n    Adapter--\u003e\u003eRaw: continue response\n    Raw--\u003e\u003eSession: continued event\n    Session--\u003e\u003eUI: state update\n    \n    Note over Adapter: Program hits breakpoint\n    Adapter--\u003e\u003eRaw: stopped event\n    Raw--\u003e\u003eSession: stopped event\n    Session--\u003e\u003eUI: stopped state\n```\n\nSources: [src/vs/workbench/contrib/debug/browser/rawDebugSession.ts:42-200](), [src/vs/workbench/contrib/debug/browser/debugSession.ts:335-500]()\n\n## Configuration and Adapter Management\n\n### Configuration Manager Role\n\nThe `ConfigurationManager` handles launch configuration resolution and debug configuration providers:\n\n```mermaid\ngraph TB\n    subgraph \"Configuration Sources\"\n        LaunchJson[\"launch.json\"]\n        DynamicProviders[\"Dynamic Config Providers\"]\n        UserSettings[\"User Settings\"]\n    end\n    \n    subgraph \"ConfigurationManager\"\n        Resolver[\"Configuration Resolver\"]\n        ProviderRegistry[\"Provider Registry\"] \n        VariableSubstitution[\"Variable Substitution\"]\n    end\n    \n    subgraph \"Output\"\n        ResolvedConfig[\"Resolved IConfig\"]\n    end\n    \n    LaunchJson --\u003e Resolver\n    DynamicProviders --\u003e ProviderRegistry\n    UserSettings --\u003e Resolver\n    \n    Resolver --\u003e VariableSubstitution\n    ProviderRegistry --\u003e VariableSubstitution\n    VariableSubstitution --\u003e ResolvedConfig\n```\n\n### Adapter Manager Responsibilities\n\nThe `AdapterManager` coordinates with debug adapters and extension contributions:\n\n| Function | Description |\n|----------|-------------|\n| Adapter Registration | Managing debug adapter contributions from extensions |\n| Debugger Activation | Activating debugger extensions when needed |\n| Adapter Creation | Creating appropriate debug adapter instances |\n| Capability Management | Tracking adapter capabilities and features |\n\nSources: [src/vs/workbench/contrib/debug/browser/debugConfigurationManager.ts:52-150](), [src/vs/workbench/contrib/debug/browser/debugAdapterManager.ts:1-100]()\n\n## Debug Model and Data Flow\n\n### Debug Model Structure\n\nThe debug model provides a structured representation of debugging state:\n\n```mermaid\ngraph TB\n    subgraph \"DebugModel\"\n        Sessions[\"Sessions[]\"]\n        Breakpoints[\"Breakpoints[]\"]\n        FunctionBPs[\"FunctionBreakpoints[]\"] \n        DataBPs[\"DataBreakpoints[]\"]\n        ExceptionBPs[\"ExceptionBreakpoints[]\"]\n        WatchExpressions[\"WatchExpressions[]\"]\n    end\n    \n    subgraph \"Session Data\"\n        Threads[\"Threads[]\"]\n        StackFrames[\"StackFrames[]\"]\n        Variables[\"Variables[]\"]\n        Sources[\"Sources[]\"]\n    end\n    \n    Sessions --\u003e Threads\n    Threads --\u003e StackFrames\n    StackFrames --\u003e Variables\n    StackFrames --\u003e Sources\n```\n\n### Expression Evaluation Flow\n\nVariable and expression evaluation follows this pattern:\n\n```mermaid\nsequenceSequence\n    participant UI as \"Variables View\"\n    participant Container as \"ExpressionContainer\"\n    participant Session as \"DebugSession\"\n    participant Raw as \"RawDebugSession\"\n    participant Adapter as \"Debug Adapter\"\n    \n    UI-\u003e\u003eContainer: getChildren()\n    Container-\u003e\u003eSession: variables(variablesReference)\n    Session-\u003e\u003eRaw: variables request\n    Raw-\u003e\u003eAdapter: variables request\n    Adapter--\u003e\u003eRaw: variables response\n    Raw--\u003e\u003eSession: variables response\n    Session--\u003e\u003eContainer: Variable[]\n    Container--\u003e\u003eUI: IExpression[]\n```\n\nSources: [src/vs/workbench/contrib/debug/common/debugModel.ts:1-100](), [src/vs/workbench/contrib/debug/common/debugModel.ts:37-240]()\n\n## Integration Points\n\n### Context Key Management\n\nThe debug system extensively uses context keys for UI state management:\n\n| Context Key | Purpose |\n|-------------|---------|\n| `CONTEXT_IN_DEBUG_MODE` | Whether any debug session is active |\n| `CONTEXT_DEBUG_STATE` | Current debug state (inactive/running/stopped) |\n| `CONTEXT_BREAKPOINTS_EXIST` | Whether any breakpoints are set |\n| `CONTEXT_VARIABLES_FOCUSED` | Variables view has focus |\n\n### Extension API Integration\n\nExtensions interact with the debug system through:\n\n- `vscode.debug` API for programmatic debugging\n- Debug configuration providers for dynamic configurations  \n- Debug adapter factories for custom adapters\n- Debug visualizers for custom variable displays\n\n### Event System\n\nThe debug service publishes key events that drive UI updates:\n\n```mermaid\ngraph LR\n    DebugService --\u003e|\"onDidChangeState\"| Views\n    DebugSession --\u003e|\"onDidChangeReplElements\"| ReplView\n    DebugModel --\u003e|\"onDidChangeBreakpoints\"| BreakpointsView\n    DebugModel --\u003e|\"onDidChangeCallStack\"| CallStackView\n```\n\nSources: [src/vs/workbench/contrib/debug/common/debug.ts:44-108](), [src/vs/workbench/contrib/debug/browser/debugService.ts:319-335]()"])</script>
    <script>self.__next_f.push([1, "2c:T386b,"])</script>
    <script>self.__next_f.push([1, "# Task System\n\n\u003cdetails\u003e\n\u003csummary\u003eRelevant source files\u003c/summary\u003e\n\nThe following files were used as context for generating this wiki page:\n\n- [extensions/vscode-api-tests/src/singlefolder-tests/terminal.test.ts](extensions/vscode-api-tests/src/singlefolder-tests/terminal.test.ts)\n- [extensions/vscode-api-tests/src/singlefolder-tests/workspace.tasks.test.ts](extensions/vscode-api-tests/src/singlefolder-tests/workspace.tasks.test.ts)\n- [src/vs/workbench/api/browser/mainThreadTask.ts](src/vs/workbench/api/browser/mainThreadTask.ts)\n- [src/vs/workbench/api/common/extHostTask.ts](src/vs/workbench/api/common/extHostTask.ts)\n- [src/vs/workbench/api/common/shared/tasks.ts](src/vs/workbench/api/common/shared/tasks.ts)\n- [src/vs/workbench/api/node/extHostTask.ts](src/vs/workbench/api/node/extHostTask.ts)\n- [src/vs/workbench/contrib/tasks/browser/abstractTaskService.ts](src/vs/workbench/contrib/tasks/browser/abstractTaskService.ts)\n- [src/vs/workbench/contrib/tasks/browser/runAutomaticTasks.ts](src/vs/workbench/contrib/tasks/browser/runAutomaticTasks.ts)\n- [src/vs/workbench/contrib/tasks/browser/task.contribution.ts](src/vs/workbench/contrib/tasks/browser/task.contribution.ts)\n- [src/vs/workbench/contrib/tasks/browser/taskQuickPick.ts](src/vs/workbench/contrib/tasks/browser/taskQuickPick.ts)\n- [src/vs/workbench/contrib/tasks/browser/taskService.ts](src/vs/workbench/contrib/tasks/browser/taskService.ts)\n- [src/vs/workbench/contrib/tasks/browser/taskTerminalStatus.ts](src/vs/workbench/contrib/tasks/browser/taskTerminalStatus.ts)\n- [src/vs/workbench/contrib/tasks/browser/terminalTaskSystem.ts](src/vs/workbench/contrib/tasks/browser/terminalTaskSystem.ts)\n- [src/vs/workbench/contrib/tasks/common/jsonSchema_v2.ts](src/vs/workbench/contrib/tasks/common/jsonSchema_v2.ts)\n- [src/vs/workbench/contrib/tasks/common/problemCollectors.ts](src/vs/workbench/contrib/tasks/common/problemCollectors.ts)\n- [src/vs/workbench/contrib/tasks/common/taskConfiguration.ts](src/vs/workbench/contrib/tasks/common/taskConfiguration.ts)\n- [src/vs/workbench/contrib/tasks/common/taskService.ts](src/vs/workbench/contrib/tasks/common/taskService.ts)\n- [src/vs/workbench/contrib/tasks/common/taskSystem.ts](src/vs/workbench/contrib/tasks/common/taskSystem.ts)\n- [src/vs/workbench/contrib/tasks/common/tasks.ts](src/vs/workbench/contrib/tasks/common/tasks.ts)\n- [src/vs/workbench/contrib/tasks/electron-browser/taskService.ts](src/vs/workbench/contrib/tasks/electron-browser/taskService.ts)\n- [src/vs/workbench/contrib/tasks/test/browser/taskTerminalStatus.test.ts](src/vs/workbench/contrib/tasks/test/browser/taskTerminalStatus.test.ts)\n\n\u003c/details\u003e\n\n\n\nThe Task System provides VS Code's capability to define, discover, execute, and manage automated tasks such as build scripts, test runners, and other development workflows. It handles task configuration through `tasks.json` files, task execution in integrated terminals, extension-provided tasks, and user interface for task selection and management.\n\nFor information about the integrated terminal that executes tasks, see [Integrated Terminal](#5). For details about extension APIs that interact with tasks, see [Extension System](#4).\n\n## Architecture Overview\n\nThe Task System follows VS Code's multi-process architecture with components distributed across the main process, renderer process, and extension host process.\n\n### Process Architecture\n\n```mermaid\ngraph TB\n    subgraph \"Main Process\"\n        MainThreadTask[\"MainThreadTask\u003cbr/\u003eRPC Handler\"]\n    end\n    \n    subgraph \"Renderer Process\"\n        AbstractTaskService[\"AbstractTaskService\u003cbr/\u003eCore Service\"]\n        TerminalTaskSystem[\"TerminalTaskSystem\u003cbr/\u003eExecution Engine\"]\n        TaskQuickPick[\"TaskQuickPick\u003cbr/\u003eUI Component\"]\n        TaskTerminalStatus[\"TaskTerminalStatus\u003cbr/\u003eStatus Manager\"]\n    end\n    \n    subgraph \"Extension Host Process\"\n        ExtHostTask[\"ExtHostTask\u003cbr/\u003eExtension API\"]\n        TaskProviders[\"TaskProvider[]\u003cbr/\u003eExtension Providers\"]\n    end\n    \n    subgraph \"Terminal Process\"\n        TaskTerminals[\"Task Terminals\u003cbr/\u003eProcess Execution\"]\n    end\n    \n    ExtHostTask \u003c-.-\u003e|\"RPC\"| MainThreadTask\n    MainThreadTask \u003c-.-\u003e|\"Service Calls\"| AbstractTaskService\n    AbstractTaskService --\u003e TerminalTaskSystem\n    AbstractTaskService --\u003e TaskQuickPick\n    TerminalTaskSystem --\u003e TaskTerminals\n    TerminalTaskSystem --\u003e TaskTerminalStatus\n    TaskProviders --\u003e ExtHostTask\n```\n\n**Sources:** [src/vs/workbench/contrib/tasks/browser/abstractTaskService.ts:197-396](), [src/vs/workbench/contrib/tasks/browser/terminalTaskSystem.ts:142-257](), [src/vs/workbench/api/common/extHostTask.ts:34-51](), [src/vs/workbench/api/browser/mainThreadTask.ts:1-42]()\n\n### Core Components\n\n| Component | Location | Purpose |\n|-----------|----------|---------|\n| `AbstractTaskService` | Renderer | Central task service managing task lifecycle, configuration, and coordination |\n| `TerminalTaskSystem` | Renderer | Executes tasks in integrated terminals, handles process management |\n| `TaskQuickPick` | Renderer | Provides UI for task selection and configuration |\n| `ExtHostTask` | Extension Host | Exposes task APIs to extensions and manages task providers |\n| `MainThreadTask` | Main Process | Handles RPC communication for task operations |\n\n**Sources:** [src/vs/workbench/contrib/tasks/browser/abstractTaskService.ts:197](), [src/vs/workbench/contrib/tasks/browser/terminalTaskSystem.ts:142](), [src/vs/workbench/contrib/tasks/browser/taskQuickPick.ts:49]()\n\n## Task Types and Execution\n\nThe Task System supports three main execution types, each with different capabilities and use cases.\n\n### Task Execution Types\n\n```mermaid\ngraph TB\n    Task[\"Task\u003cbr/\u003eBase Class\"]\n    \n    subgraph \"Execution Types\"\n        ShellExecution[\"ShellExecution\u003cbr/\u003eShell Commands\"]\n        ProcessExecution[\"ProcessExecution\u003cbr/\u003eDirect Process\"]\n        CustomExecution[\"CustomExecution\u003cbr/\u003eExtension Code\"]\n    end\n    \n    subgraph \"Task Sources\"\n        WorkspaceTask[\"Workspace Tasks\u003cbr/\u003etasks.json\"]\n        ExtensionTask[\"Extension Tasks\u003cbr/\u003eTaskProvider\"]\n        UserTask[\"User Tasks\u003cbr/\u003eGlobal Config\"]\n    end\n    \n    Task --\u003e ShellExecution\n    Task --\u003e ProcessExecution  \n    Task --\u003e CustomExecution\n    \n    WorkspaceTask --\u003e Task\n    ExtensionTask --\u003e Task\n    UserTask --\u003e Task\n    \n    ShellExecution --\u003e |\"Executes in\"| TerminalInstance[\"Terminal Instance\"]\n    ProcessExecution --\u003e |\"Executes in\"| TerminalInstance\n    CustomExecution --\u003e |\"Runs in\"| ExtensionHost[\"Extension Host\"]\n```\n\n**Sources:** [src/vs/workbench/contrib/tasks/common/tasks.ts:290-317](), [src/vs/workbench/contrib/tasks/common/tasks.ts:407-427]()\n\n### Task Configuration Properties\n\nTasks are configured with a standard set of properties that control their behavior and execution:\n\n```mermaid\ngraph LR\n    TaskConfig[\"Task Configuration\"]\n    \n    subgraph \"Core Properties\"\n        Label[\"label: string\"]\n        Type[\"type: string\"] \n        Command[\"command: CommandString\"]\n        Args[\"args: CommandString[]\"]\n    end\n    \n    subgraph \"Execution Control\"\n        Group[\"group: TaskGroup\"]\n        DependsOn[\"dependsOn: ITaskDependency[]\"]\n        IsBackground[\"isBackground: boolean\"]\n        ProblemMatchers[\"problemMatchers: ProblemMatcher[]\"]\n    end\n    \n    subgraph \"Presentation\"\n        Presentation[\"presentation: IPresentationOptions\"]\n        Icon[\"icon: {id: string, color?: string}\"]\n        Hide[\"hide: boolean\"]\n    end\n    \n    TaskConfig --\u003e Label\n    TaskConfig --\u003e Type\n    TaskConfig --\u003e Command\n    TaskConfig --\u003e Args\n    TaskConfig --\u003e Group\n    TaskConfig --\u003e DependsOn\n    TaskConfig --\u003e IsBackground\n    TaskConfig --\u003e ProblemMatchers\n    TaskConfig --\u003e Presentation\n    TaskConfig --\u003e Icon\n    TaskConfig --\u003e Hide\n```\n\n**Sources:** [src/vs/workbench/contrib/tasks/common/tasks.ts:497-626](), [src/vs/workbench/contrib/tasks/common/taskConfiguration.ts:290-371]()\n\n## Task Configuration and Discovery\n\nTasks are discovered from multiple sources and merged into a unified task registry for execution.\n\n### Task Discovery Flow\n\n```mermaid\nsequenceDiagram\n    participant UI as \"User Interface\"\n    participant ATS as \"AbstractTaskService\"\n    participant WSF as \"Workspace Folders\"\n    participant EXT as \"Extension Providers\"\n    participant TC as \"Task Configuration\"\n    \n    UI-\u003e\u003eATS: \"getWorkspaceTasks()\"\n    ATS-\u003e\u003eWSF: \"Scan tasks.json files\"\n    WSF--\u003e\u003eATS: \"Workspace tasks\"\n    ATS-\u003e\u003eEXT: \"Activate task providers\"\n    EXT--\u003e\u003eATS: \"Extension tasks\"\n    ATS-\u003e\u003eTC: \"Parse and validate\"\n    TC--\u003e\u003eATS: \"Configured tasks\"\n    ATS--\u003e\u003eUI: \"Merged task list\"\n```\n\n**Sources:** [src/vs/workbench/contrib/tasks/browser/abstractTaskService.ts:794-816](), [src/vs/workbench/contrib/tasks/browser/abstractTaskService.ts:630-646]()\n\n### Configuration Resolution\n\nThe task configuration system resolves tasks from multiple sources with a defined precedence:\n\n1. **Workspace Tasks** - Defined in `.vscode/tasks.json`\n2. **User Tasks** - Global user configuration  \n3. **Extension Tasks** - Provided by extensions via `TaskProvider`\n\n**Sources:** [src/vs/workbench/contrib/tasks/browser/abstractTaskService.ts:828-873](), [src/vs/workbench/contrib/tasks/common/taskConfiguration.ts:372-437]()\n\n## Task Execution Flow\n\nTask execution involves dependency resolution, variable substitution, terminal creation, and process management.\n\n### Execution Pipeline\n\n```mermaid\ngraph TB\n    StartExecution[\"Start Task Execution\"]\n    \n    subgraph \"Pre-Execution\"\n        ResolveDeps[\"Resolve Dependencies\u003cbr/\u003e_executeTask()\"]\n        ResolveVars[\"Resolve Variables\u003cbr/\u003e_resolveVariablesFromSet()\"]\n        CreateTerminal[\"Create Terminal\u003cbr/\u003e_createTerminal()\"]\n    end\n    \n    subgraph \"Execution\"\n        LaunchProcess[\"Launch Process\u003cbr/\u003eterminal.sendText()\"]\n        MonitorOutput[\"Monitor Output\u003cbr/\u003eProblemCollector\"]\n        TrackStatus[\"Track Status\u003cbr/\u003eTaskTerminalStatus\"]\n    end\n    \n    subgraph \"Post-Execution\"\n        FireEvents[\"Fire Task Events\u003cbr/\u003e_fireTaskEvent()\"]\n        CleanupResources[\"Cleanup Resources\u003cbr/\u003e_removeFromActiveTasks()\"]\n    end\n    \n    StartExecution --\u003e ResolveDeps\n    ResolveDeps --\u003e ResolveVars\n    ResolveVars --\u003e CreateTerminal\n    CreateTerminal --\u003e LaunchProcess\n    LaunchProcess --\u003e MonitorOutput\n    LaunchProcess --\u003e TrackStatus\n    MonitorOutput --\u003e FireEvents\n    TrackStatus --\u003e FireEvents\n    FireEvents --\u003e CleanupResources\n```\n\n**Sources:** [src/vs/workbench/contrib/tasks/browser/terminalTaskSystem.ts:276-308](), [src/vs/workbench/contrib/tasks/browser/terminalTaskSystem.ts:517-603](), [src/vs/workbench/contrib/tasks/browser/taskTerminalStatus.ts:40-67]()\n\n### Dependency Resolution\n\nTasks can depend on other tasks, which are resolved and executed according to the specified order:\n\n**Sequential Dependencies:**\n```typescript\n// Task B depends on Task A completing first\ndependsOrder: \"sequence\"\n```\n\n**Parallel Dependencies:**\n```typescript\n// Task B can start while Task A is running\ndependsOrder: \"parallel\"  \n```\n\n**Sources:** [src/vs/workbench/contrib/tasks/browser/terminalTaskSystem.ts:528-577](), [src/vs/workbench/contrib/tasks/common/tasks.ts:492-495]()\n\n## Extension Integration\n\nExtensions can provide tasks through the `TaskProvider` interface and handle custom execution logic.\n\n### Extension Task Provider Flow\n\n```mermaid\ngraph TB\n    Extension[\"Extension\"]\n    \n    subgraph \"Registration\"\n        RegisterProvider[\"tasks.registerTaskProvider()\u003cbr/\u003eExtHostTask\"]\n        TaskDefinition[\"TaskDefinition\u003cbr/\u003eContribution Point\"]\n    end\n    \n    subgraph \"Discovery\"\n        ProvideTasks[\"provideTasks()\u003cbr/\u003eTaskProvider.provideTasks()\"]\n        ResolveTask[\"resolveTask()\u003cbr/\u003eTaskProvider.resolveTask()\"]\n    end\n    \n    subgraph \"Execution\"\n        CustomExecution[\"CustomExecution\u003cbr/\u003ePseudoterminal\"]\n        ProcessExecution[\"Shell/Process\u003cbr/\u003eTerminal\"]\n    end\n    \n    Extension --\u003e RegisterProvider\n    Extension --\u003e TaskDefinition\n    RegisterProvider --\u003e ProvideTasks\n    TaskDefinition --\u003e ProvideTasks\n    ProvideTasks --\u003e ResolveTask\n    ResolveTask --\u003e CustomExecution\n    ResolveTask --\u003e ProcessExecution\n```\n\n**Sources:** [src/vs/workbench/api/common/extHostTask.ts:46-51](), [src/vs/workbench/contrib/tasks/browser/abstractTaskService.ts:727-744](), [src/vs/workbench/api/node/extHostTask.ts:29-56]()\n\n### Task Provider Implementation\n\nExtensions implement the `TaskProvider` interface to contribute tasks:\n\n```typescript\ninterface ITaskProvider {\n    provideTasks(validTypes: IStringDictionary\u003cboolean\u003e): Promise\u003cITaskSet\u003e;\n    resolveTask(task: ConfiguringTask): Promise\u003cContributedTask | undefined\u003e;\n}\n```\n\n**Sources:** [src/vs/workbench/contrib/tasks/common/taskService.ts:29-32](), [src/vs/workbench/api/common/extHostTask.ts:95-122]()\n\n## UI Components\n\nThe Task System provides several UI components for task interaction and management.\n\n### Task Quick Pick Interface\n\n```mermaid\ngraph TB\n    TaskQuickPick[\"TaskQuickPick\"]\n    \n    subgraph \"Task Categories\"\n        RecentTasks[\"Recently Used Tasks\u003cbr/\u003egetSavedTasks('historical')\"]\n        ConfiguredTasks[\"Configured Tasks\u003cbr/\u003egetWorkspaceTasks()\"]\n        ExtensionTypes[\"Extension Task Types\u003cbr/\u003etaskTypes()\"]\n    end\n    \n    subgraph \"Actions\"\n        RunTask[\"Run Task\u003cbr/\u003eexecuteTask()\"]\n        ConfigureTask[\"Configure Task\u003cbr/\u003ecustomize()\"]\n        RemoveRecent[\"Remove Recent\u003cbr/\u003eremoveRecentlyUsedTask()\"]\n    end\n    \n    TaskQuickPick --\u003e RecentTasks\n    TaskQuickPick --\u003e ConfiguredTasks  \n    TaskQuickPick --\u003e ExtensionTypes\n    \n    RecentTasks --\u003e RunTask\n    RecentTasks --\u003e RemoveRecent\n    ConfiguredTasks --\u003e RunTask\n    ConfiguredTasks --\u003e ConfigureTask\n    ExtensionTypes --\u003e RunTask\n```\n\n**Sources:** [src/vs/workbench/contrib/tasks/browser/taskQuickPick.ts:180-214](), [src/vs/workbench/contrib/tasks/browser/taskQuickPick.ts:231-291]()\n\n### Status Management\n\nTask terminals display status indicators that reflect the current state of task execution:\n\n| Status | Icon | Meaning |\n|--------|------|---------|\n| `ACTIVE_TASK_STATUS` | Spinning loader | Task is currently running |\n| `SUCCEEDED_TASK_STATUS` | Check mark | Task completed successfully |\n| `FAILED_TASK_STATUS` | Error icon | Task failed with errors |\n| `WARNING_TASK_STATUS` | Warning icon | Task completed with warnings |\n\n**Sources:** [src/vs/workbench/contrib/tasks/browser/taskTerminalStatus.ts:30-38](), [src/vs/workbench/contrib/tasks/browser/taskTerminalStatus.ts:67-119]()"])</script>
    <script>self.__next_f.push([1, "2d:T3dcc,"])</script>
    <script>self.__next_f.push([1, "# Task Service and Execution\n\n\u003cdetails\u003e\n\u003csummary\u003eRelevant source files\u003c/summary\u003e\n\nThe following files were used as context for generating this wiki page:\n\n- [extensions/vscode-api-tests/src/singlefolder-tests/terminal.test.ts](extensions/vscode-api-tests/src/singlefolder-tests/terminal.test.ts)\n- [extensions/vscode-api-tests/src/singlefolder-tests/workspace.tasks.test.ts](extensions/vscode-api-tests/src/singlefolder-tests/workspace.tasks.test.ts)\n- [src/vs/workbench/api/browser/mainThreadTask.ts](src/vs/workbench/api/browser/mainThreadTask.ts)\n- [src/vs/workbench/api/common/extHostTask.ts](src/vs/workbench/api/common/extHostTask.ts)\n- [src/vs/workbench/api/common/shared/tasks.ts](src/vs/workbench/api/common/shared/tasks.ts)\n- [src/vs/workbench/api/node/extHostTask.ts](src/vs/workbench/api/node/extHostTask.ts)\n- [src/vs/workbench/contrib/tasks/browser/abstractTaskService.ts](src/vs/workbench/contrib/tasks/browser/abstractTaskService.ts)\n- [src/vs/workbench/contrib/tasks/browser/runAutomaticTasks.ts](src/vs/workbench/contrib/tasks/browser/runAutomaticTasks.ts)\n- [src/vs/workbench/contrib/tasks/browser/task.contribution.ts](src/vs/workbench/contrib/tasks/browser/task.contribution.ts)\n- [src/vs/workbench/contrib/tasks/browser/taskQuickPick.ts](src/vs/workbench/contrib/tasks/browser/taskQuickPick.ts)\n- [src/vs/workbench/contrib/tasks/browser/taskService.ts](src/vs/workbench/contrib/tasks/browser/taskService.ts)\n- [src/vs/workbench/contrib/tasks/browser/taskTerminalStatus.ts](src/vs/workbench/contrib/tasks/browser/taskTerminalStatus.ts)\n- [src/vs/workbench/contrib/tasks/browser/terminalTaskSystem.ts](src/vs/workbench/contrib/tasks/browser/terminalTaskSystem.ts)\n- [src/vs/workbench/contrib/tasks/common/jsonSchema_v2.ts](src/vs/workbench/contrib/tasks/common/jsonSchema_v2.ts)\n- [src/vs/workbench/contrib/tasks/common/problemCollectors.ts](src/vs/workbench/contrib/tasks/common/problemCollectors.ts)\n- [src/vs/workbench/contrib/tasks/common/taskConfiguration.ts](src/vs/workbench/contrib/tasks/common/taskConfiguration.ts)\n- [src/vs/workbench/contrib/tasks/common/taskService.ts](src/vs/workbench/contrib/tasks/common/taskService.ts)\n- [src/vs/workbench/contrib/tasks/common/taskSystem.ts](src/vs/workbench/contrib/tasks/common/taskSystem.ts)\n- [src/vs/workbench/contrib/tasks/common/tasks.ts](src/vs/workbench/contrib/tasks/common/tasks.ts)\n- [src/vs/workbench/contrib/tasks/electron-browser/taskService.ts](src/vs/workbench/contrib/tasks/electron-browser/taskService.ts)\n- [src/vs/workbench/contrib/tasks/test/browser/taskTerminalStatus.test.ts](src/vs/workbench/contrib/tasks/test/browser/taskTerminalStatus.test.ts)\n\n\u003c/details\u003e\n\n\n\nThis document covers the task execution system in VS Code, focusing on how tasks are discovered, resolved, and executed. This includes the core task service architecture, the terminal-based execution engine, task lifecycle management, and integration with extensions.\n\nFor information about task configuration schemas and problem matchers, see [Task System](#10). For terminal integration details, see [Integrated Terminal](#5).\n\n## Architecture Overview\n\nThe task execution system is built around a layered architecture with clear separation between task management, execution engines, and extension integration.\n\n### Core Service Architecture\n\n```mermaid\ngraph TB\n    subgraph \"Task Service Layer\"\n        AbstractTaskService[\"AbstractTaskService\"]\n        ITaskService[\"ITaskService\"]\n        TaskQuickPick[\"TaskQuickPick\"]\n    end\n    \n    subgraph \"Execution Layer\" \n        TerminalTaskSystem[\"TerminalTaskSystem\"]\n        ITaskSystem[\"ITaskSystem\"]\n        TaskTerminalStatus[\"TaskTerminalStatus\"]\n    end\n    \n    subgraph \"Extension Integration\"\n        ExtHostTask[\"ExtHostTask\"]\n        MainThreadTask[\"MainThreadTask\"]\n        TaskProvider[\"ITaskProvider\"]\n    end\n    \n    subgraph \"Configuration Layer\"\n        TaskConfiguration[\"TaskConfiguration\"]\n        ProblemMatcher[\"ProblemMatcher\"]\n        TaskDefinitionRegistry[\"TaskDefinitionRegistry\"]\n    end\n    \n    AbstractTaskService --\u003e TerminalTaskSystem\n    AbstractTaskService --\u003e TaskQuickPick\n    TerminalTaskSystem --\u003e TaskTerminalStatus\n    ExtHostTask --\u003e MainThreadTask\n    MainThreadTask --\u003e AbstractTaskService\n    AbstractTaskService --\u003e TaskProvider\n    AbstractTaskService --\u003e TaskConfiguration\n    TerminalTaskSystem --\u003e ProblemMatcher\n```\n\nSources: [src/vs/workbench/contrib/tasks/browser/abstractTaskService.ts:197-395](), [src/vs/workbench/contrib/tasks/browser/terminalTaskSystem.ts:142-258](), [src/vs/workbench/contrib/tasks/common/taskService.ts:64-108]()\n\n### Task Type Hierarchy\n\n```mermaid\ngraph TB\n    Task[\"Task (base)\"]\n    ContributedTask[\"ContributedTask\"]\n    CustomTask[\"CustomTask\"] \n    ConfiguringTask[\"ConfiguringTask\"]\n    InMemoryTask[\"InMemoryTask\"]\n    \n    Task --\u003e ContributedTask\n    Task --\u003e CustomTask\n    Task --\u003e ConfiguringTask\n    Task --\u003e InMemoryTask\n    \n    subgraph \"Execution Types\"\n        ShellExecution[\"ShellExecution\"]\n        ProcessExecution[\"ProcessExecution\"] \n        CustomExecution[\"CustomExecution\"]\n    end\n    \n    Task --\u003e ShellExecution\n    Task --\u003e ProcessExecution\n    Task --\u003e CustomExecution\n```\n\nSources: [src/vs/workbench/contrib/tasks/common/tasks.ts:889-1200](), [src/vs/workbench/contrib/tasks/common/tasks.ts:290-317]()\n\n## Task Lifecycle Management\n\n### Task Discovery and Resolution\n\nThe task system discovers tasks from multiple sources and resolves them through a multi-stage process:\n\n| Stage | Component | Description |\n|-------|-----------|-------------|\n| Discovery | `AbstractTaskService.getWorkspaceTasks()` | Scans workspace for task configurations |\n| Provider Integration | `ITaskProvider.provideTasks()` | Collects tasks from extensions |\n| Variable Resolution | `TerminalTaskSystem._resolveVariablesFromSet()` | Resolves variables like `${workspaceFolder}` |\n| Dependency Resolution | `TerminalTaskSystem._executeTask()` | Handles task dependencies |\n| Execution | `TerminalTaskSystem.run()` | Executes the task in a terminal |\n\n```mermaid\nsequenceDiagram\n    participant User\n    participant AbstractTaskService\n    participant TaskProvider\n    participant TerminalTaskSystem\n    participant Terminal\n    \n    User-\u003e\u003eAbstractTaskService: run(task)\n    AbstractTaskService-\u003e\u003eTaskProvider: provideTasks()\n    TaskProvider--\u003e\u003eAbstractTaskService: tasks[]\n    AbstractTaskService-\u003e\u003eTerminalTaskSystem: run(task, resolver)\n    TerminalTaskSystem-\u003e\u003eTerminalTaskSystem: _resolveVariablesFromSet()\n    TerminalTaskSystem-\u003e\u003eTerminalTaskSystem: _executeTask()\n    TerminalTaskSystem-\u003e\u003eTerminal: createTerminal()\n    Terminal--\u003e\u003eTerminalTaskSystem: terminal instance\n    TerminalTaskSystem--\u003e\u003eAbstractTaskService: ITaskExecuteResult\n    AbstractTaskService--\u003e\u003eUser: TaskExecution\n```\n\nSources: [src/vs/workbench/contrib/tasks/browser/abstractTaskService.ts:794-873](), [src/vs/workbench/contrib/tasks/browser/terminalTaskSystem.ts:276-308](), [src/vs/workbench/contrib/tasks/browser/terminalTaskSystem.ts:517-603]()\n\n### Task Execution States\n\nTasks progress through defined states during execution, tracked by the `TaskEventKind` enum:\n\n```mermaid\nstateDiagram-v2\n    [*] --\u003e Start: \"TaskEventKind.Start\"\n    Start --\u003e AcquiredInput: \"TaskEventKind.AcquiredInput\" \n    AcquiredInput --\u003e DependsOnStarted: \"TaskEventKind.DependsOnStarted\"\n    DependsOnStarted --\u003e Active: \"TaskEventKind.Active\"\n    Active --\u003e ProcessStarted: \"TaskEventKind.ProcessStarted\"\n    ProcessStarted --\u003e ProcessEnded: \"TaskEventKind.ProcessEnded\"\n    ProcessEnded --\u003e Inactive: \"TaskEventKind.Inactive\"\n    ProcessStarted --\u003e Terminated: \"TaskEventKind.Terminated\"\n    Inactive --\u003e [*]\n    Terminated --\u003e [*]\n```\n\nSources: [src/vs/workbench/contrib/tasks/common/tasks.ts:1301-1330](), [src/vs/workbench/contrib/tasks/browser/terminalTaskSystem.ts:446-454]()\n\n## Terminal Task System\n\nThe `TerminalTaskSystem` is the primary execution engine that runs tasks in VS Code's integrated terminals.\n\n### Execution Flow\n\nThe execution process involves several key components working together:\n\n```mermaid\ngraph LR\n    subgraph \"Pre-Execution\"\n        VerifiedTask[\"VerifiedTask\"]\n        VariableResolver[\"VariableResolver\"]\n        DependencyResolver[\"DependencyResolver\"]\n    end\n    \n    subgraph \"Execution Core\"\n        TerminalCreation[\"Terminal Creation\"]\n        ShellLaunchConfig[\"IShellLaunchConfig\"]\n        ProcessExecution[\"Process Execution\"]\n    end\n    \n    subgraph \"Monitoring\"\n        ProblemCollector[\"ProblemCollector\"]\n        TaskTerminalStatus[\"TaskTerminalStatus\"]\n        ProgressTracking[\"Progress Tracking\"]\n    end\n    \n    VerifiedTask --\u003e VariableResolver\n    VariableResolver --\u003e DependencyResolver\n    DependencyResolver --\u003e TerminalCreation\n    TerminalCreation --\u003e ShellLaunchConfig\n    ShellLaunchConfig --\u003e ProcessExecution\n    ProcessExecution --\u003e ProblemCollector\n    ProcessExecution --\u003e TaskTerminalStatus\n    ProblemCollector --\u003e ProgressTracking\n```\n\nSources: [src/vs/workbench/contrib/tasks/browser/terminalTaskSystem.ts:110-140](), [src/vs/workbench/contrib/tasks/browser/terminalTaskSystem.ts:676-689](), [src/vs/workbench/contrib/tasks/browser/terminalTaskSystem.ts:712-779]()\n\n### Key Execution Classes\n\n| Class | Purpose | Key Methods |\n|-------|---------|-------------|\n| `TerminalTaskSystem` | Main execution engine | `run()`, `_executeTask()`, `terminate()` |\n| `VerifiedTask` | Validated task ready for execution | `verify()`, `getVerifiedTask()` |\n| `VariableResolver` | Resolves task variables | `resolve()`, `_replacer()` |\n| `TaskTerminalStatus` | Terminal status management | `addTerminal()`, `eventActive()` |\n\n### Terminal Management\n\nThe system maintains several data structures to track active terminals and tasks:\n\n```typescript\n// From TerminalTaskSystem class\nprivate _activeTasks: IStringDictionary\u003cIActiveTerminalData\u003e\nprivate _terminals: IStringDictionary\u003cITerminalData\u003e\nprivate _idleTaskTerminals: LinkedMap\u003cstring, string\u003e\nprivate _sameTaskTerminals: IStringDictionary\u003cstring\u003e\n```\n\nSources: [src/vs/workbench/contrib/tasks/browser/terminalTaskSystem.ts:184-191](), [src/vs/workbench/contrib/tasks/browser/terminalTaskSystem.ts:55-78]()\n\n## Task Configuration and Providers\n\n### Task Provider System\n\nExtensions register task providers through the `ITaskProvider` interface to contribute tasks:\n\n```mermaid\ngraph TB\n    subgraph \"Extension Host\"\n        ExtHostTask[\"ExtHostTask\"]\n        TaskProvider[\"TaskProvider\"]\n        ExtensionAPI[\"Extension API\"]\n    end\n    \n    subgraph \"Main Thread\"\n        MainThreadTask[\"MainThreadTask\"]\n        AbstractTaskService[\"AbstractTaskService\"]\n        TaskDefinitionRegistry[\"TaskDefinitionRegistry\"]\n    end\n    \n    ExtensionAPI --\u003e TaskProvider\n    TaskProvider --\u003e ExtHostTask\n    ExtHostTask --\u003e MainThreadTask\n    MainThreadTask --\u003e AbstractTaskService\n    TaskDefinitionRegistry --\u003e AbstractTaskService\n    \n    AbstractTaskService --\u003e TaskExecution[\"Task Execution\"]\n```\n\nSources: [src/vs/workbench/api/common/extHostTask.ts:34-51](), [src/vs/workbench/api/browser/mainThreadTask.ts:484-520](), [src/vs/workbench/contrib/tasks/browser/abstractTaskService.ts:727-744]()\n\n### Task Resolution Process\n\nTask resolution involves multiple phases to transform raw task definitions into executable tasks:\n\n```mermaid\nsequenceDiagram\n    participant Extension\n    participant ExtHostTask\n    participant MainThreadTask\n    participant AbstractTaskService\n    participant TerminalTaskSystem\n    \n    Extension-\u003e\u003eExtHostTask: registerTaskProvider()\n    ExtHostTask-\u003e\u003eMainThreadTask: $registerTaskProvider()\n    \n    Note over AbstractTaskService: User requests task execution\n    \n    AbstractTaskService-\u003e\u003eMainThreadTask: getTaskProvider()\n    MainThreadTask-\u003e\u003eExtHostTask: $provideTasks()\n    ExtHostTask-\u003e\u003eExtension: provideTasks()\n    Extension--\u003e\u003eExtHostTask: Task[]\n    ExtHostTask--\u003e\u003eMainThreadTask: TaskDTO[]\n    MainThreadTask--\u003e\u003eAbstractTaskService: Task[]\n    \n    AbstractTaskService-\u003e\u003eTerminalTaskSystem: run(task)\n    TerminalTaskSystem-\u003e\u003eTerminalTaskSystem: _resolveVariablesFromSet()\n    TerminalTaskSystem--\u003e\u003eAbstractTaskService: ITaskExecuteResult\n```\n\nSources: [src/vs/workbench/api/common/extHostTask.ts:95-122](), [src/vs/workbench/api/browser/mainThreadTask.ts:521-580](), [src/vs/workbench/contrib/tasks/browser/abstractTaskService.ts:1264-1320]()\n\n## Task Dependencies and Problem Matching\n\n### Dependency Execution\n\nTasks can depend on other tasks, executed either in parallel or sequence:\n\n```mermaid\ngraph TB\n    subgraph \"Task A (Main)\"\n        TaskA_Start[\"Start\"]\n        TaskA_Deps[\"Check Dependencies\"]\n        TaskA_Execute[\"Execute\"]\n        TaskA_End[\"Complete\"]\n    end\n    \n    subgraph \"Dependencies\"\n        TaskB[\"Task B\"]\n        TaskC[\"Task C\"]\n        TaskD[\"Task D\"]\n    end\n    \n    TaskA_Start --\u003e TaskA_Deps\n    TaskA_Deps --\u003e TaskB\n    TaskA_Deps --\u003e TaskC\n    TaskA_Deps --\u003e TaskD\n    \n    TaskB --\u003e TaskA_Execute\n    TaskC --\u003e TaskA_Execute\n    TaskD --\u003e TaskA_Execute\n    TaskA_Execute --\u003e TaskA_End\n    \n    subgraph \"Execution Order\"\n        Parallel[\"DependsOrder.parallel\"]\n        Sequence[\"DependsOrder.sequence\"]\n    end\n```\n\nSources: [src/vs/workbench/contrib/tasks/browser/terminalTaskSystem.ts:528-577](), [src/vs/workbench/contrib/tasks/common/tasks.ts:492-495]()\n\n### Problem Matcher Integration\n\nProblem matchers parse task output to identify and report issues:\n\n| Component | Purpose |\n|-----------|---------|\n| `StartStopProblemCollector` | Handles problem matching for finite tasks |\n| `WatchingProblemCollector` | Handles problem matching for background/watching tasks |\n| `ProblemMatcherRegistry` | Registry of available problem matchers |\n\n```mermaid\ngraph LR\n    TaskOutput[\"Task Terminal Output\"]\n    ProblemMatcher[\"Problem Matcher\"]\n    MarkerService[\"IMarkerService\"]\n    ProblemsPanel[\"Problems Panel\"]\n    \n    TaskOutput --\u003e ProblemMatcher\n    ProblemMatcher --\u003e MarkerService\n    MarkerService --\u003e ProblemsPanel\n    \n    subgraph \"Problem Collector Types\"\n        StartStop[\"StartStopProblemCollector\"]\n        Watching[\"WatchingProblemCollector\"]\n    end\n    \n    ProblemMatcher --\u003e StartStop\n    ProblemMatcher --\u003e Watching\n```\n\nSources: [src/vs/workbench/contrib/tasks/common/problemCollectors.ts:38-94](), [src/vs/workbench/contrib/tasks/browser/terminalTaskSystem.ts:1188-1254]()\n\n## Integration Points\n\n### Extension API Surface\n\nThe task system exposes a comprehensive API for extensions:\n\n| API Component | Purpose | Key Methods |\n|---------------|---------|-------------|\n| `tasks.registerTaskProvider()` | Register task providers | Extension registration |\n| `tasks.executeTask()` | Execute tasks programmatically | Task execution |\n| `tasks.fetchTasks()` | Get available tasks | Task discovery |\n| `tasks.onDidStartTask` | Task lifecycle events | Event handling |\n\n### Terminal Integration\n\nTasks integrate deeply with the terminal system for execution and status display:\n\n```mermaid\ngraph TB\n    subgraph \"Terminal Integration\"\n        ITerminalService[\"ITerminalService\"]\n        ITerminalInstance[\"ITerminalInstance\"]\n        TerminalStatusList[\"TerminalStatusList\"]\n        TaskTerminalStatus[\"TaskTerminalStatus\"]\n    end\n    \n    subgraph \"Task System\"\n        TerminalTaskSystem[\"TerminalTaskSystem\"]\n        AbstractTaskService[\"AbstractTaskService\"]\n    end\n    \n    TerminalTaskSystem --\u003e ITerminalService\n    ITerminalService --\u003e ITerminalInstance\n    ITerminalInstance --\u003e TerminalStatusList\n    TaskTerminalStatus --\u003e TerminalStatusList\n    TerminalTaskSystem --\u003e TaskTerminalStatus\n```\n\nSources: [src/vs/workbench/contrib/tasks/browser/terminalTaskSystem.ts:221-257](), [src/vs/workbench/contrib/tasks/browser/taskTerminalStatus.ts:40-68](), [extensions/vscode-api-tests/src/singlefolder-tests/workspace.tasks.test.ts:26-144]()"])</script>
    <script>self.__next_f.push([1, "5:[\"$\",\"$L12\",null,{\"repoName\":\"microsoft/vscode\",\"hasConfig\":false,\"children\":[\"$\",\"$L13\",null,{\"wiki\":{\"metadata\":{\"repo_name\":\"microsoft/vscode\",\"commit_hash\":\"0ab638ea\",\"generated_at\":\"2025-06-12T18:54:06.742347\",\"config\":null,\"config_source\":\"none\"},\"pages\":[{\"page_plan\":{\"id\":\"1\",\"title\":\"VS Code Architecture Overview\"},\"content\":\"$14\"},{\"page_plan\":{\"id\":\"1.1\",\"title\":\"Application Startup and Process Architecture\"},\"content\":\"$15\"},{\"page_plan\":{\"id\":\"1.2\",\"title\":\"Build System and Package Management\"},\"content\":\"$16\"},{\"page_plan\":{\"id\":\"2\",\"title\":\"Core Platform Services\"},\"content\":\"$17\"},{\"page_plan\":{\"id\":\"2.1\",\"title\":\"Configuration System\"},\"content\":\"$18\"},{\"page_plan\":{\"id\":\"2.2\",\"title\":\"Workbench Layout and Editor Management\"},\"content\":\"$19\"},{\"page_plan\":{\"id\":\"2.3\",\"title\":\"UI Components: Lists and Trees\"},\"content\":\"$1a\"},{\"page_plan\":{\"id\":\"3\",\"title\":\"Monaco Editor\"},\"content\":\"$1b\"},{\"page_plan\":{\"id\":\"3.1\",\"title\":\"Text Model and View Model\"},\"content\":\"$1c\"},{\"page_plan\":{\"id\":\"3.2\",\"title\":\"Editor Configuration and Features\"},\"content\":\"$1d\"},{\"page_plan\":{\"id\":\"4\",\"title\":\"Extension System\"},\"content\":\"$1e\"},{\"page_plan\":{\"id\":\"4.1\",\"title\":\"Extension Host and Language Features\"},\"content\":\"$1f\"},{\"page_plan\":{\"id\":\"4.2\",\"title\":\"Extension Management\"},\"content\":\"$20\"},{\"page_plan\":{\"id\":\"5\",\"title\":\"Integrated Terminal\"},\"content\":\"$21\"},{\"page_plan\":{\"id\":\"5.1\",\"title\":\"Terminal Architecture and Process Management\"},\"content\":\"$22\"},{\"page_plan\":{\"id\":\"6\",\"title\":\"Notebook Editor\"},\"content\":\"$23\"},{\"page_plan\":{\"id\":\"6.1\",\"title\":\"Notebook Model and Components\"},\"content\":\"$24\"},{\"page_plan\":{\"id\":\"7\",\"title\":\"Chat and AI Integration\"},\"content\":\"$25\"},{\"page_plan\":{\"id\":\"7.1\",\"title\":\"Chat System Architecture\"},\"content\":\"$26\"},{\"page_plan\":{\"id\":\"8\",\"title\":\"Source Control Management\"},\"content\":\"$27\"},{\"page_plan\":{\"id\":\"8.1\",\"title\":\"SCM Framework\"},\"content\":\"$28\"},{\"page_plan\":{\"id\":\"8.2\",\"title\":\"Git Extension\"},\"content\":\"$29\"},{\"page_plan\":{\"id\":\"9\",\"title\":\"Debugging System\"},\"content\":\"$2a\"},{\"page_plan\":{\"id\":\"9.1\",\"title\":\"Debug Service and Protocol\"},\"content\":\"$2b\"},{\"page_plan\":{\"id\":\"10\",\"title\":\"Task System\"},\"content\":\"$2c\"},{\"page_plan\":{\"id\":\"10.1\",\"title\":\"Task Service and Execution\"},\"content\":\"$2d\"}]},\"children\":[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]}]\n"])</script>
    <script>self.__next_f.push([1, "c:null\n10:[[\"$\",\"title\",\"0\",{\"children\":\"microsoft/vscode | DeepWiki\"}],[\"$\",\"meta\",\"1\",{\"name\":\"description\",\"content\":\"This document provides a high-level overview of Visual Studio Code's architecture, covering the main application structure, process model, and key design principles. It focuses on the core systems tha\"}],[\"$\",\"meta\",\"2\",{\"property\":\"og:title\",\"content\":\"microsoft/vscode | DeepWiki\"}],[\"$\",\"meta\",\"3\",{\"property\":\"og:description\",\"content\":\"This document provides a high-level overview of Visual Studio Code's architecture, covering the main application structure, process model, and key design principles. It focuses on the core systems tha\"}],[\"$\",\"meta\",\"4\",{\"property\":\"og:url\",\"content\":\"https://deepwiki.com/microsoft/vscode\"}],[\"$\",\"meta\",\"5\",{\"property\":\"og:site_name\",\"content\":\"DeepWiki\"}],[\"$\",\"meta\",\"6\",{\"property\":\"og:type\",\"content\":\"website\"}],[\"$\",\"meta\",\"7\",{\"name\":\"twitter:card\",\"content\":\"summary\"}],[\"$\",\"meta\",\"8\",{\"name\":\"twitter:title\",\"content\":\"microsoft/vscode | DeepWiki\"}],[\"$\",\"meta\",\"9\",{\"name\":\"twitter:description\",\"content\":\"This document provides a high-level overview of Visual Studio Code's architecture, covering the main application structure, process model, and key design principles. It focuses on the core systems tha\"}],[\"$\",\"link\",\"10\",{\"rel\":\"icon\",\"href\":\"/favicon.ico\",\"type\":\"image/x-icon\",\"sizes\":\"48x48\"}],[\"$\",\"link\",\"11\",{\"rel\":\"icon\",\"href\":\"/icon.png?66aaf51e0e68c818\",\"type\":\"image/png\",\"sizes\":\"16x16\"}],[\"$\",\"link\",\"12\",{\"rel\":\"apple-touch-icon\",\"href\":\"/apple-icon.png?a4f658907db0ab87\",\"type\":\"image/png\",\"sizes\":\"180x180\"}]]\n"])</script>
</body>

</html>